(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+3kh":function(Fe,_){},"+Dft":function(Fe,_,o){var x=o("BhfF"),p=o("jNud"),Y=o("H3Ql"),z=1/0,i=x&&1/Y(new x([,-0]))[1]==z?function(Z){return new x(Z)}:p;Fe.exports=i},"/e4g":function(Fe,_,o){"use strict";o.d(_,"a",function(){return bt});var x=o("L84c"),p=o.n(x),Y=o("b83N"),z=o.n(Y),i=o("xjNF"),Z=o.n(i),D=o("nSSz"),K=o("cxjn"),re=o("ylX1"),fe=o.n(re),X=o("PByh"),He=o.n(X),Xe=o("S+oY"),pe=o("T0ZP"),Ce=o.n(pe),mt=function(){function yt(xt,ze){z()(this,yt),this.attribute=void 0,this.buffer=void 0;var dt=ze.buffer,gt=ze.offset,Ht=ze.stride,hr=ze.normalized,Zr=ze.size,yr=ze.divisor;this.buffer=dt,this.attribute={buffer:dt.get(),offset:gt||0,stride:Ht||0,normalized:hr||!1,divisor:yr||0},Zr&&(this.attribute.size=Zr)}return Z()(yt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(ze){this.buffer.subData(ze)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),yt}(),Ne,At,Ye,Et,nt,Ct,Ot,Re,Ie,Be,ft,Me,ht,Wt,Qt=(Ne={},p()(Ne,K.gl.POINTS,"points"),p()(Ne,K.gl.LINES,"lines"),p()(Ne,K.gl.LINE_LOOP,"line loop"),p()(Ne,K.gl.LINE_STRIP,"line strip"),p()(Ne,K.gl.TRIANGLES,"triangles"),p()(Ne,K.gl.TRIANGLE_FAN,"triangle fan"),p()(Ne,K.gl.TRIANGLE_STRIP,"triangle strip"),Ne),ur=(At={},p()(At,K.gl.STATIC_DRAW,"static"),p()(At,K.gl.DYNAMIC_DRAW,"dynamic"),p()(At,K.gl.STREAM_DRAW,"stream"),At),oe=(Ye={},p()(Ye,K.gl.BYTE,"int8"),p()(Ye,K.gl.UNSIGNED_INT,"int16"),p()(Ye,K.gl.INT,"int32"),p()(Ye,K.gl.UNSIGNED_BYTE,"uint8"),p()(Ye,K.gl.UNSIGNED_SHORT,"uint16"),p()(Ye,K.gl.UNSIGNED_INT,"uint32"),p()(Ye,K.gl.FLOAT,"float"),Ye),J=(Et={},p()(Et,K.gl.ALPHA,"alpha"),p()(Et,K.gl.LUMINANCE,"luminance"),p()(Et,K.gl.LUMINANCE_ALPHA,"luminance alpha"),p()(Et,K.gl.RGB,"rgb"),p()(Et,K.gl.RGBA,"rgba"),p()(Et,K.gl.RGBA4,"rgba4"),p()(Et,K.gl.RGB5_A1,"rgb5 a1"),p()(Et,K.gl.RGB565,"rgb565"),p()(Et,K.gl.DEPTH_COMPONENT,"depth"),p()(Et,K.gl.DEPTH_STENCIL,"depth stencil"),Et),H=(nt={},p()(nt,K.gl.DONT_CARE,"dont care"),p()(nt,K.gl.NICEST,"nice"),p()(nt,K.gl.FASTEST,"fast"),nt),Se=(Ct={},p()(Ct,K.gl.NEAREST,"nearest"),p()(Ct,K.gl.LINEAR,"linear"),p()(Ct,K.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),p()(Ct,K.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),p()(Ct,K.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),p()(Ct,K.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Ct),be=(Ot={},p()(Ot,K.gl.REPEAT,"repeat"),p()(Ot,K.gl.CLAMP_TO_EDGE,"clamp"),p()(Ot,K.gl.MIRRORED_REPEAT,"mirror"),Ot),_e=(Re={},p()(Re,K.gl.NONE,"none"),p()(Re,K.gl.BROWSER_DEFAULT_WEBGL,"browser"),Re),me=(Ie={},p()(Ie,K.gl.NEVER,"never"),p()(Ie,K.gl.ALWAYS,"always"),p()(Ie,K.gl.LESS,"less"),p()(Ie,K.gl.LEQUAL,"lequal"),p()(Ie,K.gl.GREATER,"greater"),p()(Ie,K.gl.GEQUAL,"gequal"),p()(Ie,K.gl.EQUAL,"equal"),p()(Ie,K.gl.NOTEQUAL,"notequal"),Ie),it=(Be={},p()(Be,K.gl.FUNC_ADD,"add"),p()(Be,K.gl.MIN_EXT,"min"),p()(Be,K.gl.MAX_EXT,"max"),p()(Be,K.gl.FUNC_SUBTRACT,"subtract"),p()(Be,K.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Be),qt=(ft={},p()(ft,K.gl.ZERO,"zero"),p()(ft,K.gl.ONE,"one"),p()(ft,K.gl.SRC_COLOR,"src color"),p()(ft,K.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),p()(ft,K.gl.SRC_ALPHA,"src alpha"),p()(ft,K.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),p()(ft,K.gl.DST_COLOR,"dst color"),p()(ft,K.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),p()(ft,K.gl.DST_ALPHA,"dst alpha"),p()(ft,K.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),p()(ft,K.gl.CONSTANT_COLOR,"constant color"),p()(ft,K.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),p()(ft,K.gl.CONSTANT_ALPHA,"constant alpha"),p()(ft,K.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),p()(ft,K.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),ft),Pt=(Me={},p()(Me,K.gl.NEVER,"never"),p()(Me,K.gl.ALWAYS,"always"),p()(Me,K.gl.LESS,"less"),p()(Me,K.gl.LEQUAL,"lequal"),p()(Me,K.gl.GREATER,"greater"),p()(Me,K.gl.GEQUAL,"gequal"),p()(Me,K.gl.EQUAL,"equal"),p()(Me,K.gl.NOTEQUAL,"notequal"),Me),ve=(ht={},p()(ht,K.gl.ZERO,"zero"),p()(ht,K.gl.KEEP,"keep"),p()(ht,K.gl.REPLACE,"replace"),p()(ht,K.gl.INVERT,"invert"),p()(ht,K.gl.INCR,"increment"),p()(ht,K.gl.DECR,"decrement"),p()(ht,K.gl.INCR_WRAP,"increment wrap"),p()(ht,K.gl.DECR_WRAP,"decrement wrap"),ht),ge=(Wt={},p()(Wt,K.gl.FRONT,"front"),p()(Wt,K.gl.BACK,"back"),Wt),Ve=function(){function yt(xt,ze){z()(this,yt),this.buffer=void 0;var dt=ze.data,gt=ze.usage,Ht=ze.type;this.buffer=xt.buffer({data:dt,usage:ur[gt||K.gl.STATIC_DRAW],type:oe[Ht||K.gl.UNSIGNED_BYTE]})}return Z()(yt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(ze){var dt=ze.data,gt=ze.offset;this.buffer.subdata(dt,gt)}}]),yt}(),st=function(){function yt(xt,ze){z()(this,yt),this.elements=void 0;var dt=ze.data,gt=ze.usage,Ht=ze.type,hr=ze.count;this.elements=xt.elements({data:dt,usage:ur[gt||K.gl.STATIC_DRAW],type:oe[Ht||K.gl.UNSIGNED_BYTE],count:hr})}return Z()(yt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(ze){var dt=ze.data;this.elements.subdata(dt)}},{key:"destroy",value:function(){}}]),yt}(),Oe=function(){function yt(xt,ze){z()(this,yt),this.framebuffer=void 0;var dt=ze.width,gt=ze.height,Ht=ze.color,hr=ze.colors,Zr=ze.depth,yr=ze.stencil,Vn={width:dt,height:gt};Array.isArray(hr)&&(Vn.colors=hr.map(function(Fn){return Fn.get()})),Ht&&typeof Ht!="boolean"&&(Vn.color=Ht.get()),this.framebuffer=xt.framebuffer(Vn)}return Z()(yt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(ze){var dt=ze.width,gt=ze.height;this.framebuffer.resize(dt,gt)}}]),yt}(),vt=o("yS0f"),C=o.n(vt),R=o("tuRO"),q=o.n(R),ce=o("5RAj"),Ge=o.n(ce);function qe(yt,xt){var ze=Object.keys(yt);if(Object.getOwnPropertySymbols){var dt=Object.getOwnPropertySymbols(yt);xt&&(dt=dt.filter(function(gt){return Object.getOwnPropertyDescriptor(yt,gt).enumerable})),ze.push.apply(ze,dt)}return ze}function Tt(yt){for(var xt=1;xt<arguments.length;xt++){var ze=arguments[xt]!=null?arguments[xt]:{};xt%2?qe(Object(ze),!0).forEach(function(dt){p()(yt,dt,ze[dt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(yt,Object.getOwnPropertyDescriptors(ze)):qe(Object(ze)).forEach(function(dt){Object.defineProperty(yt,dt,Object.getOwnPropertyDescriptor(ze,dt))})}return yt}var ot=function(){function yt(xt,ze){z()(this,yt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=xt;var dt=ze.vs,gt=ze.fs,Ht=ze.attributes,hr=ze.uniforms,Zr=ze.primitive,yr=ze.count,Vn=ze.elements,Fn=ze.depth,oa=ze.blend,$n=ze.stencil,Kn=ze.cull,Cn=ze.instances,F={};this.options=ze,hr&&(this.uniforms=this.extractUniforms(hr),Object.keys(hr).forEach(function(xe){F[xe]=xt.prop(xe)}));var W={};Object.keys(Ht).forEach(function(xe){W[xe]=Ht[xe].get()});var le={attributes:W,frag:gt,uniforms:F,vert:dt,primitive:Qt[Zr===void 0?K.gl.TRIANGLES:Zr]};Cn&&(le.instances=Cn),yr&&(le.count=yr),Vn&&(le.elements=Vn.get()),this.initDepthDrawParams({depth:Fn},le),this.initBlendDrawParams({blend:oa},le),this.initStencilDrawParams({stencil:$n},le),this.initCullDrawParams({cull:Kn},le),this.drawCommand=xt(le),this.drawParams=le}return Z()(yt,[{key:"addUniforms",value:function(ze){this.uniforms=Tt(Tt({},this.uniforms),this.extractUniforms(ze))}},{key:"draw",value:function(ze){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var dt=Tt(Tt({},this.uniforms),this.extractUniforms(ze.uniforms||{})),gt={};Object.keys(dt).forEach(function(Ht){var hr=C()(dt[Ht]);hr==="boolean"||hr==="number"||Array.isArray(dt[Ht])||dt[Ht].BYTES_PER_ELEMENT?gt[Ht]=dt[Ht]:gt[Ht]=dt[Ht].get()}),this.drawCommand(gt)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(ze){ze.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(ze,dt){var gt=ze.depth;gt&&(dt.depth={enable:gt.enable===void 0?!0:!!gt.enable,mask:gt.mask===void 0?!0:!!gt.mask,func:me[gt.func||K.gl.LESS],range:gt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(ze,dt){var gt=ze.blend;if(gt){var Ht=gt.enable,hr=gt.func,Zr=gt.equation,yr=gt.color,Vn=yr===void 0?[0,0,0,0]:yr;dt.blend={enable:!!Ht,func:{srcRGB:qt[hr&&hr.srcRGB||K.gl.SRC_ALPHA],srcAlpha:qt[hr&&hr.srcAlpha||K.gl.SRC_ALPHA],dstRGB:qt[hr&&hr.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:qt[hr&&hr.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:it[Zr&&Zr.rgb||K.gl.FUNC_ADD],alpha:it[Zr&&Zr.alpha||K.gl.FUNC_ADD]},color:Vn}}}},{key:"initStencilDrawParams",value:function(ze,dt){var gt=ze.stencil;if(gt){var Ht=gt.enable,hr=gt.mask,Zr=hr===void 0?-1:hr,yr=gt.func,Vn=yr===void 0?{cmp:K.gl.ALWAYS,ref:0,mask:-1}:yr,Fn=gt.opFront,oa=Fn===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:Fn,$n=gt.opBack,Kn=$n===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:$n;dt.stencil={enable:!!Ht,mask:Zr,func:Tt(Tt({},Vn),{},{cmp:Pt[Vn.cmp]}),opFront:{fail:ve[oa.fail],zfail:ve[oa.zfail],zpass:ve[oa.zpass]},opBack:{fail:ve[Kn.fail],zfail:ve[Kn.zfail],zpass:ve[Kn.zpass]}}}}},{key:"initCullDrawParams",value:function(ze,dt){var gt=ze.cull;if(gt){var Ht=gt.enable,hr=gt.face,Zr=hr===void 0?K.gl.BACK:hr;dt.cull={enable:!!Ht,face:ge[Zr]}}}},{key:"extractUniforms",value:function(ze){var dt=this,gt={};return Object.keys(ze).forEach(function(Ht){dt.extractUniformsRecursively(Ht,ze[Ht],gt,"")}),gt}},{key:"extractUniformsRecursively",value:function(ze,dt,gt,Ht){var hr=this;if(dt===null||typeof dt=="number"||typeof dt=="boolean"||Array.isArray(dt)&&typeof dt[0]=="number"||q()(dt)||dt===""||"resize"in dt){gt["".concat(Ht&&Ht+".").concat(ze)]=dt;return}Ge()(dt)&&Object.keys(dt).forEach(function(Zr){hr.extractUniformsRecursively(Zr,dt[Zr],gt,"".concat(Ht&&Ht+".").concat(ze))}),Array.isArray(dt)&&dt.forEach(function(Zr,yr){Object.keys(Zr).forEach(function(Vn){hr.extractUniformsRecursively(Vn,Zr[Vn],gt,"".concat(Ht&&Ht+".").concat(ze,"[").concat(yr,"]"))})})}}]),yt}(),Ut=function(){function yt(xt,ze){z()(this,yt),this.texture=void 0,this.width=void 0,this.height=void 0;var dt=ze.data,gt=ze.type,Ht=gt===void 0?K.gl.UNSIGNED_BYTE:gt,hr=ze.width,Zr=ze.height,yr=ze.flipY,Vn=yr===void 0?!1:yr,Fn=ze.format,oa=Fn===void 0?K.gl.RGBA:Fn,$n=ze.mipmap,Kn=$n===void 0?!1:$n,Cn=ze.wrapS,F=Cn===void 0?K.gl.CLAMP_TO_EDGE:Cn,W=ze.wrapT,le=W===void 0?K.gl.CLAMP_TO_EDGE:W,xe=ze.aniso,ut=xe===void 0?0:xe,wt=ze.alignment,Bt=wt===void 0?1:wt,Ze=ze.premultiplyAlpha,Rt=Ze===void 0?!1:Ze,lr=ze.mag,Ur=lr===void 0?K.gl.NEAREST:lr,Gr=ze.min,cr=Gr===void 0?K.gl.NEAREST:Gr,Br=ze.colorSpace,wn=Br===void 0?K.gl.BROWSER_DEFAULT_WEBGL:Br;this.width=hr,this.height=Zr;var fn={width:hr,height:Zr,type:oe[Ht],format:J[oa],wrapS:be[F],wrapT:be[le],mag:Se[Ur],min:Se[cr],alignment:Bt,flipY:Vn,colorSpace:_e[wn],premultiplyAlpha:Rt,aniso:ut};dt&&(fn.data=dt),typeof Kn=="number"?fn.mipmap=H[Kn]:typeof Kn=="boolean"&&(fn.mipmap=Kn),this.texture=xt.texture(fn)}return Z()(yt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(ze)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(ze){var dt=ze.width,gt=ze.height;this.texture.resize(dt,gt),this.width=dt,this.height=gt}},{key:"destroy",value:function(){this.texture.destroy()}}]),yt}(),$,Qe,ae,et=($=Object(Xe.injectable)(),$(Qe=(ae=function(){function yt(){var xt=this;z()(this,yt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(ze){return new ot(xt.gl,ze)},this.createAttribute=function(ze){return new mt(xt.gl,ze)},this.createBuffer=function(ze){return new Ve(xt.gl,ze)},this.createElements=function(ze){return new st(xt.gl,ze)},this.createTexture2D=function(ze){return new Ut(xt.gl,ze)},this.createFramebuffer=function(ze){return new Oe(xt.gl,ze)},this.useFramebuffer=function(ze,dt){xt.gl({framebuffer:ze?ze.get():null})(dt)},this.clear=function(ze){var dt=ze.color,gt=ze.depth,Ht=ze.stencil,hr=ze.framebuffer,Zr=hr===void 0?null:hr,yr={color:dt,depth:gt,stencil:Ht};yr.framebuffer=Zr===null?Zr:Zr.get(),xt.gl.clear(yr)},this.viewport=function(ze){var dt=ze.x,gt=ze.y,Ht=ze.width,hr=ze.height;xt.gl._gl.viewport(dt,gt,Ht,hr),xt.width=Ht,xt.height=hr,xt.gl._refresh()},this.readPixels=function(ze){var dt=ze.framebuffer,gt=ze.x,Ht=ze.y,hr=ze.width,Zr=ze.height,yr={x:gt,y:Ht,width:hr,height:Zr};return dt&&(yr.framebuffer=dt.get()),xt.gl.read(yr)},this.getViewportSize=function(){return{width:xt.gl._gl.drawingBufferWidth,height:xt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var ze;return(ze=xt.canvas)===null||ze===void 0?void 0:ze.parentElement},this.getCanvas=function(){return xt.canvas},this.getGLContext=function(){return xt.gl._gl},this.destroy=function(){xt.gl.destroy()}}return Z()(yt,[{key:"init",value:function(){var xt=He()(fe.a.mark(function dt(gt,Ht){var hr=this;return fe.a.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return this.canvas=gt,yr.next=3,new Promise(function(Vn,Fn){Ce()({canvas:hr.canvas,attributes:{alpha:!0,antialias:Ht.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Ht.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function($n,Kn){($n||!Kn)&&Fn($n),Vn(Kn)}})});case 3:this.gl=yr.sent;case 4:case"end":return yr.stop()}},dt,this)}));function ze(dt,gt){return xt.apply(this,arguments)}return ze}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var ze=this.getGLContext();ze.disable(ze.CULL_FACE)}},{key:"setDirty",value:function(ze){this.isDirty=ze}},{key:"getDirty",value:function(){return this.isDirty}}]),yt}(),ae))||Qe),kt=o("LhPA");function pr(yt,xt){var ze=Object.keys(yt);if(Object.getOwnPropertySymbols){var dt=Object.getOwnPropertySymbols(yt);xt&&(dt=dt.filter(function(gt){return Object.getOwnPropertyDescriptor(yt,gt).enumerable})),ze.push.apply(ze,dt)}return ze}function Ke(yt){for(var xt=1;xt<arguments.length;xt++){var ze=arguments[xt]!=null?arguments[xt]:{};xt%2?pr(Object(ze),!0).forEach(function(dt){p()(yt,dt,ze[dt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(yt,Object.getOwnPropertyDescriptors(ze)):pr(Object(ze)).forEach(function(dt){Object.defineProperty(yt,dt,Object.getOwnPropertyDescriptor(ze,dt))})}return yt}var bt=function(){function yt(xt){z()(this,yt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var ze=xt.id,dt=xt.map,gt=Object(K.createSceneContainer)();this.container=gt,dt.setContainer(gt,ze),gt.bind(K.TYPES.IRendererService).to(et).inSingletonScope(),this.sceneService=gt.get(K.TYPES.ISceneService),this.mapService=gt.get(K.TYPES.IMapService),this.iconService=gt.get(K.TYPES.IIconService),this.fontService=gt.get(K.TYPES.IFontService),this.controlService=gt.get(K.TYPES.IControlService),this.layerService=gt.get(K.TYPES.ILayerService),this.markerService=gt.get(K.TYPES.IMarkerService),this.interactionService=gt.get(K.TYPES.IInteractionService),this.popupService=gt.get(K.TYPES.IPopupService),this.initComponent(ze),this.sceneService.init(xt),this.initControl()}return Z()(yt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(ze){return this.sceneService.exportPng(ze)}},{key:"exportMap",value:function(ze){return this.sceneService.exportPng(ze)}},{key:"registerRenderService",value:function(ze){var dt=this;if(this.sceneService.loaded){var gt=new ze(this);gt.init()}else this.on("loaded",function(){var Ht=new ze(dt);Ht.init()})}},{key:"addLayer",value:function(ze){var dt=Object(K.createLayerContainer)(this.container);ze.setContainer(dt),this.sceneService.addLayer(ze)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(ze){return this.layerService.getLayer(ze)}},{key:"getLayerByName",value:function(ze){return this.layerService.getLayerByName(ze)}},{key:"removeLayer",value:function(ze){this.layerService.remove(ze)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(ze,dt){this.iconService.addImage(ze,dt)}},{key:"hasImage",value:function(ze){return this.iconService.hasImage(ze)}},{key:"removeImage",value:function(ze){this.iconService.removeImage(ze)}},{key:"addIconFontGlyphs",value:function(ze,dt){this.fontService.addIconGlyphs(dt)}},{key:"addControl",value:function(ze){this.controlService.addControl(ze,this.container)}},{key:"removeControl",value:function(ze){this.controlService.removeControl(ze)}},{key:"getControlByName",value:function(ze){return this.controlService.getControlByName(ze)}},{key:"addMarker",value:function(ze){this.markerService.addMarker(ze)}},{key:"addMarkerLayer",value:function(ze){this.markerService.addMarkerLayer(ze)}},{key:"removeMarkerLayer",value:function(ze){this.markerService.removeMarkerLayer(ze)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(ze){this.popupService.addPopup(ze)}},{key:"on",value:function(ze,dt){K.SceneEventList.indexOf(ze)===-1?this.mapService.on(ze,dt):this.sceneService.on(ze,dt)}},{key:"off",value:function(ze,dt){K.SceneEventList.indexOf(ze)===-1?this.mapService.off(ze,dt):this.sceneService.off(ze,dt)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(ze){return this.mapService.setCenter(ze)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(ze){return this.mapService.setPitch(ze)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(ze){this.mapService.setRotation(ze)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(ze){this.mapService.panTo(ze)}},{key:"panBy",value:function(ze){this.mapService.panBy(ze)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(ze){this.mapService.setZoom(ze)}},{key:"fitBounds",value:function(ze,dt){var gt=this.sceneService.getSceneConfig(),Ht=gt.fitBoundsOptions,hr=gt.animate;this.mapService.fitBounds(ze,dt||Ke(Ke({},Ht),{},{animate:hr}))}},{key:"setZoomAndCenter",value:function(ze,dt){this.mapService.setZoomAndCenter(ze,dt)}},{key:"setMapStyle",value:function(ze){this.mapService.setMapStyle(ze)}},{key:"setMapStatus",value:function(ze){this.mapService.setMapStatus(ze)}},{key:"pixelToLngLat",value:function(ze){return this.mapService.pixelToLngLat(ze)}},{key:"lngLatToPixel",value:function(ze){return this.mapService.lngLatToPixel(ze)}},{key:"containerToLngLat",value:function(ze){return this.mapService.containerToLngLat(ze)}},{key:"lngLatToContainer",value:function(ze){return this.mapService.lngLatToContainer(ze)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(ze,dt){this.container.bind(K.TYPES.IPostProcessingPass).to(ze).whenTargetNamed(dt)}},{key:"initComponent",value:function(ze){this.controlService.init({container:kt.a.getContainer(ze)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var ze=this.sceneService.getSceneConfig(),dt=ze.logoVisible,gt=ze.logoPosition;dt&&this.addControl(new D.b({position:gt}))}},{key:"map",get:function(){return this.mapService.map}}]),yt}()},"/jsB":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0}),_.NAMED_TAG="named",_.NAME_TAG="name",_.UNMANAGED_TAG="unmanaged",_.OPTIONAL_TAG="optional",_.INJECT_TAG="inject",_.MULTI_INJECT_TAG="multi_inject",_.TAGGED="inversify:tagged",_.TAGGED_PROP="inversify:tagged_props",_.PARAM_TYPES="inversify:paramtypes",_.DESIGN_PARAM_TYPES="design:paramtypes",_.POST_CONSTRUCT="post_construct"},"0326":function(Fe,_,o){var x=o("Udc0"),p=o("OUY8"),Y=o("lvid");function z(i){return p(i)?Y(i):x(i)}Fe.exports=z},"0RSn":function(Fe,_){var o=Object.prototype,x=o.hasOwnProperty;function p(Y){var z=Y.length,i=new Y.constructor(z);return z&&typeof Y[0]=="string"&&x.call(Y,"index")&&(i.index=Y.index,i.input=Y.input),i}Fe.exports=p},"0d2E":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0}),_.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",_.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",_.NULL_ARGUMENT="NULL argument",_.KEY_NOT_FOUND="Key Not Found",_.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",_.CANNOT_UNBIND="Could not unbind serviceIdentifier:",_.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",_.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",_.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",_.UNDEFINED_INJECT_ANNOTATION=function(x){return"@inject called with undefined this could mean that the class "+x+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},_.CIRCULAR_DEPENDENCY="Circular dependency found:",_.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",_.INVALID_BINDING_TYPE="Invalid binding type:",_.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",_.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",_.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",_.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",_.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",_.ARGUMENTS_LENGTH_MISMATCH=function(){for(var x=[],p=0;p<arguments.length;p++)x[p]=arguments[p];return"The number of constructor arguments in the derived class "+(x[0]+" must be >= than the number of constructor arguments of its base class.")},_.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",_.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",_.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",_.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",_.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",_.POST_CONSTRUCT_ERROR=function(){for(var x=[],p=0;p<arguments.length;p++)x[p]=arguments[p];return"@postConstruct error in class "+x[0]+": "+x[1]},_.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var x=[],p=0;p<arguments.length;p++)x[p]=arguments[p];return"It looks like there is a circular dependency "+("in one of the '"+x[0]+"' bindings. Please investigate bindings with")+("service identifier '"+x[1]+"'.")},_.STACK_OVERFLOW="Maximum call stack size exceeded"},"0eeP":function(Fe,_,o){"use strict";var x=o("++Hr"),p=o.n(x),Y=o("Z2dz"),z=o.n(Y),i=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Z(ht){return i.indexOf(ht)}var D=2,K=4,re=64,fe=128,X=256,He=512,Xe=8192,pe=16384,Ce=32768,mt=32768*2,Ne=131072,At=262144,Ye=524288,Et=1048576,nt=2097152,Ct=4194304,Ot=8388608,Re=16777216,Ie=16777216*2;function Be(ht,Wt){return ht=z()(Math.floor(ht),0,255),Wt=z()(Math.floor(Wt),0,255),256*ht+Wt}function ft(ht){var Wt=ht.color,Qt=ht.radius,ur=ht.tileX,oe=ht.tileY,J=ht.shape,H=ht.opacity,Se=ht.stroke,be=ht.strokeWidth,_e=ht.strokeOpacity,me=[],it=[],qt=[],Pt=[Be(Wt[0],Wt[1]),Be(Wt[2],Wt[3])],ve=[Be(Se[0],Se[1]),Be(Se[2],Se[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ge){var Ve=p()(ge,2),st=Ve[0],Oe=Ve[1];me.push([].concat(Pt,[(st+1)*Ot+(Oe+1)*nt+Z(J)*Ne+Qt,(ur+512)*Ye+(oe+512)*re])),it.push([].concat(ve,[be,_e])),qt.push([H,0,0,0])}),{packedBuffer:me,packedBuffer2:it,packedBuffer3:qt}}function Me(ht,Wt){if(ht===0&&!Wt)return 0;if(ht===1&&Wt)return 4294967295;var Qt=Wt?1:0,ur=Math.floor(ht*127);return ur*Ie+Qt*Re+ur*Ne+Qt*mt+ur*He+Qt*X+ur*D+Qt}},"1B40":function(Fe,_,o){var x=o("BTtX");function p(Y){return Y&&Y.length?x(Y):[]}Fe.exports=p},"1BAa":function(Fe,_,o){(function(x,p){var Y=200,z="__lodash_hash_undefined__",i=800,Z=16,D=9007199254740991,K="[object Arguments]",re="[object Array]",fe="[object AsyncFunction]",X="[object Boolean]",He="[object Date]",Xe="[object Error]",pe="[object Function]",Ce="[object GeneratorFunction]",mt="[object Map]",Ne="[object Number]",At="[object Null]",Ye="[object Object]",Et="[object Proxy]",nt="[object RegExp]",Ct="[object Set]",Ot="[object String]",Re="[object Undefined]",Ie="[object WeakMap]",Be="[object ArrayBuffer]",ft="[object DataView]",Me="[object Float32Array]",ht="[object Float64Array]",Wt="[object Int8Array]",Qt="[object Int16Array]",ur="[object Int32Array]",oe="[object Uint8Array]",J="[object Uint8ClampedArray]",H="[object Uint16Array]",Se="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,_e=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,it={};it[Me]=it[ht]=it[Wt]=it[Qt]=it[ur]=it[oe]=it[J]=it[H]=it[Se]=!0,it[K]=it[re]=it[Be]=it[X]=it[ft]=it[He]=it[Xe]=it[pe]=it[mt]=it[Ne]=it[Ye]=it[nt]=it[Ct]=it[Ot]=it[Ie]=!1;var qt=typeof x=="object"&&x&&x.Object===Object&&x,Pt=typeof self=="object"&&self&&self.Object===Object&&self,ve=qt||Pt||Function("return this")(),ge=_&&!_.nodeType&&_,Ve=ge&&typeof p=="object"&&p&&!p.nodeType&&p,st=Ve&&Ve.exports===ge,Oe=st&&qt.process,vt=function(){try{var It=Ve&&Ve.require&&Ve.require("util").types;return It||Oe&&Oe.binding&&Oe.binding("util")}catch(fr){}}(),C=vt&&vt.isTypedArray;function R(It,fr,Pr){switch(Pr.length){case 0:return It.call(fr);case 1:return It.call(fr,Pr[0]);case 2:return It.call(fr,Pr[0],Pr[1]);case 3:return It.call(fr,Pr[0],Pr[1],Pr[2])}return It.apply(fr,Pr)}function q(It,fr){for(var Pr=-1,Wn=Array(It);++Pr<It;)Wn[Pr]=fr(Pr);return Wn}function ce(It){return function(fr){return It(fr)}}function Ge(It,fr){return It==null?void 0:It[fr]}function qe(It,fr){return function(Pr){return It(fr(Pr))}}var Tt=Array.prototype,ot=Function.prototype,Ut=Object.prototype,$=ve["__core-js_shared__"],Qe=ot.toString,ae=Ut.hasOwnProperty,et=function(){var It=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return It?"Symbol(src)_1."+It:""}(),kt=Ut.toString,pr=Qe.call(Object),Ke=RegExp("^"+Qe.call(ae).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=st?ve.Buffer:void 0,yt=ve.Symbol,xt=ve.Uint8Array,ze=bt?bt.allocUnsafe:void 0,dt=qe(Object.getPrototypeOf,Object),gt=Object.create,Ht=Ut.propertyIsEnumerable,hr=Tt.splice,Zr=yt?yt.toStringTag:void 0,yr=function(){try{var It=bu(Object,"defineProperty");return It({},"",{}),It}catch(fr){}}(),Vn=bt?bt.isBuffer:void 0,Fn=Math.max,oa=Date.now,$n=bu(ve,"Map"),Kn=bu(Object,"create"),Cn=function(){function It(){}return function(fr){if(!To(fr))return{};if(gt)return gt(fr);It.prototype=fr;var Pr=new It;return It.prototype=void 0,Pr}}();function F(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function W(){this.__data__=Kn?Kn(null):{},this.size=0}function le(It){var fr=this.has(It)&&delete this.__data__[It];return this.size-=fr?1:0,fr}function xe(It){var fr=this.__data__;if(Kn){var Pr=fr[It];return Pr===z?void 0:Pr}return ae.call(fr,It)?fr[It]:void 0}function ut(It){var fr=this.__data__;return Kn?fr[It]!==void 0:ae.call(fr,It)}function wt(It,fr){var Pr=this.__data__;return this.size+=this.has(It)?0:1,Pr[It]=Kn&&fr===void 0?z:fr,this}F.prototype.clear=W,F.prototype.delete=le,F.prototype.get=xe,F.prototype.has=ut,F.prototype.set=wt;function Bt(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function Ze(){this.__data__=[],this.size=0}function Rt(It){var fr=this.__data__,Pr=Wi(fr,It);if(Pr<0)return!1;var Wn=fr.length-1;return Pr==Wn?fr.pop():hr.call(fr,Pr,1),--this.size,!0}function lr(It){var fr=this.__data__,Pr=Wi(fr,It);return Pr<0?void 0:fr[Pr][1]}function Ur(It){return Wi(this.__data__,It)>-1}function Gr(It,fr){var Pr=this.__data__,Wn=Wi(Pr,It);return Wn<0?(++this.size,Pr.push([It,fr])):Pr[Wn][1]=fr,this}Bt.prototype.clear=Ze,Bt.prototype.delete=Rt,Bt.prototype.get=lr,Bt.prototype.has=Ur,Bt.prototype.set=Gr;function cr(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function Br(){this.size=0,this.__data__={hash:new F,map:new($n||Bt),string:new F}}function wn(It){var fr=so(this,It).delete(It);return this.size-=fr?1:0,fr}function fn(It){return so(this,It).get(It)}function tr(It){return so(this,It).has(It)}function rn(It,fr){var Pr=so(this,It),Wn=Pr.size;return Pr.set(It,fr),this.size+=Pr.size==Wn?0:1,this}cr.prototype.clear=Br,cr.prototype.delete=wn,cr.prototype.get=fn,cr.prototype.has=tr,cr.prototype.set=rn;function dn(It){var fr=this.__data__=new Bt(It);this.size=fr.size}function En(){this.__data__=new Bt,this.size=0}function bn(It){var fr=this.__data__,Pr=fr.delete(It);return this.size=fr.size,Pr}function gn(It){return this.__data__.get(It)}function Mn(It){return this.__data__.has(It)}function Ga(It,fr){var Pr=this.__data__;if(Pr instanceof Bt){var Wn=Pr.__data__;if(!$n||Wn.length<Y-1)return Wn.push([It,fr]),this.size=++Pr.size,this;Pr=this.__data__=new cr(Wn)}return Pr.set(It,fr),this.size=Pr.size,this}dn.prototype.clear=En,dn.prototype.delete=bn,dn.prototype.get=gn,dn.prototype.has=Mn,dn.prototype.set=Ga;function ga(It,fr){var Pr=Ol(It),Wn=!Pr&&Nu(It),Ya=!Pr&&!Wn&&xu(It),xi=!Pr&&!Wn&&!Ya&&Ks(It),Ki=Pr||Wn||Ya||xi,Ka=Ki?q(It.length,String):[],Di=Ka.length;for(var Yo in It)(fr||ae.call(It,Yo))&&!(Ki&&(Yo=="length"||Ya&&(Yo=="offset"||Yo=="parent")||xi&&(Yo=="buffer"||Yo=="byteLength"||Yo=="byteOffset")||js(Yo,Di)))&&Ka.push(Yo);return Ka}function Ma(It,fr,Pr){(Pr!==void 0&&!Mo(It[fr],Pr)||Pr===void 0&&!(fr in It))&&da(It,fr,Pr)}function Ia(It,fr,Pr){var Wn=It[fr];(!(ae.call(It,fr)&&Mo(Wn,Pr))||Pr===void 0&&!(fr in It))&&da(It,fr,Pr)}function Wi(It,fr){for(var Pr=It.length;Pr--;)if(Mo(It[Pr][0],fr))return Pr;return-1}function da(It,fr,Pr){fr=="__proto__"&&yr?yr(It,fr,{configurable:!0,enumerable:!0,value:Pr,writable:!0}):It[fr]=Pr}var vi=oo();function ya(It){return It==null?It===void 0?Re:At:Zr&&Zr in Object(It)?Qo(It):en(It)}function ba(It){return Fi(It)&&ya(It)==K}function ha(It){if(!To(It)||Le(It))return!1;var fr=Po(It)?Ke:_e;return fr.test(mo(It))}function wi(It){return Fi(It)&&ku(It.length)&&!!it[ya(It)]}function is(It){if(!To(It))return vr(It);var fr=Dt(It),Pr=[];for(var Wn in It)Wn=="constructor"&&(fr||!ae.call(It,Wn))||Pr.push(Wn);return Pr}function Xi(It,fr,Pr,Wn,Ya){if(It===fr)return;vi(fr,function(xi,Ki){if(Ya||(Ya=new dn),To(xi))Xo(It,fr,Ki,Pr,Xi,Wn,Ya);else{var Ka=Wn?Wn(Gn(It,Ki),xi,Ki+"",It,fr,Ya):void 0;Ka===void 0&&(Ka=xi),Ma(It,Ki,Ka)}},Ii)}function Xo(It,fr,Pr,Wn,Ya,xi,Ki){var Ka=Gn(It,Pr),Di=Gn(fr,Pr),Yo=Ki.get(Di);if(Yo){Ma(It,Pr,Yo);return}var Ps=xi?xi(Ka,Di,Pr+"",It,fr,Ki):void 0,gi=Ps===void 0;if(gi){var Ml=Ol(Di),$s=!Ml&&xu(Di),Ss=!Ml&&!$s&&Ks(Di);Ps=Di,Ml||$s||Ss?Ol(Ka)?Ps=Ka:pc(Ka)?Ps=Yi(Ka):$s?(gi=!1,Ps=Oi(Di,!0)):Ss?(gi=!1,Ps=ui(Di,!0)):Ps=[]:Ys(Di)||Nu(Di)?(Ps=Ka,Nu(Ka)?Ps=zs(Ka):(!To(Ka)||Po(Ka))&&(Ps=Xl(Di))):gi=!1}gi&&(Ki.set(Di,Ps),Ya(Ps,Di,Wn,xi,Ki),Ki.delete(Di)),Ma(It,Pr,Ps)}function Du(It,fr){return Mi(_n(It,fr,ml),It+"")}var Ha=yr?function(It,fr){return yr(It,"toString",{configurable:!0,enumerable:!1,value:Ts(fr),writable:!0})}:ml;function Oi(It,fr){if(fr)return It.slice();var Pr=It.length,Wn=ze?ze(Pr):new It.constructor(Pr);return It.copy(Wn),Wn}function Jo(It){var fr=new It.constructor(It.byteLength);return new xt(fr).set(new xt(It)),fr}function ui(It,fr){var Pr=fr?Jo(It.buffer):It.buffer;return new It.constructor(Pr,It.byteOffset,It.length)}function Yi(It,fr){var Pr=-1,Wn=It.length;for(fr||(fr=Array(Wn));++Pr<Wn;)fr[Pr]=It[Pr];return fr}function Oo(It,fr,Pr,Wn){var Ya=!Pr;Pr||(Pr={});for(var xi=-1,Ki=fr.length;++xi<Ki;){var Ka=fr[xi],Di=Wn?Wn(Pr[Ka],It[Ka],Ka,Pr,It):void 0;Di===void 0&&(Di=It[Ka]),Ya?da(Pr,Ka,Di):Ia(Pr,Ka,Di)}return Pr}function Za(It){return Du(function(fr,Pr){var Wn=-1,Ya=Pr.length,xi=Ya>1?Pr[Ya-1]:void 0,Ki=Ya>2?Pr[2]:void 0;for(xi=It.length>3&&typeof xi=="function"?(Ya--,xi):void 0,Ki&&ho(Pr[0],Pr[1],Ki)&&(xi=Ya<3?void 0:xi,Ya=1),fr=Object(fr);++Wn<Ya;){var Ka=Pr[Wn];Ka&&It(fr,Ka,Wn,xi)}return fr})}function oo(It){return function(fr,Pr,Wn){for(var Ya=-1,xi=Object(fr),Ki=Wn(fr),Ka=Ki.length;Ka--;){var Di=Ki[It?Ka:++Ya];if(Pr(xi[Di],Di,xi)===!1)break}return fr}}function so(It,fr){var Pr=It.__data__;return Vt(fr)?Pr[typeof fr=="string"?"string":"hash"]:Pr.map}function bu(It,fr){var Pr=Ge(It,fr);return ha(Pr)?Pr:void 0}function Qo(It){var fr=ae.call(It,Zr),Pr=It[Zr];try{It[Zr]=void 0;var Wn=!0}catch(xi){}var Ya=kt.call(It);return Wn&&(fr?It[Zr]=Pr:delete It[Zr]),Ya}function Xl(It){return typeof It.constructor=="function"&&!Dt(It)?Cn(dt(It)):{}}function js(It,fr){var Pr=typeof It;return fr=fr==null?D:fr,!!fr&&(Pr=="number"||Pr!="symbol"&&me.test(It))&&It>-1&&It%1==0&&It<fr}function ho(It,fr,Pr){if(!To(Pr))return!1;var Wn=typeof fr;return(Wn=="number"?_s(Pr)&&js(fr,Pr.length):Wn=="string"&&fr in Pr)?Mo(Pr[fr],It):!1}function Vt(It){var fr=typeof It;return fr=="string"||fr=="number"||fr=="symbol"||fr=="boolean"?It!=="__proto__":It===null}function Le(It){return!!et&&et in It}function Dt(It){var fr=It&&It.constructor,Pr=typeof fr=="function"&&fr.prototype||Ut;return It===Pr}function vr(It){var fr=[];if(It!=null)for(var Pr in Object(It))fr.push(Pr);return fr}function en(It){return kt.call(It)}function _n(It,fr,Pr){return fr=Fn(fr===void 0?It.length-1:fr,0),function(){for(var Wn=arguments,Ya=-1,xi=Fn(Wn.length-fr,0),Ki=Array(xi);++Ya<xi;)Ki[Ya]=Wn[fr+Ya];Ya=-1;for(var Ka=Array(fr+1);++Ya<fr;)Ka[Ya]=Wn[Ya];return Ka[fr]=Pr(Ki),R(It,this,Ka)}}function Gn(It,fr){return fr==="constructor"&&typeof It[fr]=="function"||fr=="__proto__"?void 0:It[fr]}var Mi=po(Ha);function po(It){var fr=0,Pr=0;return function(){var Wn=oa(),Ya=Z-(Wn-Pr);if(Pr=Wn,Ya>0){if(++fr>=i)return arguments[0]}else fr=0;return It.apply(void 0,arguments)}}function mo(It){if(It!=null){try{return Qe.call(It)}catch(fr){}try{return It+""}catch(fr){}}return""}function Mo(It,fr){return It===fr||It!==It&&fr!==fr}var Nu=ba(function(){return arguments}())?ba:function(It){return Fi(It)&&ae.call(It,"callee")&&!Ht.call(It,"callee")},Ol=Array.isArray;function _s(It){return It!=null&&ku(It.length)&&!Po(It)}function pc(It){return Fi(It)&&_s(It)}var xu=Vn||$u;function Po(It){if(!To(It))return!1;var fr=ya(It);return fr==pe||fr==Ce||fr==fe||fr==Et}function ku(It){return typeof It=="number"&&It>-1&&It%1==0&&It<=D}function To(It){var fr=typeof It;return It!=null&&(fr=="object"||fr=="function")}function Fi(It){return It!=null&&typeof It=="object"}function Ys(It){if(!Fi(It)||ya(It)!=Ye)return!1;var fr=dt(It);if(fr===null)return!0;var Pr=ae.call(fr,"constructor")&&fr.constructor;return typeof Pr=="function"&&Pr instanceof Pr&&Qe.call(Pr)==pr}var Ks=C?ce(C):wi;function zs(It){return Oo(It,Ii(It))}function Ii(It){return _s(It)?ga(It,!0):is(It)}var Gi=Za(function(It,fr,Pr,Wn){Xi(It,fr,Pr,Wn)});function Ts(It){return function(){return It}}function ml(It){return It}function $u(){return!1}p.exports=Gi}).call(this,o("UywP"),o("qrga")(Fe))},"1oef":function(Fe,_,o){"use strict";var x="2.3.1"},2:function(Fe,_){},"2F1M":function(Fe,_,o){var x=o("mCIU"),p=o("SSN4"),Y="[object Number]";function z(i){return typeof i=="number"||p(i)&&x(i)==Y}Fe.exports=z},"2pGt":function(Fe,_,o){"use strict";var x=Object.prototype.hasOwnProperty,p="~";function Y(){}Object.create&&(Y.prototype=Object.create(null),new Y().__proto__||(p=!1));function z(K,re,fe){this.fn=K,this.context=re,this.once=fe||!1}function i(K,re,fe,X,He){if(typeof fe!="function")throw new TypeError("The listener must be a function");var Xe=new z(fe,X||K,He),pe=p?p+re:re;return K._events[pe]?K._events[pe].fn?K._events[pe]=[K._events[pe],Xe]:K._events[pe].push(Xe):(K._events[pe]=Xe,K._eventsCount++),K}function Z(K,re){--K._eventsCount===0?K._events=new Y:delete K._events[re]}function D(){this._events=new Y,this._eventsCount=0}D.prototype.eventNames=function(){var re=[],fe,X;if(this._eventsCount===0)return re;for(X in fe=this._events)x.call(fe,X)&&re.push(p?X.slice(1):X);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(fe)):re},D.prototype.listeners=function(re){var fe=p?p+re:re,X=this._events[fe];if(!X)return[];if(X.fn)return[X.fn];for(var He=0,Xe=X.length,pe=new Array(Xe);He<Xe;He++)pe[He]=X[He].fn;return pe},D.prototype.listenerCount=function(re){var fe=p?p+re:re,X=this._events[fe];return X?X.fn?1:X.length:0},D.prototype.emit=function(re,fe,X,He,Xe,pe){var Ce=p?p+re:re;if(!this._events[Ce])return!1;var mt=this._events[Ce],Ne=arguments.length,At,Ye;if(mt.fn){mt.once&&this.removeListener(re,mt.fn,void 0,!0);switch(Ne){case 1:return mt.fn.call(mt.context),!0;case 2:return mt.fn.call(mt.context,fe),!0;case 3:return mt.fn.call(mt.context,fe,X),!0;case 4:return mt.fn.call(mt.context,fe,X,He),!0;case 5:return mt.fn.call(mt.context,fe,X,He,Xe),!0;case 6:return mt.fn.call(mt.context,fe,X,He,Xe,pe),!0}for(Ye=1,At=new Array(Ne-1);Ye<Ne;Ye++)At[Ye-1]=arguments[Ye];mt.fn.apply(mt.context,At)}else{var Et=mt.length,nt;for(Ye=0;Ye<Et;Ye++){mt[Ye].once&&this.removeListener(re,mt[Ye].fn,void 0,!0);switch(Ne){case 1:mt[Ye].fn.call(mt[Ye].context);break;case 2:mt[Ye].fn.call(mt[Ye].context,fe);break;case 3:mt[Ye].fn.call(mt[Ye].context,fe,X);break;case 4:mt[Ye].fn.call(mt[Ye].context,fe,X,He);break;default:if(!At)for(nt=1,At=new Array(Ne-1);nt<Ne;nt++)At[nt-1]=arguments[nt];mt[Ye].fn.apply(mt[Ye].context,At)}}}return!0},D.prototype.on=function(re,fe,X){return i(this,re,fe,X,!1)},D.prototype.once=function(re,fe,X){return i(this,re,fe,X,!0)},D.prototype.removeListener=function(re,fe,X,He){var Xe=p?p+re:re;if(!this._events[Xe])return this;if(!fe)return Z(this,Xe),this;var pe=this._events[Xe];if(pe.fn)pe.fn===fe&&(!He||pe.once)&&(!X||pe.context===X)&&Z(this,Xe);else{for(var Ce=0,mt=[],Ne=pe.length;Ce<Ne;Ce++)(pe[Ce].fn!==fe||He&&!pe[Ce].once||X&&pe[Ce].context!==X)&&mt.push(pe[Ce]);mt.length?this._events[Xe]=mt.length===1?mt[0]:mt:Z(this,Xe)}return this},D.prototype.removeAllListeners=function(re){var fe;return re?(fe=p?p+re:re,this._events[fe]&&Z(this,fe)):(this._events=new Y,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=p,D.EventEmitter=D,Fe.exports=D},"2ru6":function(Fe,_,o){"use strict";o.r(_);var x=o("Jqop"),p=o("hcOk"),Y=o("hhz5"),z=o("l76O"),i=o("x00w"),Z=o("MAyr"),D=o("Dk3c"),K=o("lO9p"),re=o("dv+D"),fe=o("OmhC"),X=o("hyHi"),He=o("Yfmi"),Xe=o("9kvl"),pe=o("xwgP"),Ce=o.n(pe),mt=o("IT+u"),Ne=o("BS6i"),At=o.n(Ne),Ye=o("cXu0"),Et=o("tlpD");function nt(w){var y=w.style;y.height="100%";var c=parseInt("".concat(getComputedStyle(w).height),10),d=parseInt("".concat(getComputedStyle(w).paddingTop),10)+parseInt("".concat(getComputedStyle(w).paddingBottom),10);return c-d}function Ct(w){if(!w)return 0;var y=w,c=nt(y),d=y.parentNode;return d&&(c=nt(d)),c}function Ot(){return function(w){var y=function(c){Object(re.a)(g,c);var d=Object(fe.a)(g);function g(){var I;Object(D.a)(this,g);for(var ee=arguments.length,B=new Array(ee),k=0;k<ee;k++)B[k]=arguments[k];return I=d.call.apply(d,[this].concat(B)),I.state={computedHeight:0},I.root=null,I.handleRoot=function(Q){I.root=Q},I}return Object(K.a)(g,[{key:"componentDidMount",value:function(){var ee=this.props.height;if(!ee&&this.root){var B=Ct(this.root);this.setState({computedHeight:B}),B<1&&(B=Ct(this.root),this.setState({computedHeight:B}))}}},{key:"render",value:function(){var ee=this.props.height,B=this.state.computedHeight,k=ee||B;return Ce.a.createElement("div",{ref:this.handleRoot},k>0&&Ce.a.createElement(w,Object(Et.a)({},this.props,{height:k})))}}]),g}(Ce.a.Component);return y}}var Re=Ot,Ie=Ye.Guide.Arc,Be=Ye.Guide.Html,ft=Ye.Guide.Line,Me=function(y){switch(y){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};Ye.Shape.registerShape&&Ye.Shape.registerShape("point","pointer",{drawShape:function(y,c){var d=y.points[0];d=this.parsePoint(d);var g=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:g.x,y1:g.y,x2:d.x,y2:d.y,stroke:y.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:g.x,y:g.y,r:6,stroke:y.color,lineWidth:3,fill:"#fff"}})}});var ht=function(y){var c=y.title,d=y.height,g=d===void 0?1:d,I=y.percent,ee=y.forceFit,B=ee===void 0?!0:ee,k=y.formatter,Q=k===void 0?Me:k,We=y.color,tt=We===void 0?"#2F9CFF":We,Pe=y.bgColor,Je=Pe===void 0?"#F0F2F5":Pe,_t={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},ke=[{value:I/10}],pt=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((ke[0].value*10).toFixed(2),`%
    </div>
  </div>`)},De={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Ce.a.createElement(Ye.Chart,{height:g,data:ke,scale:_t,padding:[-16,0,16,0],forceFit:B},Ce.a.createElement(Ye.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Ce.a.createElement(Ye.Axis,{name:"1",line:void 0}),Ce.a.createElement(Ye.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:Q,textStyle:De}}),Ce.a.createElement(Ye.Guide,null,Ce.a.createElement(ft,{start:[3,.905],end:[3,.85],lineStyle:{stroke:tt,lineDash:void 0,lineWidth:2}}),Ce.a.createElement(ft,{start:[5,.905],end:[5,.85],lineStyle:{stroke:tt,lineDash:void 0,lineWidth:3}}),Ce.a.createElement(ft,{start:[7,.905],end:[7,.85],lineStyle:{stroke:tt,lineDash:void 0,lineWidth:3}}),Ce.a.createElement(Ie,{start:[0,.965],end:[10,.965],style:{stroke:Je,lineWidth:10}}),Ce.a.createElement(Ie,{start:[0,.965],end:[ke[0].value,.965],style:{stroke:tt,lineWidth:10}}),Ce.a.createElement(Be,{position:["50%","95%"],html:pt()})),Ce.a.createElement(Ye.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:tt,active:!1}))},Wt=Re()(ht),Qt=o("0hF1"),ur={miniChart:"miniChart___27WlV",chartContent:"chartContent___2FNqq",chartLoading:"chartLoading___2DxhP"},oe=function(y){var c=y.height,d=c===void 0?1:c,g=y.data,I=g===void 0?[]:g,ee=y.forceFit,B=ee===void 0?!0:ee,k=y.color,Q=k===void 0?"rgba(24, 144, 255, 0.2)":k,We=y.borderColor,tt=We===void 0?"#1089ff":We,Pe=y.scale,Je=Pe===void 0?{x:{},y:{}}:Pe,_t=y.borderWidth,ke=_t===void 0?2:_t,pt=y.line,De=y.xAxis,Zt=y.yAxis,Kt=y.animate,dr=Kt===void 0?!0:Kt,rr=[36,5,30,5],mr={x:Object(Qt.a)({type:"cat",range:[0,1]},Je.x),y:Object(Qt.a)({min:0},Je.y)},Or=["x*y",function(Bn,on){return{name:Bn,value:on}}],$r=d+54;return Ce.a.createElement("div",{className:ur.miniChart,style:{height:d}},Ce.a.createElement("div",{className:ur.chartContent},d>0&&Ce.a.createElement(Ye.Chart,{animate:dr,scale:mr,height:$r,forceFit:B,data:I,padding:rr},Ce.a.createElement(Ye.Axis,Object(Et.a)({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},De)),Ce.a.createElement(Ye.Axis,Object(Et.a)({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},Zt)),Ce.a.createElement(Ye.Tooltip,{showTitle:!1,crosshairs:!1}),Ce.a.createElement(Ye.Geom,{type:"area",position:"x*y",color:Q,tooltip:Or,shape:"smooth",style:{fillOpacity:1}}),pt?Ce.a.createElement(Ye.Geom,{type:"line",position:"x*y",shape:"smooth",color:tt,size:ke,tooltip:!1}):Ce.a.createElement("span",{style:{display:"none"}}))))},J=Re()(oe),H=o("vzln"),Se=o("acbc"),be=o("KPh1"),_e=o("HpMi"),me=o.n(_e),it=o("TX3P"),qt=o.n(it),Pt=o("ZvQp"),ve=o.n(Pt),ge=o("iczh"),Ve=o.n(ge),st={pie:"pie___2nzPi",chart:"chart____y02v",hasLegend:"hasLegend___2tvLi",legend:"legend___aOylG",dot:"dot___3cUod",line:"line___3wzdx",legendTitle:"legendTitle___3d-qz",percent:"percent___1EUip",value:"value___3oEZu",title:"title___3EZr5",total:"total___2C3lg",legendBlock:"legendBlock___1RfCR"},Oe=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){var d;Object(D.a)(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.state={legendData:[],legendBlock:!1},d.chart=void 0,d.root=void 0,d.requestRef=0,d.resize=qt()(function(){var B=d.props.hasLegend,k=d.state.legendBlock;if(!B||!d.root){window.removeEventListener("resize",d.resize);return}d.root&&d.root.parentNode&&d.root.parentNode.clientWidth<=380?k||d.setState({legendBlock:!0}):k&&d.setState({legendBlock:!1})},300),d.getG2Instance=function(B){d.chart=B,requestAnimationFrame(function(){d.getLegendData(),d.resize()})},d.getLegendData=function(){if(!d.chart)return;var B=d.chart.getAllGeoms()[0];if(!B)return;var k=B.get("dataArray")||[],Q=k.map(function(We){var tt=We[0]._origin;return tt.color=We[0].color,tt.checked=!0,tt});d.setState({legendData:Q})},d.handleRoot=function(B){d.root=B},d.handleLegendClick=function(B,k){var Q=B;Q.checked=!Q.checked;var We=d.state.legendData;We[k]=Q;var tt=We.filter(function(Pe){return Pe.checked}).map(function(Pe){return Pe.x});d.chart&&d.chart.filter("x",function(Pe){return tt.indexOf("".concat(Pe))>-1}),d.setState({legendData:We})},d}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var g=this;window.addEventListener("resize",function(){g.requestRef=requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var I=this.props.data;I!==g.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var g,I=this,ee=this.props,B=ee.valueFormat,k=ee.subTitle,Q=ee.total,We=ee.hasLegend,tt=We===void 0?!1:We,Pe=ee.className,Je=ee.style,_t=ee.height,ke=_t===void 0?0:_t,pt=ee.forceFit,De=pt===void 0?!0:pt,Zt=ee.percent,Kt=ee.color,dr=ee.inner,rr=dr===void 0?.75:dr,mr=ee.animate,Or=mr===void 0?!0:mr,$r=ee.colors,Bn=ee.lineWidth,on=Bn===void 0?1:Bn,Dn=this.state,ca=Dn.legendData,Na=Dn.legendBlock,ri=Ve()(st.pie,Pe,(g={},Object(be.a)(g,st.hasLegend,!!tt),Object(be.a)(g,st.legendBlock,Na),g)),co=this.props,Hc=co.data,ys=co.selected,fc=ys===void 0?!0:ys,xo=co.tooltip,Wl=xo===void 0?!0:xo,Xu=Hc||[],pl=fc,wl=Wl,Mf=$r;Xu=Xu||[],pl=pl||!0,wl=wl||!0;var za,li={x:{type:"cat",range:[0,1]},y:{min:0}};(Zt||Zt===0)&&(pl=!1,wl=!1,za=function(rh){return rh==="\u5360\u6BD4"?Kt||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},Xu=[{x:"\u5360\u6BD4",y:parseFloat("".concat(Zt))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(Zt))}]);var lh=["x*percent",function(hc,rh){return{name:hc,value:"".concat((rh*100).toFixed(2),"%")}}],th=[12,0,12,0],Dh=new _e.DataView;return Dh.source(Xu).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Ce.a.createElement("div",{ref:this.handleRoot,className:ri,style:Je},Ce.a.createElement(ve.a,{maxFontSize:25},Ce.a.createElement("div",{className:st.chart},Ce.a.createElement(Ye.Chart,{scale:li,height:ke,forceFit:De,data:Dh,padding:th,animate:Or,onGetG2Instance:this.getG2Instance},!!wl&&Ce.a.createElement(Ye.Tooltip,{showTitle:!1}),Ce.a.createElement(Ye.Coord,{type:"theta",innerRadius:rr}),Ce.a.createElement(Ye.Geom,{style:{lineWidth:on,stroke:"#fff"},tooltip:wl?lh:void 0,type:"intervalStack",position:"percent",color:["x",Zt||Zt===0?za:Mf],selected:pl})),(k||Q)&&Ce.a.createElement("div",{className:st.total},k&&Ce.a.createElement("h4",{className:"pie-sub-title"},k),Q&&Ce.a.createElement("div",{className:"pie-stat"},typeof Q=="function"?Q():Q)))),tt&&Ce.a.createElement("ul",{className:st.legend},ca.map(function(hc,rh){return Ce.a.createElement("li",{key:hc.x,onClick:function(){return I.handleLegendClick(hc,rh)}},Ce.a.createElement("span",{className:st.dot,style:{backgroundColor:hc.checked?hc.color:"#aaa"}}),Ce.a.createElement("span",{className:st.legendTitle},hc.x),Ce.a.createElement(Se.a,{type:"vertical"}),Ce.a.createElement("span",{className:st.percent},"".concat((Number.isNaN(hc.percent)?0:hc.percent*100).toFixed(2),"%")),Ce.a.createElement("span",{className:st.value},B?B(hc.y):hc.y))})))}}]),c}(pe.Component),vt=Re()(Oe),C=o("4+7e"),R={tagCloud:"tagCloud___Blez5"},q="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",ce=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){var d;Object(D.a)(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.state={dv:null,height:0,width:0},d.requestRef=0,d.isUnmount=!1,d.root=void 0,d.imageMask=void 0,d.resize=function(){d.requestRef=requestAnimationFrame(function(){d.renderChart(d.props)})},d.saveRootRef=function(B){d.root=B},d.initTagCloud=function(){function B(k){return Object(Qt.a)(Object(Qt.a)({},k.style),{},{fillOpacity:k.opacity,fontSize:k.origin._origin.size,rotate:k.origin._origin.rotate,text:k.origin._origin.text,textAlign:"center",fontFamily:k.origin._origin.font,fill:k.color,textBaseline:"Alphabetic"})}Ye.Shape.registerShape("point","cloud",{drawShape:function(Q,We){var tt=B(Q);return We.addShape("text",{attrs:Object(Qt.a)(Object(Qt.a)({},tt),{},{x:Q.x,y:Q.y})})}})},d.renderChart=qt()(function(B){var k=B||d.props,Q=k.data,We=k.height;if(Q.length<1||!d.root)return;var tt=We,Pe=d.root.offsetWidth,Je=function(){var ke=new me.a.View().source(Q),pt=ke.range("value"),De=Object(C.a)(pt,2),Zt=De[0],Kt=De[1];if(ke.transform({type:"tag-cloud",fields:["name","value"],imageMask:d.imageMask,font:"Verdana",size:[Pe,tt],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(rr){var mr=Math.pow((rr.value-Zt)/(Kt-Zt),2);return mr*(17.5-5)+5}}),d.isUnmount)return;d.setState({dv:ke,width:Pe,height:tt})};d.imageMask?Je():(d.imageMask=new Image,d.imageMask.crossOrigin="",d.imageMask.src=q,d.imageMask.onload=Je)},200),d}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var g=this;requestAnimationFrame(function(){g.initTagCloud(),g.renderChart(g.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(g){var I=this.props.data;g&&JSON.stringify(g.data)!==JSON.stringify(I)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var g=this.props,I=g.className,ee=g.height,B=this.state,k=B.dv,Q=B.width,We=B.height;return Ce.a.createElement("div",{className:Ve()(R.tagCloud,I),style:{width:"100%",height:ee},ref:this.saveRootRef},k&&Ce.a.createElement(Ye.Chart,{width:Q,height:We,data:k,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},Ce.a.createElement(Ye.Tooltip,{showTitle:!1}),Ce.a.createElement(Ye.Coord,{reflect:"y"}),Ce.a.createElement(Ye.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Pe,Je){return{name:Pe,value:Je}}]})))}}]),c}(pe.Component),Ge=Re()(ce),qe={waterWave:"waterWave___hvLJA",text:"text___3asSo",waterWaveCanvasWrapper:"waterWaveCanvasWrapper___2ndFj"},Tt=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){var d;Object(D.a)(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.state={radio:1},d.timer=0,d.root=null,d.node=null,d.resize=function(){if(d.root){var B=d.props.height,k=B===void 0?1:B,Q=d.root.parentNode.offsetWidth;d.setState({radio:Q<k?Q/k:1})}},d}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var g=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var I=this.props.percent;g.percent!==I&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(g){var I=this.props,ee=I.percent,B=I.color,k=B===void 0?"#1890FF":B,Q=ee/100,We=this;if(cancelAnimationFrame(this.timer),!this.node||Q!==0&&!Q)return;var tt=this.node,Pe=tt.getContext("2d");if(!Pe)return;var Je=tt.width,_t=tt.height,ke=Je/2,pt=2,De=ke-pt;Pe.beginPath(),Pe.lineWidth=pt*2;for(var Zt=Je-pt,Kt=Zt/8,dr=.2,rr=dr,mr=pt,Or=0,$r=0,Bn=.005,on=[],Dn=ke-pt,ca=-(Math.PI/2),Na=!0,ri=ca;ri<ca+2*Math.PI;ri+=1/(8*Math.PI))on.push([ke+Dn*Math.cos(ri),ke+Dn*Math.sin(ri)]);var co=on.shift();Pe.strokeStyle=k,Pe.moveTo(co[0],co[1]);function Hc(){if(!Pe)return;Pe.beginPath(),Pe.save();for(var fc=[],xo=mr;xo<=mr+Zt;xo+=20/Zt){var Wl=Or+(mr+xo)/Kt,Xu=Math.sin(Wl)*rr,pl=xo,wl=2*De*(1-$r)+(ke-De)-Kt*Xu;Pe.lineTo(pl,wl),fc.push([pl,wl])}var Mf=fc.shift();Pe.lineTo(mr+Zt,_t),Pe.lineTo(mr,_t),Pe.lineTo(Mf[0],Mf[1]);var za=Pe.createLinearGradient(0,0,0,_t);za.addColorStop(0,"#ffffff"),za.addColorStop(1,k),Pe.fillStyle=za,Pe.fill(),Pe.restore()}function ys(){if(!Pe)return;if(Pe.clearRect(0,0,Je,_t),Na&&g!=="update")if(on.length){var fc=on.shift();Pe.lineTo(fc[0],fc[1]),Pe.stroke()}else Na=!1,Pe.lineTo(co[0],co[1]),Pe.stroke(),on=[],Pe.globalCompositeOperation="destination-over",Pe.beginPath(),Pe.lineWidth=pt,Pe.arc(ke,ke,Dn,0,2*Math.PI,!0),Pe.beginPath(),Pe.save(),Pe.arc(ke,ke,ke-3*pt,0,2*Math.PI,!0),Pe.restore(),Pe.clip(),Pe.fillStyle=k;else{if(Q>=.85){if(rr>dr/4){var xo=dr*.01;rr-=xo}}else if(Q<=.1){if(rr<dr*1.5){var Wl=dr*.01;rr+=Wl}}else{if(rr<=dr){var Xu=dr*.01;rr+=Xu}if(rr>=dr){var pl=dr*.01;rr-=pl}}Q-$r>0&&($r+=Bn),Q-$r<0&&($r-=Bn),Or+=.07,Hc()}We.timer=requestAnimationFrame(ys)}ys()}},{key:"render",value:function(){var g=this,I=this.state.radio,ee=this.props,B=ee.percent,k=ee.title,Q=ee.height,We=Q===void 0?1:Q;return Ce.a.createElement("div",{className:qe.waterWave,ref:function(Pe){return g.root=Pe},style:{transform:"scale(".concat(I,")")}},Ce.a.createElement("div",{style:{width:We,height:We,overflow:"hidden"}},Ce.a.createElement("canvas",{className:qe.waterWaveCanvasWrapper,ref:function(Pe){return g.node=Pe},width:We*2,height:We*2})),Ce.a.createElement("div",{className:qe.text,style:{width:We}},k&&Ce.a.createElement("span",null,k),Ce.a.createElement("h4",null,B,"%")))}}]),c}(pe.Component),ot=Re()(Tt),Ut=o("ylX1"),$=o.n(Ut),Qe=o("LpHj"),ae=Object(pe.createContext)({});function et(){return Object(pe.useContext)(ae)}var kt=o("FTvH"),pr=o("b83N"),Ke=o.n(pr),bt=o("xjNF"),yt=o.n(bt),xt=o("vMUQ"),ze=o.n(xt),dt=o("ArX4"),gt=o.n(dt),Ht=o("by6o"),hr=o.n(Ht),Zr=o("L84c"),yr=o.n(Zr),Vn=o("oH/p"),Fn=o.n(Vn),oa=o("jZ0V"),$n=o.n(oa),Kn=o("DXzO"),Cn=o("cxjn"),F,W,le,xe,ut,wt;function Bt(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Ze(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?Bt(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Bt(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}var Rt=(F=Object(Cn.lazyInject)(Cn.TYPES.ILogService),W=Object(Cn.lazyInject)(Cn.TYPES.IGlobalConfigService),le=(wt=function(){function w(y){Ke()(this,w),Fn()(this,"logger",xe,this),Fn()(this,"configService",ut,this),this.config=void 0,this.config=y}return yt()(w,[{key:"setContainer",value:function(c,d){c.bind(Cn.TYPES.MapConfig).toConstantValue(Ze(Ze({},this.config),{},{id:d})),c.bind(Cn.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),w}(),wt),xe=$n()(le.prototype,"logger",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=$n()(le.prototype,"configService",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le),lr=o("37+z"),Ur=o.n(lr),Gr=o("PByh"),cr=o.n(Gr),Br=o("9GRW"),wn=o.n(Br),fn=o("LhPA"),tr=o("99LQ"),rn=o("S+oY"),dn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},En=o("++Hr"),bn=o.n(En),gn=Math.PI/180,Mn=function(){function w(){Ke()(this,w),this.projectionMatrix=tr.b.create(),this.viewMatrix=tr.b.create(),this.viewProjectionMatrix=tr.b.create(),this.ViewProjectionMatrixUncentered=tr.b.create(),this.viewUncenteredMatrix=tr.b.create(),this.zoom=void 0,this.center=void 0}return yt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.zoom,g=d===void 0?1:d,I=c.pitch,ee=I===void 0?0:I,B=c.bearing,k=B===void 0?0:B,Q=c.center,We=Q===void 0?[0,0]:Q,tt=c.offsetOrigin,Pe=tt===void 0?[0,0]:tt,Je=c.cameraHeight,_t=Je===void 0?1:Je,ke=c.aspect,pt=ke===void 0?1:ke,De=c.near,Zt=De===void 0?.1:De,Kt=c.far,dr=Kt===void 0?1e3:Kt,rr=c.fov,mr=rr===void 0?0:rr;this.zoom=g,this.center=We;var Or=ee*gn,$r=(360-k)*gn;tr.b.perspective(this.projectionMatrix,mr,pt,Zt,dr);var Bn=tr.d.fromValues(_t*Math.sin(Or)*Math.sin($r),-_t*Math.sin(Or)*Math.cos($r),_t*Math.cos(Or)),on=tr.d.fromValues(-Math.cos(Or)*Math.sin($r),Math.cos(Or)*Math.cos($r),Math.sin(Or));tr.b.lookAt(this.viewMatrix,Bn,tr.d.fromValues(0,0,0),on),this.viewUncenteredMatrix=tr.b.clone(this.viewMatrix),tr.b.translate(this.viewMatrix,this.viewMatrix,tr.d.fromValues(-Pe[0],Pe[1],0)),tr.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),tr.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=bn()(this.center,2),d=c[0],g=c[1];return[d,g]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){var g=85.0511287798,I=Math.max(Math.min(g,c[1]),-g),ee=256<<20,B=Math.PI/180,k=c[0]*B,Q=I*B;Q=Math.log(Math.tan(Math.PI/4+Q/2));var We=.5/Math.PI,tt=.5,Pe=-.5/Math.PI;return B=.5,k=ee*(We*k+tt)-215440491,Q=-(ee*(Pe*Q+B)-106744817),[k,Q]}}]),w}(),Ga,ga,Ma,Ia,Wi,da,vi,ya,ba,ha,wi,is,Xi,Xo;function Du(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Ha(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?Du(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Du(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}o("qwXO")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var Oi=0;window.forceWebGL=!0;var Jo="15cd8a57710d40c9b7c0e3cc120f1200",ui="1.4.15",Yi="amap-script",Oo=!1,Za=[],oo=12,so=(Ga=Object(rn.injectable)(),ga=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),Ma=Object(rn.inject)(Cn.TYPES.ILogService),Ia=Object(rn.inject)(Cn.TYPES.MapConfig),Wi=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),da=Object(rn.inject)(Cn.TYPES.IEventEmitter),Ga(vi=(ya=(Xo=function(){function w(){var y=this;Ke()(this,w),this.map=void 0,Fn()(this,"configService",ba,this),Fn()(this,"logger",ha,this),Fn()(this,"config",wi,this),Fn()(this,"coordinateSystemService",is,this),Fn()(this,"eventEmitter",Xi,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var d=c.camera,g=d.fov,I=d.near,ee=d.far,B=d.height,k=d.pitch,Q=d.rotation,We=d.aspect,tt=d.position,Pe=y.getCenter(),Je=Pe.lng,_t=Pe.lat;y.cameraChangedCallback&&(y.viewport.syncWithMapCamera({aspect:We,bearing:360-Q,far:ee,fov:g,cameraHeight:B,near:I,pitch:k,zoom:y.map.getZoom()-1,center:[Je,_t],offsetOrigin:[tt.x,tt.y]}),y.viewport.getZoom()>oo?y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.P20_OFFSET):y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.P20),y.cameraChangedCallback(y.viewport))}}return yt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var d=c.getElementsByClassName("amap-maps")[0];this.markerContainer=fn.a.create("div","l7-marker-container",d)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(c,d)}},{key:"off",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,d):this.map.off(c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),d=c.getNorthEast(),g=c.getSouthWest(),I=this.getCenter(),ee=I.lng>d.getLng()||I.lng<g.getLng()?180-d.getLng():d.getLng(),B=I.lng<g.getLng()?g.getLng()-180:g.getLng();return[[B,g.getLat()],[ee,d.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,d){this.map.setZoomAndCenter(c,d)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var d=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:d.getLng(),lat:d.getLat()}}},{key:"lngLatToPixel",value:function(c){var d=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:d.getX(),y:d.getY()}}},{key:"containerToLngLat",value:function(c){var d=new AMap.Pixel(c[0],c[1]),g=this.map.containerToLngLat(d);return{lng:g==null?void 0:g.getLng(),lat:g==null?void 0:g.getLat()}}},{key:"lngLatToContainer",value:function(c){var d=new AMap.LngLat(c[0],c[1]),g=this.map.lngLatToContainer(d);return{x:g.getX(),y:g.getY()}}},{key:"lngLatToMercator",value:function(c,d){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,d,g){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],ee=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},B=this.viewport.projectFlat(c),k=tr.b.create();return tr.b.translate(k,k,tr.d.fromValues(B[0],B[1],d)),tr.b.scale(k,k,tr.d.fromValues(I[0],I[1],I[2])),tr.b.rotateX(k,k,g[0]),tr.b.rotateY(k,k,g[1]),tr.b.rotateZ(k,k,g[2]),k}},{key:"init",value:function(){var y=cr()($.a.mark(function d(){var g=this,I,ee,B,k,Q,We,tt,Pe,Je,_t,ke,pt,De,Zt;return $.a.wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return I=this.config,ee=I.id,B=I.style,k=B===void 0?"light":B,Q=I.minZoom,We=Q===void 0?0:Q,tt=I.maxZoom,Pe=tt===void 0?18:tt,Je=I.token,_t=Je===void 0?Jo:Je,ke=I.mapInstance,pt=I.plugin,De=pt===void 0?[]:pt,Zt=Ur()(I,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),dr.next=3,new Promise(function(rr){var mr=function(){if(ke)g.map=ke,g.$mapContainer=g.map.getContainer(),setTimeout(function(){g.map.on("camerachange",g.handleCameraChanged),rr()},30);else{g.$mapContainer=g.creatAmapContainer(ee);var $r=new AMap.Map(g.$mapContainer,Ha({mapStyle:g.getMapStyle(k),zooms:[We,Pe],viewMode:"3D"},Zt));$r.on("camerachange",g.handleCameraChanged),g.map=$r,setTimeout(function(){rr()},10)}};!Oo&&!ke?(_t===Jo&&g.logger.warn(g.configService.getSceneWarninfo("MapToken")),Oo=!0,De.push("Map3D"),wn.a.load({key:_t,version:ui,plugins:De}).then(function(Or){mr(),Za.length&&(Za.forEach(function($r){return $r()}),Za=[])}).catch(function(Or){throw new Error(Or)})):Oo&&window.AMap||ke?mr():Za.push(mr)});case 3:this.viewport=new Mn;case 4:case"end":return dr.stop()}},d,this)}));function c(){return y.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var d,g=(d=this.getContainer())===null||d===void 0?void 0:d.getElementsByClassName("amap-layer")[0],I=c==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png");return I}},{key:"emit",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(Yi);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return dn[c]?dn[c]:c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_amap_div"+Oi++,d.appendChild(g),g}}]),w}(),Xo),ba=$n()(ya.prototype,"configService",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha=$n()(ya.prototype,"logger",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wi=$n()(ya.prototype,"config",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=$n()(ya.prototype,"coordinateSystemService",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=$n()(ya.prototype,"eventEmitter",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya))||vi);function bu(w){var y=Qo();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function Qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Xl=function(w){ze()(c,w);var y=bu(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"getServiceConstructor",value:function(){return so}}]),c}(Rt);function js(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function ho(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?js(Object(c),!0).forEach(function(d){Vt(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):js(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Vt(w,y,c){return y in w?Object.defineProperty(w,y,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[y]=c,w}function Le(w,y){return Gn(w)||_n(w,y)||vr(w,y)||Dt()}function Dt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vr(w,y){if(!w)return;if(typeof w=="string")return en(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return en(w,y)}function en(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function _n(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function Gn(w){if(Array.isArray(w))return w}var Mi=Ce.a.memo(function(w){var y=w.style,c=w.className,d=w.map,g=w.option,I=w.onSceneLoaded,ee=Object(pe.createRef)(),B=Object(pe.useState)(),k=Le(B,2),Q=k[0],We=k[1];return Object(pe.useEffect)(function(){var tt=new kt.Scene(ho(ho({id:ee.current},g),{},{map:new Xl(d)}));return tt.on("loaded",function(){We(tt),I&&I(tt)}),function(){tt.destroy()}},[]),Object(pe.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(pe.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(pe.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(pe.useEffect)(function(){Q&&d.pitch&&Q.setPitch(d.pitch)},[d.pitch]),Object(pe.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(ae.Provider,{value:Q},Object(pe.createElement)("div",{ref:ee,style:y,className:c},Q&&w.children))}),po=Mi,mo=o("8tnj"),Mo=o.n(mo),Nu=o("S2c9"),Ol=o("1wMG"),_s=o("228l"),pc=o("yktm");function xu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Po(w,y){var c=pc.transformMat4([],y,w);return pc.scale(c,c,1/c[3]),c}function ku(w,y){var c=w%y;return c<0?y+c:c}function To(w,y,c){return c*y+(1-c)*w}var Fi=o("jJQI"),Ys=o("d/dq"),Ks=o("gCNn");function zs(w,y){if(!w)throw new Error(y||"viewport-mercator-project: assertion failed.")}var Ii=Math.PI,Gi=Ii/4,Ts=Ii/180,ml=180/Ii,$u=512,It=4003e4,fr=1.5;function Pr(w){return Math.pow(2,w)}function Wn(w){return Math.log2(w)}function Ya(w,y){var c=Object(C.a)(w,2),d=c[0],g=c[1];zs(Number.isFinite(d)&&Number.isFinite(y)),zs(Number.isFinite(g)&&g>=-90&&g<=90,"invalid latitude"),y*=$u;var I=d*Ts,ee=g*Ts,B=y*(I+Ii)/(2*Ii),k=y*(Ii-Math.log(Math.tan(Gi+ee*.5)))/(2*Ii);return[B,k]}function xi(w,y){var c=Object(C.a)(w,2),d=c[0],g=c[1];y*=$u;var I=d/y*(2*Ii)-Ii,ee=2*(Math.atan(Math.exp(Ii-g/y*(2*Ii)))-Gi);return[I*ml,ee*ml]}function Ki(w){var y=w.latitude;zs(Number.isFinite(y));var c=Math.cos(y*Ts);return Wn(It*c)-9}function Ka(w){var y=w.latitude,c=w.longitude,d=w.zoom,g=w.scale,I=w.highPrecision,ee=I===void 0?!1:I;g=g!==void 0?g:Pr(d),zs(Number.isFinite(y)&&Number.isFinite(c)&&Number.isFinite(g));var B={},k=$u*g,Q=Math.cos(y*Ts),We=k/360,tt=We/Q,Pe=k/It/Q;if(B.pixelsPerMeter=[Pe,-Pe,Pe],B.metersPerPixel=[1/Pe,-1/Pe,1/Pe],B.pixelsPerDegree=[We,-tt,Pe],B.degreesPerPixel=[1/We,-1/tt,1/Pe],ee){var Je=Ts*Math.tan(y*Ts)/Q,_t=We*Je/2,ke=k/It*Je,pt=ke/tt*Pe;B.pixelsPerDegree2=[0,-_t,ke],B.pixelsPerMeter2=[pt,0,pt]}return B}function Di(w,y){var c=Object(C.a)(w,3),d=c[0],g=c[1],I=c[2],ee=Object(C.a)(y,3),B=ee[0],k=ee[1],Q=ee[2],We=1,tt=Ka({longitude:d,latitude:g,scale:We,highPrecision:!0}),Pe=tt.pixelsPerMeter,Je=tt.pixelsPerMeter2,_t=Ya(w,We);_t[0]+=B*(Pe[0]+Je[0]*k),_t[1]+=k*(Pe[1]+Je[1]*k);var ke=xi(_t,We),pt=(I||0)+(Q||0);return Number.isFinite(I)||Number.isFinite(Q)?[ke[0],ke[1],pt]:ke}function Yo(w){var y=w.height,c=w.pitch,d=w.bearing,g=w.altitude,I=w.center,ee=I===void 0?null:I,B=w.flipY,k=B===void 0?!1:B,Q=xu();return Fi.translate(Q,Q,[0,0,-g]),Fi.scale(Q,Q,[1,1,1/y]),Fi.rotateX(Q,Q,-c*Ts),Fi.rotateZ(Q,Q,d*Ts),k&&Fi.scale(Q,Q,[1,-1,1]),ee&&Fi.translate(Q,Q,Ks.negate([],ee)),Q}function Ps(w){var y=w.width,c=w.height,d=w.altitude,g=d===void 0?fr:d,I=w.pitch,ee=I===void 0?0:I,B=w.nearZMultiplier,k=B===void 0?1:B,Q=w.farZMultiplier,We=Q===void 0?1:Q,tt=ee*Ts,Pe=Math.atan(.5/g),Je=Math.sin(Pe)*g/Math.sin(Math.PI/2-tt-Pe),_t=Math.cos(Math.PI/2-tt)*Je+g;return{fov:2*Math.atan(c/2/g),aspect:y/c,focalDistance:g,near:k,far:_t*We}}function gi(w){var y=w.width,c=w.height,d=w.pitch,g=w.altitude,I=w.nearZMultiplier,ee=w.farZMultiplier,B=Ps({width:y,height:c,altitude:g,pitch:d,nearZMultiplier:I,farZMultiplier:ee}),k=B.fov,Q=B.aspect,We=B.near,tt=B.far,Pe=Fi.perspective([],k,Q,We,tt);return Pe}function Ml(w,y){var c=Object(C.a)(w,3),d=c[0],g=c[1],I=c[2],ee=I===void 0?0:I;return zs(Number.isFinite(d)&&Number.isFinite(g)&&Number.isFinite(ee)),Po(y,[d,g,ee,1])}function $s(w,y){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=Object(C.a)(w,3),g=d[0],I=d[1],ee=d[2];if(zs(Number.isFinite(g)&&Number.isFinite(I),"invalid pixel coordinate"),Number.isFinite(ee)){var B=Po(y,[g,I,ee,1]);return B}var k=Po(y,[g,I,0,1]),Q=Po(y,[g,I,1,1]),We=k[2],tt=Q[2],Pe=We===tt?0:((c||0)-We)/(tt-We);return Ys.lerp([],k,Q,Pe)}var Ss=xu(),vl=function(){function w(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=y.width,d=y.height,g=y.viewMatrix,I=g===void 0?Ss:g,ee=y.projectionMatrix,B=ee===void 0?Ss:ee;Object(D.a)(this,w),this.width=c||1,this.height=d||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=I,this.projectionMatrix=B;var k=xu();Fi.multiply(k,k,this.projectionMatrix),Fi.multiply(k,k,this.viewMatrix),this.viewProjectionMatrix=k;var Q=xu();Fi.scale(Q,Q,[this.width/2,-this.height/2,1]),Fi.translate(Q,Q,[1,-1,0]),Fi.multiply(Q,Q,this.viewProjectionMatrix);var We=Fi.invert(xu(),Q);if(!We)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=Q,this.pixelUnprojectionMatrix=We,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(K.a)(w,[{key:"equals",value:function(c){return c instanceof w?c.width===this.width&&c.height===this.height&&Fi.equals(c.projectionMatrix,this.projectionMatrix)&&Fi.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,I=g===void 0?!0:g,ee=this.projectPosition(c),B=Ml(ee,this.pixelProjectionMatrix),k=Object(C.a)(B,2),Q=k[0],We=k[1],tt=I?We:this.height-We;return c.length===2?[Q,tt]:[Q,tt,B[2]]}},{key:"unproject",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,I=g===void 0?!0:g,ee=d.targetZ,B=Object(C.a)(c,3),k=B[0],Q=B[1],We=B[2],tt=I?Q:this.height-Q,Pe=ee&&ee*this.pixelsPerMeter,Je=$s([k,tt,We],this.pixelUnprojectionMatrix,Pe),_t=this.unprojectPosition(Je),ke=Object(C.a)(_t,3),pt=ke[0],De=ke[1],Zt=ke[2];return Number.isFinite(We)?[pt,De,Zt]:Number.isFinite(ee)?[pt,De,ee]:[pt,De]}},{key:"projectPosition",value:function(c){var d=this.projectFlat(c),g=Object(C.a)(d,2),I=g[0],ee=g[1],B=(c[2]||0)*this.pixelsPerMeter;return[I,ee,B]}},{key:"unprojectPosition",value:function(c){var d=this.unprojectFlat(c),g=Object(C.a)(d,2),I=g[0],ee=g[1],B=(c[2]||0)/this.pixelsPerMeter;return[I,ee,B]}},{key:"projectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),w}();function cu(w){var y=w.width,c=w.height,d=w.bounds,g=w.minExtent,I=g===void 0?0:g,ee=w.maxZoom,B=ee===void 0?24:ee,k=w.padding,Q=k===void 0?0:k,We=w.offset,tt=We===void 0?[0,0]:We,Pe=Object(C.a)(d,2),Je=Object(C.a)(Pe[0],2),_t=Je[0],ke=Je[1],pt=Object(C.a)(Pe[1],2),De=pt[0],Zt=pt[1];if(Number.isFinite(Q)){var Kt=Q;Q={top:Kt,bottom:Kt,left:Kt,right:Kt}}else zs(Number.isFinite(Q.top)&&Number.isFinite(Q.bottom)&&Number.isFinite(Q.left)&&Number.isFinite(Q.right));var dr=new Eu({width:y,height:c,longitude:0,latitude:0,zoom:0}),rr=dr.project([_t,Zt]),mr=dr.project([De,ke]),Or=[Math.max(Math.abs(mr[0]-rr[0]),I),Math.max(Math.abs(mr[1]-rr[1]),I)],$r=[y-Q.left-Q.right-Math.abs(tt[0])*2,c-Q.top-Q.bottom-Math.abs(tt[1])*2];zs($r[0]>0&&$r[1]>0);var Bn=$r[0]/Or[0],on=$r[1]/Or[1],Dn=(Q.right-Q.left)/2/Bn,ca=(Q.bottom-Q.top)/2/on,Na=[(mr[0]+rr[0])/2+Dn,(mr[1]+rr[1])/2+ca],ri=dr.unproject(Na),co=dr.zoom+Math.log2(Math.abs(Math.min(Bn,on)));return{longitude:ri[0],latitude:ri[1],zoom:Math.min(co,B)}}var Eu=function(w){Object(re.a)(y,w);function y(){var c,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=d.width,I=d.height,ee=d.latitude,B=ee===void 0?0:ee,k=d.longitude,Q=k===void 0?0:k,We=d.zoom,tt=We===void 0?0:We,Pe=d.pitch,Je=Pe===void 0?0:Pe,_t=d.bearing,ke=_t===void 0?0:_t,pt=d.altitude,De=pt===void 0?1.5:pt,Zt=d.nearZMultiplier,Kt=d.farZMultiplier;Object(D.a)(this,y),g=g||1,I=I||1;var dr=Pr(tt);De=Math.max(.75,De);var rr=Ya([Q,B],dr);rr[2]=0;var mr=gi({width:g,height:I,pitch:Je,bearing:ke,altitude:De,nearZMultiplier:Zt||1/I,farZMultiplier:Kt||1.01}),Or=Yo({height:I,center:rr,pitch:Je,bearing:ke,altitude:De,flipY:!0});return c=Object(Nu.a)(this,Object(Ol.a)(y).call(this,{width:g,height:I,viewMatrix:Or,projectionMatrix:mr})),c.latitude=B,c.longitude=Q,c.zoom=tt,c.pitch=Je,c.bearing=ke,c.altitude=De,c.scale=dr,c.center=rr,c.pixelsPerMeter=Ka(Object(_s.a)(Object(_s.a)(c))).pixelsPerMeter[2],Object.freeze(Object(_s.a)(Object(_s.a)(c))),c}return Object(K.a)(y,[{key:"projectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ya(d,g)}},{key:"unprojectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return xi(d,g)}},{key:"getMapCenterByLngLatPosition",value:function(d){var g=d.lngLat,I=d.pos,ee=$s(I,this.pixelUnprojectionMatrix),B=Ya(g,this.scale),k=Ys.add([],B,Ys.negate([],ee)),Q=Ys.add([],this.center,k);return xi(Q,this.scale)}},{key:"getLocationAtPoint",value:function(d){var g=d.lngLat,I=d.pos;return this.getMapCenterByLngLatPosition({lngLat:g,pos:I})}},{key:"fitBounds",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},I=this.width,ee=this.height,B=cu(Object.assign({width:I,height:ee,bounds:d},g)),k=B.longitude,Q=B.latitude,We=B.zoom;return new y({width:I,height:ee,longitude:k,latitude:Q,zoom:We})}}]),y}(vl),fu=function(){function w(){Ke()(this,w),this.viewport=void 0}return yt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.center,g=c.zoom,I=c.pitch,ee=c.bearing,B=c.viewportHeight,k=c.viewportWidth;this.viewport=new Eu({width:k,height:B,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:I,bearing:ee})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),w}(),ju={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Js,Mc,hf,pi,Pc,mc,$c,gl,Jc,$i,_u,yl,os,Lc;function vc(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Pl(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?vc(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):vc(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}o("qwXO")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Mo.a;var Ju={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Rc=0,hu=12,Tu="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Qc=(Js=Object(rn.injectable)(),Mc=Object(rn.inject)(Cn.TYPES.MapConfig),hf=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),pi=Object(rn.inject)(Cn.TYPES.ILogService),Pc=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),mc=Object(rn.inject)(Cn.TYPES.IEventEmitter),Js($c=(gl=(Lc=function(){function w(){var y=this;Ke()(this,w),this.map=void 0,Fn()(this,"config",Jc,this),Fn()(this,"configService",$i,this),Fn()(this,"logger",_u,this),Fn()(this,"coordinateSystemService",yl,this),Fn()(this,"eventEmitter",os,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=y.map.getCenter().wrap(),d=c.lat,g=c.lng;y.viewport.syncWithMapCamera({bearing:y.map.getBearing(),center:[g,d],viewportHeight:y.map.transform.height,pitch:y.map.getPitch(),viewportWidth:y.map.transform.width,zoom:y.map.getZoom(),cameraHeight:0}),y.viewport.getZoom()>hu?y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT_OFFSET):y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT),y.cameraChangedCallback(y.viewport)}}return yt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=fn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(Ju[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(Ju[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){var g=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),I=g.x,ee=I===void 0?0:I,B=g.y,k=B===void 0?0:B,Q=g.z,We=Q===void 0?0:Q;return{x:ee,y:k,z:We}}},{key:"getModelMatrix",value:function(c,d,g){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],ee=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},B=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),k=B.meterInMercatorCoordinateUnits(),Q=tr.b.create();return tr.b.translate(Q,Q,tr.d.fromValues(B.x-ee.x,B.y-ee.y,B.z||0-ee.z)),tr.b.scale(Q,Q,tr.d.fromValues(k*I[0],-k*I[1],k*I[2])),tr.b.rotateX(Q,Q,g[0]),tr.b.rotateY(Q,Q,g[1]),tr.b.rotateZ(Q,Q,g[2]),Q}},{key:"init",value:function(){var y=cr()($.a.mark(function d(){var g,I,ee,B,k,Q,We,tt,Pe,Je,_t,ke,pt;return $.a.wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:g=this.config,I=g.id,ee=I===void 0?"map":I,B=g.attributionControl,k=B===void 0?!1:B,Q=g.style,We=Q===void 0?"light":Q,tt=g.token,Pe=tt===void 0?Tu:tt,Je=g.rotation,_t=Je===void 0?0:Je,ke=g.mapInstance,pt=Ur()(g,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new fu,!ke&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Pe===Tu&&We!=="blank"&&!window.mapboxgl.accessToken&&!ke&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!ke&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Pe),ke?(this.map=ke,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(ee),this.map=new window.mapboxgl.Map(Pl({container:this.$mapContainer,style:this.getMapStyle(We),attributionControl:k,bearing:_t},pt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Zt.stop()}},d,this)}));function c(){return y.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),g=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_mapbox_div"+Rc++,d.appendChild(g),g}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:ju[c]?ju[c]:c}}]),w}(),Lc),Jc=$n()(gl.prototype,"config",[Mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=$n()(gl.prototype,"configService",[hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_u=$n()(gl.prototype,"logger",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=$n()(gl.prototype,"coordinateSystemService",[Pc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=$n()(gl.prototype,"eventEmitter",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||$c);function Yl(w){var y=Si();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function Si(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("qwXO")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var qc=function(w){ze()(c,w);var y=Yl(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"getServiceConstructor",value:function(){return Qc}}]),c}(Rt);function df(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Kl(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?df(Object(c),!0).forEach(function(d){Ic(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):df(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Ic(w,y,c){return y in w?Object.defineProperty(w,y,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[y]=c,w}function $l(w,y){return Jl(w)||Lo(w,y)||zu(w,y)||Qu()}function Qu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zu(w,y){if(!w)return;if(typeof w=="string")return bl(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return bl(w,y)}function bl(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function Lo(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function Jl(w){if(Array.isArray(w))return w}var Ll=Ce.a.memo(function(w){var y=w.style,c=w.className,d=w.map,g=w.option,I=w.onSceneLoaded,ee=Object(pe.createRef)(),B=Object(pe.useState)(),k=$l(B,2),Q=k[0],We=k[1];return Object(pe.useEffect)(function(){var tt=new kt.Scene(Kl(Kl({id:ee.current},g),{},{map:new qc(d)}));return tt.on("loaded",function(){We(tt),I&&I(tt)}),function(){tt.destroy()}},[]),Object(pe.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(pe.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(pe.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(pe.useEffect)(function(){Q&&d.pitch!==void 0&&Q.setPitch(d.pitch||0)},[d.pitch]),Object(pe.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(ae.Provider,{value:Q},Object(pe.createElement)("div",{ref:ee,style:y,className:c},Q&&w.children))}),Rl=Ll,Dc=o("VGra"),xl=o.n(Dc),Qs=o("RM4u"),eo=o.n(Qs),pf=o("2pGt"),mf=o("yS0f"),El=o.n(mf),Ql=o("ZJ87"),qu=o.n(Ql);function Il(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=gc(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function gc(w,y){if(!w)return;if(typeof w=="string")return yc(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return yc(w,y)}function yc(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var el;function ef(w,y,c){var d=c-y,g=((w-y)%d+d)%d+y;return g===y?c:g}function tl(w,y,c){return Math.min(c,Math.max(y,w))}function qs(w,y,c){return w*(1-c)+y*c}function _l(w,y,c,d){var g=new qu.a(w,y,c,d);return function(I){return g.solve(I)}}var ql=_l(.25,.1,.25,1);function Nc(){return window.matchMedia?(el==null&&(el=window.matchMedia("(prefers-reduced-motion: reduce)")),el.matches):!1}function tf(w,y){var c={},d=Il(y),g;try{for(d.s();!(g=d.n()).done;){var I=g.value;I in w&&(c[I]=w[I])}}catch(ee){d.e(ee)}finally{d.f()}return c}var Fs=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),vf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,rl=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function Pi(w){var y=vf(w);return{cancel:function(){return rl(y)}}}var nl=function(){yt()(w,null,[{key:"convert",value:function(c){return c instanceof w?c:new w(c)}}]);function w(y,c){Ke()(this,w),this.ne=void 0,this.sw=void 0,y&&(c?this.setSouthWest(y).setNorthEast(c):y.length===4?this.setSouthWest([y[0],y[1]]).setNorthEast([y[2],y[3]]):this.setSouthWest(y[0]).setNorthEast(y[1]))}return yt()(w,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof fi?new fi(c.lng,c.lat):fi.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof fi?new fi(c.lng,c.lat):fi.convert(c),this}},{key:"extend",value:function(c){var d=this.sw,g=this.ne,I,ee;if(c instanceof fi)I=c,ee=c;else if(c instanceof w){if(I=c.sw,ee=c.ne,!I||!ee)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var B=c;return this.extend(w.convert(B))}else{var k=c;return this.extend(fi.convert(k))}return this}return!d&&!g?(this.sw=new fi(I.lng,I.lat),this.ne=new fi(ee.lng,ee.lat)):(d.lng=Math.min(I.lng,d.lng),d.lat=Math.min(I.lat,d.lat),g.lng=Math.max(ee.lng,g.lng),g.lat=Math.max(ee.lat,g.lat)),this}},{key:"getCenter",value:function(){return new fi((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new fi(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new fi(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var d=fi.convert(c),g=d.lng,I=d.lat,ee=this.sw.lat<=I&&I<=this.ne.lat,B=this.sw.lng<=g&&g<=this.ne.lng;return this.sw.lng>this.ne.lng&&(B=this.sw.lng>=g&&g>=this.ne.lng),ee&&B}}]),w}(),Fu=63710088e-1,fi=function(){yt()(w,null,[{key:"convert",value:function(c){if(c instanceof w)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new w(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&El()(c)==="object"&&c!==null){var d="lng"in c?c.lng:c.lon;return new w(Number(d),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function w(y,c){if(Ke()(this,w),this.lng=void 0,this.lat=void 0,isNaN(y)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(y,", ").concat(c,")"));if(this.lng=+y,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return yt()(w,[{key:"wrap",value:function(){return new w(ef(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=40075017,g=360*c/d,I=g/Math.cos(Math.PI/180*this.lat);return new nl(new w(this.lng-I,this.lat-g),new w(this.lng+I,this.lat+g))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var d=Math.PI/180,g=this.lat*d,I=c.lat*d,ee=Math.sin(g)*Math.sin(I)+Math.cos(g)*Math.cos(I)*Math.cos((c.lng-this.lng)*d),B=Fu*Math.acos(Math.min(ee,1));return B}}]),w}(),kn=function(){yt()(w,null,[{key:"convert",value:function(c){return c instanceof w?c:Array.isArray(c)?new w(c[0],c[1]):c}}]);function w(y,c){Ke()(this,w),this.x=void 0,this.y=void 0,this.x=y,this.y=c}return yt()(w,[{key:"clone",value:function(){return new w(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var d=Math.cos(c),g=Math.sin(c),I=d*this.x-g*this.y,ee=g*this.x+d*this.y;return this.x=I,this.y=ee,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,d){var g=Math.cos(c),I=Math.sin(c),ee=d.x+g*(this.x-d.x)-I*(this.y-d.y),B=d.y+I*(this.x-d.x)+g*(this.y-d.y);return this.x=ee,this.y=B,this}},{key:"roateAround",value:function(c,d){return this.clone()._rotateAround(c,d)}},{key:"_matMult",value:function(c){var d=c[0]*this.x+c[1]*this.y,g=c[2]*this.x+c[3]*this.y;return this.x=d,this.y=g,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var d=c.x-this.x,g=c.y-this.y;return d*d+g*g}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)}}]),w}(),Li=function(){function w(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ke()(this,w),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(y)||y<0||isNaN(c)||c<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=y,this.bottom=c,this.left=d,this.right=g}return yt()(w,[{key:"interpolate",value:function(c,d,g){return d.top!=null&&c.top!=null&&(this.top=qs(c.top,d.top,g)),d.bottom!=null&&c.bottom!=null&&(this.bottom=qs(c.bottom,d.bottom,g)),d.left!=null&&c.left!=null&&(this.left=qs(c.left,d.left,g)),d.right!=null&&c.right!=null&&(this.right=qs(c.right,d.right,g)),this}},{key:"getCenter",value:function(c,d){var g=tl((this.left+c-this.right)/2,0,c),I=tl((this.top+d-this.bottom)/2,0,d);return new kn(g,I)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new w(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),w}(),Ls=2*Math.PI*Fu;function Dl(w){return Ls*Math.cos(w*Math.PI/180)}function Uu(w){return(180+w)/360}function al(w){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w*Math.PI/360)))/360}function gf(w,y){return w/Dl(y)}function ss(w){return w*360-180}function Tl(w){var y=180-w*360;return 360/Math.PI*Math.atan(Math.exp(y*Math.PI/180))-90}function il(w,y){return w*Dl(Tl(y))}function ol(w){return 1/Math.cos(w*Math.PI/180)}var Ui=function(){yt()(w,null,[{key:"fromLngLat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=fi.convert(c);return new w(Uu(g.lng),al(g.lat),gf(d,g.lat))}}]);function w(y,c){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ke()(this,w),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+y,this.y=+c,this.z=+d}return yt()(w,[{key:"toLngLat",value:function(){return new fi(ss(this.x),Tl(this.y))}},{key:"toAltitude",value:function(){return il(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/Ls*ol(Tl(this.y))}}]),w}();function As(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Nl(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function Nl(w,y){if(!w)return;if(typeof w=="string")return to(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return to(w,y)}function to(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var Rn=8192,Us=function(){yt()(w,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new kn(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var d=-ef(c,-180,180)*Math.PI/180;if(this.angle===d)return;this.unmodified=!1,this.angle=d,this.calcMatrices(),this.rotationMatrix=tr.a.create(),tr.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var d=tl(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===d)return;this.unmodified=!1,this._pitch=d,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var d=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===d)return;this.unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function w(y,c,d,g,I){Ke()(this,w),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=I===void 0?!0:I,this._minZoom=y||0,this._maxZoom=c||22,this._minPitch=d==null?0:d,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new fi(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Li,this.posMatrixCache={},this.alignedPosMatrixCache={}}return yt()(w,[{key:"clone",value:function(){var c=new w(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,d,g){this.unmodified=!1,this.edgeInsets.interpolate(c,d,g),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var d=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,d)}},{key:"resize",value:function(c,d){this.width=c,this.height=d,this.pixelsToGLUnits=[2/c,-2/d],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var d=tl(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new kn(Uu(c.lng)*this.worldSize,al(d)*this.worldSize)}},{key:"unproject",value:function(c){return new Ui(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,d){var g=this.pointCoordinate(d),I=this.pointCoordinate(this.centerPoint),ee=this.locationCoordinate(c),B=new Ui(ee.x-(g.x-I.x),ee.y-(g.y-I.y));this.center=this.coordinateLocation(B),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var d=0,g=new Float32Array([c.x,c.y,0,1]),I=new Float32Array([c.x,c.y,1,1]);tr.e.transformMat4(g,g,this.pixelMatrixInverse),tr.e.transformMat4(I,I,this.pixelMatrixInverse);var ee=g[3],B=I[3],k=g[0]/ee,Q=I[0]/B,We=g[1]/ee,tt=I[1]/B,Pe=g[2]/ee,Je=I[2]/B,_t=Pe===Je?0:(d-Pe)/(Je-Pe);return new Ui(qs(k,Q,_t)/this.worldSize,qs(We,tt,_t)/this.worldSize)}},{key:"getBounds",value:function(){return new nl().extend(this.pointLocation(new kn(0,0))).extend(this.pointLocation(new kn(this.width,0))).extend(this.pointLocation(new kn(this.width,this.height))).extend(this.pointLocation(new kn(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new nl([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new kn(0,0)),d=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),g=tr.e.transformMat4(d,d,this.pixelMatrix);return g[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,d=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new kn(0,d))}},{key:"getCameraQueryGeometry",value:function(c){var d=this.getCameraPoint();if(c.length===1)return[c[0],d];var g=d.x,I=d.y,ee=d.x,B=d.y,k=As(c),Q;try{for(k.s();!(Q=k.n()).done;){var We=Q.value;g=Math.min(g,We.x),I=Math.min(I,We.y),ee=Math.max(ee,We.x),B=Math.max(B,We.y)}}catch(tt){k.e(tt)}finally{k.f()}return[new kn(g,I),new kn(ee,I),new kn(ee,B),new kn(g,B),new kn(g,I)]}},{key:"coordinatePoint",value:function(c){var d=tr.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return tr.e.transformMat4(d,d,this.pixelMatrix),new kn(d[0]/d[3],d[1]/d[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return Ui.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,d=90,g=-180,I=180,ee,B,k,Q,We=this.size,tt=this.unmodified;if(this.latRange){var Pe=this.latRange;c=al(Pe[1])*this.worldSize,d=al(Pe[0])*this.worldSize,ee=d-c<We.y?We.y/(d-c):0}if(this.lngRange){var Je=this.lngRange;g=Uu(Je[0])*this.worldSize,I=Uu(Je[1])*this.worldSize,B=I-g<We.x?We.x/(I-g):0}var _t=this.point,ke=Math.max(B||0,ee||0);if(ke){this.center=this.unproject(new kn(B?(I+g)/2:_t.x,ee?(d+c)/2:_t.y)),this.zoom+=this.scaleZoom(ke),this.unmodified=tt,this.constraining=!1;return}if(this.latRange){var pt=_t.y,De=We.y/2;pt-De<c&&(Q=c+De),pt+De>d&&(Q=d-De)}if(this.lngRange){var Zt=_t.x,Kt=We.x/2;Zt-Kt<g&&(k=g+Kt),Zt+Kt>I&&(k=I-Kt)}(k!==void 0||Q!==void 0)&&(this.center=this.unproject(new kn(k!==void 0?k:_t.x,Q!==void 0?Q:_t.y))),this.unmodified=tt,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var g=Math.PI/2+this._pitch,I=this._fov*(.5+d.y/this.height),ee=Math.sin(I)*this.cameraToCenterDistance/Math.sin(tl(Math.PI-g-I,.01,Math.PI-.01)),B=this.point,k=B.x,Q=B.y,We=Math.cos(Math.PI/2-this._pitch)*ee+this.cameraToCenterDistance,tt=We*1.01,Pe=this.height/50,Je=tr.b.create();tr.b.perspective(Je,this._fov,this.width/this.height,Pe,tt),Je[8]=-d.x*2/this.width,Je[9]=d.y*2/this.height,tr.b.scale(Je,Je,[1,-1,1]),tr.b.translate(Je,Je,[0,0,-this.cameraToCenterDistance]),tr.b.rotateX(Je,Je,this._pitch),tr.b.rotateZ(Je,Je,this.angle),tr.b.translate(Je,Je,[-k,-Q,0]),this.mercatorMatrix=tr.b.scale(tr.b.create(),Je,[this.worldSize,this.worldSize,this.worldSize]),tr.b.scale(Je,Je,tr.d.fromValues(1,1,gf(1,this.center.lat)*this.worldSize)),this.projMatrix=Je,this.invProjMatrix=tr.b.invert(tr.b.create(),this.projMatrix);var _t=this.width%2/2,ke=this.height%2/2,pt=Math.cos(this.angle),De=Math.sin(this.angle),Zt=k-Math.round(k)+pt*_t+De*ke,Kt=Q-Math.round(Q)+pt*ke+De*_t,dr=tr.b.clone(Je);if(tr.b.translate(dr,dr,[Zt>.5?Zt-1:Zt,Kt>.5?Kt-1:Kt,0]),this.alignedProjMatrix=dr,Je=tr.b.create(),tr.b.scale(Je,Je,[this.width/2,-this.height/2,1]),tr.b.translate(Je,Je,[1,-1,0]),this.labelPlaneMatrix=Je,Je=tr.b.create(),tr.b.scale(Je,Je,[1,-1,1]),tr.b.translate(Je,Je,[-1,-1,0]),tr.b.scale(Je,Je,[2/this.width,2/this.height,1]),this.glCoordMatrix=Je,this.pixelMatrix=tr.b.multiply(tr.b.create(),this.labelPlaneMatrix,this.projMatrix),Je=tr.b.invert(tr.b.create(),this.pixelMatrix),!Je)throw new Error("failed to invert matrix");this.pixelMatrixInverse=Je,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),w}(),ni=function w(y){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ke()(this,w),this.type=void 0,eo()(this,c),this.type=y};function kl(w){var y=du();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Bs=function(w){ze()(c,w);var y=kl(c);function c(d){var g;Ke()(this,c),g=y.call(this),g.transform=void 0,g.options=void 0,g.moving=void 0,g.zooming=void 0,g.rotating=void 0,g.pitching=void 0,g.padding=void 0,g.bearingSnap=void 0,g.easeEndTimeoutID=void 0,g.easeStart=void 0,g.easeOptions=void 0,g.easeId=void 0,g.onEaseFrame=void 0,g.onEaseEnd=void 0,g.easeFrameId=void 0,g.renderFrameCallback=function(){var We=Math.min((Fs()-g.easeStart)/g.easeOptions.duration,1);g.onEaseFrame(g.easeOptions.easing(We)),We<1?g.easeFrameId=g.requestRenderFrame(g.renderFrameCallback):g.stop()},g.options=d;var I=d.minZoom,ee=d.maxZoom,B=d.minPitch,k=d.maxPitch,Q=d.renderWorldCopies;return g.moving=!1,g.zooming=!1,g.bearingSnap=d.bearingSnap,g.transform=new Us(I,ee,B,k,Q),g}return yt()(c,[{key:"requestRenderFrame",value:function(g){return 0}},{key:"cancelRenderFrame",value:function(g){return}},{key:"getCenter",value:function(){var g=this.transform.center,I=g.lng,ee=g.lat;return new fi(I,ee)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(g,I){return this.jumpTo({center:g},I)}},{key:"setPitch",value:function(g,I){return this.jumpTo({pitch:g},I),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(g,I,ee){return this.easeTo(eo()({center:g},I),ee)}},{key:"zoomOut",value:function(g,I){return this.zoomTo(this.getZoom()-1,g,I),this}},{key:"setBearing",value:function(g,I){return this.jumpTo({bearing:g},I),this}},{key:"setZoom",value:function(g,I){return this.jumpTo({zoom:g},I),this}},{key:"zoomIn",value:function(g,I){return this.zoomTo(this.getZoom()+1,g,I),this}},{key:"zoomTo",value:function(g,I,ee){return this.easeTo(eo()({zoom:g},I),ee)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(g,I){return this.jumpTo({padding:g},I),this}},{key:"rotateTo",value:function(g,I,ee){return this.easeTo(eo()({bearing:g},I),ee)}},{key:"resetNorth",value:function(g,I){return this.rotateTo(0,eo()({duration:1e3},g),I),this}},{key:"resetNorthPitch",value:function(g,I){return this.easeTo(eo()({bearing:0,pitch:0,duration:1e3},g),I),this}},{key:"fitBounds",value:function(g,I,ee){return this.fitInternal(this.cameraForBounds(g,I),I,ee)}},{key:"cameraForBounds",value:function(g,I){return g=nl.convert(g),this.cameraForBoxAndBearing(g.getNorthWest(),g.getSouthEast(),0,I)}},{key:"snapToNorth",value:function(g,I){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(g,I):this}},{key:"jumpTo",value:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;this.stop();var ee=this.transform,B=!1,k=!1,Q=!1;return g.zoom&&ee.zoom!==+g.zoom&&(B=!0,ee.zoom=+g.zoom),g.center!==void 0&&(ee.center=fi.convert(g.center)),g.bearing&&ee.bearing!==+g.bearing&&(k=!0,ee.bearing=+g.bearing),g.pitch&&ee.pitch!==+g.pitch&&(Q=!0,ee.pitch=+g.pitch),g.padding!=null&&!ee.isPaddingEqual(g.padding)&&(ee.padding=g.padding),this.emit("movestart",new ni("movestart",I)),this.emit("move",new ni("move",I)),B&&(this.emit("zoomstart",new ni("zoomstart",I)),this.emit("zoom",new ni("zoom",I)),this.emit("zoomend",new ni("zoomend",I))),k&&(this.emit("rotatestart",new ni("rotatestart",I)),this.emit("rotate",new ni("rotate",I)),this.emit("rotateend",new ni("rotateend",I))),Q&&(this.emit("pitchstart",new ni("pitchstart",I)),this.emit("pitch",new ni("pitch",I)),this.emit("pitchend",new ni("pitchend",I))),this.emit("moveend",new ni("moveend",I))}},{key:"easeTo",value:function(){var g=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=arguments.length>1?arguments[1]:void 0;I=eo()({offset:[0,0],duration:500,easing:ql},I),(I.animate===!1||!I.essential&&Nc())&&(I.duration=0);var B=this.transform,k=this.getZoom(),Q=this.getBearing(),We=this.getPitch(),tt=this.getPadding(),Pe=I.zoom?+I.zoom:k,Je=I.bearing?this.normalizeBearing(I.bearing,Q):Q,_t=I.pitch?+I.pitch:We,ke=I.padding?I.padding:B.padding,pt=kn.convert(I.offset),De=B.centerPoint.add(pt),Zt=B.pointLocation(De),Kt=fi.convert(I.center||Zt);this.normalizeCenter(Kt);var dr=B.project(Zt),rr=B.project(Kt).sub(dr),mr=B.zoomScale(Pe-k),Or,$r;I.around&&(Or=fi.convert(I.around),$r=B.locationPoint(Or));var Bn={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Pe!==k,this.rotating=this.rotating||Q!==Je,this.pitching=this.pitching||_t!==We,this.padding=!B.isPaddingEqual(ke),this.easeId=I.easeId,this.prepareEase(ee,I.noMoveStart,Bn),clearTimeout(this.easeEndTimeoutID),this.ease(function(on){if(g.zooming&&(B.zoom=qs(k,Pe,on)),g.rotating&&(B.bearing=qs(Q,Je,on)),g.pitching&&(B.pitch=qs(We,_t,on)),g.padding&&(B.interpolatePadding(tt,ke,on),De=B.centerPoint.add(pt)),Or)B.setLocationAtPoint(Or,$r);else{var Dn=B.zoomScale(B.zoom-k),ca=Pe>k?Math.min(2,mr):Math.max(.5,mr),Na=Math.pow(ca,1-on),ri=B.unproject(dr.add(rr.mult(on*Na)).mult(Dn));B.setLocationAtPoint(B.renderWorldCopies?ri.wrap():ri,De)}g.fireMoveEvents(ee)},function(on){g.afterEase(ee,on)},I),this}},{key:"flyTo",value:function(){var g=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=arguments.length>1?arguments[1]:void 0;if(!I.essential&&Nc()){var B=tf(I,["center","zoom","bearing","pitch","around"]);return this.jumpTo(B,ee)}this.stop(),I=eo()({offset:[0,0],speed:1.2,curve:1.42,easing:ql},I);var k=this.transform,Q=this.getZoom(),We=this.getBearing(),tt=this.getPitch(),Pe=this.getPadding(),Je=I.zoom?tl(+I.zoom,k.minZoom,k.maxZoom):Q,_t=I.bearing?this.normalizeBearing(I.bearing,We):We,ke=I.pitch?+I.pitch:tt,pt="padding"in I?I.padding:k.padding,De=k.zoomScale(Je-Q),Zt=kn.convert(I.offset),Kt=k.centerPoint.add(Zt),dr=k.pointLocation(Kt),rr=fi.convert(I.center||dr);this.normalizeCenter(rr);var mr=k.project(dr),Or=k.project(rr).sub(mr),$r=I.curve,Bn=Math.max(k.width,k.height),on=Bn/De,Dn=Or.mag();if("minZoom"in I){var ca=tl(Math.min(I.minZoom,Q,Je),k.minZoom,k.maxZoom),Na=Bn/k.zoomScale(ca-Q);$r=Math.sqrt(Na/Dn*2)}var ri=$r*$r;function co(za){var li=(on*on-Bn*Bn+(za?-1:1)*ri*ri*Dn*Dn)/(2*(za?on:Bn)*ri*Dn);return Math.log(Math.sqrt(li*li+1)-li)}function Hc(za){return(Math.exp(za)-Math.exp(-za))/2}function ys(za){return(Math.exp(za)+Math.exp(-za))/2}function fc(za){return Hc(za)/ys(za)}var xo=co(0),Wl=function(li){return ys(xo)/ys(xo+$r*li)},Xu=function(li){return Bn*((ys(xo)*fc(xo+$r*li)-Hc(xo))/ri)/Dn},pl=(co(1)-xo)/$r;if(Math.abs(Dn)<1e-6||!isFinite(pl)){if(Math.abs(Bn-on)<1e-6)return this.easeTo(I,ee);var wl=on<Bn?-1:1;pl=Math.abs(Math.log(on/Bn))/$r,Xu=function(){return 0},Wl=function(li){return Math.exp(wl*$r*li)}}if("duration"in I)I.duration=+I.duration;else{var Mf="screenSpeed"in I?+I.screenSpeed/$r:+I.speed;I.duration=1e3*pl/Mf}return I.maxDuration&&I.duration>I.maxDuration&&(I.duration=0),this.zooming=!0,this.rotating=We!==_t,this.pitching=ke!==tt,this.padding=!k.isPaddingEqual(pt),this.prepareEase(ee,!1),this.ease(function(za){var li=za*pl,lh=1/Wl(li);k.zoom=za===1?Je:Q+k.scaleZoom(lh),g.rotating&&(k.bearing=qs(We,_t,za)),g.pitching&&(k.pitch=qs(tt,ke,za)),g.padding&&(k.interpolatePadding(Pe,pt,za),Kt=k.centerPoint.add(Zt));var th=za===1?rr:k.unproject(mr.add(Or.mult(Xu(li))).mult(lh));k.setLocationAtPoint(k.renderWorldCopies?th.wrap():th,Kt),g.fireMoveEvents(ee)},function(){return g.afterEase(ee)},I),this}},{key:"fitScreenCoordinates",value:function(g,I,ee,B,k){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(kn.convert(g)),this.transform.pointLocation(kn.convert(I)),ee,B),B,k)}},{key:"stop",value:function(g,I){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var ee=this.onEaseEnd;delete this.onEaseEnd,ee.call(this,I)}return this}},{key:"normalizeBearing",value:function(g,I){g=ef(g,-180,180);var ee=Math.abs(g-I);return Math.abs(g-360-I)<ee&&(g-=360),Math.abs(g+360-I)<ee&&(g+=360),g}},{key:"normalizeCenter",value:function(g){var I=this.transform;if(!I.renderWorldCopies||I.lngRange)return;var ee=g.lng-I.center.lng;g.lng+=ee>180?-360:ee<-180?360:0}},{key:"fireMoveEvents",value:function(g){this.emit("move",new ni("move",g)),this.zooming&&this.emit("zoom",new ni("zoom",g)),this.rotating&&this.emit("rotate",new ni("rotate",g)),this.pitching&&this.emit("rotate",new ni("pitch",g))}},{key:"prepareEase",value:function(g){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!I&&!ee.moving&&this.emit("movestart",new ni("movestart",g)),this.zooming&&!ee.zooming&&this.emit("zoomstart",new ni("zoomstart",g)),this.rotating&&!ee.rotating&&this.emit("rotatestart",new ni("rotatestart",g)),this.pitching&&!ee.pitching&&this.emit("pitchstart",new ni("pitchstart",g))}},{key:"afterEase",value:function(g,I){if(this.easeId&&I&&this.easeId===I)return;delete this.easeId;var ee=this.zooming,B=this.rotating,k=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,ee&&this.emit("zoomend",new ni("zoomend",g)),B&&this.emit("rotateend",new ni("rotateend",g)),k&&this.emit("pitchend",new ni("pitchend",g)),this.emit("moveend",new ni("moveend",g))}},{key:"ease",value:function(g,I,ee){ee.animate===!1||ee.duration===0?(g(1),I()):(this.easeStart=Fs(),this.easeOptions=ee,this.onEaseFrame=g,this.onEaseEnd=I,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(g,I,ee,B){var k={top:0,bottom:0,right:0,left:0};if(B=eo()({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},B),typeof B.padding=="number"){var Q=B.padding;B.padding={top:Q,bottom:Q,right:Q,left:Q}}B.padding=eo()(k,B.padding);var We=this.transform,tt=We.padding,Pe=We.project(fi.convert(g)),Je=We.project(fi.convert(I)),_t=Pe.rotate(-ee*Math.PI/180),ke=Je.rotate(-ee*Math.PI/180),pt=new kn(Math.max(_t.x,ke.x),Math.max(_t.y,ke.y)),De=new kn(Math.min(_t.x,ke.x),Math.min(_t.y,ke.y)),Zt=pt.sub(De),Kt=(We.width-(tt.left+tt.right+B.padding.left+B.padding.right))/Zt.x,dr=(We.height-(tt.top+tt.bottom+B.padding.top+B.padding.bottom))/Zt.y;if(dr<0||Kt<0)return;var rr=Math.min(We.scaleZoom(We.scale*Math.min(Kt,dr)),B.maxZoom),mr=kn.convert(B.offset),Or=(B.padding.left-B.padding.right)/2,$r=(B.padding.top-B.padding.bottom)/2,Bn=new kn(mr.x+Or,mr.y+$r),on=Bn.mult(We.scale/We.zoomScale(rr)),Dn=We.unproject(Pe.add(Je).div(2).sub(on));return{center:Dn,zoom:rr,bearing:ee}}},{key:"fitInternal",value:function(g,I,ee){return g?(I=eo()(g,I),delete I.padding,I.linear?this.easeTo(I,ee):this.flyTo(I,ee)):this}}]),c}(pf.EventEmitter);function sl(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=tn(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function tn(w,y){if(!w)return;if(typeof w=="string")return bc(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return bc(w,y)}function bc(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var us={},ro=us;us.create=function(w,y,c){var d=window.document.createElement(w);return y!==void 0&&(d.className=y),c&&c.appendChild(d),d},us.createNS=function(w,y){var c=window.document.createElementNS(w,y);return c};var qo=window.document&&window.document.documentElement.style;function Rs(w){if(!qo)return w[0];var y=sl(w),c;try{for(y.s();!(c=y.n()).done;){var d=c.value;if(d in qo)return d}}catch(g){y.e(g)}finally{y.f()}return w[0]}var jl=Rs(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),kc;us.disableDrag=function(){qo&&jl&&(kc=qo[jl],qo[jl]="none")},us.enableDrag=function(){qo&&jl&&(qo[jl]=kc)};var Vs=Rs(["transform","WebkitTransform"]);us.setTransform=function(w,y){w.style[Vs]=y};var Su=!1;try{var zl=Object.defineProperty({},"passive",{get:function(){Su=!0}});window.addEventListener("test",zl,zl),window.removeEventListener("test",zl,zl)}catch(w){Su=!1}us.addEventListener=function(w,y,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Su?w.addEventListener(y,c,d):w.addEventListener(y,c,d.capture)},us.removeEventListener=function(w,y,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Su?w.removeEventListener(y,c,d):w.removeEventListener(y,c,d.capture)};var Fl=function w(y){y.preventDefault(),y.stopPropagation(),window.removeEventListener("click",w,!0)};us.suppressClick=function(){window.addEventListener("click",Fl,!0),window.setTimeout(function(){window.removeEventListener("click",Fl,!0)},0)},us.mousePos=function(w,y){var c=w.getBoundingClientRect();return new kn(y.clientX-c.left-w.clientLeft,y.clientY-c.top-w.clientTop)},us.touchPos=function(w,y){var c=w.getBoundingClientRect(),d=[],g=sl(y),I;try{for(g.s();!(I=g.n()).done;){var ee=I.value;d.push(new kn(ee.clientX-c.left-w.clientLeft,ee.clientY-c.top-w.clientTop))}}catch(B){g.e(B)}finally{g.f()}return d},us.mouseButton=function(w){return typeof window.InstallTrigger!="undefined"&&w.button===2&&w.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button},us.remove=function(w){w.parentNode&&w.parentNode.removeChild(w)};function rf(w){var y=jc();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function jc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ro=function(w){ze()(c,w);var y=rf(c);function c(d,g,I){var ee,B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ke()(this,c);var k=ro.mousePos(g.getCanvasContainer(),I),Q=g.unproject(k);return ee=y.call(this,d,eo()({point:k,lngLat:Q,originalEvent:I},B)),ee.type=void 0,ee.target=void 0,ee.originalEvent=void 0,ee.point=void 0,ee.lngLat=void 0,ee.defaultPrevented=void 0,ee.defaultPrevented=!1,ee.target=g,ee}return yt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni);function ls(w){var y=Pa();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var eu=function(w){ze()(c,w);var y=ls(c);function c(d,g,I){var ee;Ke()(this,c);var B=d==="touchend"?I.changedTouches:I.touches,k=ro.touchPos(g.getCanvasContainer(),B),Q=k.map(function(Pe){return g.unproject(Pe)}),We=k.reduce(function(Pe,Je,_t,ke){return Pe.add(Je.div(ke.length))},new kn(0,0)),tt=g.unproject(We);return ee=y.call(this,d,{points:k,point:We,lngLats:Q,lngLat:tt,originalEvent:I}),ee.type=void 0,ee.target=void 0,ee.originalEvent=void 0,ee.lngLat=void 0,ee.point=void 0,ee.points=void 0,ee.lngLats=void 0,ee.defaultPrevented=void 0,ee.defaultPrevented=!1,ee}return yt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni);function Io(w){var y=So();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function So(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Sl=function(w){ze()(c,w);var y=Io(c);function c(d,g,I){var ee;return Ke()(this,c),ee=y.call(this,d,{originalEvent:I}),ee.type=void 0,ee.originalEvent=void 0,ee.defaultPrevented=void 0,ee.target=void 0,ee.defaultPrevented=!1,ee}return yt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni),ul=function(){function w(y){Ke()(this,w),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=y}return yt()(w,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Ro("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new Ro(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),w}(),pu=function(){function w(y,c){Ke()(this,w),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=y,this.el=y.getCanvasContainer(),this.container=y.getContainer(),this.clickTolerance=c.clickTolerance||1}return yt()(w,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,d){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;ro.disableDrag(),this.startPos=this.lastPos=d,this.active=!0}},{key:"mousemoveWindow",value:function(c,d){if(!this.active)return;var g=d;if(this.lastPos.equals(g)||!this.box&&g.dist(this.startPos)<this.clickTolerance)return;var I=this.startPos;this.lastPos=g,this.box||(this.box=ro.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var ee=Math.min(I.x,g.x),B=Math.max(I.x,g.x),k=Math.min(I.y,g.y),Q=Math.max(I.y,g.y);ro.setTransform(this.box,"translate(".concat(ee,"px,").concat(k,"px)")),this.box&&(this.box.style.width="".concat(B-ee,"px"),this.box.style.height="".concat(Q-k,"px"))}},{key:"mouseupWindow",value:function(c,d){var g=this;if(!this.active)return;if(c.button!==0)return;var I=this.startPos,ee=d;if(this.reset(),ro.suppressClick(),I.x===ee.x&&I.y===ee.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new ni("boxzoomend",{originalEvent:c})),{cameraAnimation:function(k){return k.fitScreenCoordinates(I,ee,g.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(ro.remove(this.box),this.box=null),ro.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,d){return this.map.emit(c,new ni(c,{originalEvent:d}))}}]),w}(),Cs=pu,xc=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.reset()}return yt()(w,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,d){return c.preventDefault(),{cameraAnimation:function(I){I.easeTo({duration:300,zoom:I.getZoom()+(c.shiftKey?-1:1),around:I.unproject(d)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function Jn(w){var y=jn();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function jn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ec=function(w){ze()(c,w);var y=Jn(c);function c(){var d;Ke()(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.type="renderFrame",d.timeStamp=void 0,d}return c}(ni);function cs(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Do(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function Do(w,y){if(!w)return;if(typeof w=="string")return vo(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vo(w,y)}function vo(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var ws={linearity:.3,easing:_l(0,0,.3,1)},Au=eo()({deceleration:2500,maxSpeed:1400},ws),ec=eo()({deceleration:20,maxSpeed:1400},ws),$a=eo()({deceleration:1e3,maxSpeed:360},ws),no=eo()({deceleration:1e3,maxSpeed:90},ws),ll=function(){function w(y){Ke()(this,w),this.map=void 0,this.inertiaBuffer=void 0,this.map=y,this.clear()}return yt()(w,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:Fs(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,d=Fs(),g=160;c.length>0&&d-c[0].time>g;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var d={zoom:0,bearing:0,pitch:0,pan:new kn(0,0),pinchAround:void 0,around:void 0},g=cs(this.inertiaBuffer),I;try{for(g.s();!(I=g.n()).done;){var ee=I.value.settings;d.zoom+=ee.zoomDelta||0,d.bearing+=ee.bearingDelta||0,d.pitch+=ee.pitchDelta||0,ee.panDelta&&d.pan._add(ee.panDelta),ee.around&&(d.around=ee.around),ee.pinchAround&&(d.pinchAround=ee.pinchAround)}}catch(ke){g.e(ke)}finally{g.f()}var B=this.inertiaBuffer[this.inertiaBuffer.length-1],k=B.time-this.inertiaBuffer[0].time,Q={};if(d.pan.mag()){var We=cl(d.pan.mag(),k,eo()({},Au,c||{}));Q.offset=d.pan.mult(We.amount/d.pan.mag()),Q.center=this.map.transform.center,mu(Q,We)}if(d.zoom){var tt=cl(d.zoom,k,ec);Q.zoom=this.map.transform.zoom+tt.amount,mu(Q,tt)}if(d.bearing){var Pe=cl(d.bearing,k,$a);Q.bearing=this.map.transform.bearing+tl(Pe.amount,-179,179),mu(Q,Pe)}if(d.pitch){var Je=cl(d.pitch,k,no);Q.pitch=this.map.transform.pitch+Je.amount,mu(Q,Je)}if(Q.zoom||Q.bearing){var _t=d.pinchAround===void 0?d.around:d.pinchAround;Q.around=_t?this.map.unproject(_t):this.map.getCenter()}return this.clear(),eo()(Q,{noMoveStart:!0})}}]),w}();function mu(w,y){(!w.duration||w.duration<y.duration)&&(w.duration=y.duration,w.easing=y.easing)}function cl(w,y,c){var d=c.maxSpeed,g=c.linearity,I=c.deceleration,ee=tl(w*g/(y/1e3),-d,d),B=Math.abs(ee)/(I*g);return{easing:c.easing,duration:B*1e3,amount:ee*(B/2)}}var Cu={panStep:100,bearingStep:15,pitchStep:10},Is=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var y=Cu;this.panStep=y.panStep,this.bearingStep=y.bearingStep,this.pitchStep=y.pitchStep}return yt()(w,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var d=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var g=0,I=0,ee=0,B=0,k=0;switch(c.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:c.shiftKey?I=-1:(c.preventDefault(),B=-1);break;case 39:c.shiftKey?I=1:(c.preventDefault(),B=1);break;case 38:c.shiftKey?ee=1:(c.preventDefault(),k=-1);break;case 40:c.shiftKey?ee=-1:(c.preventDefault(),k=1);break;default:return}return{cameraAnimation:function(We){var tt=We.getZoom();We.easeTo({duration:300,easeId:"keyboardHandler",easing:zc,zoom:g?Math.round(tt)+g*(c.shiftKey?2:1):tt,bearing:We.getBearing()+I*d.bearingStep,pitch:We.getPitch()+ee*d.pitchStep,offset:[-B*d.panStep,-k*d.panStep],center:We.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function zc(w){return w*(2-w)}var Gs=Is,yf=function(){function w(y,c){Ke()(this,w),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=y,this.clickTolerance=c.clickTolerance}return yt()(w,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Sl(c.type,this.map,c))}},{key:"mousedown",value:function(c,d){return this.mousedownPos=d,this.firePreventable(new Ro(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"click",value:function(c,d){if(this.mousedownPos&&this.mousedownPos.dist(d)>=this.clickTolerance)return;this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new Ro(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new eu(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),w}(),Ul=o("jr/B"),Bl=o.n(Ul),_c,fs=0,Bu=2,Fc=(_c={},yr()(_c,fs,1),yr()(_c,Bu,2),_c);function Al(w,y){var c=Fc[y];return w.buttons===void 0||(w.buttons&c)!==c}var Vu=function(){function w(y){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=y.clickTolerance||1}return yt()(w,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,d){if(this.lastPoint)return;var g=ro.mouseButton(c);if(!this.correctButton(c,g))return;this.lastPoint=d,this.eventButton=g}},{key:"mousemoveWindow",value:function(c,d){var g=this.lastPoint;if(!g)return;if(c.preventDefault(),Al(c,this.eventButton)){this.reset();return}return!this.moved&&d.dist(g)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=d,this.move(g,d))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var d=ro.mouseButton(c);if(d!==this.eventButton)return;this.moved&&ro.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,d){return!1}},{key:"move",value:function(c,d){return}}]),w}();function tc(w){var y=Gu();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function Gu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ds=function(w){ze()(c,w);var y=tc(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"mousedown",value:function(g,I){Bl()(hr()(c.prototype),"mousedown",this).call(this,g,I),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(g,I){return{around:I,panDelta:I.sub(g)}}},{key:"correctButton",value:function(g,I){return I===fs&&!g.ctrlKey}}]),c}(Vu);function nf(w){var y=rc();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function rc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var nc=function(w){ze()(c,w);var y=nf(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"correctButton",value:function(g,I){return I===fs&&g.ctrlKey||I===Bu}},{key:"move",value:function(g,I){var ee=-.5,B=(I.y-g.y)*ee;if(B)return this.active=!0,{pitchDelta:B}}},{key:"contextmenu",value:function(g){g.preventDefault()}}]),c}(Vu);function ac(w){var y=s();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function s(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var a=function(w){ze()(c,w);var y=ac(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"contextmenu",value:function(g){g.preventDefault()}},{key:"correctButton",value:function(g,I){return I===fs&&g.ctrlKey||I===Bu}},{key:"move",value:function(g,I){var ee=.8,B=(I.x-g.x)*ee;if(B)return this.active=!0,{bearingDelta:B}}}]),c}(Vu),n=4.000244140625,l=1/100,v=1/450,O=2,L=function(){function w(y,c){var d=this;Ke()(this,w),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!d.frameId)return;if(d.frameId=null,!d.isActive())return;var g=d.map.transform;if(d.delta!==0){var I=d.type==="wheel"&&Math.abs(d.delta)>n?d.wheelZoomRate:d.defaultZoomRate,ee=O/(1+Math.exp(-Math.abs(d.delta*I)));d.delta<0&&ee!==0&&(ee=1/ee);var B=typeof d.targetZoom=="number"?g.zoomScale(d.targetZoom):g.scale;d.targetZoom=Math.min(g.maxZoom,Math.max(g.minZoom,g.scaleZoom(B*ee))),d.type==="wheel"&&(d.startZoom=g.zoom,d.easing=d.smoothOutEasing(200)),d.delta=0}var k=typeof d.targetZoom=="number"?d.targetZoom:g.zoom,Q=d.startZoom,We=d.easing,tt=!1,Pe;if(d.type==="wheel"&&Q&&We){var Je=Math.min((Fs()-d.lastWheelEventTime)/200,1),_t=We(Je);Pe=qs(Q,k,_t),Je<1?d.frameId||(d.frameId=!0):tt=!0}else Pe=k,tt=!0;return d.active=!0,tt&&(d.active=!1,d.finishTimeout=setTimeout(function(){d.zooming=!1,d.handler.triggerRenderFrame(),delete d.targetZoom,delete d.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!tt,zoomDelta:Pe-g.zoom,around:d.aroundPoint,originalEvent:d.lastWheelEvent}},this.map=y,this.el=y.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=l,this.wheelZoomRate=v}return yt()(w,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var d=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,g=Fs(),I=g-(this.lastWheelEventTime||0);this.lastWheelEventTime=g,d!==0&&d%n===0?this.type="wheel":d!==0&&Math.abs(d)<4?this.type="trackpad":I>400?(this.type=null,this.lastValue=d,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(I*d)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,d+=this.lastValue)),c.shiftKey&&d&&(d=d/4),this.type&&(this.lastWheelEvent=c,this.delta-=d,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var d=ro.mousePos(this.el,c);this.around=fi.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(d)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var d=ql;if(this.prevEase){var g=this.prevEase,I=(Fs()-g.start)/g.duration,ee=g.easing(I+.01)-g.easing(I),B=.27/Math.sqrt(ee*ee+1e-4)*.01,k=Math.sqrt(.27*.27-B*B);d=_l(B,k,.25,1)}return this.prevEase={start:Fs(),duration:c,easing:d},d}}]),w}(),j=L,ue=function(){function w(y,c){Ke()(this,w),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=y,this.tapZoom=c}return yt()(w,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),w}(),Ee=function(){function w(y,c,d){Ke()(this,w),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=y,this.mousePan=c,this.touchPan=d}return yt()(w,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),w}(),$e=function(){function w(y,c,d){Ke()(this,w),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=y.pitchWithRotate,this.mouseRotate=c,this.mousePitch=d}return yt()(w,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),w}(),rt=function(){function w(y,c,d,g){Ke()(this,w),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=y,this.touchZoom=c,this.touchRotate=d,this.tapDragZoom=g,this.rotationDisabled=!1,this.enabled=!0}return yt()(w,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),w}();function at(w,y){for(var c={},d=0;d<w.length;d++)c[w[d].identifier]=y[d];return c}function zt(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Nt(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function Nt(w,y){if(!w)return;if(typeof w=="string")return Jt(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Jt(w,y)}function Jt(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function jt(w){var y=new kn(0,0),c=zt(w),d;try{for(c.s();!(d=c.n()).done;){var g=d.value;y._add(g)}}catch(I){c.e(I)}finally{c.f()}return y.div(w.length)}var Gt=500,ar=500,nr=30,Rr=function(){function w(y){Ke()(this,w),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=y.numTouches}return yt()(w,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,d,g){if((this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),g.length===this.numTouches&&(this.centroid=jt(d),this.touches=at(g,d))}},{key:"touchmove",value:function(c,d,g){if(this.aborted||!this.centroid)return;var I=at(g,d);for(var ee in this.touches)if(this.touches[ee]){var B=this.touches[ee],k=I[ee];(!k||k.dist(B)>nr)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,d,g){if((!this.centroid||c.timeStamp-this.startTime>ar)&&(this.aborted=!0),g.length===0){var I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}]),w}(),gr=function(){function w(y){Ke()(this,w),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Rr(y),this.numTaps=y.numTaps,this.reset()}return yt()(w,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,d,g){this.singleTap.touchstart(c,d,g)}},{key:"touchmove",value:function(c,d,g){this.singleTap.touchmove(c,d,g)}},{key:"touchend",value:function(c,d,g){var I=this.singleTap.touchend(c,d,g);if(I){var ee=c.timeStamp-this.lastTime<Gt,B=!this.lastTap||this.lastTap.dist(I)<nr;if((!ee||!B)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}]),w}(),Ar=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new gr({numTouches:1,numTaps:1}),this.reset()}return yt()(w,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,d,g){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>Gt&&this.reset(),this.tapTime?g.length>0&&(this.swipePoint=d[0],this.swipeTouch=g[0].identifier):this.tap.touchstart(c,d,g)}},{key:"touchmove",value:function(c,d,g){if(!this.tapTime)this.tap.touchmove(c,d,g);else if(this.swipePoint){if(g[0].identifier!==this.swipeTouch)return;var I=d[0],ee=I.y-this.swipePoint.y;return this.swipePoint=I,c.preventDefault(),this.active=!0,{zoomDelta:ee/128}}}},{key:"touchend",value:function(c,d,g){if(this.tapTime)this.swipePoint&&(g.length===0&&this.reset());else{var I=this.tap.touchend(c,d,g);I&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),Cr=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new gr({numTouches:1,numTaps:2}),this.zoomOut=new gr({numTouches:2,numTaps:1}),this.reset()}return yt()(w,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,d,g){this.zoomIn.touchstart(c,d,g),this.zoomOut.touchstart(c,d,g)}},{key:"touchmove",value:function(c,d,g){this.zoomIn.touchmove(c,d,g),this.zoomOut.touchmove(c,d,g)}},{key:"touchend",value:function(c,d,g){var I=this,ee=this.zoomIn.touchend(c,d,g),B=this.zoomOut.touchend(c,d,g);if(ee)return this.active=!0,c.preventDefault(),setTimeout(function(){return I.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()+1,around:Q.unproject(ee)},{originalEvent:c})}};if(B)return this.active=!0,c.preventDefault(),setTimeout(function(){return I.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()-1,around:Q.unproject(B)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),an=function(){function w(y){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=y.clickTolerance||1,this.reset()}return yt()(w,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new kn(0,0)}},{key:"touchstart",value:function(c,d,g){return this.calculateTransform(c,d,g)}},{key:"touchmove",value:function(c,d,g){return this.active?(c.preventDefault(),this.calculateTransform(c,d,g)):void 0}},{key:"touchend",value:function(c,d,g){this.calculateTransform(c,d,g),this.active&&g.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,d,g){g.length>0&&(this.active=!0);var I=at(g,d),ee=new kn(0,0),B=new kn(0,0),k=0;for(var Q in I)if(I[Q]){var We=I[Q],tt=this.touches[Q];tt&&(ee._add(We),B._add(We.sub(tt)),k++,I[Q]=We)}if(this.touches=I,k<this.minTouches||!B.mag())return;var Pe=B.div(k);if(this.sum._add(Pe),this.sum.mag()<this.clickTolerance)return;var Je=ee.div(k);return{around:Je,panDelta:Pe}}}]),w}(),Yr=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return yt()(w,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,d,g){return}},{key:"touchstart",value:function(c,d,g){if(this.firstTwoTouches||g.length<2)return;this.firstTwoTouches=[g[0].identifier,g[1].identifier],this.start([d[0],d[1]])}},{key:"touchmove",value:function(c,d,g){if(!this.firstTwoTouches)return;c.preventDefault();var I=bn()(this.firstTwoTouches,2),ee=I[0],B=I[1],k=vn(g,d,ee),Q=vn(g,d,B);if(!k||!Q)return;var We=this.aroundCenter?null:k.add(Q).div(2);return this.move([k,Q],We,c)}},{key:"touchend",value:function(c,d,g){if(!this.firstTwoTouches)return;var I=bn()(this.firstTwoTouches,2),ee=I[0],B=I[1],k=vn(g,d,ee),Q=vn(g,d,B);if(k&&Q)return;this.active&&ro.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function vn(w,y,c){for(var d=0;d<w.length;d++)if(w[d].identifier===c)return y[d]}function Pn(w){var y=qn();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function qn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function sa(w){return Math.abs(w.y)>Math.abs(w.x)}var Aa=100,Wa=function(w){ze()(c,w);var y=Pn(c);function c(){var d;Ke()(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.valid=void 0,d.firstMove=void 0,d.lastPoints=void 0,d}return yt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(g){this.lastPoints=g,sa(g[0].sub(g[1]))&&(this.valid=!1)}},{key:"move",value:function(g,I,ee){var B=g[0].sub(this.lastPoints[0]),k=g[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(B,k,ee.timeStamp),!this.valid)return;this.lastPoints=g,this.active=!0;var Q=(B.y+k.y)/2,We=-.5;return{pitchDelta:Q*We}}},{key:"gestureBeginsVertically",value:function(g,I,ee){if(this.valid!==void 0)return this.valid;var B=2,k=g.mag()>=B,Q=I.mag()>=B;if(!k&&!Q)return;if(!k||!Q)return this.firstMove===void 0&&(this.firstMove=ee),ee-this.firstMove<Aa?void 0:!1;var We=g.y>0===I.y>0;return sa(g)&&sa(I)&&We}}]),c}(Yr);function Tn(w){var y=ua();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var xa=25;function Zn(w,y){return w.angleWith(y)*180/Math.PI}var Ca=function(w){ze()(c,w);var y=Tn(c);function c(){var d;Ke()(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.minDiameter=void 0,d}return yt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(g){this.startVector=this.vector=g[0].sub(g[1]),this.minDiameter=g[0].dist(g[1])}},{key:"move",value:function(g,I){var ee=this.vector;return this.vector=g[0].sub(g[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:Zn(this.vector,ee),pinchAround:I})}},{key:"isBelowThreshold",value:function(g){this.minDiameter=Math.min(this.minDiameter,g.mag());var I=Math.PI*this.minDiameter,ee=xa/I*360,B=Zn(g,this.startVector);return Math.abs(B)<ee}}]),c}(Yr);function ia(w){var y=La();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function La(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Fa=.1;function Hi(w,y){return Math.log(w/y)/Math.LN2}var Ai=function(w){ze()(c,w);var y=ia(c);function c(){var d;Ke()(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.distance=void 0,d.startDistance=void 0,d}return yt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(g){this.startDistance=this.distance=g[0].dist(g[1])}},{key:"move",value:function(g,I){var ee=this.distance;return this.distance=g[0].dist(g[1]),!this.active&&Math.abs(Hi(this.distance,this.startDistance))<Fa?void 0:(this.active=!0,{zoomDelta:Hi(this.distance,ee),pinchAround:I})}}]),c}(Yr);function Ni(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Ei(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function Ei(w,y){if(!w)return;if(typeof w=="string")return Bi(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Bi(w,y)}function Bi(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var es=function(y){return y.zoom||y.drag||y.pitch||y.rotate};function ts(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}var vu=function(){function w(y,c){var d=this;Ke()(this,w),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(tt){d.handleEvent(tt,"".concat(tt.type,"Window"))},this.handleEvent=function(tt,Pe){if(tt.type==="blur"){d.stop();return}d.updatingCamera=!0;var Je=tt.type==="renderFrame"?void 0:tt,_t={needsRenderFrame:!1},ke={},pt={},De=tt.touches?d.getMapTouches(tt.touches):void 0,Zt=De?ro.touchPos(d.el,De):ro.mousePos(d.el,tt),Kt=Ni(d.handlers),dr;try{for(Kt.s();!(dr=Kt.n()).done;){var rr=dr.value,mr=rr.handlerName,Or=rr.handler,$r=rr.allowed;if(!Or.isEnabled())continue;var Bn=void 0;if(d.blockedByActive(pt,$r,mr))Or.reset();else{var on=Pe||tt.type;Or&&Or[on]&&(Bn=Or[on](tt,Zt,De),d.mergeIHandlerResult(_t,ke,Bn,mr,Je),Bn&&Bn.needsRenderFrame&&d.triggerRenderFrame())}(Bn||Or.isActive())&&(pt[mr]=Or)}}catch(ri){Kt.e(ri)}finally{Kt.f()}var Dn={};for(var ca in d.previousActiveHandlers)pt[ca]||(Dn[ca]=Je);d.previousActiveHandlers=pt,(Object.keys(Dn).length||ts(_t))&&(d.changes.push([_t,ke,Dn]),d.triggerRenderFrame()),(Object.keys(pt).length||ts(_t))&&d.map.stop(!0),d.updatingCamera=!1;var Na=_t.cameraAnimation;Na&&(d.inertia.clear(),d.fireEvents({},{}),d.changes=[],Na(d.map))},this.map=y,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new ll(y),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var g=this.el;this.listeners=[[g,"touchstart",{passive:!1}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];var I=Ni(this.listeners),ee;try{for(I.s();!(ee=I.n()).done;){var B=bn()(ee.value,3),k=B[0],Q=B[1],We=B[2];ro.addEventListener(k,Q,k===window.document?this.handleWindowEvent:this.handleEvent,We)}}catch(tt){I.e(tt)}finally{I.f()}}return yt()(w,[{key:"destroy",value:function(){var c=Ni(this.listeners),d;try{for(c.s();!(d=c.n()).done;){var g=bn()(d.value,3),I=g[0],ee=g[1],B=g[2];ro.removeEventListener(I,ee,I===window.document?this.handleWindowEvent:this.handleEvent,B)}}catch(k){c.e(k)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Ni(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var g=d.value.handler;g.reset()}}catch(I){c.e(I)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Ni(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var g=d.value.handler;if(g.isActive())return!0}}catch(I){c.e(I)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(es(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,d,g,I,ee){if(!g)return;eo()(c,g);var B={handlerName:I,originalEvent:g.originalEvent||ee};g.zoomDelta!==void 0&&(d.zoom=B),g.panDelta!==void 0&&(d.drag=B),g.pitchDelta!==void 0&&(d.pitch=B),g.bearingDelta!==void 0&&(d.rotate=B)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(d){delete c.frameId,c.handleEvent(new Ec("renderFrame",{timeStamp:d})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var d=this.map,g=d.getCanvasContainer();this.add("mapEvent",new yf(d,c));var I=d.boxZoom=new Cs(d,c);this.add("boxZoom",I);var ee=new Cr,B=new xc;d.doubleClickZoom=new ue(B,ee),this.add("tapZoom",ee),this.add("clickZoom",B);var k=new Ar;this.add("tapDragZoom",k);var Q=d.touchPitch=new Wa;this.add("touchPitch",Q);var We=new nc(c),tt=new a(c);d.dragRotate=new $e(c,We,tt),this.add("mouseRotate",We,["mousePitch"]),this.add("mousePitch",tt,["mouseRotate"]);var Pe=new Ds(c),Je=new an(c);d.dragPan=new Ee(g,Pe,Je),this.add("mousePan",Pe),this.add("touchPan",Je,["touchZoom","touchRotate"]);var _t=new Ca,ke=new Ai;d.touchZoomRotate=new rt(g,ke,_t,k),this.add("touchRotate",_t,["touchPan","touchZoom"]),this.add("touchZoom",ke,["touchPan","touchRotate"]);var pt=d.scrollZoom=new j(d,this);this.add("scrollZoom",pt,["mousePan"]);var De=d.keyboard=new Gs;this.add("keyboard",De),this.add("blockableMapEvent",new ul(d));for(var Zt=0,Kt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Zt<Kt.length;Zt++){var dr=Kt[Zt];c.interactive&&c[dr]&&d[dr].enable(c[dr])}}},{key:"add",value:function(c,d,g){this.handlers.push({handlerName:c,handler:d,allowed:g}),this.handlersById[c]=d}},{key:"blockedByActive",value:function(c,d,g){for(var I in c){if(I===g)continue;if(!d||d.indexOf(I)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var d=[],g=Ni(c),I;try{for(g.s();!(I=g.n()).done;){var ee=I.value,B=ee.target;this.el.contains(B)&&d.push(ee)}}catch(k){g.e(k)}finally{g.f()}return d}},{key:"applyChanges",value:function(){var c={},d={},g={},I=Ni(this.changes),ee;try{for(I.s();!(ee=I.n()).done;){var B=bn()(ee.value,3),k=B[0],Q=B[1],We=B[2];k.panDelta&&(c.panDelta=(c.panDelta||new kn(0,0))._add(k.panDelta)),k.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+k.pitchDelta),k.around!==void 0&&(c.around=k.around),k.pinchAround!==void 0&&(c.pinchAround=k.pinchAround),k.noInertia&&(c.noInertia=k.noInertia),eo()(d,Q),eo()(g,We)}}catch(tt){I.e(tt)}finally{I.f()}this.updateMapTransform(c,d,g),this.changes=[]}},{key:"updateMapTransform",value:function(c,d,g){var I=this.map,ee=I.transform;if(!ts(c))return this.fireEvents(d,g);var B=c.panDelta,k=c.zoomDelta,Q=c.bearingDelta,We=c.pitchDelta,tt=c.pinchAround,Pe=c.around;tt!==void 0&&(Pe=tt),I.stop(!0),Pe=Pe||I.transform.centerPoint;var Je=ee.pointLocation(B?Pe.sub(B):Pe);Q&&(ee.bearing+=Q),We&&(ee.pitch+=We),k&&(ee.zoom+=k),ee.setLocationAtPoint(Je,Pe),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(d,g)}},{key:"fireEvents",value:function(c,d){var g=this,I=es(this.eventsInProgress),ee=es(c),B={};for(var k in c)if(c[k]){var Q=c[k].originalEvent;this.eventsInProgress[k]||(B["".concat(k,"start")]=Q),this.eventsInProgress[k]=c[k]}!I&&ee&&this.fireEvent("movestart",ee.originalEvent);for(var We in B)B[We]&&this.fireEvent(We,B[We]);c.rotate&&(this.bearingChanged=!0),ee&&this.fireEvent("move",ee.originalEvent);for(var tt in c)if(c[tt]){var Pe=c[tt].originalEvent;this.fireEvent(tt,Pe)}var Je={},_t;for(var ke in this.eventsInProgress)if(this.eventsInProgress[ke]){var pt=this.eventsInProgress[ke],De=pt.handlerName,Zt=pt.originalEvent;this.handlersById[De].isActive()||(delete this.eventsInProgress[ke],_t=d[De]||Zt,Je["".concat(ke,"end")]=_t)}for(var Kt in Je)Je[Kt]&&this.fireEvent(Kt,Je[Kt]);var dr=es(this.eventsInProgress);if((I||ee)&&!dr){this.updatingCamera=!0;var rr=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),mr=function($r){return $r!==0&&-g.bearingSnap<$r&&$r<g.bearingSnap};rr?(mr(rr.bearing||this.map.getBearing())&&(rr.bearing=0),this.map.easeTo(rr,{originalEvent:_t})):(this.map.emit("moveend",new ni("moveend",{originalEvent:_t})),mr(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,d){this.map.emit(c,new ni(c,d?{originalEvent:d}:{}))}}]),w}(),wu=vu,hs=o("cI4T"),Hs=o.n(hs),Ou=function(){function w(y){var c=this;Ke()(this,w),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var d=c.getCurrentHash();if(d.length>=3&&!d.some(function(I){return isNaN(+I)})){var g=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(d[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1},this.getCurrentHash=function(){var d=window.location.hash.replace("#","");if(c.hashName){var g;return d.split("&").map(function(I){return I.split("=")}).forEach(function(I){I[0]===c.hashName&&(g=I)}),(g&&g[1]||"").split("/")}return d.split("/")},this.updateHashUnthrottled=function(){var d=c.getHashString();try{window.history.replaceState(window.history.state,"",d)}catch(g){}},this.hashName=y&&encodeURIComponent(y),this.updateHash=Hs()(this.updateHashUnthrottled,30*1e3/100)}return yt()(w,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var d=this.map.getCenter(),g=Math.round(this.map.getZoom()*100)/100,I=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),ee=Math.pow(10,I),B=Math.round(d.lng*ee)/ee,k=Math.round(d.lat*ee)/ee,Q=this.map.getBearing(),We=this.map.getPitch(),tt="";if(c?tt+="/".concat(B,"/").concat(k,"/").concat(g):tt+="".concat(g,"/").concat(k,"/").concat(B),(Q||We)&&(tt+="/".concat(Math.round(Q*10)/10)),We&&(tt+="/".concat(Math.round(We))),this.hashName){var Pe=this.hashName,Je=!1,_t=window.location.hash.slice(1).split("&").map(function(ke){var pt=ke.split("=")[0];return pt===Pe?(Je=!0,"".concat(pt,"=").concat(tt)):ke}).filter(function(ke){return ke});return Je||_t.push("".concat(Pe,"=").concat(tt)),"#".concat(_t.join("&"))}return"#".concat(tt)}}]),w}(),ic=Ou,tu=null,Hu=[],oc=30,ru=1e3/oc,Mu=window.performance,ds={create:"create",load:"load",fullLoad:"fullLoad"},ao={mark:function(y){Mu.mark(y)},frame:function(y){var c=y;if(tu!=null){var d=c-tu;Hu.push(d)}tu=c},clearMetrics:function(){tu=null,Hu=[],Mu.clearMeasures("loadTime"),Mu.clearMeasures("fullLoadTime");for(var y in ds)Mu.clearMarks(ds[y])},getPerformanceMetrics:function(){var y=Mu.measure("loadTime",ds.create,ds.load).duration,c=Mu.measure("fullLoadTime",ds.create,ds.fullLoad).duration,d=Hu.length,g=Hu.reduce(function(k,Q){return k+Q},0)/d/1e3,I=1/g,ee=Hu.filter(function(k){return k>ru}).reduce(function(k,Q){return k+(Q-ru)/ru},0),B=ee/(d+ee)*100;return{loadTime:y,fullLoadTime:c,fps:I,percentDroppedFrames:B}}};function Zu(w,y){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Vl(w))||y&&w&&typeof w.length=="number"){c&&(w=c);var d=0,g=function(){};return{s:g,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,ee=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){ee=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(ee)throw B}}}}function Vl(w,y){if(!w)return;if(typeof w=="string")return ps(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ps(w,y)}function ps(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}var No=function(){function w(){Ke()(this,w),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return yt()(w,[{key:"add",value:function(c){var d=++this.id,g=this.queue;return g.push({callback:c,id:d,cancelled:!1}),d}},{key:"remove",value:function(c){var d=this.currentlyRunning,g=d?this.queue.concat(d):this.queue,I=Zu(g),ee;try{for(I.s();!(ee=I.n()).done;){var B=ee.value;if(B.id===c){B.cancelled=!0;return}}}catch(k){I.e(k)}finally{I.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=this.currentlyRunning=this.queue;this.queue=[];var g=Zu(d),I;try{for(g.s();!(I=g.n()).done;){var ee=I.value;if(ee.cancelled)continue;if(ee.callback(c),this.cleared)break}}catch(B){g.e(B)}finally{g.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),w}(),ko=No;function Ko(w){var y=Ao();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function Ao(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("qwXO")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var uo=-2,Ns=22,nu=0,Gl=60,Uc={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:uo,maxZoom:Ns,minPitch:nu,maxPitch:Gl,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},fl=function(w){ze()(c,w);var y=Ko(c);function c(d){var g;Ke()(this,c),g=y.call(this,eo()({},Uc,d)),g.doubleClickZoom=void 0,g.dragRotate=void 0,g.dragPan=void 0,g.touchZoomRotate=void 0,g.scrollZoom=void 0,g.keyboard=void 0,g.touchPitch=void 0,g.boxZoom=void 0,g.handlers=void 0,g.container=void 0,g.canvas=void 0,g.canvasContainer=void 0,g.renderTaskQueue=new ko,g.frame=void 0,g.trackResize=!0,g.hash=void 0,g.onWindowOnline=function(){g.update()},g.onWindowResize=function(ee){g.trackResize&&g.resize({originalEvent:ee}).update()},g.initContainer(),g.resize(),g.handlers=new wu(xl()(g),g.options),typeof window!="undefined"&&(window.addEventListener("online",g.onWindowOnline,!1),window.addEventListener("resize",g.onWindowResize,!1),window.addEventListener("orientationchange",g.onWindowResize,!1));var I=typeof d.hash=="string"&&d.hash||void 0;return d.hash&&(g.hash=new ic(I).addTo(xl()(g))),(!g.hash||!g.hash.onHashChange())&&(g.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(g.resize(),g.fitBounds(d.bounds,eo()({},d.fitBoundsOptions,{duration:0})))),g}return yt()(c,[{key:"resize",value:function(g){var I=this.containerDimensions(),ee=I[0],B=I[1];this.transform.resize(ee,B);var k=!this.moving;return k&&(this.stop(),this.emit("movestart",new Event("movestart",g)),this.emit("move",new Event("move",g))),this.emit("resize",new Event("resize",g)),k&&this.emit("moveend",new Event("moveend",g)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(g){return this.transform.locationPoint(fi.convert(g))}},{key:"unproject",value:function(g){return this.transform.pointLocation(kn.convert(g))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(g){this.transform.setMaxBounds(nl.convert(g))}},{key:"setStyle",value:function(g){return}},{key:"setMinZoom",value:function(g){if(g=g==null?uo:g,g>=uo&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between ".concat(uo," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(g){if(g=g==null?Ns:g,g>=this.transform.minZoom)return this.transform.maxZoom=g,this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(g){if(g=g==null?nu:g,g<nu)throw new Error("minPitch must be greater than or equal to ".concat(nu));if(g>=nu&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between ".concat(nu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(g){if(g=g==null?Gl:g,g>Gl)throw new Error("maxPitch must be less than or equal to ".concat(Gl));if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(g){this.transform.renderWorldCopies=!!g}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(g){return this.update(),this.renderTaskQueue.add(g)}},{key:"cancelRenderFrame",value:function(g){return this.renderTaskQueue.remove(g)}},{key:"triggerRepaint",value:function(){var g=this;this.frame||(this.frame=Pi(function(I){ao.frame(I),g.frame=null,g.update(I)}))}},{key:"update",value:function(g){var I=this;this.frame||(this.frame=Pi(function(ee){ao.frame(ee),I.frame=null,I.renderTaskQueue.run(g)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var g=this.container;g.classList.add("l7-map");var I=this.canvasContainer=fn.a.create("div","l7-canvas-container",g);this.options.interactive&&I.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var g=0,I=0;return this.container&&(g=this.container.clientWidth||400,I=this.container.clientHeight||300),[g,I]}},{key:"resizeCanvas",value:function(g,I){var ee=window.devicePixelRatio||1;this.canvas.width=ee*g,this.canvas.height=ee*I,this.canvas.style.width="".concat(g,"px"),this.canvas.style.height="".concat(I,"px")}}]),c}(Bs),sc=function(){function w(){Ke()(this,w),this.viewport=void 0}return yt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.center,g=c.zoom,I=c.pitch,ee=c.bearing,B=c.viewportHeight,k=c.viewportWidth;this.viewport=new Eu({width:k,height:B,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:I,bearing:ee})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),w}(),hl={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},ks,go,Tc,ms,af,Sf,Af,Sc,Wu,bf,of,Cf,Pu,uc;function If(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Bc(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?If(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):If(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}var Ac={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},$f=12,Jf=(ks=Object(rn.injectable)(),go=Object(rn.inject)(Cn.TYPES.MapConfig),Tc=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),ms=Object(rn.inject)(Cn.TYPES.ILogService),af=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),Sf=Object(rn.inject)(Cn.TYPES.IEventEmitter),ks(Af=(Sc=(uc=function(){function w(){var y=this;Ke()(this,w),this.map=void 0,Fn()(this,"config",Wu,this),Fn()(this,"configService",bf,this),Fn()(this,"logger",of,this),Fn()(this,"coordinateSystemService",Cf,this),Fn()(this,"eventEmitter",Pu,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=y.map.getCenter(),d=c.lat,g=c.lng;y.viewport.syncWithMapCamera({bearing:y.map.getBearing(),center:[g,d],viewportHeight:y.map.transform.height,pitch:y.map.getPitch(),viewportWidth:y.map.transform.width,zoom:y.map.getZoom(),cameraHeight:0}),y.viewport.getZoom()>$f?y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT_OFFSET):y.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT),y.cameraChangedCallback(y.viewport)}}return yt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=fn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(Ac[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(Ac[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,d,g){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],ee=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var y=cr()($.a.mark(function d(){var g,I,ee,B,k,Q,We,tt,Pe,Je,_t;return $.a.wrap(function(pt){for(;;)switch(pt.prev=pt.next){case 0:g=this.config,I=g.id,ee=I===void 0?"map":I,B=g.attributionControl,k=B===void 0?!1:B,Q=g.style,We=Q===void 0?"light":Q,tt=g.rotation,Pe=tt===void 0?0:tt,Je=g.mapInstance,_t=Ur()(g,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new sc,Je?(this.map=Je,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(ee),this.map=new fl(Bc({container:this.$mapContainer,style:this.getMapStyle(We),bearing:Pe},_t))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return pt.stop()}},d,this)}));function c(){return y.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,g=arguments.length,I=new Array(g>1?g-1:0),ee=1;ee<g;ee++)I[ee-1]=arguments[ee];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),g=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;return typeof c=="string"&&(d=document.getElementById(c)),d}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:hl[c]?hl[c]:c}}]),w}(),uc),Wu=$n()(Sc.prototype,"config",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bf=$n()(Sc.prototype,"configService",[Tc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),of=$n()(Sc.prototype,"logger",[ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cf=$n()(Sc.prototype,"coordinateSystemService",[af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=$n()(Sc.prototype,"eventEmitter",[Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sc))||Af);function Qf(w){var y=qf();return function(){var d=hr()(w),g;if(y){var I=hr()(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return gt()(this,g)}}function qf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var wf=function(w){ze()(c,w);var y=Qf(c);function c(){return Ke()(this,c),y.apply(this,arguments)}return yt()(c,[{key:"getServiceConstructor",value:function(){return Jf}}]),c}(Rt);function eh(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function Hl(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?eh(Object(c),!0).forEach(function(d){sf(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):eh(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function sf(w,y,c){return y in w?Object.defineProperty(w,y,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[y]=c,w}function io(w,y){return Cl(w)||au(w,y)||xf(w,y)||lc()}function lc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xf(w,y){if(!w)return;if(typeof w=="string")return Cc(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Cc(w,y)}function Cc(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function au(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function Cl(w){if(Array.isArray(w))return w}var Ef=Ce.a.memo(function(w){var y=w.style,c=w.className,d=w.map,g=w.option,I=w.onSceneLoaded,ee=Object(pe.createRef)(),B=Object(pe.useState)(),k=io(B,2),Q=k[0],We=k[1];return Object(pe.useEffect)(function(){var tt=new kt.Scene(Hl(Hl({id:ee.current},g),{},{map:new wf(d)}));return tt.on("loaded",function(){We(tt),I&&I(tt)}),function(){tt.destroy()}},[]),Object(pe.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(pe.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(pe.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(pe.useEffect)(function(){Q&&d.pitch&&Q.setPitch(d.pitch)},[d.pitch]),Object(pe.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(ae.Provider,{value:Q},Object(pe.createElement)("div",{ref:ee,style:y,className:c},Q&&w.children))}),Df=Ef;function Vc(w,y){return se(w)||ne(w,y)||Gc(w,y)||uf()}function uf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gc(w,y){if(!w)return;if(typeof w=="string")return dl(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return dl(w,y)}function dl(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function ne(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function se(w){if(Array.isArray(w))return w}var N=Ce.a.memo(function(w){var y=w.style,c=w.className,d=w.map,g=Object(pe.createRef)(),I=Object(pe.useState)(),ee=Vc(I,2),B=ee[0],k=ee[1];return Object(pe.useEffect)(function(){var Q=new kt.Scene({id:g.current,map:d});return Q.on("loaded",function(){k(Q)}),function(){Q.destroy()}},[]),Ce.a.createElement(ae.Provider,{value:B},Object(pe.createElement)("div",{ref:g,style:y,className:c},B&&w.children))});function G(w,y){return or(w)||sr(w,y)||ct(w,y)||Ae()}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ct(w,y){if(!w)return;if(typeof w=="string")return Yt(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Yt(w,y)}function Yt(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function sr(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function or(w){if(Array.isArray(w))return w}var Dr=Ce.a.memo(function(y){var c=et(),d=Object(pe.useState)(),g=G(d,2),I=g[1],ee=y.type,B=y.position;return Object(pe.useEffect)(function(){var k;switch(ee){case"scale":k=new kt.Scale({position:B||"bottomright"});break;case"zoom":k=new kt.Zoom({position:B||"topright"});break;case"logo":k=new kt.Logo({position:B||"bottomleft"})}return I(k),c.addControl(k),function(){c.removeControl(k)}},[ee,B]),null}),sn=o("fK+4"),Hn=pe.useEffect,ea=pe.useState;function la(w){var y=w.className,c=w.style,d=w.children,g=w.position,I=et(),ee=document.createElement("div");return Hn(function(){var B=new kt.Control({position:g});return B.onAdd=function(){if(y&&(ee.className=y),c){var k=Object.keys(c).map(function(Q){return"".concat(Q,":").concat(c[Q])}).join(";");ee.style.cssText=k}return ee},I.addControl(B),function(){I.removeControl(B)}},[]),Object(sn.createPortal)(d,ee)}var ti=Object(pe.createContext)({});function ja(){return Object(pe.useContext)(ti)}var _i=pe.useEffect,Qa=pe.memo(function(y){var c=y.layer,d=y.active;return _i(function(){c.active(d.option)},[JSON.stringify(d)]),null}),Vi=pe.useEffect,Co=pe.memo(function(y){var c=y.layer,d=y.animate;return Vi(function(){c.animate(d)},[JSON.stringify(d)]),null}),yo=pe.useEffect,Zi=pe.memo(function(y){var c=y.layer,d=y.color;return yo(function(){d.field?c.color(d.field,d.values):c.color(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),jo=pe.useEffect,qa=pe.memo(function(y){var c=y.layer,d=y.filter;return jo(function(){d.field&&c.filter(d.field,d.values)},[d.field,d.values,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),lo=pe.useEffect,iu=pe.memo(function(y){var c=y.layer,d=y.scale;return lo(function(){c.scale(d.values)},[d.values]),null}),Ti=pe.useEffect,ki=pe.memo(function(y){var c=y.layer,d=y.select;return Ti(function(){c.select(d.option)},[JSON.stringify(d)]),null}),Ea=pe.useEffect,wo=pe.memo(function(y){var c=y.layer,d=y.shape;return Ea(function(){d.field?c.shape(d.field,d.values):c.shape(d.values)},[d.field,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),cc=pe.useEffect,Nf=pe.memo(function(y){var c=y.layer,d=y.size;return cc(function(){d.field?c.size(d.field,d.values):c.size(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null});function oh(w,y){if(w==null)return{};var c=kf(w,y),d,g;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(w);for(g=0;g<I.length;g++){if(d=I[g],y.indexOf(d)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(w,d))continue;c[d]=w[d]}}return c}function kf(w,y){if(w==null)return{};var c={},d=Object.keys(w),g,I;for(I=0;I<d.length;I++){if(g=d[I],y.indexOf(g)>=0)continue;c[g]=w[g]}return c}var Lu=pe.useEffect,jf=pe.memo(function(y){var c=y.layer,d=y.source,g=d.data,I=oh(d,["data"]);return Lu(function(){c.inited?c.setData(g,I):c.source(g,I),I.autoFit&&c.fitBounds(I&&I.fitBoundsOptions)},[g,JSON.stringify(I)]),null}),lf=pe.useEffect,zf=pe.memo(function(y){var c=y.layer,d=y.style;return lf(function(){c.style(d)},Object.keys(d).map(function(g){return d[g]})),null});function Eh(w,y){return uh(w)||Uf(w,y)||_f(w,y)||sh()}function sh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _f(w,y){if(!w)return;if(typeof w=="string")return Ff(w,y);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ff(w,y)}function Ff(w,y){(y==null||y>w.length)&&(y=w.length);for(var c=0,d=new Array(y);c<y;c++)d[c]=w[c];return d}function Uf(w,y){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,g=!1,I=void 0;try{for(var ee=w[Symbol.iterator](),B;!(d=(B=ee.next()).done)&&!(c.push(B.value),y&&c.length===y);d=!0);}catch(k){g=!0,I=k}finally{try{!d&&ee.return!=null&&ee.return()}finally{if(g)throw I}}return c}function uh(w){if(Array.isArray(w))return w}var Bf=pe.useEffect,Of=pe.useState;function Zl(w,y){var c=y.source,d=y.color,g=y.shape,I=y.style,ee=y.size,B=y.scale,k=y.active,Q=y.select,We=y.filter,tt=y.animate,Pe=y.options,Je=y.onLayerLoaded,_t=et(),ke=Of(),pt=Eh(ke,2),De=pt[0],Zt=pt[1];if(!De){var Kt;switch(w){case"polygonLayer":Kt=new kt.PolygonLayer(Pe);break;case"lineLayer":Kt=new kt.LineLayer(Pe);break;case"pointLayer":Kt=new kt.PointLayer(Pe);break;case"heatmapLayer":Kt=new kt.HeatmapLayer(Pe);break;case"rasterLayer":Kt=new kt.RasterLayer(Pe);break;case"imageLayer":Kt=new kt.ImageLayer(Pe);break;case"citybuildingLayer":Kt=new kt.CityBuildingLayer(Pe);break;default:Kt=new kt.PolygonLayer(Pe)}Kt.on("inited",function(){Je&&Je(Kt,_t)}),Zt(Kt)}return Bf(function(){if(De!==void 0)return _t.addLayer(De),function(){_t.removeLayer(De)}},[]),Bf(function(){De&&_t.render()}),Bf(function(){De&&De.inited&&Pe&&De.updateLayerConfig(Pe)},[Pe==null?void 0:Pe.minZoom,Pe==null?void 0:Pe.maxZoom,Pe==null?void 0:Pe.visible]),Bf(function(){De&&De.inited&&Pe&&Pe.zIndex&&De.setIndex(Pe.zIndex)},[Pe==null?void 0:Pe.zIndex]),Bf(function(){De&&De.inited&&Pe&&Pe.blend&&De.setBlend(Pe.blend)},[Pe==null?void 0:Pe.blend]),De!=null?pe.createElement(ti.Provider,{value:De},pe.createElement(jf,{layer:De,source:c}),B&&pe.createElement(iu,{layer:De,scale:B}),d&&pe.createElement(Zi,{layer:De,color:d}),ee&&pe.createElement(Nf,{layer:De,size:ee}),g&&pe.createElement(wo,{layer:De,shape:g}),I&&pe.createElement(zf,{layer:De,style:I}),k&&pe.createElement(Qa,{layer:De,active:k}),Q&&pe.createElement(ki,{layer:De,select:Q}),We&&pe.createElement(qa,{layer:De,filter:We}),tt&&pe.createElement(Co,{layer:De,animate:tt}),y.children):null}var Ih=pe.memo(function(y){return Zl("polygonLayer",y)}),ye=pe.memo(function(y){return Zl("lineLayer",y)}),je=pe.memo(function(y){return Zl("pointLayer",y)}),Mt=pe.memo(function(y){return Zl("heatmapLayer",y)}),Er=pe.memo(function(y){return Zl("rasterLayer",y)}),Lr=pe.memo(function(y){return Zl("imageLayer",y)}),wr=pe.memo(function(y){return Zl("citybuildingLayer",y)}),_r=pe.useEffect,Wr=pe.memo(function(w){var y=w.type,c=w.handler,d=ja();return _r(function(){return d.off(y,c),d.on(y,c),function(){d.off(y,c)}},[y,c]),null}),un=pe.memo(function(w){var y=w.className,c=w.style,d=w.title,g=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return pe.createElement("div",null,pe.createElement("div",null,g.map(function(I,ee){return pe.createElement("div",{key:ee.toString(),style:{background:I.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-g.length)/g.length+"%",marginRight:"1%",padding:5}})})),pe.createElement("div",null,g.map(function(I,ee){return pe.createElement("div",{key:ee.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-g.length)/g.length+"%",marginRight:"1%"}},I.title)})))});function Jr(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jr=function(c){return typeof c}:Jr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Jr(w)}function Qr(w,y){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);y&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(w,g).enumerable})),c.push.apply(c,d)}return c}function ln(w){for(var y=1;y<arguments.length;y++){var c=arguments[y]!=null?arguments[y]:{};y%2?Qr(Object(c),!0).forEach(function(d){Sn(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Qr(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Sn(w,y,c){return y in w?Object.defineProperty(w,y,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[y]=c,w}function pn(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function nn(w,y){for(var c=0;c<y.length;c++){var d=y[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function Tr(w,y,c){return y&&nn(w.prototype,y),c&&nn(w,c),w}function xr(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),y&&Xr(w,y)}function Xr(w,y){return Xr=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},Xr(w,y)}function On(w){var y=qr();return function(){var d=Fr(w),g;if(y){var I=Fr(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return Ir(this,g)}}function Ir(w,y){return y&&(Jr(y)==="object"||typeof y=="function")?y:ta(w)}function ta(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function qr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function Fr(w){return Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Fr(w)}var Vr=function(w){xr(c,w);var y=On(c);function c(d){var g;return pn(this,c),g=y.call(this,d),g.el=document.createElement("div"),g}return Tr(c,[{key:"componentDidMount",value:function(){var g=this.props,I=g.lnglat,ee=g.children,B=g.option,k=new kt.Popup(ln(ln({},B),{},{stopPropagation:!1}));I&&k.setLnglat(I),ee&&k.setDOMContent(this.el),this.popup=k,this.scene.addPopup(k)}},{key:"componentDidUpdate",value:function(g){var I,ee,B,k,Q,We,tt=Array.isArray(g.lnglat)?g.lnglat:[g==null||((I=g.lnglat)===null||I===void 0)?void 0:I.lng,g==null||((ee=g.lnglat)===null||ee===void 0)?void 0:ee.lat],Pe=Array.isArray(this.props.lnglat)?this.props.lnglat:[(B=this.props)===null||B===void 0||((k=B.lnglat)===null||k===void 0)?void 0:k.lng,(Q=this.props)===null||Q===void 0||((We=Q.lnglat)===null||We===void 0)?void 0:We.lat],Je=tt.toString()!==Pe.toString();Je&&(this.popup.remove(),this.popup=new kt.Popup(ln(ln({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var g=this;return pe.createElement(ae.Consumer,{},function(I){return I&&(g.scene=I),Object(sn.createPortal)(g.props.children,g.el)})}}]),c}(pe.PureComponent);function Kr(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kr=function(c){return typeof c}:Kr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Kr(w)}function Xn(w,y){if(!(w instanceof y))throw new TypeError("Cannot call a class as a function")}function na(w,y){for(var c=0;c<y.length;c++){var d=y[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function cn(w,y,c){return y&&na(w.prototype,y),c&&na(w,c),w}function Hr(w,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(y&&y.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),y&&jr(w,y)}function jr(w,y){return jr=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},jr(w,y)}function ma(w){var y=Ua();return function(){var d=_a(w),g;if(y){var I=_a(this).constructor;g=Reflect.construct(d,arguments,I)}else g=d.apply(this,arguments);return pa(this,g)}}function pa(w,y){return y&&(Kr(y)==="object"||typeof y=="function")?y:Un(w)}function Un(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function Ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function _a(w){return _a=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},_a(w)}var Ba=function(w){Hr(c,w);var y=ma(c);function c(d){var g;return Xn(this,c),g=y.call(this,d),g.el=document.createElement("div"),g}return cn(c,[{key:"componentDidMount",value:function(){var g=this.props,I=g.lnglat,ee=g.children,B=g.option,k=g.onMarkerLoaded,Q=new kt.Marker(B);I&&Q.setLnglat(I),ee&&Q.setElement(this.el),this.marker=Q,k&&k(Q),this.scene.addMarker(Q)}},{key:"componentDidUpdate",value:function(g){var I,ee=(g==null?void 0:g.lnglat.toString())!==((I=this.props)===null||I===void 0?void 0:I.lnglat.toString());ee&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var g=this;return pe.createElement(ae.Consumer,{},function(I){return I&&(g.scene=I),Object(sn.createPortal)(g.props.children,g.el)})}}]),c}(pe.PureComponent),hi=pe.useEffect,zo=pe.memo(function(w){var y=w.type,c=w.handler,d=et();return hi(function(){return d.on(y,c),function(){d.off(y,c)}},[y]),null}),Os=zo,ei=pe.useEffect,bo=pe.memo(function(y){var c=y.name,d=y.url,g=et();return ei(function(){g.addImage(c,d)},[c,d]),null}),Ci=o("+o6o"),vs=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Fo=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){var d;Object(D.a)(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.state={data:null,grid:null,loading:!1},d}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var d=Object(Qe.a)($.a.mark(function I(){var ee,B,k,Q;return $.a.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:return tt.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Pe){return Pe.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Pe){return Pe.json()})]);case 2:ee=tt.sent,B=Object(C.a)(ee,2),k=B[0],Q=B[1],this.setState({data:k,grid:Q,loading:!0});case 7:case"end":return tt.stop()}},I,this)}));function g(){return d.apply(this,arguments)}return g}()},{key:"render",value:function(){var g=this.state,I=g.data,ee=g.grid,B=g.loading;return B===!1?pe.createElement(Ci.a,null):pe.createElement(Rl,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},ee&&pe.createElement(Mt,{key:"1",source:{data:ee,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),I&&[pe.createElement(je,{key:"2",options:{autoFit:!0},source:{data:I},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:vs},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),pe.createElement(je,{key:"5",source:{data:I},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(Q){return Q>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),c}(pe.Component),gs={Pie:vt,WaterWave:ot,Gauge:Wt,MiniArea:J,TagCloud:Ge,Map:Fo},Uo=o("TAnc"),Bo={activeChart:"activeChart___15gpK",activeChartGrid:"activeChartGrid___3PL4c",activeChartLegend:"activeChartLegend___2Ieyc",dashedLine:"dashedLine___2fgZX",line:"line___2cxqk"};function Vo(w){return w*1<10?"0".concat(w):w}function aa(){for(var w=[],y=0;y<24;y+=1)w.push({x:"".concat(Vo(y),":00"),y:Math.floor(Math.random()*200)+y*50});return w}var ou=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){var d;Object(D.a)(this,c);for(var g=arguments.length,I=new Array(g),ee=0;ee<g;ee++)I[ee]=arguments[ee];return d=y.call.apply(y,[this].concat(I)),d.state={activeData:aa()},d.timer=void 0,d.requestRef=void 0,d.loopData=function(){d.requestRef=requestAnimationFrame(function(){d.timer=window.setTimeout(function(){d.setState({activeData:aa()},function(){d.loopData()})},1e3)})},d}return Object(K.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var g=this.state.activeData,I=g===void 0?[]:g;return Ce.a.createElement("div",{className:Bo.activeChart},Ce.a.createElement(He.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Ce.a.createElement("div",{style:{marginTop:32}},Ce.a.createElement(J,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:I})),I&&Ce.a.createElement("div",null,Ce.a.createElement("div",{className:Bo.activeChartGrid},Ce.a.createElement("p",null,Object(Uo.a)(I).sort()[I.length-1].y+200," \u4EBF\u5143"),Ce.a.createElement("p",null,Object(Uo.a)(I).sort()[Math.floor(I.length/2)].y," \u4EBF\u5143")),Ce.a.createElement("div",{className:Bo.dashedLine},Ce.a.createElement("div",{className:Bo.line})),Ce.a.createElement("div",{className:Bo.dashedLine},Ce.a.createElement("div",{className:Bo.line}))),I&&Ce.a.createElement("div",{className:Bo.activeChartLegend},Ce.a.createElement("span",null,"00:00"),Ce.a.createElement("span",null,I[Math.floor(I.length/2)].x),Ce.a.createElement("span",null,I[I.length-1].x)))}}]),c}(pe.Component),yi={mapChart:"mapChart___4fQJB",pieCard:"pieCard___1ETZj"},An=He.a.Countdown,Ra=Date.now()+1e3*60*60*24*2+1e3*30,Va=function(w){Object(re.a)(c,w);var y=Object(fe.a)(c);function c(){return Object(D.a)(this,c),y.apply(this,arguments)}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var g=this.props.dispatch;g({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var g=this.props,I=g.dashboardAndmonitor,ee=g.loading,B=I.tags;return Ce.a.createElement(mt.a,null,Ce.a.createElement(Ce.a.Fragment,null,Ce.a.createElement(z.a,{gutter:24},Ce.a.createElement(Z.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},Ce.a.createElement(z.a,null,Ce.a.createElement(Z.a,{md:6,sm:12,xs:24},Ce.a.createElement(He.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:At()(124543233).format("0,0")})),Ce.a.createElement(Z.a,{md:6,sm:12,xs:24},Ce.a.createElement(He.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),Ce.a.createElement(Z.a,{md:6,sm:12,xs:24},Ce.a.createElement(An,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Ra,format:"HH:mm:ss:SSS"})),Ce.a.createElement(Z.a,{md:6,sm:12,xs:24},Ce.a.createElement(He.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:At()(234).format("0,0")}))),Ce.a.createElement("div",{className:yi.mapChart},Ce.a.createElement(Fo,null)))),Ce.a.createElement(Z.a,{xl:6,lg:24,md:24,sm:24,xs:24},Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},Ce.a.createElement(ou,null)),Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},Ce.a.createElement(Wt,{title:Object(Xe.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),Ce.a.createElement(z.a,{gutter:24},Ce.a.createElement(Z.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:yi.pieCard},Ce.a.createElement(z.a,{style:{padding:"16px 0"}},Ce.a.createElement(Z.a,{span:8},Ce.a.createElement(vt,{animate:!1,percent:28,title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),Ce.a.createElement(Z.a,{span:8},Ce.a.createElement(vt,{animate:!1,color:"#5DDECF",percent:22,title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),Ce.a.createElement(Z.a,{span:8},Ce.a.createElement(vt,{animate:!1,color:"#2FC25B",percent:32,title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),Ce.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:ee,bordered:!1,bodyStyle:{overflow:"hidden"}},Ce.a.createElement(Ge,{data:B||[],height:161}))),Ce.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(p.a,{title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},Ce.a.createElement(ot,{height:161,title:Ce.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),c}(pe.Component),rs=_.default=Object(Xe.c)(function(w){var y=w.dashboardAndmonitor,c=w.loading;return{dashboardAndmonitor:y,loading:c.models.dashboardAndmonitor}})(Va)},"36Cu":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("7s3S"),p=o("QbGg"),Y=function(){function z(i,Z){this.id=p.id(),this.activated=!1,this.serviceIdentifier=i,this.scope=Z,this.type=x.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return z.prototype.clone=function(){var i=new z(this.serviceIdentifier,this.scope);return i.activated=!1,i.implementationType=this.implementationType,i.dynamicValue=this.dynamicValue,i.scope=this.scope,i.type=this.type,i.factory=this.factory,i.provider=this.provider,i.constraint=this.constraint,i.onActivation=this.onActivation,i.cache=this.cache,i},z}();_.Binding=Y},"3GKU":function(Fe,_){Fe.exports=function(x){return x&&typeof x=="object"&&typeof x.copy=="function"&&typeof x.fill=="function"&&typeof x.readUInt8=="function"}},"3Jho":function(Fe,_,o){var x=o("jBg4"),p=x?x.prototype:void 0,Y=p?p.valueOf:void 0;function z(i){return Y?Object(Y.call(i)):{}}Fe.exports=z},"3XrA":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0}),_.earthRadius=63710088e-1,_.factors={centimeters:_.earthRadius*100,centimetres:_.earthRadius*100,degrees:_.earthRadius/111325,feet:_.earthRadius*3.28084,inches:_.earthRadius*39.37,kilometers:_.earthRadius/1e3,kilometres:_.earthRadius/1e3,meters:_.earthRadius,metres:_.earthRadius,miles:_.earthRadius/1609.344,millimeters:_.earthRadius*1e3,millimetres:_.earthRadius*1e3,nauticalmiles:_.earthRadius/1852,radians:1,yards:_.earthRadius/1.0936},_.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/_.earthRadius,yards:1/1.0936},_.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function x(J,H,Se){Se===void 0&&(Se={});var be={type:"Feature"};return(Se.id===0||Se.id)&&(be.id=Se.id),Se.bbox&&(be.bbox=Se.bbox),be.properties=H||{},be.geometry=J,be}_.feature=x;function p(J,H,Se){Se===void 0&&(Se={});switch(J){case"Point":return Y(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return i(H).geometry;case"MultiPoint":return X(H).geometry;case"MultiLineString":return fe(H).geometry;case"MultiPolygon":return He(H).geometry;default:throw new Error(J+" is invalid")}}_.geometry=p;function Y(J,H,Se){Se===void 0&&(Se={});var be={type:"Point",coordinates:J};return x(be,H,Se)}_.point=Y;function z(J,H,Se){return Se===void 0&&(Se={}),re(J.map(function(be){return Y(be,H)}),Se)}_.points=z;function i(J,H,Se){Se===void 0&&(Se={});for(var be=0,_e=J;be<_e.length;be++){var me=_e[be];if(me.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var it=0;it<me[me.length-1].length;it++)if(me[me.length-1][it]!==me[0][it])throw new Error("First and last Position are not equivalent.")}var qt={type:"Polygon",coordinates:J};return x(qt,H,Se)}_.polygon=i;function Z(J,H,Se){return Se===void 0&&(Se={}),re(J.map(function(be){return i(be,H)}),Se)}_.polygons=Z;function D(J,H,Se){if(Se===void 0&&(Se={}),J.length<2)throw new Error("coordinates must be an array of two or more positions");var be={type:"LineString",coordinates:J};return x(be,H,Se)}_.lineString=D;function K(J,H,Se){return Se===void 0&&(Se={}),re(J.map(function(be){return D(be,H)}),Se)}_.lineStrings=K;function re(J,H){H===void 0&&(H={});var Se={type:"FeatureCollection"};return H.id&&(Se.id=H.id),H.bbox&&(Se.bbox=H.bbox),Se.features=J,Se}_.featureCollection=re;function fe(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiLineString",coordinates:J};return x(be,H,Se)}_.multiLineString=fe;function X(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiPoint",coordinates:J};return x(be,H,Se)}_.multiPoint=X;function He(J,H,Se){Se===void 0&&(Se={});var be={type:"MultiPolygon",coordinates:J};return x(be,H,Se)}_.multiPolygon=He;function Xe(J,H,Se){Se===void 0&&(Se={});var be={type:"GeometryCollection",geometries:J};return x(be,H,Se)}_.geometryCollection=Xe;function pe(J,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Se=Math.pow(10,H||0);return Math.round(J*Se)/Se}_.round=pe;function Ce(J,H){H===void 0&&(H="kilometers");var Se=_.factors[H];if(!Se)throw new Error(H+" units is invalid");return J*Se}_.radiansToLength=Ce;function mt(J,H){H===void 0&&(H="kilometers");var Se=_.factors[H];if(!Se)throw new Error(H+" units is invalid");return J/Se}_.lengthToRadians=mt;function Ne(J,H){return Ye(mt(J,H))}_.lengthToDegrees=Ne;function At(J){var H=J%360;return H<0&&(H+=360),H}_.bearingToAzimuth=At;function Ye(J){var H=J%(2*Math.PI);return H*180/Math.PI}_.radiansToDegrees=Ye;function Et(J){var H=J%360;return H*Math.PI/180}_.degreesToRadians=Et;function nt(J,H,Se){if(H===void 0&&(H="kilometers"),Se===void 0&&(Se="kilometers"),!(J>=0))throw new Error("length must be a positive number");return Ce(mt(J,H),Se)}_.convertLength=nt;function Ct(J,H,Se){if(H===void 0&&(H="meters"),Se===void 0&&(Se="kilometers"),!(J>=0))throw new Error("area must be a positive number");var be=_.areaFactors[H];if(!be)throw new Error("invalid original units");var _e=_.areaFactors[Se];if(!_e)throw new Error("invalid final units");return J/be*_e}_.convertArea=Ct;function Ot(J){return!isNaN(J)&&J!==null&&!Array.isArray(J)&&!/^\s*$/.test(J)}_.isNumber=Ot;function Re(J){return!!J&&J.constructor===Object}_.isObject=Re;function Ie(J){if(!J)throw new Error("bbox is required");if(!Array.isArray(J))throw new Error("bbox must be an Array");if(J.length!==4&&J.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");J.forEach(function(H){if(!Ot(H))throw new Error("bbox must only contain numbers")})}_.validateBBox=Ie;function Be(J){if(!J)throw new Error("id is required");if(["string","number"].indexOf(typeof J)===-1)throw new Error("id must be a number or a string")}_.validateId=Be;function ft(){throw new Error("method has been renamed to `radiansToDegrees`")}_.radians2degrees=ft;function Me(){throw new Error("method has been renamed to `degreesToRadians`")}_.degrees2radians=Me;function ht(){throw new Error("method has been renamed to `lengthToDegrees`")}_.distanceToDegrees=ht;function Wt(){throw new Error("method has been renamed to `lengthToRadians`")}_.distanceToRadians=Wt;function Qt(){throw new Error("method has been renamed to `radiansToLength`")}_.radiansToDistance=Qt;function ur(){throw new Error("method has been renamed to `bearingToAzimuth`")}_.bearingToAngle=ur;function oe(){throw new Error("method has been renamed to `convertLength`")}_.convertDistance=oe},"3qw5":function(Fe,_){},"4bLW":function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x;(function(p){p.Hover="hover",p.Click="click",p.Select="select",p.Active="active",p.Drag="drag"})(x||(x={}))},"4eip":function(Fe,_,o){"use strict";(function(x){var p=o("dZOt");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Y(Me,ht){if(Me===ht)return 0;for(var Wt=Me.length,Qt=ht.length,ur=0,oe=Math.min(Wt,Qt);ur<oe;++ur)if(Me[ur]!==ht[ur]){Wt=Me[ur],Qt=ht[ur];break}return Wt<Qt?-1:Qt<Wt?1:0}function z(Me){return x.Buffer&&typeof x.Buffer.isBuffer=="function"?x.Buffer.isBuffer(Me):!!(Me!=null&&Me._isBuffer)}var i=o("SaUU"),Z=Object.prototype.hasOwnProperty,D=Array.prototype.slice,K=function(){return function(){}.name==="foo"}();function re(Me){return Object.prototype.toString.call(Me)}function fe(Me){return z(Me)||typeof x.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Me):Me?Me instanceof DataView?!0:!!(Me.buffer&&Me.buffer instanceof ArrayBuffer):!1}var X=Fe.exports=At,He=/\s*function\s+([^\(\s]*)\s*/;function Xe(Me){if(!i.isFunction(Me))return;if(K)return Me.name;var ht=Me.toString(),Wt=ht.match(He);return Wt&&Wt[1]}X.AssertionError=function(ht){this.name="AssertionError",this.actual=ht.actual,this.expected=ht.expected,this.operator=ht.operator,ht.message?(this.message=ht.message,this.generatedMessage=!1):(this.message=mt(this),this.generatedMessage=!0);var Wt=ht.stackStartFunction||Ne;if(Error.captureStackTrace)Error.captureStackTrace(this,Wt);else{var Qt=new Error;if(Qt.stack){var ur=Qt.stack,oe=Xe(Wt),J=ur.indexOf(`
`+oe);if(J>=0){var H=ur.indexOf(`
`,J+1);ur=ur.substring(H+1)}this.stack=ur}}},i.inherits(X.AssertionError,Error);function pe(Me,ht){return typeof Me=="string"?Me.length<ht?Me:Me.slice(0,ht):Me}function Ce(Me){if(K||!i.isFunction(Me))return i.inspect(Me);var ht=Xe(Me),Wt=ht?": "+ht:"";return"[Function"+Wt+"]"}function mt(Me){return pe(Ce(Me.actual),128)+" "+Me.operator+" "+pe(Ce(Me.expected),128)}function Ne(Me,ht,Wt,Qt,ur){throw new X.AssertionError({message:Wt,actual:Me,expected:ht,operator:Qt,stackStartFunction:ur})}X.fail=Ne;function At(Me,ht){Me||Ne(Me,!0,ht,"==",X.ok)}X.ok=At,X.equal=function(ht,Wt,Qt){ht!=Wt&&Ne(ht,Wt,Qt,"==",X.equal)},X.notEqual=function(ht,Wt,Qt){ht==Wt&&Ne(ht,Wt,Qt,"!=",X.notEqual)},X.deepEqual=function(ht,Wt,Qt){Ye(ht,Wt,!1)||Ne(ht,Wt,Qt,"deepEqual",X.deepEqual)},X.deepStrictEqual=function(ht,Wt,Qt){Ye(ht,Wt,!0)||Ne(ht,Wt,Qt,"deepStrictEqual",X.deepStrictEqual)};function Ye(Me,ht,Wt,Qt){if(Me===ht)return!0;if(z(Me)&&z(ht))return Y(Me,ht)===0;if(i.isDate(Me)&&i.isDate(ht))return Me.getTime()===ht.getTime();if(i.isRegExp(Me)&&i.isRegExp(ht))return Me.source===ht.source&&Me.global===ht.global&&Me.multiline===ht.multiline&&Me.lastIndex===ht.lastIndex&&Me.ignoreCase===ht.ignoreCase;if((Me===null||typeof Me!="object")&&(ht===null||typeof ht!="object"))return Wt?Me===ht:Me==ht;if(fe(Me)&&fe(ht)&&re(Me)===re(ht)&&!(Me instanceof Float32Array||Me instanceof Float64Array))return Y(new Uint8Array(Me.buffer),new Uint8Array(ht.buffer))===0;if(z(Me)!==z(ht))return!1;Qt=Qt||{actual:[],expected:[]};var ur=Qt.actual.indexOf(Me);return ur!==-1&&ur===Qt.expected.indexOf(ht)?!0:(Qt.actual.push(Me),Qt.expected.push(ht),nt(Me,ht,Wt,Qt))}function Et(Me){return Object.prototype.toString.call(Me)=="[object Arguments]"}function nt(Me,ht,Wt,Qt){if(Me==null||ht===null||ht===void 0)return!1;if(i.isPrimitive(Me)||i.isPrimitive(ht))return Me===ht;if(Wt&&Object.getPrototypeOf(Me)!==Object.getPrototypeOf(ht))return!1;var ur=Et(Me),oe=Et(ht);if(ur&&!oe||!ur&&oe)return!1;if(ur)return Me=D.call(Me),ht=D.call(ht),Ye(Me,ht,Wt);var J=ft(Me),H=ft(ht),Se,be;if(J.length!==H.length)return!1;for(J.sort(),H.sort(),be=J.length-1;be>=0;be--)if(J[be]!==H[be])return!1;for(be=J.length-1;be>=0;be--)if(Se=J[be],!Ye(Me[Se],ht[Se],Wt,Qt))return!1;return!0}X.notDeepEqual=function(ht,Wt,Qt){Ye(ht,Wt,!1)&&Ne(ht,Wt,Qt,"notDeepEqual",X.notDeepEqual)},X.notDeepStrictEqual=Ct;function Ct(Me,ht,Wt){Ye(Me,ht,!0)&&Ne(Me,ht,Wt,"notDeepStrictEqual",Ct)}X.strictEqual=function(ht,Wt,Qt){ht!==Wt&&Ne(ht,Wt,Qt,"===",X.strictEqual)},X.notStrictEqual=function(ht,Wt,Qt){ht===Wt&&Ne(ht,Wt,Qt,"!==",X.notStrictEqual)};function Ot(Me,ht){if(!Me||!ht)return!1;if(Object.prototype.toString.call(ht)=="[object RegExp]")return ht.test(Me);try{if(Me instanceof ht)return!0}catch(Wt){}return Error.isPrototypeOf(ht)?!1:ht.call({},Me)===!0}function Re(Me){var ht;try{Me()}catch(Wt){ht=Wt}return ht}function Ie(Me,ht,Wt,Qt){var ur;if(typeof ht!="function")throw new TypeError('"block" argument must be a function');typeof Wt=="string"&&(Qt=Wt,Wt=null),ur=Re(ht),Qt=(Wt&&Wt.name?" ("+Wt.name+").":".")+(Qt?" "+Qt:"."),Me&&!ur&&Ne(ur,Wt,"Missing expected exception"+Qt);var oe=typeof Qt=="string",J=!Me&&i.isError(ur),H=!Me&&ur&&!Wt;if((J&&oe&&Ot(ur,Wt)||H)&&Ne(ur,Wt,"Got unwanted exception"+Qt),Me&&ur&&Wt&&!Ot(ur,Wt)||!Me&&ur)throw ur}X.throws=function(Me,ht,Wt){Ie(!0,Me,ht,Wt)},X.doesNotThrow=function(Me,ht,Wt){Ie(!1,Me,ht,Wt)},X.ifError=function(Me){if(Me)throw Me};function Be(Me,ht){Me||Ne(Me,!0,ht,"==",Be)}X.strict=p(Be,X,{equal:X.strictEqual,deepEqual:X.deepStrictEqual,notEqual:X.notStrictEqual,notDeepEqual:X.notDeepStrictEqual}),X.strict.strict=X.strict;var ft=Object.keys||function(Me){var ht=[];for(var Wt in Me)Z.call(Me,Wt)&&ht.push(Wt);return ht}}).call(this,o("UywP"))},"4wWY":function(Fe,_,o){"use strict";(function(x){o.d(_,"a",function(){return z});var p=o("PoO7"),Y=o("pg6l");function z(){var Z=(typeof x=="undefined"?"undefined":Object(p.a)(x))==="object"&&String(x)==="[object process]"&&!x.browser;return!Z||Object(Y.a)()}function i(){return z()&&typeof document!="undefined"}}).call(this,o("7vYp"))},"5+VK":function(Fe,_,o){var x=o("cOPB"),p=1,Y=4;function z(i){return x(i,p|Y)}Fe.exports=z},"5MNg":function(Fe,_){function o(x){return x==null}Fe.exports=o},"5NJe":function(Fe,_){function o(x){return function(p){return p==null?void 0:p[x]}}Fe.exports=o},"5RAj":function(Fe,_,o){var x=o("mCIU"),p=o("PPmI"),Y=o("SSN4"),z="[object Object]",i=Function.prototype,Z=Object.prototype,D=i.toString,K=Z.hasOwnProperty,re=D.call(Object);function fe(X){if(!Y(X)||x(X)!=z)return!1;var He=p(X);if(He===null)return!0;var Xe=K.call(He,"constructor")&&He.constructor;return typeof Xe=="function"&&Xe instanceof Xe&&D.call(Xe)==re}Fe.exports=fe},"5d8b":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("CD4/"),p=o("9R00"),Y=o("D6nA"),z=function(){function i(Z){this._binding=Z,this._bindingWhenSyntax=new Y.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new p.BindingOnSyntax(this._binding),this._bindingInSyntax=new x.BindingInSyntax(Z)}return i.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},i.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},i.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},i.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},i.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},i.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},i.prototype.whenTargetTagged=function(Z,D){return this._bindingWhenSyntax.whenTargetTagged(Z,D)},i.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},i.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},i.prototype.whenParentTagged=function(Z,D){return this._bindingWhenSyntax.whenParentTagged(Z,D)},i.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},i.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},i.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},i.prototype.whenAnyAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,D)},i.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},i.prototype.whenNoAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,D)},i.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},i.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},i.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},i}();_.BindingInWhenOnSyntax=z},"5oCn":function(Fe,_,o){"use strict";var x=o("xwgP"),p=o.n(x),Y=Object(x.createContext)({});_.a=Y},"5uMz":function(Fe,_){function o(x,p,Y,z){for(var i=x.length,Z=Y+(z?1:-1);z?Z--:++Z<i;)if(p(x[Z],Z,x))return Z;return-1}Fe.exports=o},"66qL":function(Fe,_,o){var x=o("v6Pd"),p=x();Fe.exports=p},"6AiZ":function(Fe,_,o){"use strict";o.d(_,"a",function(){return Z});var x=o("LhPA");function p(He,Xe){var pe;if(typeof Symbol=="undefined"||He[Symbol.iterator]==null){if(Array.isArray(He)||(pe=Y(He))||Xe&&He&&typeof He.length=="number"){pe&&(He=pe);var Ce=0,mt=function(){};return{s:mt,n:function(){return Ce>=He.length?{done:!0}:{done:!1,value:He[Ce++]}},e:function(nt){throw nt},f:mt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ne=!0,At=!1,Ye;return{s:function(){pe=He[Symbol.iterator]()},n:function(){var nt=pe.next();return Ne=nt.done,nt},e:function(nt){At=!0,Ye=nt},f:function(){try{!Ne&&pe.return!=null&&pe.return()}finally{if(At)throw Ye}}}}function Y(He,Xe){if(!He)return;if(typeof He=="string")return z(He,Xe);var pe=Object.prototype.toString.call(He).slice(8,-1);if(pe==="Object"&&He.constructor&&(pe=He.constructor.name),pe==="Map"||pe==="Set")return Array.from(He);if(pe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pe))return z(He,Xe)}function z(He,Xe){(Xe==null||Xe>He.length)&&(Xe=He.length);for(var pe=0,Ce=new Array(Xe);pe<Xe;pe++)Ce[pe]=He[pe];return Ce}var i=6378e3;function Z(He,Xe){var pe=He.dataArray,Ce=Xe.size,mt=Ce===void 0?10:Ce,Ne=mt/(2*Math.PI*i)*(256<<20)/2,At=D(pe,mt),Ye=At.gridHash,Et=At.gridOffset,nt=X(Ye,Et,Xe);return{yOffset:Ne,xOffset:Ne,radius:Ne,type:"grid",dataArray:nt}}function D(He,Xe){var pe=Infinity,Ce=-Infinity,mt,Ne=p(He),At;try{for(Ne.s();!(At=Ne.n()).done;){var Ye=At.value;mt=Ye.coordinates[1],Number.isFinite(mt)&&(pe=mt<pe?mt:pe,Ce=mt>Ce?mt:Ce)}}catch(Qt){Ne.e(Qt)}finally{Ne.f()}var Et=(pe+Ce)/2,nt=K(Xe,Et);if(nt.xOffset<=0||nt.yOffset<=0)return{gridHash:{},gridOffset:nt};var Ct={},Ot=p(He),Re;try{for(Ot.s();!(Re=Ot.n()).done;){var Ie=Re.value,Be=Ie.coordinates[1],ft=Ie.coordinates[0];if(Number.isFinite(Be)&&Number.isFinite(ft)){var Me=Math.floor((Be+90)/nt.yOffset),ht=Math.floor((ft+180)/nt.xOffset),Wt="".concat(Me,"-").concat(ht);Ct[Wt]=Ct[Wt]||{count:0,points:[]},Ct[Wt].count+=1,Ct[Wt].points.push(Ie)}}}catch(Qt){Ot.e(Qt)}finally{Ot.f()}return{gridHash:Ct,gridOffset:nt}}function K(He,Xe){var pe=re(He),Ce=fe(Xe,He);return{yOffset:pe,xOffset:Ce}}function re(He){return He/i*(180/Math.PI)}function fe(He,Xe){return Xe/i*(180/Math.PI)/Math.cos(He*Math.PI/180)}function X(He,Xe,pe){return Object.keys(He).reduce(function(Ce,mt,Ne){var At=mt.split("-"),Ye=parseInt(At[0],10),Et=parseInt(At[1],10),nt={};if(pe.field&&pe.method){var Ct=x.c.getColumn(He[mt].points,pe.field);nt[pe.method]=x.c.statMap[pe.method](Ct)}return Object.assign(nt,{_id:Ne,coordinates:Object(x.d)([-180+Xe.xOffset*(Et+.5),-90+Xe.yOffset*(Ye+.5)]),rawData:He[mt].points,count:He[mt].count}),Ce.push(nt),Ce},[])}},"6Q7i":function(Fe,_,o){var x=o("wEuU");function p(Y){var z=x(Y),i=z%1;return z===z?i?z-i:z:0}Fe.exports=p},"6gzr":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=o("Vkc/");function z(i){return function(Z,D,K){var re=new p.Metadata(x.MULTI_INJECT_TAG,i);typeof K=="number"?Y.tagParameter(Z,D,K,re):Y.tagProperty(Z,D,re)}}_.multiInject=z},"7S95":function(Fe,_,o){var x=o("HtJV"),p=o("SSN4"),Y="[object Set]";function z(i){return p(i)&&x(i)==Y}Fe.exports=z},"7otc":function(Fe,_){var o=Array.isArray;Fe.exports=o},"7s3S":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x={Request:"Request",Singleton:"Singleton",Transient:"Transient"};_.BindingScopeEnum=x;var p={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};_.BindingTypeEnum=p;var Y={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};_.TargetTypeEnum=Y},"7vCJ":function(Fe,_,o){"use strict";var x=this&&this.__awaiter||function(mt,Ne,At,Ye){return new(At||(At=Promise))(function(Et,nt){function Ct(Ie){try{Re(Ye.next(Ie))}catch(Be){nt(Be)}}function Ot(Ie){try{Re(Ye.throw(Ie))}catch(Be){nt(Be)}}function Re(Ie){Ie.done?Et(Ie.value):new At(function(Be){Be(Ie.value)}).then(Ct,Ot)}Re((Ye=Ye.apply(mt,Ne||[])).next())})},p=this&&this.__generator||function(mt,Ne){var At={label:0,sent:function(){if(nt[0]&1)throw nt[1];return nt[1]},trys:[],ops:[]},Ye,Et,nt,Ct;return Ct={next:Ot(0),throw:Ot(1),return:Ot(2)},typeof Symbol=="function"&&(Ct[Symbol.iterator]=function(){return this}),Ct;function Ot(Ie){return function(Be){return Re([Ie,Be])}}function Re(Ie){if(Ye)throw new TypeError("Generator is already executing.");for(;At;)try{if(Ye=1,Et&&(nt=Et[Ie[0]&2?"return":Ie[0]?"throw":"next"])&&!(nt=nt.call(Et,Ie[1])).done)return nt;(Et=0,nt)&&(Ie=[0,nt.value]);switch(Ie[0]){case 0:case 1:nt=Ie;break;case 4:return At.label++,{value:Ie[1],done:!1};case 5:At.label++,Et=Ie[1],Ie=[0];continue;case 7:Ie=At.ops.pop(),At.trys.pop();continue;default:if(!(nt=At.trys,nt=nt.length>0&&nt[nt.length-1])&&(Ie[0]===6||Ie[0]===2)){At=0;continue}if(Ie[0]===3&&(!nt||Ie[1]>nt[0]&&Ie[1]<nt[3])){At.label=Ie[1];break}if(Ie[0]===6&&At.label<nt[1]){At.label=nt[1],nt=Ie;break}if(nt&&At.label<nt[2]){At.label=nt[2],At.ops.push(Ie);break}nt[2]&&At.ops.pop(),At.trys.pop();continue}Ie=Ne.call(mt,At)}catch(Be){Ie=[6,Be],Et=0}finally{Ye=nt=0}if(Ie[0]&5)throw Ie[1];return{value:Ie[0]?Ie[1]:void 0,done:!0}}};Object.defineProperty(_,"__esModule",{value:!0});var Y=o("36Cu"),z=o("0d2E"),i=o("7s3S"),Z=o("/jsB"),D=o("g0Ch"),K=o("nVKE"),re=o("xVag"),fe=o("XIPF"),X=o("QbGg"),He=o("QTk+"),Xe=o("RLa6"),pe=o("HPW9"),Ce=function(){function mt(Ne){var At=Ne||{};if(typeof At!="object")throw new Error(""+z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(At.defaultScope===void 0)At.defaultScope=i.BindingScopeEnum.Transient;else if(At.defaultScope!==i.BindingScopeEnum.Singleton&&At.defaultScope!==i.BindingScopeEnum.Transient&&At.defaultScope!==i.BindingScopeEnum.Request)throw new Error(""+z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(At.autoBindInjectable===void 0)At.autoBindInjectable=!1;else if(typeof At.autoBindInjectable!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(At.skipBaseClassChecks===void 0)At.skipBaseClassChecks=!1;else if(typeof At.skipBaseClassChecks!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:At.autoBindInjectable,defaultScope:At.defaultScope,skipBaseClassChecks:At.skipBaseClassChecks},this.id=X.id(),this._bindingDictionary=new pe.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return mt.merge=function(Ne,At){var Ye=new mt,Et=K.getBindingDictionary(Ye),nt=K.getBindingDictionary(Ne),Ct=K.getBindingDictionary(At);function Ot(Re,Ie){Re.traverse(function(Be,ft){ft.forEach(function(Me){Ie.add(Me.serviceIdentifier,Me.clone())})})}return Ot(nt,Et),Ot(Ct,Et),Ye},mt.prototype.load=function(){for(var Ne=[],At=0;At<arguments.length;At++)Ne[At]=arguments[At];for(var Ye=this._getContainerModuleHelpersFactory(),Et=0,nt=Ne;Et<nt.length;Et++){var Ct=nt[Et],Ot=Ye(Ct.id);Ct.registry(Ot.bindFunction,Ot.unbindFunction,Ot.isboundFunction,Ot.rebindFunction)}},mt.prototype.loadAsync=function(){for(var Ne=[],At=0;At<arguments.length;At++)Ne[At]=arguments[At];return x(this,void 0,void 0,function(){var Ye,Et,nt,Ct,Ot;return p(this,function(Re){switch(Re.label){case 0:Ye=this._getContainerModuleHelpersFactory(),Et=0,nt=Ne,Re.label=1;case 1:return Et<nt.length?(Ct=nt[Et],Ot=Ye(Ct.id),[4,Ct.registry(Ot.bindFunction,Ot.unbindFunction,Ot.isboundFunction,Ot.rebindFunction)]):[3,4];case 2:Re.sent(),Re.label=3;case 3:return Et++,[3,1];case 4:return[2]}})})},mt.prototype.unload=function(){for(var Ne=this,At=[],Ye=0;Ye<arguments.length;Ye++)At[Ye]=arguments[Ye];var Et=function(Ct){return function(Ot){return Ot.moduleId===Ct}};At.forEach(function(nt){var Ct=Et(nt.id);Ne._bindingDictionary.removeByCondition(Ct)})},mt.prototype.bind=function(Ne){var At=this.options.defaultScope||i.BindingScopeEnum.Transient,Ye=new Y.Binding(Ne,At);return this._bindingDictionary.add(Ne,Ye),new fe.BindingToSyntax(Ye)},mt.prototype.rebind=function(Ne){return this.unbind(Ne),this.bind(Ne)},mt.prototype.unbind=function(Ne){try{this._bindingDictionary.remove(Ne)}catch(At){throw new Error(z.CANNOT_UNBIND+" "+He.getServiceIdentifierAsString(Ne))}},mt.prototype.unbindAll=function(){this._bindingDictionary=new pe.Lookup},mt.prototype.isBound=function(Ne){var At=this._bindingDictionary.hasKey(Ne);return!At&&this.parent&&(At=this.parent.isBound(Ne)),At},mt.prototype.isBoundNamed=function(Ne,At){return this.isBoundTagged(Ne,Z.NAMED_TAG,At)},mt.prototype.isBoundTagged=function(Ne,At,Ye){var Et=!1;if(this._bindingDictionary.hasKey(Ne)){var nt=this._bindingDictionary.get(Ne),Ct=K.createMockRequest(this,Ne,At,Ye);Et=nt.some(function(Ot){return Ot.constraint(Ct)})}return!Et&&this.parent&&(Et=this.parent.isBoundTagged(Ne,At,Ye)),Et},mt.prototype.snapshot=function(){this._snapshots.push(Xe.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},mt.prototype.restore=function(){var Ne=this._snapshots.pop();if(Ne===void 0)throw new Error(z.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ne.bindings,this._middleware=Ne.middleware},mt.prototype.createChild=function(Ne){var At=new mt(Ne||this.options);return At.parent=this,At},mt.prototype.applyMiddleware=function(){for(var Ne=[],At=0;At<arguments.length;At++)Ne[At]=arguments[At];var Ye=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ne.reduce(function(Et,nt){return nt(Et)},Ye)},mt.prototype.applyCustomMetadataReader=function(Ne){this._metadataReader=Ne},mt.prototype.get=function(Ne){return this._get(!1,!1,i.TargetTypeEnum.Variable,Ne)},mt.prototype.getTagged=function(Ne,At,Ye){return this._get(!1,!1,i.TargetTypeEnum.Variable,Ne,At,Ye)},mt.prototype.getNamed=function(Ne,At){return this.getTagged(Ne,Z.NAMED_TAG,At)},mt.prototype.getAll=function(Ne){return this._get(!0,!0,i.TargetTypeEnum.Variable,Ne)},mt.prototype.getAllTagged=function(Ne,At,Ye){return this._get(!1,!0,i.TargetTypeEnum.Variable,Ne,At,Ye)},mt.prototype.getAllNamed=function(Ne,At){return this.getAllTagged(Ne,Z.NAMED_TAG,At)},mt.prototype.resolve=function(Ne){var At=this.createChild();return At.bind(Ne).toSelf(),At.get(Ne)},mt.prototype._getContainerModuleHelpersFactory=function(){var Ne=this,At=function(Re,Ie){Re._binding.moduleId=Ie},Ye=function(Re){return function(Ie){var Be=Ne.bind.bind(Ne),ft=Be(Ie);return At(ft,Re),ft}},Et=function(Re){return function(Ie){var Be=Ne.unbind.bind(Ne);Be(Ie)}},nt=function(Re){return function(Ie){var Be=Ne.isBound.bind(Ne);return Be(Ie)}},Ct=function(Re){return function(Ie){var Be=Ne.rebind.bind(Ne),ft=Be(Ie);return At(ft,Re),ft}};return function(Ot){return{bindFunction:Ye(Ot),isboundFunction:nt(Ot),rebindFunction:Ct(Ot),unbindFunction:Et(Ot)}}},mt.prototype._get=function(Ne,At,Ye,Et,nt,Ct){var Ot=null,Re={avoidConstraints:Ne,contextInterceptor:function(Be){return Be},isMultiInject:At,key:nt,serviceIdentifier:Et,targetType:Ye,value:Ct};if(this._middleware){if(Ot=this._middleware(Re),Ot==null)throw new Error(z.INVALID_MIDDLEWARE_RETURN)}else Ot=this._planAndResolve()(Re);return Ot},mt.prototype._planAndResolve=function(){var Ne=this;return function(At){var Ye=K.plan(Ne._metadataReader,Ne,At.isMultiInject,At.targetType,At.serviceIdentifier,At.key,At.value,At.avoidConstraints);Ye=At.contextInterceptor(Ye);var Et=re.resolve(Ye);return Et}},mt}();_.Container=Ce},"8FOW":function(Fe,_){},"8Mwt":function(Fe,_,o){"use strict";o.d(_,"a",function(){return x}),o.d(_,"b",function(){return p});var x;(function(Y){Y[Y.LNGLAT=1]="LNGLAT",Y[Y.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Y[Y.VECTOR_TILE=3]="VECTOR_TILE",Y[Y.IDENTITY=4]="IDENTITY",Y[Y.P20=5]="P20",Y[Y.P20_OFFSET=6]="P20_OFFSET",Y[Y.METER_OFFSET=7]="METER_OFFSET"})(x||(x={}));var p={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},"8RlI":function(Fe,_,o){var x=o("VhfK"),p=o("qun4"),Y=o("xrLW"),z=o("VyIr");function i(Z,D,K){return Z=Y(Z),D=K?void 0:D,D===void 0?p(Z)?z(Z):x(Z):Z.match(D)||[]}Fe.exports=i},"8enF":function(Fe,_,o){var x=o("U3SQ"),p=o("kHJI"),Y=o("xTFY"),z=o("gteZ");function i(Z,D,K){if(!z(K))return!1;var re=typeof D;return(re=="number"?p(K)&&Y(D,K.length):re=="string"&&D in K)?x(K[D],Z):!1}Fe.exports=i},"8tnj":function(Fe,_,o){(function(x,p){Fe.exports=p()})(this,function(){"use strict";var x,p,Y;function z(i,Z){if(!x)x=Z;else if(!p)p=Z;else{var D="var sharedChunk = {}; ("+x+")(sharedChunk); ("+p+")(sharedChunk);",K={};x(K),Y=Z(K),typeof window!="undefined"&&(Y.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(i){"use strict";function Z(e,t){return e(t={exports:{}},t.exports),t.exports}var D=K;function K(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}K.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},K.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},K.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},K.prototype.solveCurveX=function(e,t){var r,u,f,m,S;for(t===void 0&&(t=1e-6),f=e,S=0;S<8;S++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var P=this.sampleCurveDerivativeX(f);if(Math.abs(P)<1e-6)break;f-=m/P}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?r=f:u=f,f=.5*(u-r)+r}return f},K.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var re=fe;function fe(e,t){this.x=e,this.y=t}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),m=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(e){return e instanceof fe?e:Array.isArray(e)?new fe(e[0],e[1]):e};var X=typeof self!="undefined"?self:{},He=Math.pow(2,53)-1;function Xe(e,t,r,u){var f=new D(e,t,r,u);return function(m){return f.solve(m)}}var pe=Xe(.25,.1,.25,1);function Ce(e,t,r){return Math.min(r,Math.max(t,e))}function mt(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function Ne(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var S in m)e[S]=m[S]}return e}var At=1;function Ye(){return At++}function Et(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function nt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Ct(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function Ot(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Re(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function Ie(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function Be(e){return Array.isArray(e)?e.map(Be):typeof e=="object"&&e?Re(e,Be):e}var ft={};function Me(e){ft[e]||(typeof console!="undefined"&&console.warn(e),ft[e]=!0)}function ht(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Wt(e){for(var t=0,r=0,u=e.length,f=u-1,m=void 0,S=void 0;r<u;f=r++)t+=((S=e[f]).x-(m=e[r]).x)*(m.y+S.y);return t}function Qt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ur(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,m,S){var P=m||S;return t[f]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function J(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=X[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Se,be,_e,me,it=X.performance&&X.performance.now?X.performance.now.bind(X.performance):Date.now.bind(Date),qt=X.requestAnimationFrame||X.mozRequestAnimationFrame||X.webkitRequestAnimationFrame||X.msRequestAnimationFrame,Pt=X.cancelAnimationFrame||X.mozCancelAnimationFrame||X.webkitCancelAnimationFrame||X.msCancelAnimationFrame,ve={now:it,frame:function(t){var r=qt(t);return{cancel:function(){return Pt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=X.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Se||(Se=X.document.createElement("a")),Se.href=t,Se.href},hardwareConcurrency:X.navigator&&X.navigator.hardwareConcurrency||4,get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(be==null&&(be=X.matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}},ge={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ve={supported:!1,testSupport:function(t){!st&&me&&(Oe?vt(t):_e=t)}},st=!1,Oe=!1;function vt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,me),e.isContextLost())return;Ve.supported=!0}catch(r){}e.deleteTexture(t),st=!0}X.document&&((me=X.document.createElement("img")).onload=function(){_e&&vt(_e),_e=null,Oe=!0},me.onerror=function(){st=!0,_e=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var C="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",C,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=Tt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,u){var f=Tt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,ot(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=Tt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ve.devicePixelRatio>=2||t===512?"@2x":"")+(Ve.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var m=0,S=f;m<S.length;m+=1){var P=S[m].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||ge.ACCESS_TOKEN;return ge.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},R.prototype.canonicalizeTileURL=function(e,t){var r=Tt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],f=0,m=e.tiles||[];f<m.length;f+=1){var S=m[f];Ge(S)?u.push(this.canonicalizeTileURL(S,r)):u.push(S)}return u},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=Tt(ge.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!ge.REQUIRE_ACCESS_TOKEN)return ot(e);if(!(t=t||ge.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),ot(e)};var ce=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ge(e){return ce.test(e)}var qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(e){var t=e.match(qe);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ot(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ut(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=Ut(ge.ACCESS_TOKEN);return t=r&&r.u?X.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):ge.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=X.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=X.localStorage.getItem(r);f&&(this.anonId=f)}catch(m){Me("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{X.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Me("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,u){var f=this;if(ge.EVENTS_URL){var m=Tt(ge.EVENTS_URL);m.params.push("access_token="+(u||ge.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:C,userId:this.anonId},P=t?Ne(S,t):S,V={url:ot(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=Cn(V,function(te){f.pendingRequest=null,r(te),f.saveEventData(),f.processRequests(u)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Qe,ae,et=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,m){this.skuToken=f,(ge.EVENTS_URL&&m||ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return q(S)||Ge(S)}))&&this.queueRequest({id:u,timestamp:Date.now()},m)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,S=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),nt(this.anonId)||(this.anonId=Et()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||m&&(u.success[m]=!0)},r))}},t}($),kt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){ge.EVENTS_URL&&ge.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||Ge(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Ut(ge.ACCESS_TOKEN),m=f?f.u:ge.ACCESS_TOKEN,S=m!==this.eventData.tokenU;nt(this.anonId)||(this.anonId=Et(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var V=new Date(this.eventData.lastSuccess),te=new Date(P),he=(P-this.eventData.lastSuccess)/864e5;S=S||he>=1||he<-1||V.getDate()!==te.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(Te){Te||(u.eventData.lastSuccess=P,u.eventData.tokenU=m)},r)}},t}($)),pr=kt.postTurnstileEvent.bind(kt),Ke=new et,bt=Ke.postMapLoadEvent.bind(Ke),yt=500,xt=50;function ze(){X.caches&&!Qe&&(Qe=X.caches.open("mapbox-tiles"))}function dt(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var gt,Ht=1/0;function hr(){return gt==null&&(gt=X.OffscreenCanvas&&new X.OffscreenCanvas(1,1).getContext("2d")&&typeof X.createImageBitmap=="function"),gt}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var yr=function(e){function t(r,u,f){u===401&&Ge(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Vn=Qt()?function(){return self.worker&&self.worker.referrer}:function(){return(X.location.protocol==="blob:"?X.parent:X).location.href},Fn,oa,$n=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Vn())&&!/^\w+:/.test(u))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return function(f,m){var S,P=new X.AbortController,V=new X.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Vn(),signal:P.signal}),te=!1,he=!1,Te=(S=V.url).indexOf("sku=")>0&&Ge(S);f.type==="json"&&V.headers.set("Accept","application/json");var we=function(St,$t,Xt){if(!he){if(St&&St.message!=="SecurityError"&&Me(St),$t&&Xt)return lt($t);var ir=Date.now();X.fetch(V).then(function(br){if(br.ok){var Sr=Te?br.clone():null;return lt(br,Sr,ir)}return m(new yr(br.statusText,br.status,f.url))}).catch(function(br){br.code!==20&&m(new Error(br.message))})}},lt=function(St,$t,Xt){(f.type==="arrayBuffer"?St.arrayBuffer():f.type==="json"?St.json():St.text()).then(function(ir){he||($t&&Xt&&function(br,Sr,zr){if(ze(),Qe){var Nr={status:Sr.status,statusText:Sr.statusText,headers:new X.Headers};Sr.headers.forEach(function(hn,Ln){return Nr.headers.set(Ln,hn)});var mn=ur(Sr.headers.get("Cache-Control")||"");mn["no-store"]||(mn["max-age"]&&Nr.headers.set("Expires",new Date(zr+1e3*mn["max-age"]).toUTCString()),new Date(Nr.headers.get("Expires")).getTime()-zr<42e4||function(hn,Ln){if(ae===void 0)try{new Response(new ReadableStream),ae=!0}catch(Qn){ae=!1}ae?Ln(hn.body):hn.blob().then(Ln)}(Sr,function(hn){var Ln=new X.Response(hn,Nr);ze(),Qe&&Qe.then(function(Qn){return Qn.put(dt(br.url),Ln)}).catch(function(Qn){return Me(Qn.message)})}))}}(V,$t,Xt),te=!0,m(null,ir,St.headers.get("Cache-Control"),St.headers.get("Expires")))}).catch(function(ir){he||m(new Error(ir.message))})};return Te?function(Lt,St){if(ze(),!Qe)return St(null);var $t=dt(Lt.url);Qe.then(function(Xt){Xt.match($t).then(function(ir){var br=function(Sr){if(!Sr)return!1;var zr=new Date(Sr.headers.get("Expires")||0),Nr=ur(Sr.headers.get("Cache-Control")||"");return zr>Date.now()&&!Nr["no-cache"]}(ir);Xt.delete($t),br&&Xt.put($t,ir.clone()),St(null,ir,br)}).catch(St)}).catch(St)}(V,we):we(null,null),{cancel:function(){he=!0,te||P.abort()}}}(t,r);if(Qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,m){var S=new X.XMLHttpRequest;for(var P in S.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(S.responseType="arraybuffer"),f.headers)S.setRequestHeader(P,f.headers[P]);return f.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=f.credentials==="include",S.onerror=function(){m(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){var V=S.response;if(f.type==="json")try{V=JSON.parse(S.response)}catch(te){return m(te)}m(null,V,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else m(new yr(S.statusText,S.status,f.url))},S.send(f.body),{cancel:function(){return S.abort()}}}(t,r)},Kn=function(t,r){return $n(Ne(t,{type:"arrayBuffer"}),r)},Cn=function(t,r){return $n(Ne(t,{method:"POST"}),r)},F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Fn=[],oa=0;var W=function e(t,r){if(Ve.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),oa>=ge.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return Fn.push(u),u}oa++;var f=!1,m=function(){if(!f)for(f=!0,oa--;Fn.length&&oa<ge.MAX_PARALLEL_IMAGE_REQUESTS;){var V=Fn.shift();V.cancelled||(V.cancel=e(V.requestParameters,V.callback).cancel)}},S=Kn(t,function(P,V,te,he){m(),P?r(P):V&&(hr()?function(Te,we){var lt=new X.Blob([new Uint8Array(Te)],{type:"image/png"});X.createImageBitmap(lt).then(function(Lt){we(null,Lt)}).catch(function(Lt){we(new Error("Could not load image because of "+Lt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(V,r):function(Te,we,lt,Lt){var St=new X.Image,$t=X.URL;St.onload=function(){we(null,St),$t.revokeObjectURL(St.src),St.onload=null,St.src=F},St.onerror=function(){return we(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Xt=new X.Blob([new Uint8Array(Te)],{type:"image/png"});St.cacheControl=lt,St.expires=Lt,St.src=Te.byteLength?$t.createObjectURL(Xt):F}(V,r,te,he))});return{cancel:function(){S.cancel(),m()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function xe(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var ut=function(t,r){r===void 0&&(r={}),Ne(this,r),this.type=t},wt=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",Ne({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ut),Bt=function(){};Bt.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},Bt.prototype.off=function(e,t){return xe(e,t,this._listeners),xe(e,t,this._oneTimeListeners),this},Bt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},Bt.prototype.fire=function(e,t){typeof e=="string"&&(e=new ut(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var m=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];m<S.length;m+=1){var P=S[m];xe(r,P,this._oneTimeListeners),P.call(this,e)}var V=this._eventedParent;V&&(Ne(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(e))}else e instanceof wt&&console.error(e.error);return this},Bt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Bt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Rt=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function lr(e){var t=e.value;return t?[new Rt(e.key,t,"constants have been deprecated as of v8")]:[]}function Ur(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var S in m)e[S]=m[S]}return e}function Gr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function cr(e){if(Array.isArray(e))return e.map(cr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=cr(e[r]);return t}return Gr(e)}var Br=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),wn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var m=f[u];this.bindings[m[0]]=m[1]}};wn.prototype.concat=function(e){return new wn(this,e)},wn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},wn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var fn={kind:"null"},tr={kind:"number"},rn={kind:"string"},dn={kind:"boolean"},En={kind:"color"},bn={kind:"object"},gn={kind:"value"},Mn={kind:"collator"},Ga={kind:"formatted"},ga={kind:"resolvedImage"};function Ma(e,t){return{kind:"array",itemType:e,N:t}}function Ia(e){if(e.kind==="array"){var t=Ia(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Wi=[fn,tr,rn,dn,En,Ga,bn,Ma(gn),ga];function da(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!da(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Wi;r<u.length;r+=1)if(!da(u[r],t))return null}}return"Expected "+Ia(e)+" but found "+Ia(t)+" instead."}function vi(e,t){return t.some(function(r){return r.kind===e.kind})}function ya(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ba=Z(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(P){return(P=Math.round(P))<0?0:P>255?255:P}function f(P){return u(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function m(P){return(V=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:V>1?1:V;var V}function S(P,V,te){return te<0?te+=1:te>1&&(te-=1),6*te<1?P+(V-P)*te*6:2*te<1?V:3*te<2?P+(V-P)*(2/3-te)*6:P}try{t.parseCSSColor=function(P){var V,te=P.replace(/ /g,"").toLowerCase();if(te in r)return r[te].slice();if(te[0]==="#")return te.length===4?(V=parseInt(te.substr(1),16))>=0&&V<=4095?[(3840&V)>>4|(3840&V)>>8,240&V|(240&V)>>4,15&V|(15&V)<<4,1]:null:te.length===7&&(V=parseInt(te.substr(1),16))>=0&&V<=16777215?[(16711680&V)>>16,(65280&V)>>8,255&V,1]:null;var he=te.indexOf("("),Te=te.indexOf(")");if(he!==-1&&Te+1===te.length){var we=te.substr(0,he),lt=te.substr(he+1,Te-(he+1)).split(","),Lt=1;switch(we){case"rgba":if(lt.length!==4)return null;Lt=m(lt.pop());case"rgb":return lt.length!==3?null:[f(lt[0]),f(lt[1]),f(lt[2]),Lt];case"hsla":if(lt.length!==4)return null;Lt=m(lt.pop());case"hsl":if(lt.length!==3)return null;var St=(parseFloat(lt[0])%360+360)%360/360,$t=m(lt[1]),Xt=m(lt[2]),ir=Xt<=.5?Xt*($t+1):Xt+$t-Xt*$t,br=2*Xt-ir;return[u(255*S(br,ir,St+1/3)),u(255*S(br,ir,St)),u(255*S(br,ir,St-1/3)),Lt];default:return null}}return null}}catch(P){}}).parseCSSColor,ha=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};ha.parse=function(e){if(e){if(e instanceof ha)return e;if(typeof e=="string"){var t=ba(e);if(t)return new ha(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ha.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},ha.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ha.black=new ha(0,0,0,1),ha.white=new ha(1,1,1,1),ha.transparent=new ha(0,0,0,0),ha.red=new ha(1,0,0,1);var wi=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};wi.prototype.compare=function(e,t){return this.collator.compare(e,t)},wi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var is=function(t,r,u,f,m){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=m},Xi=function(t){this.sections=t};Xi.fromString=function(e){return new Xi([new is(e,null,null,null,null)])},Xi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Xi.factory=function(e){return e instanceof Xi?e:Xi.fromString(e)},Xi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Xi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Xo=function(t){this.name=t.name,this.available=t.available};function Du(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ha(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof ha)return!0;if(e instanceof wi)return!0;if(e instanceof Xi)return!0;if(e instanceof Xo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ha(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!Ha(e[u]))return!1;return!0}return!1}function Oi(e){if(e===null)return fn;if(typeof e=="string")return rn;if(typeof e=="boolean")return dn;if(typeof e=="number")return tr;if(e instanceof ha)return En;if(e instanceof wi)return Mn;if(e instanceof Xi)return Ga;if(e instanceof Xo)return ga;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var m=Oi(f[u]);if(t){if(t===m)continue;t=gn;break}t=m}return Ma(t||gn,r)}return bn}function Jo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ha||e instanceof Xi||e instanceof Xo?e.toString():JSON.stringify(e)}Xo.prototype.toString=function(){return this.name},Xo.fromString=function(e){return e?new Xo({name:e,available:!1}):null},Xo.prototype.serialize=function(){return["image",this.name]};var ui=function(t,r){this.type=t,this.value=r};ui.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ha(e[1]))return t.error("invalid value");var r=e[1],u=Oi(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new ui(u,r)},ui.prototype.evaluate=function(){return this.value},ui.prototype.eachChild=function(){},ui.prototype.outputDefined=function(){return!0},ui.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ha?["rgba"].concat(this.value.toArray()):this.value instanceof Xi?this.value.serialize():this.value};var Yi=function(t){this.name="ExpressionEvaluationError",this.message=t};Yi.prototype.toJSON=function(){return this.message};var Oo={string:rn,number:tr,boolean:dn,object:bn},Za=function(t,r){this.type=t,this.args=r};Za.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var m,S;if(e.length>2){var P=e[1];if(typeof P!="string"||!(P in Oo)||P==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=Oo[P],u++}else m=gn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],u++}r=Ma(m,S)}else r=Oo[f];for(var V=[];u<e.length;u++){var te=t.parse(e[u],u,gn);if(!te)return null;V.push(te)}return new Za(r,V)},Za.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!da(this.type,Oi(r)))return r;if(t===this.args.length-1)throw new Yi("Expected value to be of type "+Ia(this.type)+", but found "+Ia(Oi(r))+" instead.")}return null},Za.prototype.eachChild=function(e){this.args.forEach(e)},Za.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Za.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Ga,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,m=1;m<=e.length-1;++m){var S=e[m];if(f&&typeof S=="object"&&!Array.isArray(S)){f=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,tr)))return null;var V=null;if(S["text-font"]&&!(V=t.parse(S["text-font"],1,Ma(rn))))return null;var te=null;if(S["text-color"]&&!(te=t.parse(S["text-color"],1,En)))return null;var he=u[u.length-1];he.scale=P,he.font=V,he.textColor=te}else{var Te=t.parse(e[m],1,gn);if(!Te)return null;var we=Te.type.kind;if(we!=="string"&&we!=="value"&&we!=="null"&&we!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:Te,scale:null,font:null,textColor:null})}}return new oo(u)},oo.prototype.evaluate=function(e){return new Xi(this.sections.map(function(t){var r=t.content.evaluate(e);return Oi(r)===ga?new is("",r,null,null,null):new is(Jo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=ga,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,rn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Xo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var bu={"to-boolean":dn,"to-color":En,"to-number":tr,"to-string":rn},Qo=function(t,r){this.type=t,this.args=r};Qo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=bu[r],f=[],m=1;m<e.length;m++){var S=t.parse(e[m],m,gn);if(!S)return null;f.push(S)}return new Qo(u,f)},Qo.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof ha)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Du(t[0],t[1],t[2],t[3])))return new ha(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Yi(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var S=null,P=0,V=this.args;P<V.length;P+=1){if((S=V[P].evaluate(e))===null)return 0;var te=Number(S);if(!isNaN(te))return te}throw new Yi("Could not convert "+JSON.stringify(S)+" to number.")}return this.type.kind==="formatted"?Xi.fromString(Jo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Xo.fromString(Jo(this.args[0].evaluate(e))):Jo(this.args[0].evaluate(e))},Qo.prototype.eachChild=function(e){this.args.forEach(e)},Qo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Qo.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Xl=["Unknown","Point","LineString","Polygon"],js=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};js.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},js.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Xl[this.feature.type]:this.feature.type:null},js.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},js.prototype.canonicalID=function(){return this.canonical},js.prototype.properties=function(){return this.feature&&this.feature.properties||{}},js.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ha.parse(e)),t};var ho=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};ho.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ho.prototype.eachChild=function(e){this.args.forEach(e)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ho.parse=function(e,t){var r,u=e[0],f=ho.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,S=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,P=S.filter(function(Yn){var Nn=Yn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),V=null,te=0,he=P;te<he.length;te+=1){var Te=he[te],we=Te[0],lt=Te[1];V=new Ks(t.registry,t.path,null,t.scope);for(var Lt=[],St=!1,$t=1;$t<e.length;$t++){var Xt=e[$t],ir=Array.isArray(we)?we[$t-1]:we.type,br=V.parse(Xt,1+Lt.length,ir);if(!br){St=!0;break}Lt.push(br)}if(!St)if(Array.isArray(we)&&we.length!==Lt.length)V.error("Expected "+we.length+" arguments, but found "+Lt.length+" instead.");else{for(var Sr=0;Sr<Lt.length;Sr++){var zr=Array.isArray(we)?we[Sr]:we.type,Nr=Lt[Sr];V.concat(Sr+1).checkSubtype(zr,Nr.type)}if(V.errors.length===0)return new ho(u,m,lt,Lt)}}if(P.length===1)(r=t.errors).push.apply(r,V.errors);else{for(var mn=(P.length?P:S).map(function(Yn){var Nn;return Nn=Yn[0],Array.isArray(Nn)?"("+Nn.map(Ia).join(", ")+")":"("+Ia(Nn.type)+"...)"}).join(" | "),hn=[],Ln=1;Ln<e.length;Ln++){var Qn=t.parse(e[Ln],1+hn.length);if(!Qn)return null;hn.push(Ia(Qn.type))}t.error("Expected arguments of type "+mn+", but found ("+hn.join(", ")+") instead.")}return null},ho.register=function(e,t){for(var r in ho.definitions=t,t)e[r]=ho};var Vt=function(t,r,u){this.type=Mn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Le(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function vr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function en(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function _n(e,t){for(var r,u,f,m,S,P,V,te=!1,he=0,Te=t.length;he<Te;he++)for(var we=t[he],lt=0,Lt=we.length;lt<Lt-1;lt++){if((m=(r=e)[0]-(u=we[lt])[0])*(V=r[1]-(f=we[lt+1])[1])-(P=r[0]-f[0])*(S=r[1]-u[1])==0&&m*P<=0&&S*V<=0)return!1;en(e,we[lt],we[lt+1])&&(te=!te)}return te}function Gn(e,t){for(var r=0;r<t.length;r++)if(_n(e,t[r]))return!0;return!1}function Mi(e,t,r,u){var f=u[0]-r[0],m=u[1]-r[1],S=(e[0]-r[0])*m-f*(e[1]-r[1]),P=(t[0]-r[0])*m-f*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function po(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var m=f[u],S=0;S<m.length-1;++S)if((Te=[(he=m[S+1])[0]-(te=m[S])[0],he[1]-te[1]])[0]*(we=[(V=t)[0]-(P=e)[0],V[1]-P[1]])[1]-Te[1]*we[0]!=0&&Mi(P,V,te,he)&&Mi(te,he,P,V))return!0;var P,V,te,he,Te,we;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!_n(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(po(e[u],e[u+1],t))return!1;return!0}function Mo(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function Nu(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var m=[],S=0;S<e[f].length;S++){var P=vr(e[f][S],r);Le(t,P),m.push(P)}u.push(m)}return u}function Ol(e,t,r){for(var u=[],f=0;f<e.length;f++){var m=Nu(e[f],t,r);u.push(m)}return u}function _s(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,m=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;m===0&&(m=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=m}Le(t,e)}function pc(e,t,r,u){for(var f=8192*Math.pow(2,u.z),m=[8192*u.x,8192*u.y],S=[],P=0,V=e;P<V.length;P+=1)for(var te=0,he=V[P];te<he.length;te+=1){var Te=he[te],we=[Te.x+m[0],Te.y+m[1]];_s(we,t,r,f),S.push(we)}return S}function xu(e,t,r,u){for(var f,m=8192*Math.pow(2,u.z),S=[8192*u.x,8192*u.y],P=[],V=0,te=e;V<te.length;V+=1){for(var he=[],Te=0,we=te[V];Te<we.length;Te+=1){var lt=we[Te],Lt=[lt.x+S[0],lt.y+S[1]];Le(t,Lt),he.push(Lt)}P.push(he)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var St=0,$t=P;St<$t.length;St+=1)for(var Xt=0,ir=$t[St];Xt<ir.length;Xt+=1)_s(ir[Xt],t,r,m)}return P}Vt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,dn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,dn);if(!f)return null;var m=null;return r.locale&&!(m=t.parse(r.locale,1,rn))?null:new Vt(u,f,m)},Vt.prototype.evaluate=function(e){return new wi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Vt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Po=function(t,r){this.type=dn,this.geojson=t,this.geometries=r};function ku(e){if(e instanceof ho){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Po)return!1;var t=!0;return e.eachChild(function(r){t&&!ku(r)&&(t=!1)}),t}function To(e){if(e instanceof ho&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!To(r)&&(t=!1)}),t}function Fi(e,t){if(e instanceof ho&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!Fi(u,t)&&(r=!1)}),r}Po.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ha(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Po(r,r.features[u].geometry)}else if(r.type==="Feature"){var m=r.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Po(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Po(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Po.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var S=Nu(r.coordinates,f,m),P=pc(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var V=0,te=P;V<te.length;V+=1)if(!_n(te[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ol(r.coordinates,f,m),Te=pc(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var we=0,lt=Te;we<lt.length;we+=1)if(!Gn(lt[we],he))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var S=Nu(r.coordinates,f,m),P=xu(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var V=0,te=P;V<te.length;V+=1)if(!mo(te[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ol(r.coordinates,f,m),Te=xu(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var we=0,lt=Te;we<lt.length;we+=1)if(!Mo(lt[we],he))return!1}return!0}(e,this.geometries)}return!1},Po.prototype.eachChild=function(){},Po.prototype.outputDefined=function(){return!0},Po.prototype.serialize=function(){return["within",this.geojson]};var Ys=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Ys.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ys(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ys.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ys.prototype.eachChild=function(){},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["var",this.name]};var Ks=function(t,r,u,f,m){r===void 0&&(r=[]),f===void 0&&(f=new wn),m===void 0&&(m=[]),this.registry=t,this.path=r,this.key=r.map(function(S){return"["+S+"]"}).join(""),this.scope=f,this.errors=m,this.expectedType=u};function zs(e,t){for(var r,u=e.length-1,f=0,m=u,S=0;f<=m;)if((r=e[S=Math.floor((f+m)/2)])<=t){if(S===u||t<e[S+1])return S;f=S+1}else{if(!(r>t))throw new Yi("Input is not a number.");m=S-1}return 0}Ks.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},Ks.prototype._parse=function(e,t){function r(te,he,Te){return Te==="assert"?new Za(he,[te]):Te==="coerce"?new Qo(he,[te]):te}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var S=this.expectedType,P=m.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||P.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(S,P))return null}else m=r(m,S,t.typeAnnotation||"coerce");else m=r(m,S,t.typeAnnotation||"assert")}if(!(m instanceof ui)&&m.type.kind!=="resolvedImage"&&function te(he){if(he instanceof Ys)return te(he.boundExpression);if(he instanceof ho&&he.name==="error")return!1;if(he instanceof Vt)return!1;if(he instanceof Po)return!1;var Te=he instanceof Qo||he instanceof Za,we=!0;return he.eachChild(function(lt){we=Te?we&&te(lt):we&&lt instanceof ui}),!!we&&ku(he)&&Fi(he,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var V=new js;try{m=new ui(m.type,m.evaluate(V))}catch(te){return this.error(te.message),null}}return m}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ks.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Ks(this.registry,u,t||null,f,this.errors)},Ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Br(u,e))},Ks.prototype.checkSubtype=function(e,t){var r=da(e,t);return r&&this.error(r),r};var Ii=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,m=u;f<m.length;f+=1){var S=m[f],P=S[1];this.labels.push(S[0]),this.outputs.push(P)}};function Gi(e,t,r){return e*(1-r)+t*r}Ii.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,tr);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var S=m===1?-1/0:e[m],P=e[m+1],V=m,te=m+1;if(typeof S!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(u.length&&u[u.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);var he=t.parse(P,te,f);if(!he)return null;f=f||he.type,u.push([S,he])}return new Ii(f,r,u)},Ii.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[zs(t,u)].evaluate(e)},Ii.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ii.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ii.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Ts=Object.freeze({__proto__:null,number:Gi,color:function(t,r,u){return new ha(Gi(t.r,r.r,u),Gi(t.g,r.g,u),Gi(t.b,r.b,u),Gi(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,m){return Gi(f,r[m],u)})}}),ml=6/29*3*(6/29),$u=Math.PI/180,It=180/Math.PI;function fr(e){return e>.008856451679035631?Math.pow(e,1/3):e/ml+4/29}function Pr(e){return e>6/29?e*e*e:ml*(e-4/29)}function Wn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ya(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function xi(e){var t=Ya(e.r),r=Ya(e.g),u=Ya(e.b),f=fr((.4124564*t+.3575761*r+.1804375*u)/.95047),m=fr((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-fr((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Ki(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Pr(t),r=.95047*Pr(r),u=1.08883*Pr(u),new ha(Wn(3.2404542*r-1.5371385*t-.4985314*u),Wn(-.969266*r+1.8760108*t+.041556*u),Wn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function Ka(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var Di={forward:xi,reverse:Ki,interpolate:function(t,r,u){return{l:Gi(t.l,r.l,u),a:Gi(t.a,r.a,u),b:Gi(t.b,r.b,u),alpha:Gi(t.alpha,r.alpha,u)}}},Yo={forward:function(t){var r=xi(t),u=r.l,f=r.a,m=r.b,S=Math.atan2(m,f)*It;return{h:S<0?S+360:S,c:Math.sqrt(f*f+m*m),l:u,alpha:t.a}},reverse:function(t){var r=t.h*$u,u=t.c;return Ki({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:Ka(t.h,r.h,u),c:Gi(t.c,r.c,u),l:Gi(t.l,r.l,u),alpha:Gi(t.alpha,r.alpha,u)}}},Ps=Object.freeze({__proto__:null,lab:Di,hcl:Yo}),gi=function(t,r,u,f,m){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var S=0,P=m;S<P.length;S+=1){var V=P[S],te=V[1];this.labels.push(V[0]),this.outputs.push(te)}};function Ml(e,t,r,u){var f=u-r,m=e-r;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}gi.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=Ml(t,e.base,r,u);else if(e.name==="linear")f=Ml(t,1,r,u);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new D(m[0],m[1],m[2],m[3]).solve(Ml(t,1,r,u))}return f},gi.parse=function(e,t){var r=e[0],u=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var S=u[1];if(typeof S!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:S}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var P=u.slice(1);if(P.length!==4||P.some(function($t){return typeof $t!="number"||$t<0||$t>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,tr)))return null;var V=[],te=null;r==="interpolate-hcl"||r==="interpolate-lab"?te=En:t.expectedType&&t.expectedType.kind!=="value"&&(te=t.expectedType);for(var he=0;he<m.length;he+=2){var Te=m[he],we=m[he+1],lt=he+3,Lt=he+4;if(typeof Te!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',lt);if(V.length&&V[V.length-1][0]>=Te)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',lt);var St=t.parse(we,Lt,te);if(!St)return null;te=te||St.type,V.push([Te,St])}return te.kind==="number"||te.kind==="color"||te.kind==="array"&&te.itemType.kind==="number"&&typeof te.N=="number"?new gi(te,r,u,f,V):t.error("Type "+Ia(te)+" is not interpolatable.")},gi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var m=zs(t,u),S=gi.interpolationFactor(this.interpolation,u,t[m],t[m+1]),P=r[m].evaluate(e),V=r[m+1].evaluate(e);return this.operator==="interpolate"?Ts[this.type.kind.toLowerCase()](P,V,S):this.operator==="interpolate-hcl"?Yo.reverse(Yo.interpolate(Yo.forward(P),Yo.forward(V),S)):Di.reverse(Di.interpolate(Di.forward(P),Di.forward(V),S))},gi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var $s=function(t,r){this.type=t,this.args=r};$s.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],m=0,S=e.slice(1);m<S.length;m+=1){var P=t.parse(S[m],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,f.push(P)}var V=u&&f.some(function(te){return da(u,te.type)});return new $s(V?gn:r,f)},$s.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,m=this.args;f<m.length&&(u++,(r=m[f].evaluate(e))&&r instanceof Xo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},$s.prototype.eachChild=function(e){this.args.forEach(e)},$s.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$s.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ss=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};Ss.prototype.evaluate=function(e){return this.result.evaluate(e)},Ss.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Ss.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var m=t.parse(e[u+1],u+1);if(!m)return null;r.push([f,m])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Ss(r,S):null},Ss.prototype.outputDefined=function(){return this.result.outputDefined()},Ss.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var vl=function(t,r,u){this.type=t,this.index=r,this.input=u};vl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,tr),u=t.parse(e[2],2,Ma(t.expectedType||gn));return r&&u?new vl(u.type.itemType,r,u):null},vl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Yi("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Yi("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Yi("Array index must be an integer, but found "+t+" instead.");return r[t]},vl.prototype.eachChild=function(e){e(this.index),e(this.input)},vl.prototype.outputDefined=function(){return!1},vl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cu=function(t,r){this.type=dn,this.needle=t,this.haystack=r};cu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,gn);return r&&u?vi(r.type,[dn,rn,tr,fn,gn])?new cu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead"):null},cu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ya(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Oi(t))+" instead.");if(!ya(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Oi(r))+" instead.");return r.indexOf(t)>=0},cu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},cu.prototype.outputDefined=function(){return!0},cu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Eu=function(t,r,u){this.type=tr,this.needle=t,this.haystack=r,this.fromIndex=u};Eu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,gn);if(!r||!u)return null;if(!vi(r.type,[dn,rn,tr,fn,gn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,tr);return f?new Eu(r,u,f):null}return new Eu(r,u)},Eu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ya(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Oi(t))+" instead.");if(!ya(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Oi(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},Eu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Eu.prototype.outputDefined=function(){return!1},Eu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fu=function(t,r,u,f,m,S){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=m,this.otherwise=S};fu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},m=[],S=2;S<e.length-1;S+=2){var P=e[S],V=e[S+1];Array.isArray(P)||(P=[P]);var te=t.concat(S);if(P.length===0)return te.error("Expected at least one branch label.");for(var he=0,Te=P;he<Te.length;he+=1){var we=Te[he];if(typeof we!="number"&&typeof we!="string")return te.error("Branch labels must be numbers or strings.");if(typeof we=="number"&&Math.abs(we)>Number.MAX_SAFE_INTEGER)return te.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof we=="number"&&Math.floor(we)!==we)return te.error("Numeric branch labels must be integer values.");if(r){if(te.checkSubtype(r,Oi(we)))return null}else r=Oi(we);if(f[String(we)]!==void 0)return te.error("Branch labels must be unique.");f[String(we)]=m.length}var lt=t.parse(V,S,u);if(!lt)return null;u=u||lt.type,m.push(lt)}var Lt=t.parse(e[1],1,gn);if(!Lt)return null;var St=t.parse(e[e.length-1],e.length-1,u);return St?Lt.type.kind!=="value"&&t.concat(1).checkSubtype(r,Lt.type)?null:new fu(r,u,Lt,f,m,St):null},fu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Oi(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var S=m[f];(Te=u[this.cases[S]])===void 0?(u[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[Te][1].push(S)}for(var P=function(Lt){return e.inputType.kind==="number"?Number(Lt):Lt},V=0,te=r;V<te.length;V+=1){var he=te[V],Te=he[0],we=he[1];t.push(we.length===1?P(we[0]):we.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ju=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};ju.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,dn);if(!m)return null;var S=t.parse(e[f+1],f+1,r);if(!S)return null;u.push([m,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new ju(r,u,P):null},ju.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},ju.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},ju.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ju.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Js=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function Mc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function hf(e,t,r,u){return u.compare(t,r)===0}function pi(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(m,S,P){this.type=dn,this.lhs=m,this.rhs=S,this.collator=P,this.hasUntypedArgument=m.type.kind==="value"||S.type.kind==="value"}return f.parse=function(m,S){if(m.length!==3&&m.length!==4)return S.error("Expected two or three arguments.");var P=m[0],V=S.parse(m[1],1,gn);if(!V)return null;if(!Mc(P,V.type))return S.concat(1).error('"'+P+`" comparisons are not supported for type '`+Ia(V.type)+"'.");var te=S.parse(m[2],2,gn);if(!te)return null;if(!Mc(P,te.type))return S.concat(2).error('"'+P+`" comparisons are not supported for type '`+Ia(te.type)+"'.");if(V.type.kind!==te.type.kind&&V.type.kind!=="value"&&te.type.kind!=="value")return S.error("Cannot compare types '"+Ia(V.type)+"' and '"+Ia(te.type)+"'.");u&&(V.type.kind==="value"&&te.type.kind!=="value"?V=new Za(te.type,[V]):V.type.kind!=="value"&&te.type.kind==="value"&&(te=new Za(V.type,[te])));var he=null;if(m.length===4){if(V.type.kind!=="string"&&te.type.kind!=="string"&&V.type.kind!=="value"&&te.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(!(he=S.parse(m[3],3,Mn)))return null}return new f(V,te,he)},f.prototype.evaluate=function(m){var S=this.lhs.evaluate(m),P=this.rhs.evaluate(m);if(u&&this.hasUntypedArgument){var V=Oi(S),te=Oi(P);if(V.kind!==te.kind||V.kind!=="string"&&V.kind!=="number")throw new Yi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+V.kind+", "+te.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var he=Oi(S),Te=Oi(P);if(he.kind!=="string"||Te.kind!=="string")return t(m,S,P)}return this.collator?r(m,S,P,this.collator.evaluate(m)):t(m,S,P)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(S){m.push(S.serialize())}),m},f}()}Js.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,tr);if(!r||!u)return null;if(!vi(r.type,[Ma(gn),rn,gn]))return t.error("Expected first argument to be of type array or string, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,tr);return f?new Js(r.type,r,u,f):null}return new Js(r.type,r,u)},Js.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!ya(t,["string","array"]))throw new Yi("Expected first argument to be of type array or string, but found "+Ia(Oi(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Js.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Pc=pi("==",function(e,t,r){return t===r},hf),mc=pi("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!hf(0,t,r,u)}),$c=pi("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),gl=pi(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),Jc=pi("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),$i=pi(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),_u=function(t,r,u,f,m){this.type=rn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=m};_u.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,tr);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,rn)))return null;var m=null;if(u.currency&&!(m=t.parse(u.currency,1,rn)))return null;var S=null;if(u["min-fraction-digits"]&&!(S=t.parse(u["min-fraction-digits"],1,tr)))return null;var P=null;return u["max-fraction-digits"]&&!(P=t.parse(u["max-fraction-digits"],1,tr))?null:new _u(r,f,m,S,P)},_u.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},_u.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},_u.prototype.outputDefined=function(){return!1},_u.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var yl=function(t){this.type=tr,this.input=t};yl.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ia(r.type)+" instead."):new yl(r):null},yl.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Yi("Expected value to be of type string or array, but found "+Ia(Oi(t))+" instead.")},yl.prototype.eachChild=function(e){e(this.input)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var os={"==":Pc,"!=":mc,">":gl,"<":$c,">=":$i,"<=":Jc,array:Za,at:vl,boolean:Za,case:ju,coalesce:$s,collator:Vt,format:oo,image:so,in:cu,"index-of":Eu,interpolate:gi,"interpolate-hcl":gi,"interpolate-lab":gi,length:yl,let:Ss,literal:ui,match:fu,number:Za,"number-format":_u,object:Za,slice:Js,step:Ii,string:Za,"to-boolean":Qo,"to-color":Qo,"to-number":Qo,"to-string":Qo,var:Ys,within:Po};function Lc(e,t){var r=t[0],u=t[1],f=t[2],m=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var S=m?m.evaluate(e):1,P=Du(r,u,f,S);if(P)throw new Yi(P);return new ha(r/255*S,u/255*S,f/255*S,S)}function vc(e,t){return e in t}function Pl(e,t){var r=t[e];return r===void 0?null:r}function Ju(e){return{type:e}}function Rc(e){return{result:"success",value:e}}function hu(e){return{result:"error",value:e}}function Tu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Qc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Yl(e){return!!e.expression&&e.expression.interpolated}function Si(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function qc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function df(e){return e}function Kl(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Ic(e,t,r,u,f){return Kl(typeof r===f?u[r]:void 0,e.default,t.default)}function $l(e,t,r){if(Si(r)!=="number")return Kl(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=zs(e.stops.map(function(m){return m[0]}),r);return e.stops[f][1]}function Qu(e,t,r){var u=e.base!==void 0?e.base:1;if(Si(r)!=="number")return Kl(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var m=zs(e.stops.map(function(Te){return Te[0]}),r),S=function(Te,we,lt,Lt){var St=Lt-lt,$t=Te-lt;return St===0?0:we===1?$t/St:(Math.pow(we,$t)-1)/(Math.pow(we,St)-1)}(r,u,e.stops[m][0],e.stops[m+1][0]),P=e.stops[m][1],V=e.stops[m+1][1],te=Ts[t.type]||df;if(e.colorSpace&&e.colorSpace!=="rgb"){var he=Ps[e.colorSpace];te=function(we,lt){return he.reverse(he.interpolate(he.forward(we),he.forward(lt),S))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var we=[],lt=arguments.length;lt--;)we[lt]=arguments[lt];var Lt=P.evaluate.apply(void 0,we),St=V.evaluate.apply(void 0,we);if(Lt!==void 0&&St!==void 0)return te(Lt,St,S)}}:te(P,V,S)}function zu(e,t,r){return t.type==="color"?r=ha.parse(r):t.type==="formatted"?r=Xi.fromString(r.toString()):t.type==="resolvedImage"?r=Xo.fromString(r.toString()):Si(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Kl(r,e.default,t.default)}ho.register(os,{error:[{kind:"error"},[rn],function(e,t){throw new Yi(t[0].evaluate(e))}],typeof:[rn,[gn],function(e,t){return Ia(Oi(t[0].evaluate(e)))}],"to-rgba":[Ma(tr,4),[En],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[En,[tr,tr,tr],Lc],rgba:[En,[tr,tr,tr,tr],Lc],has:{type:dn,overloads:[[[rn],function(e,t){return vc(t[0].evaluate(e),e.properties())}],[[rn,bn],function(e,t){var r=t[1];return vc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:gn,overloads:[[[rn],function(e,t){return Pl(t[0].evaluate(e),e.properties())}],[[rn,bn],function(e,t){var r=t[1];return Pl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[gn,[rn],function(e,t){return Pl(t[0].evaluate(e),e.featureState||{})}],properties:[bn,[],function(e){return e.properties()}],"geometry-type":[rn,[],function(e){return e.geometryType()}],id:[gn,[],function(e){return e.id()}],zoom:[tr,[],function(e){return e.globals.zoom}],"heatmap-density":[tr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[tr,[],function(e){return e.globals.lineProgress||0}],accumulated:[gn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[tr,Ju(tr),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[tr,Ju(tr),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:tr,overloads:[[[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[tr],function(e,t){return-t[0].evaluate(e)}]]},"/":[tr,[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[tr,[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[tr,[],function(){return Math.LN2}],pi:[tr,[],function(){return Math.PI}],e:[tr,[],function(){return Math.E}],"^":[tr,[tr,tr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[tr,[tr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[tr,[tr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[tr,[tr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[tr,[tr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[tr,[tr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[tr,[tr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[tr,[tr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[tr,Ju(tr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[tr,Ju(tr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[tr,[tr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[tr,[tr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[tr,[tr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[tr,[tr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[dn,[gn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[dn,[rn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f<m}],"filter-id-<":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f>m}],"filter-id->":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[dn,[gn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[dn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[dn,[Ma(rn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[dn,[Ma(gn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[dn,[rn,Ma(gn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[dn,[rn,Ma(gn)],function(e,t){var r=t[0],u=t[1];return function(f,m,S,P){for(;S<=P;){var V=S+P>>1;if(m[V]===f)return!0;m[V]>f?P=V-1:S=V+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Ju(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Ju(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[dn,[dn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[dn,[rn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[rn,[rn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[rn,[rn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[rn,Ju(gn),function(e,t){return t.map(function(r){return Jo(r.evaluate(e))}).join("")}],"resolved-locale":[rn,[Mn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var bl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new js,this._defaultValue=r?function(u){return u.type==="color"&&qc(u.default)?new ha(0,0,0,0):u.type==="color"?ha.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Lo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in os}function Jl(e,t){var r=new Ks(os,[],t?function(f){var m={color:En,string:rn,number:tr,enum:rn,boolean:dn,formatted:Ga,resolvedImage:ga};return f.type==="array"?Ma(m[f.value]||gn,f.length):m[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Rc(new bl(u,t)):hu(r.errors)}bl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},bl.prototype.evaluate=function(e,t,r,u,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Yi("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Ll=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!To(r.expression)};Ll.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,m)},Ll.prototype.evaluate=function(e,t,r,u,f,m){return this._styleExpression.evaluate(e,t,r,u,f,m)};var Rl=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!To(r.expression),this.interpolationType=f};function Dc(e,t){if((e=Jl(e,t)).result==="error")return e;var r=e.value.expression,u=ku(r);if(!u&&!Tu(t))return hu([new Br("","data expressions not supported")]);var f=Fi(r,["zoom"]);if(!f&&!Qc(t))return hu([new Br("","zoom expressions not supported")]);var m=function S(P){var V=null;if(P instanceof Ss)V=S(P.result);else if(P instanceof $s)for(var te=0,he=P.args;te<he.length&&!(V=S(he[te]));te+=1);else(P instanceof Ii||P instanceof gi)&&P.input instanceof ho&&P.input.name==="zoom"&&(V=P);return V instanceof Br||P.eachChild(function(Te){var we=S(Te);we instanceof Br?V=we:!V&&we?V=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&we&&V!==we&&(V=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(r);return m||f?m instanceof Br?hu([m]):m instanceof gi&&!Yl(t)?hu([new Br("",'"interpolate" expressions cannot be used with this property')]):Rc(m?new Rl(u?"camera":"composite",e.value,m.labels,m instanceof gi?m.interpolation:void 0):new Ll(u?"constant":"source",e.value)):hu([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Rl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,m)},Rl.prototype.evaluate=function(e,t,r,u,f,m){return this._styleExpression.evaluate(e,t,r,u,f,m)},Rl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?gi.interpolationFactor(this.interpolationType,e,t,r):0};var xl=function(t,r){this._parameters=t,this._specification=r,Ur(this,function u(f,m){var S,P,V,te=m.type==="color",he=f.stops&&typeof f.stops[0][0]=="object",Te=he||!(he||f.property!==void 0),we=f.type||(Yl(m)?"exponential":"interval");if(te&&((f=Ur({},f)).stops&&(f.stops=f.stops.map(function(Yn){return[Yn[0],ha.parse(Yn[1])]})),f.default=ha.parse(f.default?f.default:m.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Ps[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(we==="exponential")S=Qu;else if(we==="interval")S=$l;else if(we==="categorical"){S=Ic,P=Object.create(null);for(var lt=0,Lt=f.stops;lt<Lt.length;lt+=1){var St=Lt[lt];P[St[0]]=St[1]}V=typeof f.stops[0][0]}else{if(we!=="identity")throw new Error('Unknown function type "'+we+'"');S=zu}if(he){for(var $t={},Xt=[],ir=0;ir<f.stops.length;ir++){var br=f.stops[ir],Sr=br[0].zoom;$t[Sr]===void 0&&($t[Sr]={zoom:Sr,type:f.type,property:f.property,default:f.default,stops:[]},Xt.push(Sr)),$t[Sr].stops.push([br[0].value,br[1]])}for(var zr=[],Nr=0,mn=Xt;Nr<mn.length;Nr+=1){var hn=mn[Nr];zr.push([$t[hn].zoom,u($t[hn],m)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:gi.interpolationFactor.bind(void 0,Ln),zoomStops:zr.map(function(Yn){return Yn[0]}),evaluate:function(Nn,Ta){var fa=Nn.zoom;return Qu({stops:zr,base:f.base},m,fa).evaluate(fa,Ta)}}}if(Te){var Qn=we==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Qn,interpolationFactor:gi.interpolationFactor.bind(void 0,Qn),zoomStops:f.stops.map(function(Yn){return Yn[0]}),evaluate:function(Nn){return S(f,m,Nn.zoom,P,V)}}}return{kind:"source",evaluate:function(Nn,Ta){var fa=Ta&&Ta.properties?Ta.properties[f.property]:void 0;return fa===void 0?Kl(f.default,m.default):S(f,m,fa,P,V)}}}(this._parameters,this._specification))};function Qs(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,S=e.styleSpec,P=[],V=Si(r);if(V!=="object")return[new Rt(t,r,"object expected, "+V+" found")];for(var te in r){var he=te.split(".")[0],Te=u[he]||u["*"],we=void 0;if(f[he])we=f[he];else if(u[he])we=kn;else if(f["*"])we=f["*"];else{if(!u["*"]){P.push(new Rt(t,r[te],'unknown property "'+te+'"'));continue}we=kn}P=P.concat(we({key:(t&&t+".")+te,value:r[te],valueSpec:Te,style:m,styleSpec:S,object:r,objectKey:te},r))}for(var lt in u)f[lt]||u[lt].required&&u[lt].default===void 0&&r[lt]===void 0&&P.push(new Rt(t,r,'missing required property "'+lt+'"'));return P}function eo(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,m=e.key,S=e.arrayElementValidator||kn;if(Si(t)!=="array")return[new Rt(m,t,"array expected, "+Si(t)+" found")];if(r.length&&t.length!==r.length)return[new Rt(m,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Rt(m,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};f.$version<7&&(P.function=r.function),Si(r.value)==="object"&&(P=r.value);for(var V=[],te=0;te<t.length;te++)V=V.concat(S({array:t,arrayIndex:te,value:t[te],valueSpec:P,style:u,styleSpec:f,key:m+"["+te+"]"}));return V}function pf(e){var t=e.key,r=e.value,u=e.valueSpec,f=Si(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Rt(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new Rt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new Rt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function mf(e){var t,r,u,f=e.valueSpec,m=Gr(e.value.type),S={},P=m!=="categorical"&&e.value.property===void 0,V=!P,te=Si(e.value.stops)==="array"&&Si(e.value.stops[0])==="array"&&Si(e.value.stops[0][0])==="object",he=Qs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Lt){if(m==="identity")return[new Rt(Lt.key,Lt.value,'identity function may not have a "stops" property')];var St=[],$t=Lt.value;return St=St.concat(eo({key:Lt.key,value:$t,valueSpec:Lt.valueSpec,style:Lt.style,styleSpec:Lt.styleSpec,arrayElementValidator:Te})),Si($t)==="array"&&$t.length===0&&St.push(new Rt(Lt.key,$t,"array must have at least one stop")),St},default:function(Lt){return kn({key:Lt.key,value:Lt.value,valueSpec:f,style:Lt.style,styleSpec:Lt.styleSpec})}}});return m==="identity"&&P&&he.push(new Rt(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||he.push(new Rt(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!Yl(e.valueSpec)&&he.push(new Rt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(V&&!Tu(e.valueSpec)?he.push(new Rt(e.key,e.value,"property functions not supported")):P&&!Qc(e.valueSpec)&&he.push(new Rt(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!te||e.value.property!==void 0||he.push(new Rt(e.key,e.value,'"property" property is required')),he;function Te(lt){var Lt=[],St=lt.value,$t=lt.key;if(Si(St)!=="array")return[new Rt($t,St,"array expected, "+Si(St)+" found")];if(St.length!==2)return[new Rt($t,St,"array length 2 expected, length "+St.length+" found")];if(te){if(Si(St[0])!=="object")return[new Rt($t,St,"object expected, "+Si(St[0])+" found")];if(St[0].zoom===void 0)return[new Rt($t,St,"object stop key must have zoom")];if(St[0].value===void 0)return[new Rt($t,St,"object stop key must have value")];if(u&&u>Gr(St[0].zoom))return[new Rt($t,St[0].zoom,"stop zoom values must appear in ascending order")];Gr(St[0].zoom)!==u&&(u=Gr(St[0].zoom),r=void 0,S={}),Lt=Lt.concat(Qs({key:$t+"[0]",value:St[0],valueSpec:{zoom:{}},style:lt.style,styleSpec:lt.styleSpec,objectElementValidators:{zoom:pf,value:we}}))}else Lt=Lt.concat(we({key:$t+"[0]",value:St[0],valueSpec:{},style:lt.style,styleSpec:lt.styleSpec},St));return Lo(cr(St[1]))?Lt.concat([new Rt($t+"[1]",St[1],"expressions are not allowed in function stops.")]):Lt.concat(kn({key:$t+"[1]",value:St[1],valueSpec:f,style:lt.style,styleSpec:lt.styleSpec}))}function we(lt,Lt){var St=Si(lt.value),$t=Gr(lt.value),Xt=lt.value!==null?lt.value:Lt;if(t){if(St!==t)return[new Rt(lt.key,Xt,St+" stop domain type must match previous stop domain type "+t)]}else t=St;if(St!=="number"&&St!=="string"&&St!=="boolean")return[new Rt(lt.key,Xt,"stop domain value must be a number, string, or boolean")];if(St!=="number"&&m!=="categorical"){var ir="number expected, "+St+" found";return Tu(f)&&m===void 0&&(ir+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(lt.key,Xt,ir)]}return m!=="categorical"||St!=="number"||isFinite($t)&&Math.floor($t)===$t?m!=="categorical"&&St==="number"&&r!==void 0&&$t<r?[new Rt(lt.key,Xt,"stop domain values must appear in ascending order")]:(r=$t,m==="categorical"&&$t in S?[new Rt(lt.key,Xt,"stop domain values must be unique")]:(S[$t]=!0,[])):[new Rt(lt.key,Xt,"integer expected, found "+$t)]}}function El(e){var t=(e.expressionContext==="property"?Dc:Jl)(cr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new Rt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Rt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!To(r))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!To(r))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Fi(r,["zoom","feature-state"]))return[new Rt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ku(r))return[new Rt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ql(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Gr(r))===-1&&f.push(new Rt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Gr(r))===-1&&f.push(new Rt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function qu(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!qu(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}xl.deserialize=function(e){return new xl(e._parameters,e._specification)},xl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Il={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};qu(e)||(e=el(e));var t=Jl(e,Il);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,m){return t.value.evaluate(u,f,{},m)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function yc(e,t){return e<t?-1:e>t?1:0}function el(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?ef(e[1],e[2],"=="):r==="!="?_l(ef(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ef(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(el))):r==="all"?["all"].concat(e.slice(1).map(el)):r==="none"?["all"].concat(e.slice(1).map(el).map(_l)):r==="in"?tl(e[1],e.slice(2)):r==="!in"?_l(tl(e[1],e.slice(2))):r==="has"?qs(e[1]):r==="!has"?_l(qs(e[1])):r!=="within"||e}function ef(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function tl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(yc)]]:["filter-in-small",e,["literal",t]]}}function qs(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function _l(e){return["!",e]}function ql(e){return qu(cr(e.value))?El(Ur({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(Si(u)!=="array")return[new Rt(f,u,"array expected, "+Si(u)+" found")];var m,S=r.styleSpec,P=[];if(u.length<1)return[new Rt(f,u,"filter array must have at least 1 element")];switch(P=P.concat(Ql({key:f+"[0]",value:u[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Gr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Gr(u[1])==="$type"&&P.push(new Rt(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&P.push(new Rt(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(m=Si(u[1]))!=="string"&&P.push(new Rt(f+"[1]",u[1],"string expected, "+m+" found"));for(var V=2;V<u.length;V++)m=Si(u[V]),Gr(u[1])==="$type"?P=P.concat(Ql({key:f+"["+V+"]",value:u[V],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&P.push(new Rt(f+"["+V+"]",u[V],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var te=1;te<u.length;te++)P=P.concat(t({key:f+"["+te+"]",value:u[te],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=Si(u[1]),u.length!==2?P.push(new Rt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="string"&&P.push(new Rt(f+"[1]",u[1],"string expected, "+m+" found"));break;case"within":m=Si(u[1]),u.length!==2?P.push(new Rt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="object"&&P.push(new Rt(f+"[1]",u[1],"object expected, "+m+" found"))}return P}(e)}function Nc(e,t){var r=e.key,u=e.style,f=e.styleSpec,m=e.value,S=e.objectKey,P=f[t+"_"+e.layerType];if(!P)return[];var V=S.match(/^(.*)-transition$/);if(t==="paint"&&V&&P[V[1]]&&P[V[1]].transition)return kn({key:r,value:m,valueSpec:f.transition,style:u,styleSpec:f});var te,he=e.valueSpec||P[S];if(!he)return[new Rt(r,m,'unknown property "'+S+'"')];if(Si(m)==="string"&&Tu(he)&&!he.tokens&&(te=/^{([^}]+)}$/.exec(m)))return[new Rt(r,m,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(te[1])+" }`.")];var Te=[];return e.layerType==="symbol"&&(S==="text-field"&&u&&!u.glyphs&&Te.push(new Rt(r,m,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&qc(cr(m))&&Gr(m.type)==="identity"&&Te.push(new Rt(r,m,'"text-font" does not support identity functions'))),Te.concat(kn({key:e.key,value:m,valueSpec:he,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:S}))}function tf(e){return Nc(e,"paint")}function Fs(e){return Nc(e,"layout")}function vf(e){var t=[],r=e.value,u=e.key,f=e.style,m=e.styleSpec;r.type||r.ref||t.push(new Rt(u,r,'either "type" or "ref" is required'));var S,P=Gr(r.type),V=Gr(r.ref);if(r.id)for(var te=Gr(r.id),he=0;he<e.arrayIndex;he++){var Te=f.layers[he];Gr(Te.id)===te&&t.push(new Rt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Te.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Lt){Lt in r&&t.push(new Rt(u,r[Lt],'"'+Lt+'" is prohibited for ref layers'))}),f.layers.forEach(function(Lt){Gr(Lt.id)===V&&(S=Lt)}),S?S.ref?t.push(new Rt(u,r.ref,"ref cannot reference another ref layer")):P=Gr(S.type):t.push(new Rt(u,r.ref,'ref layer "'+V+'" not found'));else if(P!=="background")if(r.source){var we=f.sources&&f.sources[r.source],lt=we&&Gr(we.type);we?lt==="vector"&&P==="raster"?t.push(new Rt(u,r.source,'layer "'+r.id+'" requires a raster source')):lt==="raster"&&P!=="raster"?t.push(new Rt(u,r.source,'layer "'+r.id+'" requires a vector source')):lt!=="vector"||r["source-layer"]?lt==="raster-dem"&&P!=="hillshade"?t.push(new Rt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!r.paint||!r.paint["line-gradient"]||lt==="geojson"&&we.lineMetrics||t.push(new Rt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Rt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Rt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new Rt(u,r,'missing required property "source"'));return t=t.concat(Qs({key:u,value:r,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:u+".type",value:r.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:ql,layout:function(St){return Qs({layer:r,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Xt){return Fs(Ur({layerType:P},Xt))}}})},paint:function(St){return Qs({layer:r,key:St.key,value:St.value,style:St.style,styleSpec:St.styleSpec,objectElementValidators:{"*":function(Xt){return tf(Ur({layerType:P},Xt))}}})}}}))}function rl(e){var t=e.value,r=e.key,u=Si(t);return u!=="string"?[new Rt(r,t,"string expected, "+u+" found")]:[]}var Pi={promoteId:function(t){var r=t.key,u=t.value;if(Si(u)==="string")return rl({key:r,value:u});var f=[];for(var m in u)f.push.apply(f,rl({key:r+"."+m,value:u[m]}));return f}};function nl(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new Rt(r,t,'"type" is required')];var m,S=Gr(t.type);switch(S){case"vector":case"raster":case"raster-dem":return Qs({key:r,value:t,valueSpec:u["source_"+S.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:Pi});case"geojson":if(m=Qs({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:Pi}),t.cluster)for(var P in t.clusterProperties){var V=t.clusterProperties[P],te=V[0],he=typeof te=="string"?[te,["accumulated"],["get",P]]:te;m.push.apply(m,El({key:r+"."+P+".map",value:V[1],expressionContext:"cluster-map"})),m.push.apply(m,El({key:r+"."+P+".reduce",value:he,expressionContext:"cluster-reduce"}))}return m;case"video":return Qs({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Qs({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Rt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ql({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function Fu(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,m=[],S=Si(t);if(t===void 0)return m;if(S!=="object")return m.concat([new Rt("light",t,"object expected, "+S+" found")]);for(var P in t){var V=P.match(/^(.*)-transition$/);m=m.concat(V&&u[V[1]]&&u[V[1]].transition?kn({key:P,value:t[P],valueSpec:r.transition,style:f,styleSpec:r}):u[P]?kn({key:P,value:t[P],valueSpec:u[P],style:f,styleSpec:r}):[new Rt(P,t[P],'unknown property "'+P+'"')])}return m}var fi={"*":function(){return[]},array:eo,boolean:function(t){var r=t.value,u=t.key,f=Si(r);return f!=="boolean"?[new Rt(u,r,"boolean expected, "+f+" found")]:[]},number:pf,color:function(t){var r=t.key,u=t.value,f=Si(u);return f!=="string"?[new Rt(r,u,"color expected, "+f+" found")]:ba(u)===null?[new Rt(r,u,'color expected, "'+u+'" found')]:[]},constants:lr,enum:Ql,filter:ql,function:mf,layer:vf,object:Qs,source:nl,light:Fu,string:rl,formatted:function(t){return rl(t).length===0?[]:El(t)},resolvedImage:function(t){return rl(t).length===0?[]:El(t)}};function kn(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&qc(Gr(t))?mf(e):r.expression&&Lo(cr(t))?El(e):r.type&&fi[r.type]?fi[r.type](e):Qs(Ur({},e,{valueSpec:r.type?u[r.type]:r}))}function Li(e){var t=e.value,r=e.key,u=rl(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Rt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Rt(r,t,'"glyphs" url must include a "{range}" token'))),u}function Ls(e,t){t===void 0&&(t=Ze);var r=[];return r=r.concat(kn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Li,"*":function(){return[]}}})),e.constants&&(r=r.concat(lr({key:"constants",value:e.constants,style:e,styleSpec:t}))),Dl(r)}function Dl(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Uu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Dl(e.apply(this,t))}}Ls.source=Uu(nl),Ls.light=Uu(Fu),Ls.layer=Uu(vf),Ls.filter=Uu(ql),Ls.paintProperty=Uu(tf),Ls.layoutProperty=Uu(Fs);var al=Ls,gf=al.light,ss=al.paintProperty,Tl=al.layoutProperty;function il(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new wt(new Error(f[u].message))),r=!0;return r}var ol=Ui;function Ui(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var m=0;m<this.d*this.d;m++){var S=f[3+m],P=f[3+m+1];u.push(S===P?null:f.subarray(S,P))}var V=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],V),this.bboxes=f.subarray(V),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var te=0;te<this.d*this.d;te++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var he=r/t*e;this.min=-he,this.max=e+he}Ui.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},Ui.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ui.prototype._insertCell=function(e,t,r,u,f,m){this.cells[f].push(m)},Ui.prototype.query=function(e,t,r,u,f){var m=this.min,S=this.max;if(e<=m&&t<=m&&S<=r&&S<=u&&!f)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,u,this._queryCell,P,{},f),P},Ui.prototype._queryCell=function(e,t,r,u,f,m,S,P){var V=this.cells[f];if(V!==null)for(var te=this.keys,he=this.bboxes,Te=0;Te<V.length;Te++){var we=V[Te];if(S[we]===void 0){var lt=4*we;(P?P(he[lt+0],he[lt+1],he[lt+2],he[lt+3]):e<=he[lt+2]&&t<=he[lt+3]&&r>=he[lt+0]&&u>=he[lt+1])?(S[we]=!0,m.push(te[we])):S[we]=!1}}},Ui.prototype._forEachCell=function(e,t,r,u,f,m,S,P){for(var V=this._convertToCellCoord(e),te=this._convertToCellCoord(t),he=this._convertToCellCoord(r),Te=this._convertToCellCoord(u),we=V;we<=he;we++)for(var lt=te;lt<=Te;lt++){var Lt=this.d*lt+we;if((!P||P(this._convertFromCellCoord(we),this._convertFromCellCoord(lt),this._convertFromCellCoord(we+1),this._convertFromCellCoord(lt+1)))&&f.call(this,e,t,r,u,Lt,m,S,P))return}},Ui.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ui.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ui.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,S=0;S<e.length;S++){var P=e[S];f[3+S]=m,f.set(P,m),m+=P.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var As=X.ImageData,Nl=X.ImageBitmap,to={};function Rn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),to[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Us in Rn("Object",Object),ol.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ol.deserialize=function(e){return new ol(e.buffer)},Rn("Grid",ol),Rn("Color",ha),Rn("Error",Error),Rn("ResolvedImage",Xo),Rn("StylePropertyFunction",xl),Rn("StyleExpression",bl,{omit:["_evaluator"]}),Rn("ZoomDependentExpression",Rl),Rn("ZoomConstantExpression",Ll),Rn("CompoundExpression",ho,{omit:["_evaluate"]}),os)os[Us]._classRegistryKey||Rn("Expression_"+Us,os[Us]);function ni(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function kl(e){return Nl&&e instanceof Nl}function du(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ni(e)||kl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof As)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,m=e;f<m.length;f+=1)u.push(du(m[f],t));return u}if(typeof e=="object"){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var V=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var te in e)if(e.hasOwnProperty(te)&&!(to[P].omit.indexOf(te)>=0)){var he=e[te];V[te]=to[P].shallow.indexOf(te)>=0?he:du(he,t)}e instanceof Error&&(V.message=e.message)}if(V.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(V.$name=P),V}throw new Error("can't serialize object of type "+typeof e)}function Bs(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ni(e)||kl(e)||ArrayBuffer.isView(e)||e instanceof As)return e;if(Array.isArray(e))return e.map(Bs);if(typeof e=="object"){var t=e.$name||"Object",r=to[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var S=m[f];if(S!=="$name"){var P=e[S];u[S]=to[t].shallow.indexOf(S)>=0?P:Bs(P)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var sl=function(){this.first=!0};sl.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var tn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function bc(e){for(var t=0,r=e;t<r.length;t+=1)if(us(r[t].charCodeAt(0)))return!0;return!1}function us(e){return!(e!==746&&e!==747&&(e<4352||!(tn["Bopomofo Extended"](e)||tn.Bopomofo(e)||tn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||tn["CJK Compatibility Ideographs"](e)||tn["CJK Compatibility"](e)||tn["CJK Radicals Supplement"](e)||tn["CJK Strokes"](e)||!(!tn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||tn["CJK Unified Ideographs Extension A"](e)||tn["CJK Unified Ideographs"](e)||tn["Enclosed CJK Letters and Months"](e)||tn["Hangul Compatibility Jamo"](e)||tn["Hangul Jamo Extended-A"](e)||tn["Hangul Jamo Extended-B"](e)||tn["Hangul Jamo"](e)||tn["Hangul Syllables"](e)||tn.Hiragana(e)||tn["Ideographic Description Characters"](e)||tn.Kanbun(e)||tn["Kangxi Radicals"](e)||tn["Katakana Phonetic Extensions"](e)||tn.Katakana(e)&&e!==12540||!(!tn["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!tn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||tn["Unified Canadian Aboriginal Syllabics"](e)||tn["Unified Canadian Aboriginal Syllabics Extended"](e)||tn["Vertical Forms"](e)||tn["Yijing Hexagram Symbols"](e)||tn["Yi Syllables"](e)||tn["Yi Radicals"](e))))}function ro(e){return!(us(e)||function(t){return!!(tn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||tn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||tn["Letterlike Symbols"](t)||tn["Number Forms"](t)||tn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||tn["Control Pictures"](t)&&t!==9251||tn["Optical Character Recognition"](t)||tn["Enclosed Alphanumerics"](t)||tn["Geometric Shapes"](t)||tn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||tn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||tn["CJK Symbols and Punctuation"](t)||tn.Katakana(t)||tn["Private Use Area"](t)||tn["CJK Compatibility Forms"](t)||tn["Small Form Variants"](t)||tn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function qo(e){return e>=1424&&e<=2303||tn["Arabic Presentation Forms-A"](e)||tn["Arabic Presentation Forms-B"](e)}function Rs(e,t){return!(!t&&qo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||tn.Khmer(e))}function jl(e){for(var t=0,r=e;t<r.length;t+=1)if(qo(r[t].charCodeAt(0)))return!0;return!1}var kc=null,Vs="unavailable",Su=null,zl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Vs="error"),kc&&kc(t)};function Fl(){rf.fire(new ut("pluginStateChange",{pluginStatus:Vs,pluginURL:Su}))}var rf=new Bt,jc=function(){return Vs},Ro=function(){if(Vs!=="deferred"||!Su)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Vs="loading",Fl(),Su&&Kn({url:Su},function(t){t?zl(t):(Vs="loaded",Fl())})},ls={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Vs==="loaded"||ls.applyArabicShaping!=null},isLoading:function(){return Vs==="loading"},setState:function(t){Vs=t.pluginStatus,Su=t.pluginURL},isParsed:function(){return ls.applyArabicShaping!=null&&ls.processBidirectionalText!=null&&ls.processStyledBidirectionalText!=null},getPluginURL:function(){return Su}},Pa=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sl,this.transition={})};Pa.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Rs(f[u].charCodeAt(0),r))return!1;return!0}(e,ls.isLoaded())},Pa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Pa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var eu=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(qc(u))return new xl(u,f);if(Lo(u)){var m=Dc(u,f);if(m.result==="error")throw new Error(m.value.map(function(P){return P.key+": "+P.message}).join(", "));return m.value}var S=u;return typeof u=="string"&&f.type==="color"&&(S=ha.parse(u)),{kind:"constant",evaluate:function(){return S}}}(r===void 0?t.specification.default:r,t.specification)};eu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},eu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Io=function(t){this.property=t,this.value=new eu(t,void 0)};Io.prototype.transitioned=function(e,t){return new Sl(this.property,this.value,t,Ne({},e.transition,this.transition),e.now)},Io.prototype.untransitioned=function(){return new Sl(this.property,this.value,null,{},0)};var So=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};So.prototype.getValue=function(e){return Be(this._values[e].value.value)},So.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Io(this._values[e].property)),this._values[e].value=new eu(this._values[e].property,t===null?void 0:Be(t))},So.prototype.getTransition=function(e){return Be(this._values[e].transition)},So.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Io(this._values[e].property)),this._values[e].transition=Be(t)||void 0},So.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var m=this.getTransition(u);m!==void 0&&(e[u+"-transition"]=m)}return e},So.prototype.transitioned=function(e,t){for(var r=new ul(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var m=f[u];r._values[m]=this._values[m].transitioned(e,t._values[m])}return r},So.prototype.untransitioned=function(){for(var e=new ul(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Sl=function(t,r,u,f,m){this.property=t,this.value=r,this.begin=m+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};Sl.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,t,r);var S=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,r),f,function(P){if(P<=0)return 0;if(P>=1)return 1;var V=P*P,te=V*P;return 4*(P<.5?te:3*(P-V)+te-.75)}(S))}return f};var ul=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};ul.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xc(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var S=m[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u},ul.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var pu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};pu.prototype.getValue=function(e){return Be(this._values[e].value)},pu.prototype.setValue=function(e,t){this._values[e]=new eu(this._values[e].property,t===null?void 0:Be(t))},pu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},pu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xc(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var S=m[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u};var Cs=function(t,r,u){this.property=t,this.value=r,this.parameters=u};Cs.prototype.isConstant=function(){return this.value.kind==="constant"},Cs.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Cs.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var xc=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};xc.prototype.get=function(e){return this._values[e]};var Jn=function(t){this.specification=t};Jn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Jn.prototype.interpolate=function(e,t,r){var u=Ts[this.specification.type];return u?u(e,t,r):e};var jn=function(t,r){this.specification=t,this.overrides=r};jn.prototype.possiblyEvaluate=function(e,t,r,u){return new Cs(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},jn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Cs(this,{kind:"constant",value:void 0},e.parameters);var u=Ts[this.specification.type];return u?new Cs(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},jn.prototype.evaluate=function(e,t,r,u,f,m){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,m)};var Ec=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,m){if(r.value===void 0)return new Cs(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var S=r.expression.evaluate(u,null,{},f,m),P=r.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,V=this._calculate(P,P,P,u);return new Cs(this,{kind:"constant",value:V},u)}if(r.expression.kind==="camera"){var te=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Cs(this,{kind:"constant",value:te},u)}return new Cs(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,m,S,P){if(r.kind==="source"){var V=r.evaluate(u,f,m,S,P);return this._calculate(V,V,V,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,m),r.evaluate({zoom:Math.floor(u.zoom)},f,m),r.evaluate({zoom:Math.floor(u.zoom)+1},f,m),u):r.value},t.prototype._calculate=function(r,u,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(jn),cs=function(t){this.specification=t};cs.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Pa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom+1),t)),t)}},cs.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},cs.prototype.interpolate=function(e){return e};var Do=function(t){this.specification=t};Do.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Do.prototype.interpolate=function(){return!1};var vo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new eu(u,void 0),m=this.defaultTransitionablePropertyValues[r]=new Io(u);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};Rn("DataDrivenProperty",jn),Rn("DataConstantProperty",Jn),Rn("CrossFadedDataDrivenProperty",Ec),Rn("CrossFadedProperty",cs),Rn("ColorRampProperty",Do);var ws=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new pu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new So(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var m in r.layout)this.setLayoutProperty(m,r.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xc(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(Tl,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return Ot(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(ss,"layers."+this.id+".paint."+r,r,u,f))return!1;if(Ot(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var m=this._transitionablePaint._values[r],S=m.property.specification["property-type"]==="cross-faded-data-driven",P=m.value.isDataDriven(),V=m.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var te=this._transitionablePaint._values[r].value;return te.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,V,te)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ie(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,m,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&il(this,r.call(al,{key:u,layerType:this.type,objectKey:f,value:m,styleSpec:Ze,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof Cs&&Tu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(Bt),Au={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ec=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$a=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function no(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var m=Au[f.type].BYTES_PER_ELEMENT,S=r=ll(r,Math.max(t,m)),P=f.components||1;return u=Math.max(u,m),r+=m*P,{name:f.name,type:f.type,components:P,offset:S}}),size:ll(r,Math.max(u,t)),alignment:t}}function ll(e,t){return Math.ceil(e/t)*t}$a.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},$a.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},$a.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$a.prototype.clear=function(){this.length=0},$a.prototype.resize=function(e){this.reserve(e),this.length=e},$a.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},$a.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.int16[m+0]=u,this.int16[m+1]=f,r},t}($a);mu.prototype.bytesPerElement=4,Rn("StructArrayLayout2i4",mu);var cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=4*r;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=m,this.int16[P+3]=S,r},t}($a);cl.prototype.bytesPerElement=8,Rn("StructArrayLayout4i8",cl);var Cu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=m,this.int16[te+3]=S,this.int16[te+4]=P,this.int16[te+5]=V,r},t}($a);Cu.prototype.bytesPerElement=12,Rn("StructArrayLayout2i4i12",Cu);var Is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var te=4*r,he=8*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.uint8[he+4]=m,this.uint8[he+5]=S,this.uint8[he+6]=P,this.uint8[he+7]=V,r},t}($a);Is.prototype.bytesPerElement=8,Rn("StructArrayLayout2i4ub8",Is);var zc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.float32[m+0]=u,this.float32[m+1]=f,r},t}($a);zc.prototype.bytesPerElement=8,Rn("StructArrayLayout2f8",zc);var Gs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,te,he,Te){var we=this.length;return this.resize(we+1),this.emplace(we,r,u,f,m,S,P,V,te,he,Te)},t.prototype.emplace=function(r,u,f,m,S,P,V,te,he,Te,we){var lt=10*r;return this.uint16[lt+0]=u,this.uint16[lt+1]=f,this.uint16[lt+2]=m,this.uint16[lt+3]=S,this.uint16[lt+4]=P,this.uint16[lt+5]=V,this.uint16[lt+6]=te,this.uint16[lt+7]=he,this.uint16[lt+8]=Te,this.uint16[lt+9]=we,r},t}($a);Gs.prototype.bytesPerElement=20,Rn("StructArrayLayout10ui20",Gs);var yf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,te,he,Te,we,lt){var Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,r,u,f,m,S,P,V,te,he,Te,we,lt)},t.prototype.emplace=function(r,u,f,m,S,P,V,te,he,Te,we,lt,Lt){var St=12*r;return this.int16[St+0]=u,this.int16[St+1]=f,this.int16[St+2]=m,this.int16[St+3]=S,this.uint16[St+4]=P,this.uint16[St+5]=V,this.uint16[St+6]=te,this.uint16[St+7]=he,this.int16[St+8]=Te,this.int16[St+9]=we,this.int16[St+10]=lt,this.int16[St+11]=Lt,r},t}($a);yf.prototype.bytesPerElement=24,Rn("StructArrayLayout4i4ui4i24",yf);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=m,r},t}($a);Ul.prototype.bytesPerElement=12,Rn("StructArrayLayout3f12",Ul);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}($a);Bl.prototype.bytesPerElement=4,Rn("StructArrayLayout1ul4",Bl);var _c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,te,he){var Te=this.length;return this.resize(Te+1),this.emplace(Te,r,u,f,m,S,P,V,te,he)},t.prototype.emplace=function(r,u,f,m,S,P,V,te,he,Te){var we=10*r,lt=5*r;return this.int16[we+0]=u,this.int16[we+1]=f,this.int16[we+2]=m,this.int16[we+3]=S,this.int16[we+4]=P,this.int16[we+5]=V,this.uint32[lt+3]=te,this.uint16[we+8]=he,this.uint16[we+9]=Te,r},t}($a);_c.prototype.bytesPerElement=20,Rn("StructArrayLayout6i1ul2ui20",_c);var fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=f,this.int16[te+2]=m,this.int16[te+3]=S,this.int16[te+4]=P,this.int16[te+5]=V,r},t}($a);fs.prototype.bytesPerElement=12,Rn("StructArrayLayout2i2i2i12",fs);var Bu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,u,f,m,S)},t.prototype.emplace=function(r,u,f,m,S,P){var V=4*r,te=8*r;return this.float32[V+0]=u,this.float32[V+1]=f,this.float32[V+2]=m,this.int16[te+6]=S,this.int16[te+7]=P,r},t}($a);Bu.prototype.bytesPerElement=16,Rn("StructArrayLayout2f1f2i16",Bu);var Fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=12*r,V=3*r;return this.uint8[P+0]=u,this.uint8[P+1]=f,this.float32[V+1]=m,this.float32[V+2]=S,r},t}($a);Fc.prototype.bytesPerElement=12,Rn("StructArrayLayout2ub2f12",Fc);var Al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=m,r},t}($a);Al.prototype.bytesPerElement=6,Rn("StructArrayLayout3ui6",Al);var Vu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir){var br=this.length;return this.resize(br+1),this.emplace(br,r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir)},t.prototype.emplace=function(r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir,br){var Sr=24*r,zr=12*r,Nr=48*r;return this.int16[Sr+0]=u,this.int16[Sr+1]=f,this.uint16[Sr+2]=m,this.uint16[Sr+3]=S,this.uint32[zr+2]=P,this.uint32[zr+3]=V,this.uint32[zr+4]=te,this.uint16[Sr+10]=he,this.uint16[Sr+11]=Te,this.uint16[Sr+12]=we,this.float32[zr+7]=lt,this.float32[zr+8]=Lt,this.uint8[Nr+36]=St,this.uint8[Nr+37]=$t,this.uint8[Nr+38]=Xt,this.uint32[zr+10]=ir,this.int16[Sr+22]=br,r},t}($a);Vu.prototype.bytesPerElement=48,Rn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vu);var tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir,br,Sr,zr,Nr,mn,hn,Ln,Qn,Yn,Nn,Ta){var fa=this.length;return this.resize(fa+1),this.emplace(fa,r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir,br,Sr,zr,Nr,mn,hn,Ln,Qn,Yn,Nn,Ta)},t.prototype.emplace=function(r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St,$t,Xt,ir,br,Sr,zr,Nr,mn,hn,Ln,Qn,Yn,Nn,Ta,fa){var ra=34*r,Ja=17*r;return this.int16[ra+0]=u,this.int16[ra+1]=f,this.int16[ra+2]=m,this.int16[ra+3]=S,this.int16[ra+4]=P,this.int16[ra+5]=V,this.int16[ra+6]=te,this.int16[ra+7]=he,this.uint16[ra+8]=Te,this.uint16[ra+9]=we,this.uint16[ra+10]=lt,this.uint16[ra+11]=Lt,this.uint16[ra+12]=St,this.uint16[ra+13]=$t,this.uint16[ra+14]=Xt,this.uint16[ra+15]=ir,this.uint16[ra+16]=br,this.uint16[ra+17]=Sr,this.uint16[ra+18]=zr,this.uint16[ra+19]=Nr,this.uint16[ra+20]=mn,this.uint16[ra+21]=hn,this.uint16[ra+22]=Ln,this.uint32[Ja+12]=Qn,this.float32[Ja+13]=Yn,this.float32[Ja+14]=Nn,this.float32[Ja+15]=Ta,this.float32[Ja+16]=fa,r},t}($a);tc.prototype.bytesPerElement=68,Rn("StructArrayLayout8i15ui1ul4f68",tc);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}($a);Gu.prototype.bytesPerElement=4,Rn("StructArrayLayout1f4",Gu);var Ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=m,r},t}($a);Ds.prototype.bytesPerElement=6,Rn("StructArrayLayout3i6",Ds);var nf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=4*r;return this.uint32[2*r+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=m,r},t}($a);nf.prototype.bytesPerElement=8,Rn("StructArrayLayout1ul2ui8",nf);var rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.uint16[m+0]=u,this.uint16[m+1]=f,r},t}($a);rc.prototype.bytesPerElement=4,Rn("StructArrayLayout2ui4",rc);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}($a);nc.prototype.bytesPerElement=2,Rn("StructArrayLayout1ui2",nc);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=4*r;return this.float32[P+0]=u,this.float32[P+1]=f,this.float32[P+2]=m,this.float32[P+3]=S,r},t}($a);ac.prototype.bytesPerElement=16,Rn("StructArrayLayout4f16",ac);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new re(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(ec);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(_c);Rn("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(ec);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Vu);Rn("PlacedSymbolArray",l);var v=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(ec);v.prototype.size=68;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new v(this,r)},t}(tc);Rn("SymbolInstanceArray",O);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Gu);Rn("GlyphOffsetArray",L);var j=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ds);Rn("SymbolLineVertexArray",j);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(ec);ue.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(nf);Rn("FeatureIndexArray",Ee);var $e=no([{name:"a_pos",components:2,type:"Int16"}],4).members,rt=function(t){t===void 0&&(t=[]),this.segments=t};function at(e,t){return 256*(e=Ce(Math.floor(e),0,255))+Ce(Math.floor(t),0,255)}rt.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>rt.MAX_VERTEX_ARRAY_LENGTH&&Me("Max vertices per segment is "+rt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>rt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},rt.prototype.get=function(){return this.segments},rt.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},rt.simpleSegment=function(e,t,r,u){return new rt([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn("SegmentVector",rt);var zt=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Nt=Z(function(e){e.exports=function(t,r){var u,f,m,S,P,V,te,he;for(f=t.length-(u=3&t.length),m=r,P=3432918353,V=461845907,he=0;he<f;)te=255&t.charCodeAt(he)|(255&t.charCodeAt(++he))<<8|(255&t.charCodeAt(++he))<<16|(255&t.charCodeAt(++he))<<24,++he,m=27492+(65535&(S=5*(65535&(m=(m^=te=(65535&(te=(te=(65535&te)*P+(((te>>>16)*P&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(te=0,u){case 3:te^=(255&t.charCodeAt(he+2))<<16;case 2:te^=(255&t.charCodeAt(he+1))<<8;case 1:m^=te=(65535&(te=(te=(65535&(te^=255&t.charCodeAt(he)))*P+(((te>>>16)*P&65535)<<16)&4294967295)<<15|te>>>17))*V+(((te>>>16)*V&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),Jt=Z(function(e){e.exports=function(t,r){for(var u,f=t.length,m=r^f,S=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++S;switch(f){case 3:m^=(255&t.charCodeAt(S+2))<<16;case 2:m^=(255&t.charCodeAt(S+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(S)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),jt=Nt,Gt=Jt;jt.murmur3=Nt,jt.murmur2=Gt;var ar=function(){this.ids=[],this.positions=[],this.indexed=!1};ar.prototype.add=function(e,t,r,u){this.ids.push(Rr(e)),this.positions.push(t,r,u)},ar.prototype.getPositions=function(e){for(var t=Rr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var m=[];this.ids[r]===t;)m.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return m},ar.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(m,S,P,V){for(;P<V;){for(var te=m[P+V>>1],he=P-1,Te=V+1;;){do he++;while(m[he]<te);do Te--;while(m[Te]>te);if(he>=Te)break;gr(m,he,Te),gr(S,3*he,3*Te),gr(S,3*he+1,3*Te+1),gr(S,3*he+2,3*Te+2)}Te-P<V-Te?(f(m,S,P,Te),P=Te+1):(f(m,S,Te+1,V),V=Te)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},ar.deserialize=function(e){var t=new ar;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var nr=Math.pow(2,53)-1;function Rr(e){var t=+e;return!isNaN(t)&&t<=nr?t:jt(String(e))}function gr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}Rn("FeaturePositionMap",ar);var Ar=function(t,r){this.gl=t.gl,this.location=r},Cr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Ar),an=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Ar),Yr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Ar),vn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Ar),Pn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Ar),qn=function(e){function t(r,u){e.call(this,r,u),this.current=ha.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Ar),sa=new Float32Array(16),Aa=function(e){function t(r,u){e.call(this,r,u),this.current=sa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Ar);function Wa(e){return[at(255*e.r,255*e.g),at(255*e.b,255*e.a)]}var Tn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};Tn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Tn.prototype.getBinding=function(e,t,r){return this.type==="color"?new qn(e,t):new an(e,t)};var ua=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ua.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ua.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ua.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Pn(e,t):new an(e,t)};var xa=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(m){return{name:"a_"+m,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};xa.prototype.populatePaintArray=function(e,t,r,u,f){var m=this.paintVertexArray.length,S=this.expression.evaluate(new Pa(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,S)},xa.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},xa.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Wa(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},xa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Zn=function(t,r,u,f,m,S){this.expression=t,this.uniformNames=r.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(function(P){return{name:"a_"+P,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new S};Zn.prototype.populatePaintArray=function(e,t,r,u,f){var m=this.expression.evaluate(new Pa(this.zoom),t,{},u,[],f),S=this.expression.evaluate(new Pa(this.zoom+1),t,{},u,[],f),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,m,S)},Zn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),m=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,m)},Zn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Wa(r),m=Wa(u),S=e;S<t;S++)this.paintVertexArray.emplace(S,f[0],f[1],m[0],m[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Zn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Zn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Zn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=Ce(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Zn.prototype.getBinding=function(e,t,r){return new an(e,t)};var Ca=function(t,r,u,f,m,S){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=S,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Ca.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Ca.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Ca.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],m=u[r.mid],S=u[r.max];if(f&&m&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,m.tl[0],m.tl[1],m.br[0],m.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],m.pixelRatio,S.pixelRatio)}},Ca.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,zt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,zt.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ia=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var m in t.paint._values)if(u(m)){var S=t.paint.get(m);if(S instanceof Cs&&Tu(S.property.specification)){var P=Fa(m,t.type),V=S.value,te=S.property.specification.type,he=S.property.useIntegerZoom,Te=S.property.specification["property-type"],we=Te==="cross-faded"||Te==="cross-faded-data-driven";if(V.kind==="constant")this.binders[m]=we?new ua(V.value,P):new Tn(V.value,P,te),f.push("/u_"+m);else if(V.kind==="source"||we){var lt=Hi(m,te,"source");this.binders[m]=we?new Ca(V,te,he,r,lt,t.id):new xa(V,P,te,lt),f.push("/a_"+m)}else{var Lt=Hi(m,te,"composite");this.binders[m]=new Zn(V,P,te,he,r,Lt),f.push("/z_"+m)}}}this.cacheKey=f.sort().join("")};ia.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof xa||t instanceof Zn?t.maxValue:0},ia.prototype.populatePaintArrays=function(e,t,r,u,f){for(var m in this.binders){var S=this.binders[m];(S instanceof xa||S instanceof Zn||S instanceof Ca)&&S.populatePaintArray(e,t,r,u,f)}},ia.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ua&&u.setConstantPatternPositions(e,t)}},ia.prototype.updatePaintArrays=function(e,t,r,u,f){var m=!1;for(var S in e)for(var P=0,V=t.getPositions(S);P<V.length;P+=1){var te=V[P],he=r.feature(te.index);for(var Te in this.binders){var we=this.binders[Te];if((we instanceof xa||we instanceof Zn||we instanceof Ca)&&we.expression.isStateDependent===!0){var lt=u.paint.get(Te);we.expression=lt.value,we.updatePaintArray(te.start,te.end,he,e[S],f),m=!0}}}return m},ia.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Tn||r instanceof ua)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},ia.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof xa||r instanceof Zn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Ca)for(var f=0;f<zt.members.length;f++)e.push(zt.members[f].name)}return e},ia.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Tn||r instanceof ua||r instanceof Zn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},ia.prototype.getPaintVertexBuffers=function(){return this._buffers},ia.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof Tn||f instanceof ua||f instanceof Zn)for(var m=0,S=f.uniformNames;m<S.length;m+=1){var P=S[m];if(t[P]){var V=f.getBinding(e,t[P],P);r.push({name:P,property:u,binding:V})}}}return r},ia.prototype.setUniforms=function(e,t,r,u){for(var f=0,m=t;f<m.length;f+=1){var S=m[f],P=S.name,V=S.property;this.binders[V].setUniform(S.binding,u,r.get(V),P)}},ia.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ca){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof xa||r instanceof Zn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ia.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof xa||r instanceof Zn||r instanceof Ca)&&r.upload(e)}this.updatePaintBuffers()},ia.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof xa||t instanceof Zn||t instanceof Ca)&&t.destroy()}};var La=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,m=t;f<m.length;f+=1){var S=m[f];this.programConfigurations[S.id]=new ia(S,r,u)}this.needsUpload=!1,this._featureMap=new ar,this._bufferOffset=0};function Fa(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Hi(e,t,r){var u={color:{source:zc,composite:ac},number:{source:Gu,composite:zc}},f=function(m){return{"line-pattern":{source:Gs,composite:Gs},"fill-pattern":{source:Gs,composite:Gs},"fill-extrusion-pattern":{source:Gs,composite:Gs}}[m]}(e);return f&&f[r]||u[t][r]}La.prototype.populatePaintArrays=function(e,t,r,u,f,m){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,u,f,m);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},La.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,m=r;f<m.length;f+=1){var S=m[f];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,u)||this.needsUpload}},La.prototype.get=function(e){return this.programConfigurations[e]},La.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},La.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Rn("ConstantBinder",Tn),Rn("CrossFadedConstantBinder",ua),Rn("SourceExpressionBinder",xa),Rn("CrossFadedCompositeBinder",Ca),Rn("CompositeExpressionBinder",Zn),Rn("ProgramConfiguration",ia,{omit:["_buffers"]}),Rn("ProgramConfigurationSet",La);var Ai=Math.pow(2,14)-1,Ni=-Ai-1;function Ei(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],m=0;m<f.length;m++){var S=f[m],P=Math.round(S.x*t),V=Math.round(S.y*t);S.x=Ce(P,Ni,Ai),S.y=Ce(V,Ni,Ai),(P<S.x||P>S.x+1||V<S.y||V>S.y+1)&&Me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Bi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ei(e):[]}}function es(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var ts=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new Al,this.segments=new rt,this.programConfigurations=new La(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function vu(e,t){for(var r=0;r<e.length;r++)if(ru(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(ru(e,t[u]))return!0;return!!Ou(e,t)}function wu(e,t,r){return!!ru(e,t)||!!tu(t,e,r)}function hs(e,t){if(e.length===1)return oc(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(ru(e,u[f]))return!0;for(var m=0;m<e.length;m++)if(oc(t,e[m]))return!0;for(var S=0;S<t.length;S++)if(Ou(e,t[S]))return!0;return!1}function Hs(e,t,r){if(e.length>1){if(Ou(e,t))return!0;for(var u=0;u<t.length;u++)if(tu(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(tu(e[f],t,r))return!0;return!1}function Ou(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],m=0;m<t.length-1;m++)if(ic(u,f,t[m],t[m+1]))return!0;return!1}function ic(e,t,r,u){return ht(e,r,u)!==ht(t,r,u)&&ht(e,t,r)!==ht(e,t,u)}function tu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Hu(e,t[f-1],t[f])<u)return!0;return!1}function Hu(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function oc(e,t){for(var r,u,f,m=!1,S=0;S<e.length;S++)for(var P=0,V=(r=e[S]).length-1;P<r.length;V=P++)(u=r[P]).y>t.y!=(f=r[V]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(m=!m);return m}function ru(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var m=e[u],S=e[f];m.y>t.y!=S.y>t.y&&t.x<(S.x-m.x)*(t.y-m.y)/(S.y-m.y)+m.x&&(r=!r)}return r}function Mu(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var m=ht(e,t,r[0]);return m!==ht(e,t,r[1])||m!==ht(e,t,r[2])||m!==ht(e,t,r[3])}function ds(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ao(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Zu(e,t,r,u,f){if(!t[0]&&!t[1])return e;var m=re.convert(t)._mult(f);r==="viewport"&&m._rotate(-u);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(m));return S}ts.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],m=null;u.type==="circle"&&(m=u.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var V=P[S],te=V.feature,he=V.id,Te=V.index,we=V.sourceLayerIndex,lt=this.layers[0]._featureFilter.needGeometry,Lt=Bi(te,lt);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Lt,r)){var St=m?m.evaluate(Lt,{},r):void 0,$t={id:he,properties:te.properties,type:te.type,sourceLayerIndex:we,index:Te,geometry:lt?Lt.geometry:Ei(te),patterns:{},sortKey:St};f.push($t)}}m&&f.sort(function(hn,Ln){return hn.sortKey-Ln.sortKey});for(var Xt=0,ir=f;Xt<ir.length;Xt+=1){var br=ir[Xt],Sr=br.geometry,zr=br.index,Nr=br.sourceLayerIndex,mn=e[zr].feature;this.addFeature(br,Sr,zr,r),t.featureIndex.insert(mn,Sr,zr,Nr,this.index)}},ts.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ts.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ts.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ts.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ts.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ts.prototype.addFeature=function(e,t,r,u){for(var f=0,m=t;f<m.length;f+=1)for(var S=0,P=m[f];S<P.length;S+=1){var V=P[S],te=V.x,he=V.y;if(!(te<0||te>=8192||he<0||he>=8192)){var Te=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),we=Te.vertexLength;es(this.layoutVertexArray,te,he,-1,-1),es(this.layoutVertexArray,te,he,1,-1),es(this.layoutVertexArray,te,he,1,1),es(this.layoutVertexArray,te,he,-1,1),this.indexArray.emplaceBack(we,we+1,we+2),this.indexArray.emplaceBack(we,we+3,we+2),Te.vertexLength+=4,Te.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},Rn("CircleBucket",ts,{omit:["layers"]});var Vl=new vo({"circle-sort-key":new jn(Ze.layout_circle["circle-sort-key"])}),ps={paint:new vo({"circle-radius":new jn(Ze.paint_circle["circle-radius"]),"circle-color":new jn(Ze.paint_circle["circle-color"]),"circle-blur":new jn(Ze.paint_circle["circle-blur"]),"circle-opacity":new jn(Ze.paint_circle["circle-opacity"]),"circle-translate":new Jn(Ze.paint_circle["circle-translate"]),"circle-translate-anchor":new Jn(Ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jn(Ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jn(Ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(Ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(Ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(Ze.paint_circle["circle-stroke-opacity"])}),layout:Vl},No=typeof Float32Array!="undefined"?Float32Array:Array;function ko(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ko(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3],P=t[4],V=t[5],te=t[6],he=t[7],Te=t[8],we=t[9],lt=t[10],Lt=t[11],St=t[12],$t=t[13],Xt=t[14],ir=t[15],br=r[0],Sr=r[1],zr=r[2],Nr=r[3];return e[0]=br*u+Sr*P+zr*Te+Nr*St,e[1]=br*f+Sr*V+zr*we+Nr*$t,e[2]=br*m+Sr*te+zr*lt+Nr*Xt,e[3]=br*S+Sr*he+zr*Lt+Nr*ir,e[4]=(br=r[4])*u+(Sr=r[5])*P+(zr=r[6])*Te+(Nr=r[7])*St,e[5]=br*f+Sr*V+zr*we+Nr*$t,e[6]=br*m+Sr*te+zr*lt+Nr*Xt,e[7]=br*S+Sr*he+zr*Lt+Nr*ir,e[8]=(br=r[8])*u+(Sr=r[9])*P+(zr=r[10])*Te+(Nr=r[11])*St,e[9]=br*f+Sr*V+zr*we+Nr*$t,e[10]=br*m+Sr*te+zr*lt+Nr*Xt,e[11]=br*S+Sr*he+zr*Lt+Nr*ir,e[12]=(br=r[12])*u+(Sr=r[13])*P+(zr=r[14])*Te+(Nr=r[15])*St,e[13]=br*f+Sr*V+zr*we+Nr*$t,e[14]=br*m+Sr*te+zr*lt+Nr*Xt,e[15]=br*S+Sr*he+zr*Lt+Nr*ir,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Ao,uo=Ko;function Ns(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*m+r[12]*S,e[1]=r[1]*u+r[5]*f+r[9]*m+r[13]*S,e[2]=r[2]*u+r[6]*f+r[10]*m+r[14]*S,e[3]=r[3]*u+r[7]*f+r[11]*m+r[15]*S,e}Ao=new No(3),No!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new No(4);No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nu=(function(){var e=new No(2);No!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,ps)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ts(r)},t.prototype.queryRadius=function(r){var u=r;return ds("circle-radius",this,u)+ds("circle-stroke-width",this,u)+ao(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V,te){for(var he=Zu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,V),Te=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),we=this.paint.get("circle-pitch-alignment")==="map",lt=we?he:function(mn,hn){return mn.map(function(Ln){return Gl(Ln,hn)})}(he,te),Lt=we?Te*V:Te,St=0,$t=m;St<$t.length;St+=1)for(var Xt=0,ir=$t[St];Xt<ir.length;Xt+=1){var br=ir[Xt],Sr=we?br:Gl(br,te),zr=Lt,Nr=Ns([],[br.x,br.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?zr*=Nr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(zr*=P.cameraToCenterDistance/Nr[3]),wu(lt,Sr,zr))return!0}return!1},t}(ws));function Gl(e,t){var r=Ns([],[e.x,e.y,0,1],t);return new re(r[0]/r[3],r[1]/r[3])}var Uc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ts);function fl(e,t,r,u){var f=t.width,m=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*m*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*m*r);return e.width=f,e.height=m,e.data=u,e}function sc(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var m=fl({},{width:u,height:f},r);hl(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=m.data}}function hl(e,t,r,u,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,V=0;V<f.height;V++)for(var te=((r.y+V)*e.width+r.x)*m,he=((u.y+V)*t.width+u.x)*m,Te=0;Te<f.width*m;Te++)P[he+Te]=S[te+Te];return t}Rn("HeatmapBucket",Uc,{omit:["layers"]});var ks=function(t,r){fl(this,t,1,r)};ks.prototype.resize=function(e){sc(this,e,1)},ks.prototype.clone=function(){return new ks({width:this.width,height:this.height},new Uint8Array(this.data))},ks.copy=function(e,t,r,u,f){hl(e,t,r,u,f,1)};var go=function(t,r){fl(this,t,4,r)};go.prototype.resize=function(e){sc(this,e,4)},go.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},go.prototype.clone=function(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))},go.copy=function(e,t,r,u,f){hl(e,t,r,u,f,4)},Rn("AlphaImage",ks),Rn("RGBAImage",go);var Tc={paint:new vo({"heatmap-radius":new jn(Ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(Ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jn(Ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Do(Ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jn(Ze.paint_heatmap["heatmap-opacity"])})};function ms(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new go({width:r,height:u}),m=function(St,$t,Xt){t[e.evaluationKey]=Xt;var ir=e.expression.evaluate(t);f.data[St+$t+0]=Math.floor(255*ir.r/ir.a),f.data[St+$t+1]=Math.floor(255*ir.g/ir.a),f.data[St+$t+2]=Math.floor(255*ir.b/ir.a),f.data[St+$t+3]=Math.floor(255*ir.a)};if(e.clips)for(var S=0,P=0;S<u;++S,P+=4*r)for(var V=0,te=0;V<r;V++,te+=4){var he=V/(r-1),Te=e.clips[S];m(P,te,Te.start*(1-he)+Te.end*he)}else for(var we=0,lt=0;we<r;we++,lt+=4)m(0,lt,we/(r-1));return f}var af=function(e){function t(r){e.call(this,r,Tc),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Uc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ms({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(ws),Sf={paint:new vo({"hillshade-illumination-direction":new Jn(Ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jn(Ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jn(Ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jn(Ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jn(Ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jn(Ze.paint_hillshade["hillshade-accent-color"])})},Af=function(e){function t(r){e.call(this,r,Sf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(ws),Sc=no([{name:"a_pos",components:2,type:"Int16"}],4).members,Wu=of,bf=of;function of(e,t,r){r=r||2;var u,f,m,S,P,V,te,he=t&&t.length,Te=he?t[0]*r:e.length,we=Cf(e,0,Te,r,!0),lt=[];if(!we||we.next===we.prev)return lt;if(he&&(we=function(St,$t,Xt,ir){var br,Sr,zr,Nr=[];for(br=0,Sr=$t.length;br<Sr;br++)(zr=Cf(St,$t[br]*ir,br<Sr-1?$t[br+1]*ir:St.length,ir,!1))===zr.next&&(zr.steiner=!0),Nr.push(eh(zr));for(Nr.sort(Jf),br=0;br<Nr.length;br++)Qf(Nr[br],Xt),Xt=Pu(Xt,Xt.next);return Xt}(e,t,we,r)),e.length>80*r){u=m=e[0],f=S=e[1];for(var Lt=r;Lt<Te;Lt+=r)(P=e[Lt])<u&&(u=P),(V=e[Lt+1])<f&&(f=V),P>m&&(m=P),V>S&&(S=V);te=(te=Math.max(m-u,S-f))!==0?1/te:0}return uc(we,lt,r,u,f,te),lt}function Cf(e,t,r,u,f){var m,S;if(f===Gc(e,t,r,u)>0)for(m=t;m<r;m+=u)S=Df(m,e[m],e[m+1],S);else for(m=r-u;m>=t;m-=u)S=Df(m,e[m],e[m+1],S);return S&&lc(S,S.next)&&(Vc(S),S=S.next),S}function Pu(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!lc(u,u.next)&&io(u.prev,u,u.next)!==0)u=u.next;else{if(Vc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function uc(e,t,r,u,f,m,S){if(e){!S&&m&&function(he,Te,we,lt){var Lt=he;do Lt.z===null&&(Lt.z=wf(Lt.x,Lt.y,Te,we,lt)),Lt.prevZ=Lt.prev,Lt.nextZ=Lt.next,Lt=Lt.next;while(Lt!==he);Lt.prevZ.nextZ=null,Lt.prevZ=null,function(St){var $t,Xt,ir,br,Sr,zr,Nr,mn,hn=1;do{for(Xt=St,St=null,Sr=null,zr=0;Xt;){for(zr++,ir=Xt,Nr=0,$t=0;$t<hn&&(Nr++,ir=ir.nextZ);$t++);for(mn=hn;Nr>0||mn>0&&ir;)Nr!==0&&(mn===0||!ir||Xt.z<=ir.z)?(br=Xt,Xt=Xt.nextZ,Nr--):(br=ir,ir=ir.nextZ,mn--),Sr?Sr.nextZ=br:St=br,br.prevZ=Sr,Sr=br;Xt=ir}Sr.nextZ=null,hn*=2}while(zr>1)}(Lt)}(e,u,f,m);for(var P,V,te=e;e.prev!==e.next;)if(P=e.prev,V=e.next,m?Bc(e,u,f,m):If(e))t.push(P.i/r),t.push(e.i/r),t.push(V.i/r),Vc(e),e=V.next,te=V.next;else if((e=V)===te){S?S===1?uc(e=Ac(Pu(e),t,r),t,r,u,f,m,2):S===2&&$f(e,t,r,u,f,m):uc(Pu(e),t,r,u,f,m,1);break}}}function If(e){var t=e.prev,r=e,u=e.next;if(io(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Hl(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&io(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Bc(e,t,r,u){var f=e.prev,m=e,S=e.next;if(io(f,m,S)>=0)return!1;for(var P=f.x>m.x?f.x>S.x?f.x:S.x:m.x>S.x?m.x:S.x,V=f.y>m.y?f.y>S.y?f.y:S.y:m.y>S.y?m.y:S.y,te=wf(f.x<m.x?f.x<S.x?f.x:S.x:m.x<S.x?m.x:S.x,f.y<m.y?f.y<S.y?f.y:S.y:m.y<S.y?m.y:S.y,t,r,u),he=wf(P,V,t,r,u),Te=e.prevZ,we=e.nextZ;Te&&Te.z>=te&&we&&we.z<=he;){if(Te!==e.prev&&Te!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,Te.x,Te.y)&&io(Te.prev,Te,Te.next)>=0)return!1;if(Te=Te.prevZ,we!==e.prev&&we!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,we.x,we.y)&&io(we.prev,we,we.next)>=0)return!1;we=we.nextZ}for(;Te&&Te.z>=te;){if(Te!==e.prev&&Te!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,Te.x,Te.y)&&io(Te.prev,Te,Te.next)>=0)return!1;Te=Te.prevZ}for(;we&&we.z<=he;){if(we!==e.prev&&we!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,we.x,we.y)&&io(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function Ac(e,t,r){var u=e;do{var f=u.prev,m=u.next.next;!lc(f,m)&&xf(f,u,u.next,m)&&Cl(f,m)&&Cl(m,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(m.i/r),Vc(u),Vc(u.next),u=e=m),u=u.next}while(u!==e);return Pu(u)}function $f(e,t,r,u,f,m){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&sf(S,P)){var V=Ef(S,P);return S=Pu(S,S.next),V=Pu(V,V.next),uc(S,t,r,u,f,m),void uc(V,t,r,u,f,m)}P=P.next}S=S.next}while(S!==e)}function Jf(e,t){return e.x-t.x}function Qf(e,t){if(t=function(u,f){var m,S=f,P=u.x,V=u.y,te=-1/0;do{if(V<=S.y&&V>=S.next.y&&S.next.y!==S.y){var he=S.x+(V-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(he<=P&&he>te){if(te=he,he===P){if(V===S.y)return S;if(V===S.next.y)return S.next}m=S.x<S.next.x?S:S.next}}S=S.next}while(S!==f);if(!m)return null;if(P===te)return m;var Te,we=m,lt=m.x,Lt=m.y,St=1/0;S=m;do P>=S.x&&S.x>=lt&&P!==S.x&&Hl(V<Lt?P:te,V,lt,Lt,V<Lt?te:P,V,S.x,S.y)&&(Te=Math.abs(V-S.y)/(P-S.x),Cl(S,u)&&(Te<St||Te===St&&(S.x>m.x||S.x===m.x&&qf(m,S)))&&(m=S,St=Te)),S=S.next;while(S!==we);return m}(e,t)){var r=Ef(t,e);Pu(t,t.next),Pu(r,r.next)}}function qf(e,t){return io(e.prev,e,t.prev)<0&&io(t.next,e,e.next)<0}function wf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function eh(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Hl(e,t,r,u,f,m,S,P){return(f-S)*(t-P)-(e-S)*(m-P)>=0&&(e-S)*(u-P)-(r-S)*(t-P)>=0&&(r-S)*(m-P)-(f-S)*(u-P)>=0}function sf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&xf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Cl(e,t)&&Cl(t,e)&&function(r,u){var f=r,m=!1,S=(r.x+u.x)/2,P=(r.y+u.y)/2;do f.y>P!=f.next.y>P&&f.next.y!==f.y&&S<(f.next.x-f.x)*(P-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==r);return m}(e,t)&&(io(e.prev,e,t.prev)||io(e,t.prev,t))||lc(e,t)&&io(e.prev,e,e.next)>0&&io(t.prev,t,t.next)>0)}function io(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function lc(e,t){return e.x===t.x&&e.y===t.y}function xf(e,t,r,u){var f=au(io(e,t,r)),m=au(io(e,t,u)),S=au(io(r,u,e)),P=au(io(r,u,t));return f!==m&&S!==P||!(f!==0||!Cc(e,r,t))||!(m!==0||!Cc(e,u,t))||!(S!==0||!Cc(r,e,u))||!(P!==0||!Cc(r,t,u))}function Cc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function au(e){return e>0?1:e<0?-1:0}function Cl(e,t){return io(e.prev,e,e.next)<0?io(e,t,e.next)>=0&&io(e,e.prev,t)>=0:io(e,t,e.prev)<0||io(e,e.next,t)<0}function Ef(e,t){var r=new uf(e.i,e.x,e.y),u=new uf(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,m.next=u,u.prev=m,u}function Df(e,t,r,u){var f=new uf(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Vc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function uf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gc(e,t,r,u){for(var f=0,m=t,S=r-u;m<r;m+=u)f+=(e[S]-e[m])*(e[m+1]+e[S+1]),S=m;return f}function dl(e,t,r,u,f){!function m(S,P,V,te,he){for(;te>V;){if(te-V>600){var Te=te-V+1,we=P-V+1,lt=Math.log(Te),Lt=.5*Math.exp(2*lt/3),St=.5*Math.sqrt(lt*Lt*(Te-Lt)/Te)*(we-Te/2<0?-1:1);m(S,P,Math.max(V,Math.floor(P-we*Lt/Te+St)),Math.min(te,Math.floor(P+(Te-we)*Lt/Te+St)),he)}var $t=S[P],Xt=V,ir=te;for(ne(S,V,P),he(S[te],$t)>0&&ne(S,V,te);Xt<ir;){for(ne(S,Xt,ir),Xt++,ir--;he(S[Xt],$t)<0;)Xt++;for(;he(S[ir],$t)>0;)ir--}he(S[V],$t)===0?ne(S,V,ir):ne(S,++ir,te),ir<=P&&(V=ir+1),P<=ir&&(te=ir-1)}}(e,t,r||0,u||e.length-1,f||se)}function ne(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function se(e,t){return e<t?-1:e>t?1:0}function N(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,m=[],S=0;S<r;S++){var P=Wt(e[S]);P!==0&&(e[S].area=Math.abs(P),f===void 0&&(f=P<0),f===P<0?(u&&m.push(u),u=[e[S]]):u.push(e[S]))}if(u&&m.push(u),t>1)for(var V=0;V<m.length;V++)m[V].length<=t||(dl(m[V],t,1,m[V].length-1,G),m[V]=m[V].slice(0,t));return m}function G(e,t){return t.area-e.area}function Ae(e,t,r){for(var u=r.patternDependencies,f=!1,m=0,S=t;m<S.length;m+=1){var P=S[m].paint.get(e+"-pattern");P.isConstant()||(f=!0);var V=P.constantOr(null);V&&(f=!0,u[V.to]=!0,u[V.from]=!0)}return f}function ct(e,t,r,u,f){for(var m=f.patternDependencies,S=0,P=t;S<P.length;S+=1){var V=P[S],te=V.paint.get(e+"-pattern").value;if(te.kind!=="constant"){var he=te.evaluate({zoom:u-1},r,{},f.availableImages),Te=te.evaluate({zoom:u},r,{},f.availableImages),we=te.evaluate({zoom:u+1},r,{},f.availableImages);Te=Te&&Te.name?Te.name:Te,we=we&&we.name?we.name:we,m[he=he&&he.name?he.name:he]=!0,m[Te]=!0,m[we]=!0,r.patterns[V.id]={min:he,mid:Te,max:we}}}return r}of.deviation=function(e,t,r,u){var f=t&&t.length,m=Math.abs(Gc(e,0,f?t[0]*r:e.length,r));if(f)for(var S=0,P=t.length;S<P;S++)m-=Math.abs(Gc(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var V=0;for(S=0;S<u.length;S+=3){var te=u[S]*r,he=u[S+1]*r,Te=u[S+2]*r;V+=Math.abs((e[te]-e[Te])*(e[he+1]-e[te+1])-(e[te]-e[he])*(e[Te+1]-e[te+1]))}return m===0&&V===0?0:Math.abs((V-m)/m)},of.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var S=0;S<t;S++)r.vertices.push(e[f][m][S]);f>0&&r.holes.push(u+=e[f-1].length)}return r},Wu.default=bf;var Yt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mu,this.indexArray=new Al,this.indexArray2=new rc,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.segments2=new rt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Yt.prototype.populate=function(e,t,r){this.hasPattern=Ae("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,S=e;m<S.length;m+=1){var P=S[m],V=P.feature,te=P.id,he=P.index,Te=P.sourceLayerIndex,we=this.layers[0]._featureFilter.needGeometry,lt=Bi(V,we);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Lt=u?u.evaluate(lt,{},r,t.availableImages):void 0,St={id:te,properties:V.properties,type:V.type,sourceLayerIndex:Te,index:he,geometry:we?lt.geometry:Ei(V),patterns:{},sortKey:Lt};f.push(St)}}u&&f.sort(function(mn,hn){return mn.sortKey-hn.sortKey});for(var $t=0,Xt=f;$t<Xt.length;$t+=1){var ir=Xt[$t],br=ir.geometry,Sr=ir.index,zr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=ct("fill",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,br,Sr,r,{});t.featureIndex.insert(e[Sr].feature,br,Sr,zr,this.index)}},Yt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Yt.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},Yt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Yt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Yt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Yt.prototype.addFeature=function(e,t,r,u,f){for(var m=0,S=N(t,500);m<S.length;m+=1){for(var P=S[m],V=0,te=0,he=P;te<he.length;te+=1)V+=he[te].length;for(var Te=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),we=Te.vertexLength,lt=[],Lt=[],St=0,$t=P;St<$t.length;St+=1){var Xt=$t[St];if(Xt.length!==0){Xt!==P[0]&&Lt.push(lt.length/2);var ir=this.segments2.prepareSegment(Xt.length,this.layoutVertexArray,this.indexArray2),br=ir.vertexLength;this.layoutVertexArray.emplaceBack(Xt[0].x,Xt[0].y),this.indexArray2.emplaceBack(br+Xt.length-1,br),lt.push(Xt[0].x),lt.push(Xt[0].y);for(var Sr=1;Sr<Xt.length;Sr++)this.layoutVertexArray.emplaceBack(Xt[Sr].x,Xt[Sr].y),this.indexArray2.emplaceBack(br+Sr-1,br+Sr),lt.push(Xt[Sr].x),lt.push(Xt[Sr].y);ir.vertexLength+=Xt.length,ir.primitiveLength+=Xt.length}}for(var zr=Wu(lt,Lt),Nr=0;Nr<zr.length;Nr+=3)this.indexArray.emplaceBack(we+zr[Nr],we+zr[Nr+1],we+zr[Nr+2]);Te.vertexLength+=V,Te.primitiveLength+=zr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Rn("FillBucket",Yt,{omit:["layers","patternFeatures"]});var sr=new vo({"fill-sort-key":new jn(Ze.layout_fill["fill-sort-key"])}),or={paint:new vo({"fill-antialias":new Jn(Ze.paint_fill["fill-antialias"]),"fill-opacity":new jn(Ze.paint_fill["fill-opacity"]),"fill-color":new jn(Ze.paint_fill["fill-color"]),"fill-outline-color":new jn(Ze.paint_fill["fill-outline-color"]),"fill-translate":new Jn(Ze.paint_fill["fill-translate"]),"fill-translate-anchor":new Jn(Ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ec(Ze.paint_fill["fill-pattern"])}),layout:sr},Dr=function(e){function t(r){e.call(this,r,or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Yt(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V){return hs(Zu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,V),m)},t.prototype.isTileClipped=function(){return!0},t}(ws),sn=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hn=ea;function ea(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(la,this,t)}function la(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var m=u.readVarint()+u.pos;u.pos<m;){var S=f._keys[u.readVarint()],P=f._values[u.readVarint()];f.properties[S]=P}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function ti(e){for(var t,r,u=0,f=0,m=e.length,S=m-1;f<m;S=f++)u+=((r=e[S]).x-(t=e[f]).x)*(t.y+r.y);return u}ea.types=["Unknown","Point","LineString","Polygon"],ea.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,m=0,S=0,P=[];e.pos<r;){if(f<=0){var V=e.readVarint();u=7&V,f=V>>3}if(f--,u===1||u===2)m+=e.readSVarint(),S+=e.readSVarint(),u===1&&(t&&P.push(t),t=[]),t.push(new re(m,S));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&P.push(t),P},ea.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,m=0,S=1/0,P=-1/0,V=1/0,te=-1/0;e.pos<t;){if(u<=0){var he=e.readVarint();r=7&he,u=he>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<S&&(S=f),f>P&&(P=f),(m+=e.readSVarint())<V&&(V=m),m>te&&(te=m);else if(r!==7)throw new Error("unknown command "+r)}return[S,V,P,te]},ea.prototype.toGeoJSON=function(e,t,r){var u,f,m=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,V=this.loadGeometry(),te=ea.types[this.type];function he(lt){for(var Lt=0;Lt<lt.length;Lt++){var St=lt[Lt];lt[Lt]=[360*(St.x+S)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(St.y+P)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var Te=[];for(u=0;u<V.length;u++)Te[u]=V[u][0];he(V=Te);break;case 2:for(u=0;u<V.length;u++)he(V[u]);break;case 3:for(V=function(lt){var Lt=lt.length;if(Lt<=1)return[lt];for(var St,$t,Xt=[],ir=0;ir<Lt;ir++){var br=ti(lt[ir]);br!==0&&($t===void 0&&($t=br<0),$t===br<0?(St&&Xt.push(St),St=[lt[ir]]):St.push(lt[ir]))}return St&&Xt.push(St),Xt}(V),u=0;u<V.length;u++)for(f=0;f<V[u].length;f++)he(V[u][f])}V.length===1?V=V[0]:te="Multi"+te;var we={type:"Feature",geometry:{type:te,coordinates:V},properties:this.properties};return"id"in this&&(we.id=this.id),we};var ja=_i;function _i(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Qa,this,t),this.length=this._features.length}function Qa(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,m=u.readVarint()+u.pos;u.pos<m;){var S=u.readVarint()>>3;f=S===1?u.readString():S===2?u.readFloat():S===3?u.readDouble():S===4?u.readVarint64():S===5?u.readVarint():S===6?u.readSVarint():S===7?u.readBoolean():null}return f}(r))}function Vi(e,t,r){if(e===3){var u=new ja(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}_i.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Hn(this._pbf,t,this.extent,this._keys,this._values)};var Co={VectorTile:function(t,r){this.layers=t.readFields(Vi,{},r)},VectorTileFeature:Hn,VectorTileLayer:ja},yo=Co.VectorTileFeature.types,Zi=Math.pow(2,13);function jo(e,t,r,u,f,m,S,P){e.emplaceBack(t,r,2*Math.floor(u*Zi)+S,f*Zi*2,m*Zi*2,Math.round(P))}var qa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Cu,this.indexArray=new Al,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function lo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}qa.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ae("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var m=f[u],S=m.feature,P=m.id,V=m.index,te=m.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,Te=Bi(S,he);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Te,r)){var we={id:P,sourceLayerIndex:te,index:V,geometry:he?Te.geometry:Ei(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(ct("fill-extrusion",this.layers,we,this.zoom,t)):this.addFeature(we,we.geometry,V,r,{}),t.featureIndex.insert(S,we.geometry,V,te,this.index,!0)}}},qa.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},qa.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qa.prototype.addFeature=function(e,t,r,u,f){for(var m=0,S=N(t,500);m<S.length;m+=1){for(var P=S[m],V=0,te=0,he=P;te<he.length;te+=1)V+=he[te].length;for(var Te=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),we=0,lt=P;we<lt.length;we+=1){var Lt=lt[we];if(Lt.length!==0&&!((Ja=Lt).every(function(Da){return Da.x<0})||Ja.every(function(Da){return Da.x>8192})||Ja.every(function(Da){return Da.y<0})||Ja.every(function(Da){return Da.y>8192})))for(var St=0,$t=0;$t<Lt.length;$t++){var Xt=Lt[$t];if($t>=1){var ir=Lt[$t-1];if(!lo(Xt,ir)){Te.vertexLength+4>rt.MAX_VERTEX_ARRAY_LENGTH&&(Te=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var br=Xt.sub(ir)._perp()._unit(),Sr=ir.dist(Xt);St+Sr>32768&&(St=0),jo(this.layoutVertexArray,Xt.x,Xt.y,br.x,br.y,0,0,St),jo(this.layoutVertexArray,Xt.x,Xt.y,br.x,br.y,0,1,St),jo(this.layoutVertexArray,ir.x,ir.y,br.x,br.y,0,0,St+=Sr),jo(this.layoutVertexArray,ir.x,ir.y,br.x,br.y,0,1,St);var zr=Te.vertexLength;this.indexArray.emplaceBack(zr,zr+2,zr+1),this.indexArray.emplaceBack(zr+1,zr+2,zr+3),Te.vertexLength+=4,Te.primitiveLength+=2}}}}if(Te.vertexLength+V>rt.MAX_VERTEX_ARRAY_LENGTH&&(Te=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),yo[e.type]==="Polygon"){for(var Nr=[],mn=[],hn=Te.vertexLength,Ln=0,Qn=P;Ln<Qn.length;Ln+=1){var Yn=Qn[Ln];if(Yn.length!==0){Yn!==P[0]&&mn.push(Nr.length/2);for(var Nn=0;Nn<Yn.length;Nn++){var Ta=Yn[Nn];jo(this.layoutVertexArray,Ta.x,Ta.y,0,0,1,1,0),Nr.push(Ta.x),Nr.push(Ta.y)}}}for(var fa=Wu(Nr,mn),ra=0;ra<fa.length;ra+=3)this.indexArray.emplaceBack(hn+fa[ra],hn+fa[ra+2],hn+fa[ra+1]);Te.primitiveLength+=fa.length/3,Te.vertexLength+=V}}var Ja;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Rn("FillExtrusionBucket",qa,{omit:["layers","features"]});var iu={paint:new vo({"fill-extrusion-opacity":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ec(Ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ti=function(e){function t(r){e.call(this,r,iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qa(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V,te){var he=Zu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,V),Te=this.paint.get("fill-extrusion-height").evaluate(u,f),we=this.paint.get("fill-extrusion-base").evaluate(u,f),lt=function(St,$t,Xt,ir){for(var br=[],Sr=0,zr=St;Sr<zr.length;Sr+=1){var Nr=zr[Sr],mn=[Nr.x,Nr.y,0,1];Ns(mn,mn,$t),br.push(new re(mn[0]/mn[3],mn[1]/mn[3]))}return br}(he,te),Lt=function(St,$t,Xt,ir){for(var br=[],Sr=[],zr=ir[8]*$t,Nr=ir[9]*$t,mn=ir[10]*$t,hn=ir[11]*$t,Ln=ir[8]*Xt,Qn=ir[9]*Xt,Yn=ir[10]*Xt,Nn=ir[11]*Xt,Ta=0,fa=St;Ta<fa.length;Ta+=1){for(var ra=[],Ja=[],Da=0,ji=fa[Ta];Da<ji.length;Da+=1){var va=ji[Da],ai=va.x,Go=va.y,bi=ir[0]*ai+ir[4]*Go+ir[12],Ho=ir[1]*ai+ir[5]*Go+ir[13],Zo=ir[2]*ai+ir[6]*Go+ir[14],ns=ir[3]*ai+ir[7]*Go+ir[15],gu=Zo+mn,as=ns+hn,Yu=bi+Ln,su=Ho+Qn,Ku=Zo+Yn,uu=ns+Nn,Ws=new re((bi+zr)/as,(Ho+Nr)/as);Ws.z=gu/as,ra.push(Ws);var lu=new re(Yu/uu,su/uu);lu.z=Ku/uu,Ja.push(lu)}br.push(ra),Sr.push(Ja)}return[br,Sr]}(m,we,Te,te);return function(St,$t,Xt){var ir=1/0;hs(Xt,$t)&&(ir=Ea(Xt,$t[0]));for(var br=0;br<$t.length;br++)for(var Sr=$t[br],zr=St[br],Nr=0;Nr<Sr.length-1;Nr++){var mn=Sr[Nr],hn=[mn,Sr[Nr+1],zr[Nr+1],zr[Nr],mn];vu(Xt,hn)&&(ir=Math.min(ir,Ea(Xt,hn)))}return ir!==1/0&&ir}(Lt[0],Lt[1],lt)},t}(ws);function ki(e,t){return e.x*t.x+e.y*t.y}function Ea(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var m=t[u],S=e[0],P=r.sub(f),V=m.sub(f),te=S.sub(f),he=ki(P,P),Te=ki(P,V),we=ki(V,V),lt=ki(te,P),Lt=ki(te,V),St=he*we-Te*Te,$t=(we*lt-Te*Lt)/St,Xt=(he*Lt-Te*lt)/St,ir=f.z*(1-$t-Xt)+r.z*$t+m.z*Xt;if(isFinite(ir))return ir}return 1/0}for(var br=1/0,Sr=0,zr=t;Sr<zr.length;Sr+=1)br=Math.min(br,zr[Sr].z);return br}var wo=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,cc=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Nf=Co.VectorTileFeature.types,oh=Math.cos(Math.PI/180*37.5),kf=Math.pow(2,14)/.5,Lu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Is,this.layoutVertexArray2=new zc,this.indexArray=new Al,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Lu.prototype.populate=function(e,t,r){this.hasPattern=Ae("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],m=0,S=e;m<S.length;m+=1){var P=S[m],V=P.feature,te=P.id,he=P.index,Te=P.sourceLayerIndex,we=this.layers[0]._featureFilter.needGeometry,lt=Bi(V,we);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Lt=u?u.evaluate(lt,{},r):void 0,St={id:te,properties:V.properties,type:V.type,sourceLayerIndex:Te,index:he,geometry:we?lt.geometry:Ei(V),patterns:{},sortKey:Lt};f.push(St)}}u&&f.sort(function(mn,hn){return mn.sortKey-hn.sortKey});for(var $t=0,Xt=f;$t<Xt.length;$t+=1){var ir=Xt[$t],br=ir.geometry,Sr=ir.index,zr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=ct("line",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,br,Sr,r,{});t.featureIndex.insert(e[Sr].feature,br,Sr,zr,this.index)}},Lu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Lu.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},Lu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,cc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Lu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Lu.prototype.addFeature=function(e,t,r,u,f){var m=this.layers[0].layout,S=m.get("line-join").evaluate(e,{}),P=m.get("line-cap"),V=m.get("line-miter-limit"),te=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var he=0,Te=t;he<Te.length;he+=1)this.addLine(Te[he],e,S,P,V,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Lu.prototype.addLine=function(e,t,r,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=Nf[t.type]==="Polygon",V=e.length;V>=2&&e[V-1].equals(e[V-2]);)V--;for(var te=0;te<V-1&&e[te].equals(e[te+1]);)te++;if(!(V<(P?3:2))){r==="bevel"&&(f=1.05);var he,Te=this.overscaling<=16?122880/(512*this.overscaling):0,we=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray),lt=void 0,Lt=void 0,St=void 0,$t=void 0;this.e1=this.e2=-1,P&&($t=e[te].sub(he=e[V-2])._unit()._perp());for(var Xt=te;Xt<V;Xt++)if(!(Lt=Xt===V-1?P?e[te+1]:void 0:e[Xt+1])||!e[Xt].equals(Lt)){$t&&(St=$t),he&&(lt=he),he=e[Xt],$t=Lt?Lt.sub(he)._unit()._perp():St;var ir=(St=St||$t).add($t);ir.x===0&&ir.y===0||ir._unit();var br=St.x*$t.x+St.y*$t.y,Sr=ir.x*$t.x+ir.y*$t.y,zr=Sr!==0?1/Sr:1/0,Nr=2*Math.sqrt(2-2*Sr),mn=Sr<oh&&lt&&Lt,hn=St.x*$t.y-St.y*$t.x>0;if(mn&&Xt>te){var Ln=he.dist(lt);if(Ln>2*Te){var Qn=he.sub(he.sub(lt)._mult(Te/Ln)._round());this.updateDistance(lt,Qn),this.addCurrentVertex(Qn,St,0,0,we),lt=Qn}}var Yn=lt&&Lt,Nn=Yn?r:P?"butt":u;if(Yn&&Nn==="round"&&(zr<m?Nn="miter":zr<=2&&(Nn="fakeround")),Nn==="miter"&&zr>f&&(Nn="bevel"),Nn==="bevel"&&(zr>2&&(Nn="flipbevel"),zr<f&&(Nn="miter")),lt&&this.updateDistance(lt,he),Nn==="miter")ir._mult(zr),this.addCurrentVertex(he,ir,0,0,we);else if(Nn==="flipbevel"){if(zr>100)ir=$t.mult(-1);else{var Ta=zr*St.add($t).mag()/St.sub($t).mag();ir._perp()._mult(Ta*(hn?-1:1))}this.addCurrentVertex(he,ir,0,0,we),this.addCurrentVertex(he,ir.mult(-1),0,0,we)}else if(Nn==="bevel"||Nn==="fakeround"){var fa=-Math.sqrt(zr*zr-1),ra=hn?fa:0,Ja=hn?0:fa;if(lt&&this.addCurrentVertex(he,St,ra,Ja,we),Nn==="fakeround")for(var Da=Math.round(180*Nr/Math.PI/20),ji=1;ji<Da;ji++){var va=ji/Da;if(va!==.5){var ai=va-.5;va+=va*ai*(va-1)*((1.0904+br*(br*(3.55645-1.43519*br)-3.2452))*ai*ai+(.848013+br*(.215638*br-1.06021)))}var Go=$t.sub(St)._mult(va)._add(St)._unit()._mult(hn?-1:1);this.addHalfVertex(he,Go.x,Go.y,!1,hn,0,we)}Lt&&this.addCurrentVertex(he,$t,-ra,-Ja,we)}else if(Nn==="butt")this.addCurrentVertex(he,ir,0,0,we);else if(Nn==="square"){var bi=lt?1:-1;this.addCurrentVertex(he,ir,bi,bi,we)}else Nn==="round"&&(lt&&(this.addCurrentVertex(he,St,0,0,we),this.addCurrentVertex(he,St,1,1,we,!0)),Lt&&(this.addCurrentVertex(he,$t,-1,-1,we,!0),this.addCurrentVertex(he,$t,0,0,we)));if(mn&&Xt<V-1){var Ho=he.dist(Lt);if(Ho>2*Te){var Zo=he.add(Lt.sub(he)._mult(Te/Ho)._round());this.updateDistance(he,Zo),this.addCurrentVertex(Zo,$t,0,0,we),he=Zo}}}}},Lu.prototype.addCurrentVertex=function(e,t,r,u,f,m){m===void 0&&(m=!1);var S=t.y*u-t.x,P=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,m,!1,r,f),this.addHalfVertex(e,S,P,m,!0,-u,f),this.distance>kf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,m))},Lu.prototype.addHalfVertex=function(e,t,r,u,f,m,S){var P=.5*(this.lineClips?this.scaledDistance*(kf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(m===0?0:m<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var V=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),S.primitiveLength++),f?this.e2=V:this.e1=V},Lu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Lu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Rn("LineBucket",Lu,{omit:["layers","patternFeatures"]});var jf=new vo({"line-cap":new Jn(Ze.layout_line["line-cap"]),"line-join":new jn(Ze.layout_line["line-join"]),"line-miter-limit":new Jn(Ze.layout_line["line-miter-limit"]),"line-round-limit":new Jn(Ze.layout_line["line-round-limit"]),"line-sort-key":new jn(Ze.layout_line["line-sort-key"])}),lf={paint:new vo({"line-opacity":new jn(Ze.paint_line["line-opacity"]),"line-color":new jn(Ze.paint_line["line-color"]),"line-translate":new Jn(Ze.paint_line["line-translate"]),"line-translate-anchor":new Jn(Ze.paint_line["line-translate-anchor"]),"line-width":new jn(Ze.paint_line["line-width"]),"line-gap-width":new jn(Ze.paint_line["line-gap-width"]),"line-offset":new jn(Ze.paint_line["line-offset"]),"line-blur":new jn(Ze.paint_line["line-blur"]),"line-dasharray":new cs(Ze.paint_line["line-dasharray"]),"line-pattern":new Ec(Ze.paint_line["line-pattern"]),"line-gradient":new Do(Ze.paint_line["line-gradient"])}),layout:jf},zf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Pa(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,m){return u=Ne({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,m)},t}(jn))(lf.paint.properties["line-width"].specification);zf.useIntegerZoom=!0;var Eh=function(e){function t(r){e.call(this,r,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ii,this.gradientVersion=(this.gradientVersion+1)%He)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=zf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Lu(r)},t.prototype.queryRadius=function(r){var u=r,f=sh(ds("line-width",this,u),ds("line-gap-width",this,u)),m=ds("line-offset",this,u);return f/2+Math.abs(m)+ao(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V){var te=Zu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,V),he=V/2*sh(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),Te=this.paint.get("line-offset").evaluate(u,f);return Te&&(m=function(we,lt){for(var Lt=[],St=new re(0,0),$t=0;$t<we.length;$t++){for(var Xt=we[$t],ir=[],br=0;br<Xt.length;br++){var Sr=Xt[br],zr=Xt[br+1],Nr=br===0?St:Sr.sub(Xt[br-1])._unit()._perp(),mn=br===Xt.length-1?St:zr.sub(Sr)._unit()._perp(),hn=Nr._add(mn)._unit();hn._mult(1/(hn.x*mn.x+hn.y*mn.y)),ir.push(hn._mult(lt)._add(Sr))}Lt.push(ir)}return Lt}(m,Te*V)),function(we,lt,Lt){for(var St=0;St<lt.length;St++){var $t=lt[St];if(we.length>=3){for(var Xt=0;Xt<$t.length;Xt++)if(ru(we,$t[Xt]))return!0}if(Hs(we,$t,Lt))return!0}return!1}(te,m,he)},t.prototype.isTileClipped=function(){return!0},t}(ws);function sh(e,t){return t>0?t+2*e:e}var _f=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ff=no([{name:"a_projected_pos",components:3,type:"Float32"}],4),Uf=(no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),uh=(no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Bf=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Of(e,t,r){return e.sections.forEach(function(u){u.text=function(f,m,S){var P=m.layout.get("text-transform").evaluate(S,{});return P==="uppercase"?f=f.toLocaleUpperCase():P==="lowercase"&&(f=f.toLocaleLowerCase()),ls.applyArabicShaping&&(f=ls.applyArabicShaping(f)),f}(u.text,t,r)}),e}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ih=function(t,r,u,f,m){var S,P,V=8*m-f-1,te=(1<<V)-1,he=te>>1,Te=-7,we=u?m-1:0,lt=u?-1:1,Lt=t[r+we];for(we+=lt,S=Lt&(1<<-Te)-1,Lt>>=-Te,Te+=V;Te>0;S=256*S+t[r+we],we+=lt,Te-=8);for(P=S&(1<<-Te)-1,S>>=-Te,Te+=f;Te>0;P=256*P+t[r+we],we+=lt,Te-=8);if(S===0)S=1-he;else{if(S===te)return P?NaN:1/0*(Lt?-1:1);P+=Math.pow(2,f),S-=he}return(Lt?-1:1)*P*Math.pow(2,S-f)},ye=function(t,r,u,f,m,S){var P,V,te,he=8*S-m-1,Te=(1<<he)-1,we=Te>>1,lt=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,Lt=f?0:S-1,St=f?1:-1,$t=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(V=isNaN(r)?1:0,P=Te):(P=Math.floor(Math.log(r)/Math.LN2),r*(te=Math.pow(2,-P))<1&&(P--,te*=2),(r+=P+we>=1?lt/te:lt*Math.pow(2,1-we))*te>=2&&(P++,te/=2),P+we>=Te?(V=0,P=Te):P+we>=1?(V=(r*te-1)*Math.pow(2,m),P+=we):(V=r*Math.pow(2,we-1)*Math.pow(2,m),P=0));m>=8;t[u+Lt]=255&V,Lt+=St,V/=256,m-=8);for(P=P<<m|V,he+=m;he>0;t[u+Lt]=255&P,Lt+=St,P/=256,he-=8);t[u+Lt-St]|=128*$t},je=Mt;function Mt(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Mt.Varint=0,Mt.Fixed64=1,Mt.Bytes=2,Mt.Fixed32=5;var Er=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Lr(e){return e.type===Mt.Bytes?e.readVarint()+e.pos:e.pos+1}function wr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function _r(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function un(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Jr(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Qr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function ln(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Sn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function pn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Tr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function xr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Xr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function On(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Ir(e,t,r){e===1&&r.readMessage(ta,t)}function ta(e,t,r){if(e===3){var u=r.readMessage(qr,{}),f=u.width,m=u.height,S=u.left,P=u.top,V=u.advance;t.push({id:u.id,bitmap:new ks({width:f+6,height:m+6},u.bitmap),metrics:{width:f,height:m,left:S,top:P,advance:V}})}}function qr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Fr(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var m=f[u];t+=m.w*m.h,r=Math.max(r,m.w)}e.sort(function(St,$t){return $t.h-St.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,V=0,te=0,he=e;te<he.length;te+=1)for(var Te=he[te],we=S.length-1;we>=0;we--){var lt=S[we];if(!(Te.w>lt.w||Te.h>lt.h)){if(Te.x=lt.x,Te.y=lt.y,V=Math.max(V,Te.y+Te.h),P=Math.max(P,Te.x+Te.w),Te.w===lt.w&&Te.h===lt.h){var Lt=S.pop();we<S.length&&(S[we]=Lt)}else Te.h===lt.h?(lt.x+=Te.w,lt.w-=Te.w):Te.w===lt.w?(lt.y+=Te.h,lt.h-=Te.h):(S.push({x:lt.x+Te.w,y:lt.y,w:lt.w-Te.w,h:Te.h}),lt.y+=Te.h,lt.h-=Te.h);break}}return{w:P,h:V,fill:t/(P*V)||0}}Mt.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),m=f>>3,S=this.pos;this.type=7&f,t(m,r,this),this.pos===S&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=xr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=On(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=xr(this.buf,this.pos)+4294967296*xr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=xr(this.buf,this.pos)+4294967296*On(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ih(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ih(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(m,S,P){var V,te,he=P.buf;if(V=(112&(te=he[P.pos++]))>>4,te<128)return wr(m,V,S);if(V|=(127&(te=he[P.pos++]))<<3,te<128)return wr(m,V,S);if(V|=(127&(te=he[P.pos++]))<<10,te<128)return wr(m,V,S);if(V|=(127&(te=he[P.pos++]))<<17,te<128)return wr(m,V,S);if(V|=(127&(te=he[P.pos++]))<<24,te<128)return wr(m,V,S);if(V|=(1&(te=he[P.pos++]))<<31,te<128)return wr(m,V,S);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&Er?function(u,f,m){return Er.decode(u.subarray(f,m))}(this.buf,r,t):function(u,f,m){for(var S="",P=f;P<m;){var V,te,he,Te=u[P],we=null,lt=Te>239?4:Te>223?3:Te>191?2:1;if(P+lt>m)break;lt===1?Te<128&&(we=Te):lt===2?(192&(V=u[P+1]))==128&&(we=(31&Te)<<6|63&V)<=127&&(we=null):lt===3?(te=u[P+2],(192&(V=u[P+1]))==128&&(192&te)==128&&((we=(15&Te)<<12|(63&V)<<6|63&te)<=2047||we>=55296&&we<=57343)&&(we=null)):lt===4&&(te=u[P+2],he=u[P+3],(192&(V=u[P+1]))==128&&(192&te)==128&&(192&he)==128&&((we=(15&Te)<<18|(63&V)<<12|(63&te)<<6|63&he)<=65535||we>=1114112)&&(we=null)),we===null?(we=65533,lt=1):we>65535&&(we-=65536,S+=String.fromCharCode(we>>>10&1023|55296),we=56320|1023&we),S+=String.fromCharCode(we),P+=lt}return S}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Mt.Bytes)return t.push(this.readVarint(r));var u=Lr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSVarint());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Mt.Bytes)return t.push(this.readBoolean());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFloat());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Mt.Bytes)return t.push(this.readDouble());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFixed32());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSFixed32());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFixed64());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSFixed64());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Mt.Varint)for(;this.buf[this.pos++]>127;);else if(r===Mt.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Mt.Fixed32)this.pos+=4;else{if(r!==Mt.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,m;if(r>=0?(f=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(S,P,V){V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,V.buf[V.pos]=127&(S>>>=7)}(f,0,u),function(S,P){var V=(7&S)<<4;P.buf[P.pos++]|=V|((S>>>=3)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S)))))}(m,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,m,S){for(var P,V,te=0;te<m.length;te++){if((P=m.charCodeAt(te))>55295&&P<57344){if(!V){P>56319||te+1===m.length?(f[S++]=239,f[S++]=191,f[S++]=189):V=P;continue}if(P<56320){f[S++]=239,f[S++]=191,f[S++]=189,V=P;continue}P=V-55296<<10|P-56320|65536,V=null}else V&&(f[S++]=239,f[S++]=191,f[S++]=189,V=null);P<128?f[S++]=P:(P<2048?f[S++]=P>>6|192:(P<65536?f[S++]=P>>12|224:(f[S++]=P>>18|240,f[S++]=P>>12&63|128),f[S++]=P>>6&63|128),f[S++]=63&P|128)}return S}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&_r(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),ye(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ye(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&_r(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,Mt.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,un,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,ln,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Jr,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,Qr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Sn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,pn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,nn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Tr,r)},writeBytesField:function(t,r){this.writeTag(t,Mt.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Mt.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Mt.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Mt.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Vr=function(t,r){var u=r.pixelRatio,f=r.version,m=r.stretchX,S=r.stretchY,P=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=m,this.stretchY=S,this.content=P,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Vr.prototype,Kr);var Xn=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var m=[];this.addImages(t,u,m),this.addImages(r,f,m);var S=Fr(m),P=new go({width:S.w||1,height:S.h||1});for(var V in t){var te=t[V],he=u[V].paddedRect;go.copy(te.data,P,{x:0,y:0},{x:he.x+1,y:he.y+1},te.data)}for(var Te in r){var we=r[Te],lt=f[Te].paddedRect,Lt=lt.x+1,St=lt.y+1,$t=we.data.width,Xt=we.data.height;go.copy(we.data,P,{x:0,y:0},{x:Lt,y:St},we.data),go.copy(we.data,P,{x:0,y:Xt-1},{x:Lt,y:St-1},{width:$t,height:1}),go.copy(we.data,P,{x:0,y:0},{x:Lt,y:St+Xt},{width:$t,height:1}),go.copy(we.data,P,{x:$t-1,y:0},{x:Lt-1,y:St},{width:1,height:Xt}),go.copy(we.data,P,{x:0,y:0},{x:Lt+$t,y:St},{width:1,height:Xt})}this.image=P,this.iconPositions=u,this.patternPositions=f};Xn.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(m),t[u]=new Vr(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Xn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Xn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},Rn("ImagePosition",Vr),Rn("ImageAtlas",Xn);var na={horizontal:1,vertical:2,horizontalOnly:3},cn=function(){this.scale=1,this.fontStack="",this.imageName=null};cn.forText=function(e,t){var r=new cn;return r.scale=e||1,r.fontStack=t,r},cn.forImage=function(e){var t=new cn;return t.imageName=e,t};var Hr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function jr(e,t,r,u,f,m,S,P,V,te,he,Te,we,lt,Lt,St){var $t,Xt=Hr.fromFeature(e,f);Te===na.vertical&&Xt.verticalizePunctuation();var ir=ls.processBidirectionalText,br=ls.processStyledBidirectionalText;if(ir&&Xt.sections.length===1){$t=[];for(var Sr=0,zr=ir(Xt.toString(),hi(Xt,te,m,t,u,lt,Lt));Sr<zr.length;Sr+=1){var Nr=zr[Sr],mn=new Hr;mn.text=Nr,mn.sections=Xt.sections;for(var hn=0;hn<Nr.length;hn++)mn.sectionIndex.push(0);$t.push(mn)}}else if(br){$t=[];for(var Ln=0,Qn=br(Xt.text,Xt.sectionIndex,hi(Xt,te,m,t,u,lt,Lt));Ln<Qn.length;Ln+=1){var Yn=Qn[Ln],Nn=new Hr;Nn.text=Yn[0],Nn.sectionIndex=Yn[1],Nn.sections=Xt.sections,$t.push(Nn)}}else $t=function(ra,Ja){for(var Da=[],ji=ra.text,va=0,ai=0,Go=Ja;ai<Go.length;ai+=1){var bi=Go[ai];Da.push(ra.substring(va,bi)),va=bi}return va<ji.length&&Da.push(ra.substring(va,ji.length)),Da}(Xt,hi(Xt,te,m,t,u,lt,Lt));var Ta=[],fa={positionedLines:Ta,text:Xt.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:Te,iconsInText:!1,verticalizable:!1};return function(ra,Ja,Da,ji,va,ai,Go,bi,Ho,Zo,ns,gu){for(var as=0,Yu=-17,su=0,Ku=0,uu=bi==="right"?1:bi==="left"?0:.5,Ws=0,lu=0,mi=va;lu<mi.length;lu+=1){var ii=mi[lu];ii.trim();var Ji=ii.getMaxScale(),fo=24*(Ji-1),yu={positionedGlyphs:[],lineOffset:0};ra.positionedLines[Ws]=yu;var Eo=yu.positionedGlyphs,Wo=0;if(ii.length()){for(var Ru=0;Ru<ii.length();Ru++){var di=ii.getSection(Ru),Zf=ii.getSectionIndex(Ru),Zc=ii.getCharCode(Ru),cf=0,dc=null,Iu=null,Pf=null,Lf=24,Wf=!(Ho===na.horizontal||!ns&&!us(Zc)||ns&&(ma[Zc]||(dh=Zc,tn.Arabic(dh)||tn["Arabic Supplement"](dh)||tn["Arabic Extended-A"](dh)||tn["Arabic Presentation Forms-A"](dh)||tn["Arabic Presentation Forms-B"](dh))));if(di.imageName){var Th=ji[di.imageName];if(!Th)continue;Pf=di.imageName,ra.iconsInText=ra.iconsInText||!0,Iu=Th.paddedRect;var Tf=Th.displaySize;di.scale=24*di.scale/gu,cf=fo+(24-Tf[1]*di.scale),Lf=(dc={width:Tf[0],height:Tf[1],left:1,top:-3,advance:Wf?Tf[1]:Tf[0]}).advance;var Sh=Wf?Tf[0]*di.scale-24*Ji:Tf[1]*di.scale-24*Ji;Sh>0&&Sh>Wo&&(Wo=Sh)}else{var Xf=Da[di.fontStack],hh=Xf&&Xf[Zc];if(hh&&hh.rect)Iu=hh.rect,dc=hh.metrics;else{var Zh=Ja[di.fontStack],kh=Zh&&Zh[Zc];if(!kh)continue;dc=kh.metrics}cf=24*(Ji-di.scale)}Wf?(ra.verticalizable=!0,Eo.push({glyph:Zc,imageName:Pf,x:as,y:Yu+cf,vertical:Wf,scale:di.scale,fontStack:di.fontStack,sectionIndex:Zf,metrics:dc,rect:Iu}),as+=Lf*di.scale+Zo):(Eo.push({glyph:Zc,imageName:Pf,x:as,y:Yu+cf,vertical:Wf,scale:di.scale,fontStack:di.fontStack,sectionIndex:Zf,metrics:dc,rect:Iu}),as+=dc.advance*di.scale+Zo)}Eo.length!==0&&(su=Math.max(as-Zo,su),Os(Eo,0,Eo.length-1,uu,Wo)),as=0;var Wh=ai*Ji+Wo;yu.lineOffset=Math.max(Wo,fo),Yu+=Wh,Ku=Math.max(Wh,Ku),++Ws}else Yu+=ai,++Ws}var dh,Ah=Yu- -17,Xh=zo(Go),ph=Xh.horizontalAlign,Yf=Xh.verticalAlign;(function(nh,Yh,jh,mh,zh,Ch,vh,Fh,Uh){var wh,Oh=(Yh-jh)*zh;wh=Ch!==vh?-Fh*mh- -17:(-mh*Uh+.5)*vh;for(var gh=0,Mh=nh;gh<Mh.length;gh+=1)for(var yh=0,Rf=Mh[gh].positionedGlyphs;yh<Rf.length;yh+=1){var Ph=Rf[yh];Ph.x+=Oh,Ph.y+=wh}})(ra.positionedLines,uu,ph,Yf,su,Ku,ai,Ah,va.length),ra.top+=-Yf*Ah,ra.bottom=ra.top+Ah,ra.left+=-ph*su,ra.right=ra.left+su}(fa,t,r,u,$t,S,P,V,Te,te,we,St),!function(ra){for(var Ja=0,Da=ra;Ja<Da.length;Ja+=1)if(Da[Ja].positionedGlyphs.length!==0)return!1;return!0}(Ta)&&fa}Hr.fromFeature=function(e,t){for(var r=new Hr,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Hr.prototype.length=function(){return this.text.length},Hr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Hr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Hr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Hr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&ro(u)&&!Zl[e[r+1]]||f&&ro(f)&&!Zl[e[r-1]]||!Zl[e[r]]?e[r]:Zl[e[r]]}return t}(this.text)},Hr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ma[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&ma[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Hr.prototype.substring=function(e,t){var r=new Hr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Hr.prototype.toString=function(){return this.text},Hr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Hr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(cn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Hr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(cn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Me("Reached maximum number of images 6401")}else Me("Can't add FormattedSection with an empty image.")},Hr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ma={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pa={};function Un(e,t,r,u,f,m){if(t.imageName){var S=u[t.imageName];return S?S.displaySize[0]*t.scale*24/m+f:0}var P=r[t.fontStack],V=P&&P[e];return V?V.metrics.advance*t.scale+f:0}function Ua(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function _a(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Ba(e,t,r,u,f,m){for(var S=null,P=Ua(t,r,f,m),V=0,te=u;V<te.length;V+=1){var he=te[V],Te=Ua(t-he.x,r,f,m)+he.badness;Te<=P&&(S=he,P=Te)}return{index:e,x:t,priorBreak:S,badness:P}}function hi(e,t,r,u,f,m,S){if(m!=="point")return[];if(!e)return[];for(var P,V=[],te=function($t,Xt,ir,br,Sr,zr){for(var Nr=0,mn=0;mn<$t.length();mn++){var hn=$t.getSection(mn);Nr+=Un($t.getCharCode(mn),hn,br,Sr,Xt,zr)}return Nr/Math.max(1,Math.ceil(Nr/ir))}(e,t,r,u,f,S),he=e.text.indexOf("\u200B")>=0,Te=0,we=0;we<e.length();we++){var lt=e.getSection(we),Lt=e.getCharCode(we);if(ma[Lt]||(Te+=Un(Lt,lt,u,f,t,S)),we<e.length()-1){var St=!((P=Lt)<11904||!(tn["Bopomofo Extended"](P)||tn.Bopomofo(P)||tn["CJK Compatibility Forms"](P)||tn["CJK Compatibility Ideographs"](P)||tn["CJK Compatibility"](P)||tn["CJK Radicals Supplement"](P)||tn["CJK Strokes"](P)||tn["CJK Symbols and Punctuation"](P)||tn["CJK Unified Ideographs Extension A"](P)||tn["CJK Unified Ideographs"](P)||tn["Enclosed CJK Letters and Months"](P)||tn["Halfwidth and Fullwidth Forms"](P)||tn.Hiragana(P)||tn["Ideographic Description Characters"](P)||tn["Kangxi Radicals"](P)||tn["Katakana Phonetic Extensions"](P)||tn.Katakana(P)||tn["Vertical Forms"](P)||tn["Yi Radicals"](P)||tn["Yi Syllables"](P)));(pa[Lt]||St||lt.imageName)&&V.push(Ba(we+1,Te,te,V,_a(Lt,e.getCharCode(we+1),St&&he),!1))}}return function $t(Xt){return Xt?$t(Xt.priorBreak).concat(Xt.index):[]}(Ba(e.length(),Te,te,V,0,!0))}function zo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Os(e,t,r,u,f){if(u||f)for(var m=e[r],S=(e[r].x+m.metrics.advance*m.scale)*u,P=t;P<=r;P++)e[P].x-=S,e[P].y+=f}function ei(e,t,r,u,f,m){var S,P=e.image;if(P.content){var V=P.content,te=P.pixelRatio||1;S=[V[0]/te,V[1]/te,P.displaySize[0]-V[2]/te,P.displaySize[1]-V[3]/te]}var he,Te,we,lt,Lt=t.left*m,St=t.right*m;r==="width"||r==="both"?(lt=f[0]+Lt-u[3],Te=f[0]+St+u[1]):Te=(lt=f[0]+(Lt+St-P.displaySize[0])/2)+P.displaySize[0];var $t=t.top*m,Xt=t.bottom*m;return r==="height"||r==="both"?(he=f[1]+$t-u[0],we=f[1]+Xt+u[2]):we=(he=f[1]+($t+Xt-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:he,right:Te,bottom:we,left:lt,collisionPadding:S}}pa[10]=!0,pa[32]=!0,pa[38]=!0,pa[40]=!0,pa[41]=!0,pa[43]=!0,pa[45]=!0,pa[47]=!0,pa[173]=!0,pa[183]=!0,pa[8203]=!0,pa[8208]=!0,pa[8211]=!0,pa[8231]=!0;var bo=function(e){function t(r,u,f,m){e.call(this,r,u),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(re);function Ci(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pa(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,m=0;m<u.length&&u[m]<=e;)m++;for(var S=m=Math.max(0,m-1);S<u.length&&u[S]<e+1;)S++;S=Math.min(u.length-1,S);var P=u[m],V=u[S];return r.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:V,interpolationType:f}:{kind:"camera",minZoom:P,maxZoom:V,minSize:r.evaluate(new Pa(P)),maxSize:r.evaluate(new Pa(V)),interpolationType:f}}function vs(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Gi(f/128,r.upperSize/128,t.uSizeT):u}function Fo(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?Ce(gi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Gi(e.minSize,e.maxSize,m):r=m}return{uSizeT:r,uSize:u}}Rn("Anchor",bo);var gs=Object.freeze({__proto__:null,getSizeData:Ci,evaluateSizeForFeature:vs,evaluateSizeForZoom:Fo,SIZE_PACK_FACTOR:128});function Uo(e,t,r,u,f){if(t.segment===void 0)return!0;for(var m=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(m),m=e[S]}P+=e[S].dist(e[S+1]),S++;for(var V=[],te=0;P<r/2;){var he=e[S],Te=e[S+1];if(!Te)return!1;var we=e[S-1].angleTo(he)-he.angleTo(Te);for(we=Math.abs((we+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:P,angleDelta:we}),te+=we;P-V[0].distance>u;)te-=V.shift().angleDelta;if(te>f)return!1;S++,P+=he.dist(Te)}return!0}function Bo(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Vo(e,t,r){return e?.6*t*r:0}function aa(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function ou(e,t,r,u,f,m){for(var S=Vo(r,f,m),P=aa(r,u)*m,V=0,te=Bo(e)/2,he=0;he<e.length-1;he++){var Te=e[he],we=e[he+1],lt=Te.dist(we);if(V+lt>te){var Lt=(te-V)/lt,St=Gi(Te.x,we.x,Lt),$t=Gi(Te.y,we.y,Lt),Xt=new bo(St,$t,we.angleTo(Te),he);return Xt._round(),!S||Uo(e,Xt,P,S,t)?Xt:void 0}V+=lt}}function yi(e,t,r,u,f,m,S,P,V){var te=Vo(u,m,S),he=aa(u,f),Te=he*S,we=e[0].x===0||e[0].x===V||e[0].y===0||e[0].y===V;return t-Te<t/4&&(t=Te+t/4),function lt(Lt,St,$t,Xt,ir,br,Sr,zr,Nr){for(var mn=br/2,hn=Bo(Lt),Ln=0,Qn=St-$t,Yn=[],Nn=0;Nn<Lt.length-1;Nn++){for(var Ta=Lt[Nn],fa=Lt[Nn+1],ra=Ta.dist(fa),Ja=fa.angleTo(Ta);Qn+$t<Ln+ra;){var Da=((Qn+=$t)-Ln)/ra,ji=Gi(Ta.x,fa.x,Da),va=Gi(Ta.y,fa.y,Da);if(ji>=0&&ji<Nr&&va>=0&&va<Nr&&Qn-mn>=0&&Qn+mn<=hn){var ai=new bo(ji,va,Ja,Nn);ai._round(),Xt&&!Uo(Lt,ai,br,Xt,ir)||Yn.push(ai)}}Ln+=ra}return zr||Yn.length||Sr||(Yn=lt(Lt,Ln/2,$t,Xt,ir,br,Sr,!0,Nr)),Yn}(e,we?t/2*P%t:(he/2+2*m)*S*P%t,t,te,r,Te,we,!1,V)}function An(e,t,r,u,f){for(var m=[],S=0;S<e.length;S++)for(var P=e[S],V=void 0,te=0;te<P.length-1;te++){var he=P[te],Te=P[te+1];he.x<t&&Te.x<t||(he.x<t?he=new re(t,he.y+(t-he.x)/(Te.x-he.x)*(Te.y-he.y))._round():Te.x<t&&(Te=new re(t,he.y+(t-he.x)/(Te.x-he.x)*(Te.y-he.y))._round()),he.y<r&&Te.y<r||(he.y<r?he=new re(he.x+(r-he.y)/(Te.y-he.y)*(Te.x-he.x),r)._round():Te.y<r&&(Te=new re(he.x+(r-he.y)/(Te.y-he.y)*(Te.x-he.x),r)._round()),he.x>=u&&Te.x>=u||(he.x>=u?he=new re(u,he.y+(u-he.x)/(Te.x-he.x)*(Te.y-he.y))._round():Te.x>=u&&(Te=new re(u,he.y+(u-he.x)/(Te.x-he.x)*(Te.y-he.y))._round()),he.y>=f&&Te.y>=f||(he.y>=f?he=new re(he.x+(f-he.y)/(Te.y-he.y)*(Te.x-he.x),f)._round():Te.y>=f&&(Te=new re(he.x+(f-he.y)/(Te.y-he.y)*(Te.x-he.x),f)._round()),V&&he.equals(V[V.length-1])||m.push(V=[he]),V.push(Te)))))}return m}function Ra(e,t,r,u){var f=[],m=e.image,S=m.pixelRatio,P=m.paddedRect.w-2,V=m.paddedRect.h-2,te=e.right-e.left,he=e.bottom-e.top,Te=m.stretchX||[[0,P]],we=m.stretchY||[[0,V]],lt=function(va,ai){return va+ai[1]-ai[0]},Lt=Te.reduce(lt,0),St=we.reduce(lt,0),$t=P-Lt,Xt=V-St,ir=0,br=Lt,Sr=0,zr=St,Nr=0,mn=$t,hn=0,Ln=Xt;if(m.content&&u){var Qn=m.content;ir=Va(Te,0,Qn[0]),Sr=Va(we,0,Qn[1]),br=Va(Te,Qn[0],Qn[2]),zr=Va(we,Qn[1],Qn[3]),Nr=Qn[0]-ir,hn=Qn[1]-Sr,mn=Qn[2]-Qn[0]-br,Ln=Qn[3]-Qn[1]-zr}var Yn=function(va,ai,Go,bi){var Ho=w(va.stretch-ir,br,te,e.left),Zo=y(va.fixed-Nr,mn,va.stretch,Lt),ns=w(ai.stretch-Sr,zr,he,e.top),gu=y(ai.fixed-hn,Ln,ai.stretch,St),as=w(Go.stretch-ir,br,te,e.left),Yu=y(Go.fixed-Nr,mn,Go.stretch,Lt),su=w(bi.stretch-Sr,zr,he,e.top),Ku=y(bi.fixed-hn,Ln,bi.stretch,St),uu=new re(Ho,ns),Ws=new re(as,ns),lu=new re(as,su),mi=new re(Ho,su),ii=new re(Zo/S,gu/S),Ji=new re(Yu/S,Ku/S),fo=t*Math.PI/180;if(fo){var yu=Math.sin(fo),Eo=Math.cos(fo),Wo=[Eo,-yu,yu,Eo];uu._matMult(Wo),Ws._matMult(Wo),mi._matMult(Wo),lu._matMult(Wo)}var Ru=va.stretch+va.fixed,di=ai.stretch+ai.fixed;return{tl:uu,tr:Ws,bl:mi,br:lu,tex:{x:m.paddedRect.x+1+Ru,y:m.paddedRect.y+1+di,w:Go.stretch+Go.fixed-Ru,h:bi.stretch+bi.fixed-di},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ii,pixelOffsetBR:Ji,minFontScaleX:mn/S/te,minFontScaleY:Ln/S/he,isSDF:r}};if(u&&(m.stretchX||m.stretchY))for(var Nn=rs(Te,$t,Lt),Ta=rs(we,Xt,St),fa=0;fa<Nn.length-1;fa++)for(var ra=Nn[fa],Ja=Nn[fa+1],Da=0;Da<Ta.length-1;Da++)f.push(Yn(ra,Ta[Da],Ja,Ta[Da+1]));else f.push(Yn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:V+1}));return f}function Va(e,t,r){for(var u=0,f=0,m=e;f<m.length;f+=1){var S=m[f];u+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return u}function rs(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var S=m[f],P=S[0],V=S[1],te=u[u.length-1];u.push({fixed:P-te.stretch,stretch:te.stretch}),u.push({fixed:P-te.stretch,stretch:te.stretch+(V-P)})}return u.push({fixed:t+1,stretch:r}),u}function w(e,t,r,u){return e/t*r+u}function y(e,t,r,u){return e-t*r/u}var c=function(t,r,u,f,m,S,P,V,te,he){if(this.boxStartIndex=t.length,te){var Te=S.top,we=S.bottom,lt=S.collisionPadding;lt&&(Te-=lt[1],we+=lt[3]);var Lt=we-Te;Lt>0&&(Lt=Math.max(10,Lt),this.circleDiameter=Lt)}else{var St=S.top*P-V,$t=S.bottom*P+V,Xt=S.left*P-V,ir=S.right*P+V,br=S.collisionPadding;if(br&&(Xt-=br[0]*P,St-=br[1]*P,ir+=br[2]*P,$t+=br[3]*P),he){var Sr=new re(Xt,St),zr=new re(ir,St),Nr=new re(Xt,$t),mn=new re(ir,$t),hn=he*Math.PI/180;Sr._rotate(hn),zr._rotate(hn),Nr._rotate(hn),mn._rotate(hn),Xt=Math.min(Sr.x,zr.x,Nr.x,mn.x),ir=Math.max(Sr.x,zr.x,Nr.x,mn.x),St=Math.min(Sr.y,zr.y,Nr.y,mn.y),$t=Math.max(Sr.y,zr.y,Nr.y,mn.y)}t.emplaceBack(r.x,r.y,Xt,St,ir,$t,u,f,m)}this.boxEndIndex=t.length},d=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=g),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function g(e,t){return e<t?-1:e>t?1:0}function I(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,m=-1/0,S=-1/0,P=e[0],V=0;V<P.length;V++){var te=P[V];(!V||te.x<u)&&(u=te.x),(!V||te.y<f)&&(f=te.y),(!V||te.x>m)&&(m=te.x),(!V||te.y>S)&&(S=te.y)}var he=Math.min(m-u,S-f),Te=he/2,we=new d([],ee);if(he===0)return new re(u,f);for(var lt=u;lt<m;lt+=he)for(var Lt=f;Lt<S;Lt+=he)we.push(new B(lt+Te,Lt+Te,Te,e));for(var St=function(ir){for(var br=0,Sr=0,zr=0,Nr=ir[0],mn=0,hn=Nr.length,Ln=hn-1;mn<hn;Ln=mn++){var Qn=Nr[mn],Yn=Nr[Ln],Nn=Qn.x*Yn.y-Yn.x*Qn.y;Sr+=(Qn.x+Yn.x)*Nn,zr+=(Qn.y+Yn.y)*Nn,br+=3*Nn}return new B(Sr/br,zr/br,0,ir)}(e),$t=we.length;we.length;){var Xt=we.pop();(Xt.d>St.d||!St.d)&&(St=Xt,r&&console.log("found best %d after %d probes",Math.round(1e4*Xt.d)/1e4,$t)),Xt.max-St.d<=t||(we.push(new B(Xt.p.x-(Te=Xt.h/2),Xt.p.y-Te,Te,e)),we.push(new B(Xt.p.x+Te,Xt.p.y-Te,Te,e)),we.push(new B(Xt.p.x-Te,Xt.p.y+Te,Te,e)),we.push(new B(Xt.p.x+Te,Xt.p.y+Te,Te,e)),$t+=4)}return r&&(console.log("num probes: "+$t),console.log("best distance: "+St.d)),St.p}function ee(e,t){return t.max-e.max}function B(e,t,r,u){this.p=new re(e,t),this.h=r,this.d=function(f,m){for(var S=!1,P=1/0,V=0;V<m.length;V++)for(var te=m[V],he=0,Te=te.length,we=Te-1;he<Te;we=he++){var lt=te[he],Lt=te[we];lt.y>f.y!=Lt.y>f.y&&f.x<(Lt.x-lt.x)*(f.y-lt.y)/(Lt.y-lt.y)+lt.x&&(S=!S),P=Math.min(P,Hu(f,lt,Lt))}return(S?1:-1)*Math.sqrt(P)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}d.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},d.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},d.prototype.peek=function(){return this.data[0]},d.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,m=t[f];if(r(u,m)>=0)break;t[e]=m,e=f}t[e]=u},d.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var m=1+(e<<1),S=t[m],P=m+1;if(P<this.length&&r(t[P],S)<0&&(m=P,S=t[P]),r(S,f)>=0)break;t[e]=S,e=m}t[e]=f};var k=Number.POSITIVE_INFINITY;function Q(e,t){return t[1]!==k?function(r,u,f){var m=0,S=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":S=f-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-f}switch(r){case"top-right":case"bottom-right":case"right":m=-u;break;case"top-left":case"bottom-left":case"left":m=u}return[m,S]}(e,t[0],t[1]):function(r,u){var f=0,m=0;u<0&&(u=0);var S=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=S-7;break;case"bottom-right":case"bottom-left":m=7-S;break;case"bottom":m=7-u;break;case"top":m=u-7}switch(r){case"top-right":case"bottom-right":f=-S;break;case"top-left":case"bottom-left":f=S;break;case"left":f=u;break;case"right":f=-u}return[f,m]}(e,t[0])}function We(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tt(e,t,r,u,f,m,S,P,V,te,he,Te,we,lt,Lt){var St=function(Sr,zr,Nr,mn,hn,Ln,Qn,Yn){for(var Nn=mn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,Ta=[],fa=0,ra=zr.positionedLines;fa<ra.length;fa+=1)for(var Ja=ra[fa],Da=0,ji=Ja.positionedGlyphs;Da<ji.length;Da+=1){var va=ji[Da];if(va.rect){var ai=va.rect||{},Go=4,bi=!0,Ho=1,Zo=0,ns=(hn||Yn)&&va.vertical,gu=va.metrics.advance*va.scale/2;if(Yn&&zr.verticalizable&&(Zo=Ja.lineOffset/2-(va.imageName?-(24-va.metrics.width*va.scale)/2:24*(va.scale-1))),va.imageName){var as=Qn[va.imageName];bi=as.sdf,Go=1/(Ho=as.pixelRatio)}var Yu=hn?[va.x+gu,va.y]:[0,0],su=hn?[0,0]:[va.x+gu+Nr[0],va.y+Nr[1]-Zo],Ku=[0,0];ns&&(Ku=su,su=[0,0]);var uu=(va.metrics.left-Go)*va.scale-gu+su[0],Ws=(-va.metrics.top-Go)*va.scale+su[1],lu=uu+ai.w*va.scale/Ho,mi=Ws+ai.h*va.scale/Ho,ii=new re(uu,Ws),Ji=new re(lu,Ws),fo=new re(uu,mi),yu=new re(lu,mi);if(ns){var Eo=new re(-gu,gu- -17),Wo=-Math.PI/2,Ru=12-gu,di=new re(22-Ru,-(va.imageName?Ru:0)),Zf=new(Function.prototype.bind.apply(re,[null].concat(Ku)));ii._rotateAround(Wo,Eo)._add(di)._add(Zf),Ji._rotateAround(Wo,Eo)._add(di)._add(Zf),fo._rotateAround(Wo,Eo)._add(di)._add(Zf),yu._rotateAround(Wo,Eo)._add(di)._add(Zf)}if(Nn){var Zc=Math.sin(Nn),cf=Math.cos(Nn),dc=[cf,-Zc,Zc,cf];ii._matMult(dc),Ji._matMult(dc),fo._matMult(dc),yu._matMult(dc)}var Iu=new re(0,0),Pf=new re(0,0);Ta.push({tl:ii,tr:Ji,bl:fo,br:yu,tex:ai,writingMode:zr.writingMode,glyphOffset:Yu,sectionIndex:va.sectionIndex,isSDF:bi,pixelOffsetTL:Iu,pixelOffsetBR:Pf,minFontScaleX:0,minFontScaleY:0})}}return Ta}(0,r,P,f,m,S,u,e.allowVerticalPlacement),$t=e.textSizeData,Xt=null;$t.kind==="source"?(Xt=[128*f.layout.get("text-size").evaluate(S,{})])[0]>32640&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):$t.kind==="composite"&&((Xt=[128*lt.compositeTextSizes[0].evaluate(S,{},Lt),128*lt.compositeTextSizes[1].evaluate(S,{},Lt)])[0]>32640||Xt[1]>32640)&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,St,Xt,P,m,S,te,t,V.lineStartIndex,V.lineLength,we,Lt);for(var ir=0,br=he;ir<br.length;ir+=1)Te[br[ir]]=e.text.placedSymbolArray.length-1;return 4*St.length}function Pe(e){for(var t in e)return e[t];return null}function Je(e,t,r,u){var f=e.compareText;if(t in f){for(var m=f[t],S=m.length-1;S>=0;S--)if(u.dist(m[S])<r)return!0}else f[t]=[];return f[t].push(u),!1}var _t=Co.VectorTileFeature.types,ke=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pt(e,t,r,u,f,m,S,P,V,te,he,Te,we){var lt=P?Math.min(32640,Math.round(P[0])):0,Lt=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),m,S,(lt<<1)+(V?1:0),Lt,16*te,16*he,256*Te,256*we)}function De(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Zt(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(jl(r[t].text))return!0;return!1}var Kt=function(t){this.layoutVertexArray=new yf,this.indexArray=new Al,this.programConfigurations=t,this.segments=new rt,this.dynamicLayoutVertexArray=new Ul,this.opacityVertexArray=new Bl,this.placedSymbolArray=new l};Kt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Kt.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_f.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Ff.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ke,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},Kt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Rn("SymbolBuffers",Kt);var dr=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new rt,this.collisionVertexArray=new Fc};dr.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Uf.members,!0)},dr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Rn("CollisionBuffers",dr);var rr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(S){return S.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ko([]),this.placementViewportMatrix=ko([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ci(this.zoom,r["text-size"]),this.iconSizeData=Ci(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),m=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(S){return na[S]})),this.stateDependentLayerIds=this.layers.filter(function(S){return S.isStateDependent()}).map(function(S){return S.id}),this.sourceID=t.sourceID};rr.prototype.createArrays=function(){this.text=new Kt(new La(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Kt(new La(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new L,this.lineVertexArray=new j,this.symbolInstances=new O},rr.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(r||u)&&f){var S=Zl[e.charAt(m)];S&&(t[S.charCodeAt(0)]=!0)}},rr.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,m=f.get("text-font"),S=f.get("text-field"),P=f.get("icon-image"),V=(S.value.kind!=="constant"||S.value.value instanceof Xi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),te=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,he=f.get("symbol-sort-key");if(this.features=[],V||te){for(var Te=t.iconDependencies,we=t.glyphDependencies,lt=t.availableImages,Lt=new Pa(this.zoom),St=0,$t=e;St<$t.length;St+=1){var Xt=$t[St],ir=Xt.feature,br=Xt.id,Sr=Xt.index,zr=Xt.sourceLayerIndex,Nr=u._featureFilter.needGeometry,mn=Bi(ir,Nr);if(u._featureFilter.filter(Lt,mn,r)){Nr||(mn.geometry=Ei(ir));var hn=void 0;if(V){var Ln=u.getValueAndResolveTokens("text-field",mn,r,lt),Qn=Xi.factory(Ln);Zt(Qn)&&(this.hasRTLText=!0),(!this.hasRTLText||jc()==="unavailable"||this.hasRTLText&&ls.isParsed())&&(hn=Of(Qn,u,mn))}var Yn=void 0;if(te){var Nn=u.getValueAndResolveTokens("icon-image",mn,r,lt);Yn=Nn instanceof Xo?Nn:Xo.fromString(Nn)}if(hn||Yn){var Ta=this.sortFeaturesByKey?he.evaluate(mn,{},r):void 0;if(this.features.push({id:br,text:hn,icon:Yn,index:Sr,sourceLayerIndex:zr,geometry:mn.geometry,properties:ir.properties,type:_t[ir.type],sortKey:Ta}),Yn&&(Te[Yn.name]=!0),hn){var fa=m.evaluate(mn,{},r).join(","),ra=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(na.vertical)>=0;for(var Ja=0,Da=hn.sections;Ja<Da.length;Ja+=1){var ji=Da[Ja];if(ji.image)Te[ji.image.name]=!0;else{var va=bc(hn.toString()),ai=ji.fontStack||fa,Go=we[ai]=we[ai]||{};this.calculateGlyphDependencies(ji.text,Go,ra,this.allowVerticalPlacement,va)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(bi){var Ho={},Zo={},ns=[],gu=0;function as(Eo){ns.push(bi[Eo]),gu++}function Yu(Eo,Wo,Ru){var di=Zo[Eo];return delete Zo[Eo],Zo[Wo]=di,ns[di].geometry[0].pop(),ns[di].geometry[0]=ns[di].geometry[0].concat(Ru[0]),di}function su(Eo,Wo,Ru){var di=Ho[Wo];return delete Ho[Wo],Ho[Eo]=di,ns[di].geometry[0].shift(),ns[di].geometry[0]=Ru[0].concat(ns[di].geometry[0]),di}function Ku(Eo,Wo,Ru){var di=Ru?Wo[0][Wo[0].length-1]:Wo[0][0];return Eo+":"+di.x+":"+di.y}for(var uu=0;uu<bi.length;uu++){var Ws=bi[uu],lu=Ws.geometry,mi=Ws.text?Ws.text.toString():null;if(mi){var ii=Ku(mi,lu),Ji=Ku(mi,lu,!0);if(ii in Zo&&Ji in Ho&&Zo[ii]!==Ho[Ji]){var fo=su(ii,Ji,lu),yu=Yu(ii,Ji,ns[fo].geometry);delete Ho[ii],delete Zo[Ji],Zo[Ku(mi,ns[yu].geometry,!0)]=yu,ns[fo].geometry=null}else ii in Zo?Yu(ii,Ji,lu):Ji in Ho?su(ii,Ji,lu):(as(uu),Ho[ii]=gu-1,Zo[Ji]=gu-1)}else as(uu)}return ns.filter(function(Eo){return Eo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(bi,Ho){return bi.sortKey-Ho.sortKey})}},rr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},rr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},rr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},rr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},rr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},rr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},rr.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},S=e.segment+1;S<t.length;S++)m[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:u},S<t.length-1&&(u+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)m[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:f},P>0&&(f+=t[P-1].dist(t[P]));for(var V=0;V<t.length;V++){var te=m[V];this.lineVertexArray.emplaceBack(te.x,te.y,te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},rr.prototype.addSymbols=function(e,t,r,u,f,m,S,P,V,te,he,Te){for(var we=e.indexArray,lt=e.layoutVertexArray,Lt=e.segments.prepareSegment(4*t.length,lt,we,this.canOverlap?m.sortKey:void 0),St=this.glyphOffsetArray.length,$t=Lt.vertexLength,Xt=this.allowVerticalPlacement&&S===na.vertical?Math.PI/2:0,ir=m.text&&m.text.sections,br=0;br<t.length;br++){var Sr=t[br],zr=Sr.tl,Nr=Sr.tr,mn=Sr.bl,hn=Sr.br,Ln=Sr.tex,Qn=Sr.pixelOffsetTL,Yn=Sr.pixelOffsetBR,Nn=Sr.minFontScaleX,Ta=Sr.minFontScaleY,fa=Sr.glyphOffset,ra=Sr.isSDF,Ja=Sr.sectionIndex,Da=Lt.vertexLength,ji=fa[1];pt(lt,P.x,P.y,zr.x,ji+zr.y,Ln.x,Ln.y,r,ra,Qn.x,Qn.y,Nn,Ta),pt(lt,P.x,P.y,Nr.x,ji+Nr.y,Ln.x+Ln.w,Ln.y,r,ra,Yn.x,Qn.y,Nn,Ta),pt(lt,P.x,P.y,mn.x,ji+mn.y,Ln.x,Ln.y+Ln.h,r,ra,Qn.x,Yn.y,Nn,Ta),pt(lt,P.x,P.y,hn.x,ji+hn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,ra,Yn.x,Yn.y,Nn,Ta),De(e.dynamicLayoutVertexArray,P,Xt),we.emplaceBack(Da,Da+1,Da+2),we.emplaceBack(Da+1,Da+2,Da+3),Lt.vertexLength+=4,Lt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fa[0]),br!==t.length-1&&Ja===t[br+1].sectionIndex||e.programConfigurations.populatePaintArrays(lt.length,m,m.index,{},Te,ir&&ir[Ja])}e.placedSymbolArray.emplaceBack(P.x,P.y,St,this.glyphOffsetArray.length-St,$t,V,te,P.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],S,0,!1,0,he)},rr.prototype._addCollisionDebugVertex=function(e,t,r,u,f,m){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(m.x),Math.round(m.y))},rr.prototype.addCollisionDebugVertices=function(e,t,r,u,f,m,S){var P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),V=P.vertexLength,te=f.layoutVertexArray,he=f.collisionVertexArray,Te=S.anchorX,we=S.anchorY;this._addCollisionDebugVertex(te,he,m,Te,we,new re(e,t)),this._addCollisionDebugVertex(te,he,m,Te,we,new re(r,t)),this._addCollisionDebugVertex(te,he,m,Te,we,new re(r,u)),this._addCollisionDebugVertex(te,he,m,Te,we,new re(e,u)),P.vertexLength+=4;var lt=f.indexArray;lt.emplaceBack(V,V+1),lt.emplaceBack(V+1,V+2),lt.emplaceBack(V+2,V+3),lt.emplaceBack(V+3,V),P.primitiveLength+=4},rr.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,r)}},rr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dr(fs,uh.members,rc),this.iconCollisionBox=new dr(fs,uh.members,rc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},rr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,m,S,P,V){for(var te={},he=t;he<r;he++){var Te=e.get(he);te.textBox={x1:Te.x1,y1:Te.y1,x2:Te.x2,y2:Te.y2,anchorPointX:Te.anchorPointX,anchorPointY:Te.anchorPointY},te.textFeatureIndex=Te.featureIndex;break}for(var we=u;we<f;we++){var lt=e.get(we);te.verticalTextBox={x1:lt.x1,y1:lt.y1,x2:lt.x2,y2:lt.y2,anchorPointX:lt.anchorPointX,anchorPointY:lt.anchorPointY},te.verticalTextFeatureIndex=lt.featureIndex;break}for(var Lt=m;Lt<S;Lt++){var St=e.get(Lt);te.iconBox={x1:St.x1,y1:St.y1,x2:St.x2,y2:St.y2,anchorPointX:St.anchorPointX,anchorPointY:St.anchorPointY},te.iconFeatureIndex=St.featureIndex;break}for(var $t=P;$t<V;$t++){var Xt=e.get($t);te.verticalIconBox={x1:Xt.x1,y1:Xt.y1,x2:Xt.x2,y2:Xt.y2,anchorPointX:Xt.anchorPointX,anchorPointY:Xt.anchorPointY},te.verticalIconFeatureIndex=Xt.featureIndex;break}return te},rr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},rr.prototype.hasTextData=function(){return this.text.segments.get().length>0},rr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},rr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},rr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},rr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},rr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},rr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],m=[],S=0;S<this.symbolInstances.length;++S){m.push(S);var P=this.symbolInstances.get(S);u.push(0|Math.round(t*P.anchorX+r*P.anchorY)),f.push(P.featureIndex)}return m.sort(function(V,te){return u[V]-u[te]||f[te]-f[V]}),m},rr.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},rr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,S,P){m>=0&&P.indexOf(m)===S&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Rn("SymbolBucket",rr,{omit:["layers","collisionBoxArray","features","compareText"]}),rr.MAX_GLYPHS=65535,rr.addDynamicAttributes=De;var mr=new vo({"symbol-placement":new Jn(Ze.layout_symbol["symbol-placement"]),"symbol-spacing":new Jn(Ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jn(Ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(Ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jn(Ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jn(Ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jn(Ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jn(Ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jn(Ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(Ze.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(Ze.layout_symbol["icon-image"]),"icon-rotate":new jn(Ze.layout_symbol["icon-rotate"]),"icon-padding":new Jn(Ze.layout_symbol["icon-padding"]),"icon-keep-upright":new Jn(Ze.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(Ze.layout_symbol["icon-offset"]),"icon-anchor":new jn(Ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jn(Ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jn(Ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jn(Ze.layout_symbol["text-rotation-alignment"]),"text-field":new jn(Ze.layout_symbol["text-field"]),"text-font":new jn(Ze.layout_symbol["text-font"]),"text-size":new jn(Ze.layout_symbol["text-size"]),"text-max-width":new jn(Ze.layout_symbol["text-max-width"]),"text-line-height":new Jn(Ze.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(Ze.layout_symbol["text-letter-spacing"]),"text-justify":new jn(Ze.layout_symbol["text-justify"]),"text-radial-offset":new jn(Ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jn(Ze.layout_symbol["text-variable-anchor"]),"text-anchor":new jn(Ze.layout_symbol["text-anchor"]),"text-max-angle":new Jn(Ze.layout_symbol["text-max-angle"]),"text-writing-mode":new Jn(Ze.layout_symbol["text-writing-mode"]),"text-rotate":new jn(Ze.layout_symbol["text-rotate"]),"text-padding":new Jn(Ze.layout_symbol["text-padding"]),"text-keep-upright":new Jn(Ze.layout_symbol["text-keep-upright"]),"text-transform":new jn(Ze.layout_symbol["text-transform"]),"text-offset":new jn(Ze.layout_symbol["text-offset"]),"text-allow-overlap":new Jn(Ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jn(Ze.layout_symbol["text-ignore-placement"]),"text-optional":new Jn(Ze.layout_symbol["text-optional"])}),Or={paint:new vo({"icon-opacity":new jn(Ze.paint_symbol["icon-opacity"]),"icon-color":new jn(Ze.paint_symbol["icon-color"]),"icon-halo-color":new jn(Ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(Ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(Ze.paint_symbol["icon-halo-blur"]),"icon-translate":new Jn(Ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jn(Ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(Ze.paint_symbol["text-opacity"]),"text-color":new jn(Ze.paint_symbol["text-color"],{runtimeType:En,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new jn(Ze.paint_symbol["text-halo-color"]),"text-halo-width":new jn(Ze.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(Ze.paint_symbol["text-halo-blur"]),"text-translate":new Jn(Ze.paint_symbol["text-translate"]),"text-translate-anchor":new Jn(Ze.paint_symbol["text-translate-anchor"])}),layout:mr},$r=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:fn,this.defaultValue=t};$r.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},$r.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return null},Rn("FormatSectionOverride",$r,{omit:["defaultValue"]});var Bn=function(e){function t(r){e.call(this,r,Or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],S=0,P=f;S<P.length;S+=1){var V=P[S];m.indexOf(V)<0&&m.push(V)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,m){var S=this.layout.get(r).evaluate(u,{},f,m),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||Lo(P.value)||!S?S:function(V,te){return te.replace(/{([^{}]+)}/g,function(he,Te){return Te in V?String(V[Te]):""})}(u.properties,S)},t.prototype.createBucket=function(r){return new rr(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=Or.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var m,S=this.paint.get(f),P=new $r(S),V=new bl(P,S.property.specification);m=S.value.kind==="constant"||S.value.kind==="source"?new Ll("source",V):new Rl("composite",V,S.value.zoomStops,S.value._interpolationType),this.paint._values[f]=new Cs(S.property,m,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),m=Or.paint.properties[u],S=!1,P=function(Te){for(var we=0,lt=Te;we<lt.length;we+=1)if(m.overrides&&m.overrides.hasOverride(lt[we]))return void(S=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Xi)P(f.value.value.sections);else if(f.value.kind==="source"){var V=function he(Te){S||(Te instanceof ui&&Oi(Te.value)===Ga?P(Te.value.sections):Te instanceof oo?P(Te.sections):Te.eachChild(he))},te=f.value;te._styleExpression&&V(te._styleExpression.expression)}return S},t}(ws),on={paint:new vo({"background-color":new Jn(Ze.paint_background["background-color"]),"background-pattern":new cs(Ze.paint_background["background-pattern"]),"background-opacity":new Jn(Ze.paint_background["background-opacity"])})},Dn=function(e){function t(r){e.call(this,r,on)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ws),ca={paint:new vo({"raster-opacity":new Jn(Ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jn(Ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jn(Ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jn(Ze.paint_raster["raster-brightness-max"]),"raster-saturation":new Jn(Ze.paint_raster["raster-saturation"]),"raster-contrast":new Jn(Ze.paint_raster["raster-contrast"]),"raster-resampling":new Jn(Ze.paint_raster["raster-resampling"]),"raster-fade-duration":new Jn(Ze.paint_raster["raster-fade-duration"])})},Na=function(e){function t(r){e.call(this,r,ca)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ws),ri=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(ws),co={circle:nu,heatmap:af,hillshade:Af,fill:Dr,"fill-extrusion":Ti,line:Eh,symbol:Bn,background:Dn,raster:Na},Hc=X.HTMLImageElement,ys=X.HTMLCanvasElement,fc=X.HTMLVideoElement,xo=X.ImageData,Wl=X.ImageBitmap,Xu=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};Xu.prototype.update=function(e,t,r){var u=e.width,f=e.height,m=!(this.size&&this.size[0]===u&&this.size[1]===f||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[u,f],e instanceof Hc||e instanceof ys||e instanceof fc||e instanceof xo||Wl&&e instanceof Wl?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,u,f,0,this.format,P.UNSIGNED_BYTE,e.data);else{var V=r||{x:0,y:0},te=V.x,he=V.y;e instanceof Hc||e instanceof ys||e instanceof fc||e instanceof xo||Wl&&e instanceof Wl?P.texSubImage2D(P.TEXTURE_2D,0,te,he,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,te,he,u,f,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},Xu.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Xu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Xu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var pl=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};pl.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},pl.prototype.remove=function(){delete this._channel,this._callback=function(){}};var wl=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ct(["receive","process"],this),this.invoker=new pl(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qt()?t:X};function Mf(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}wl.prototype.send=function(e,t,r,u,f){var m=this;f===void 0&&(f=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=J(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:du(t,P)},P),{cancel:function(){r&&delete m.callbacks[S],m.target.postMessage({id:S,type:"<cancel>",targetMapId:u,sourceMapId:m.mapId})}}},wl.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Qt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},wl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},wl.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Bs(t.error)):u(null,Bs(t.data)))}else{var f=!1,m=J(this.globalScope)?void 0:[],S=t.hasCallback?function(he,Te){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:he?du(he):null,data:du(Te,m)},m)}:function(he){f=!0},P=null,V=Bs(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,V,S);else if(this.parent.getWorkerSource){var te=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,te[0],V.source)[te[1]](V,S)}else S(new Error("Could not find function "+t.type));!f&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},wl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var za=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};za.prototype.setNorthEast=function(e){return this._ne=e instanceof li?new li(e.lng,e.lat):li.convert(e),this},za.prototype.setSouthWest=function(e){return this._sw=e instanceof li?new li(e.lng,e.lat):li.convert(e),this},za.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof li)t=e,r=e;else{if(!(e instanceof za))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(za.convert(e)):this.extend(li.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new li(t.lng,t.lat),this._ne=new li(r.lng,r.lat)),this},za.prototype.getCenter=function(){return new li((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},za.prototype.getSouthWest=function(){return this._sw},za.prototype.getNorthEast=function(){return this._ne},za.prototype.getNorthWest=function(){return new li(this.getWest(),this.getNorth())},za.prototype.getSouthEast=function(){return new li(this.getEast(),this.getSouth())},za.prototype.getWest=function(){return this._sw.lng},za.prototype.getSouth=function(){return this._sw.lat},za.prototype.getEast=function(){return this._ne.lng},za.prototype.getNorth=function(){return this._ne.lat},za.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},za.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},za.prototype.isEmpty=function(){return!(this._sw&&this._ne)},za.prototype.contains=function(e){var t=li.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},za.convert=function(e){return!e||e instanceof za?e:new za(e)};var li=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};li.prototype.wrap=function(){return new li(mt(this.lng,-180,180),this.lat)},li.prototype.toArray=function(){return[this.lng,this.lat]},li.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},li.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},li.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new za(new li(this.lng-r,this.lat-t),new li(this.lng+r,this.lat+t))},li.convert=function(e){if(e instanceof li)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new li(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new li(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var lh=2*Math.PI*63710088e-1;function th(e){return lh*Math.cos(e*Math.PI/180)}function Dh(e){return(180+e)/360}function hc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function rh(e,t){return e/th(t)}function Vh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ch=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};ch.fromLngLat=function(e,t){t===void 0&&(t=0);var r=li.convert(e);return new ch(Dh(r.lng),hc(r.lat),rh(t,r.lat))},ch.prototype.toLngLat=function(){return new li(360*this.x-180,Vh(this.y))},ch.prototype.toAltitude=function(){return this.z*th(Vh(this.y))},ch.prototype.meterInMercatorCoordinateUnits=function(){return 1/lh*(e=Vh(this.y),1/Math.cos(e*Math.PI/180));var e};var fh=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=Nh(0,t,t,r,u)};fh.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},fh.prototype.url=function(e,t){var r,u,f,m,S,P=(u=this.y,f=this.z,m=Mf(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),S=Mf(256*(r+1),256*(u+1),f),m[0]+","+m[1]+","+S[0]+","+S[1]),V=function(te,he,Te){for(var we,lt="",Lt=te;Lt>0;Lt--)lt+=(he&(we=1<<Lt-1)?1:0)+(Te&we?2:0);return lt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",P)},fh.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new re(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},fh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qh=function(t,r){this.wrap=t,this.canonical=r,this.key=Nh(t,r.z,r.z,r.x,r.y)},Zs=function(t,r,u,f,m){this.overscaledZ=t,this.wrap=r,this.canonical=new fh(u,+f,+m),this.key=Nh(r,t,u,f,m)};function Nh(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var m=1<<r;return(m*m*e+m*f+u).toString(36)+r.toString(36)+t.toString(36)}Zs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Zs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Zs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Zs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Nh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Nh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Zs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Zs.prototype.children=function(e){if(this.overscaledZ>=e)return[new Zs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Zs(t,this.wrap,t,r,u),new Zs(t,this.wrap,t,r+1,u),new Zs(t,this.wrap,t,r,u+1),new Zs(t,this.wrap,t,r+1,u+1)]},Zs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Zs.prototype.wrapped=function(){return new Zs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.unwrapTo=function(e){return new Zs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Zs.prototype.toUnwrapped=function(){return new qh(this.wrap,this.canonical)},Zs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Zs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ch(e.x-this.wrap,e.y))},Rn("CanonicalTileID",fh),Rn("OverscaledTileID",Zs,{omit:["posMatrix"]});var Vf=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Me('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var m=0;m<f;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(f,m)]=this.data[this._idx(f-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,f)]=this.data[this._idx(m,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Vf.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},Vf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Vf.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Vf.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Vf.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Vf.prototype.getPixels=function(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Vf.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,m=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:m=S-1;break;case 1:S=m+1}for(var P=-t*this.dim,V=-r*this.dim,te=m;te<S;te++)for(var he=u;he<f;he++)this.data[this._idx(he,te)]=e.data[this._idx(he+P,te+V)]},Rn("DEMData",Vf);var Gh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};Gh.prototype.encode=function(e){return this._stringToNumber[e]},Gh.prototype.decode=function(e){return this._numberToString[e]};var Hh=function(t,r,u,f,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=m},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Hh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Hh.prototype,ed);var _h=function(){this.state={},this.stateChanges={},this.deletedStates={}};_h.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Ne(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var m in this.deletedStates[e][u]={},this.state[e][u])r[m]||(this.deletedStates[e][u][m]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][S]===null&&delete this.deletedStates[e][u][S]},_h.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},_h.prototype.getState=function(e,t){var r=String(t),u=Ne({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete u[m]}return u},_h.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},_h.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Ne(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];r[u]=f}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(this.deletedStates[S]===null)for(var V in this.state[S])P[V]={},this.state[S][V]={};else for(var te in this.deletedStates[S]){if(this.deletedStates[S][te]===null)this.state[S][te]={};else for(var he=0,Te=Object.keys(this.deletedStates[S][te]);he<Te.length;he+=1)delete this.state[S][te][Te[he]];P[te]=this.state[S][te]}r[S]=r[S]||{},Ne(r[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var we in e)e[we].setFeatureState(r,t)};var Gf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ol(8192,16,0),this.grid3D=new ol(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function td(e,t,r,u,f){return Re(e,function(m,S){var P=t instanceof xc?t.get(S):null;return P&&P.evaluate?P.evaluate(r,u,f):P})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,m=0,S=e;m<S.length;m+=1){var P=S[m];t=Math.min(t,P.x),r=Math.min(r,P.y),u=Math.max(u,P.x),f=Math.max(f,P.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ld(e,t){return t-e}Gf.prototype.insert=function(e,t,r,u,f,m){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var P=m?this.grid3D:this.grid,V=0;V<t.length;V++){for(var te=t[V],he=[1/0,1/0,-1/0,-1/0],Te=0;Te<te.length;Te++){var we=te[Te];he[0]=Math.min(he[0],we.x),he[1]=Math.min(he[1],we.y),he[2]=Math.max(he[2],we.x),he[3]=Math.max(he[3],we.y)}he[0]<8192&&he[1]<8192&&he[2]>=0&&he[3]>=0&&P.insert(S,he[0],he[1],he[2],he[3])}},Gf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Co.VectorTile(new je(this.rawTileData)).layers,this.sourceLayerCoder=new Gh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Gf.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var m=e.params||{},S=8192/e.tileSize/e.scale,P=gc(m.filter),V=e.queryGeometry,te=e.queryPadding*S,he=rd(V),Te=this.grid.query(he.minX-te,he.minY-te,he.maxX+te,he.maxY+te),we=rd(e.cameraQueryGeometry),lt=this.grid3D.query(we.minX-te,we.minY-te,we.maxX+te,we.maxY+te,function(Sr,zr,Nr,mn){return function(hn,Ln,Qn,Yn,Nn){for(var Ta=0,fa=hn;Ta<fa.length;Ta+=1){var ra=fa[Ta];if(Ln<=ra.x&&Qn<=ra.y&&Yn>=ra.x&&Nn>=ra.y)return!0}var Ja=[new re(Ln,Qn),new re(Ln,Nn),new re(Yn,Nn),new re(Yn,Qn)];if(hn.length>2){for(var Da=0,ji=Ja;Da<ji.length;Da+=1)if(ru(hn,ji[Da]))return!0}for(var va=0;va<hn.length-1;va++)if(Mu(hn[va],hn[va+1],Ja))return!0;return!1}(e.cameraQueryGeometry,Sr-te,zr-te,Nr+te,mn+te)}),Lt=0,St=lt;Lt<St.length;Lt+=1)Te.push(St[Lt]);Te.sort(ld);for(var $t,Xt={},ir=function(zr){var Nr=Te[zr];if(Nr!==$t){$t=Nr;var mn=f.featureIndexArray.get(Nr),hn=null;f.loadMatchingFeature(Xt,mn.bucketIndex,mn.sourceLayerIndex,mn.featureIndex,P,m.layers,m.availableImages,t,r,u,function(Ln,Qn,Yn){return hn||(hn=Ei(Ln)),Qn.queryIntersectsFeature(V,Ln,Yn,hn,f.z,e.transform,S,e.pixelPosMatrix)})}},br=0;br<Te.length;br++)ir(br);return Xt},Gf.prototype.loadMatchingFeature=function(e,t,r,u,f,m,S,P,V,te,he){var Te=this.bucketLayerIDs[t];if(!m||function(hn,Ln){for(var Qn=0;Qn<hn.length;Qn++)if(Ln.indexOf(hn[Qn])>=0)return!0;return!1}(m,Te)){var we=this.sourceLayerCoder.decode(r),lt=this.vtLayers[we].feature(u);if(f.needGeometry){var Lt=Bi(lt,!0);if(!f.filter(new Pa(this.tileID.overscaledZ),Lt,this.tileID.canonical))return}else if(!f.filter(new Pa(this.tileID.overscaledZ),lt))return;for(var St=this.getId(lt,we),$t=0;$t<Te.length;$t++){var Xt=Te[$t];if(!(m&&m.indexOf(Xt)<0)){var ir=P[Xt];if(ir){var br={};St!==void 0&&te&&(br=te.getState(ir.sourceLayer||"_geojsonTileLayer",St));var Sr=Ne({},V[Xt]);Sr.paint=td(Sr.paint,ir.paint,lt,br,S),Sr.layout=td(Sr.layout,ir.layout,lt,br,S);var zr=!he||he(lt,ir,br);if(zr){var Nr=new Hh(lt,this.z,this.x,this.y,St);Nr.layer=Sr;var mn=e[Xt];mn===void 0&&(mn=e[Xt]=[]),mn.push({featureIndex:u,feature:Nr,intersectionZ:zr})}}}}}},Gf.prototype.lookupSymbolFeatures=function(e,t,r,u,f,m,S,P){var V={};this.loadVTLayers();for(var te=gc(f),he=0,Te=e;he<Te.length;he+=1)this.loadMatchingFeature(V,r,u,Te[he],te,m,S,P,t);return V},Gf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Gf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},Rn("FeatureIndex",Gf,{omit:["rawTileData","sourceLayerCoder"]});var bs=function(t,r){this.tileID=t,this.uid=Ye(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};bs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ve.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},bs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},bs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(te,he){var Te={};if(!he)return Te;for(var we=function(){var $t=Lt[lt],Xt=$t.layerIds.map(function(Sr){return he.getLayer(Sr)}).filter(Boolean);if(Xt.length!==0){$t.layers=Xt,$t.stateDependentLayerIds&&($t.stateDependentLayers=$t.stateDependentLayerIds.map(function(Sr){return Xt.filter(function(zr){return zr.id===Sr})[0]}));for(var ir=0,br=Xt;ir<br.length;ir+=1)Te[br[ir].id]=$t}},lt=0,Lt=te;lt<Lt.length;lt+=1)we();return Te}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof rr){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var S=this.buckets[m];if(S instanceof rr&&S.hasRTLText){this.hasRTLText=!0,ls.isLoading()||ls.isLoaded()||jc()!=="deferred"||Ro();break}}for(var P in this.queryPadding=0,this.buckets){var V=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(V))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},bs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},bs.prototype.getBucket=function(e){return this.buckets[e.id]},bs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xu(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xu(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},bs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},bs.prototype.queryRenderedFeatures=function(e,t,r,u,f,m,S,P,V,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:te,transform:P,params:S,queryPadding:this.queryPadding*V},e,t,r):{}},bs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(m)for(var S=gc(t&&t.filter),P=this.tileID.canonical,V=P.z,te=P.x,he=P.y,Te={z:V,x:te,y:he},we=0;we<m.length;we++){var lt=m.feature(we);if(S.needGeometry){var Lt=Bi(lt,!0);if(!S.filter(new Pa(this.tileID.overscaledZ),Lt,this.tileID.canonical))continue}else if(!S.filter(new Pa(this.tileID.overscaledZ),lt))continue;var St=r.getId(lt,f),$t=new Hh(lt,V,te,he,St);$t.tile=Te,e.push($t)}}},bs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},bs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},bs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ur(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=u+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},bs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},bs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],m=f.layers[0].sourceLayer||"_geojsonTileLayer",S=r[m],P=e[m];if(S&&P&&Object.keys(P).length!==0){f.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var V=t&&t.style&&t.style.getLayer(u);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(f)))}}}},bs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},bs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ve.now()},bs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},bs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ve.now()+e},bs.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},bs.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var m=0,S=t;m<S.length;m+=1)if(f[S[m]])return!0}}return!1};var Hf=X.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Hf.mark(this._marks.start)};cd.prototype.finish=function(){Hf.mark(this._marks.end);var e=Hf.getEntriesByName(this._marks.measure);return e.length===0&&(Hf.measure(this._marks.measure,this._marks.start,this._marks.end),e=Hf.getEntriesByName(this._marks.measure),Hf.clearMarks(this._marks.start),Hf.clearMarks(this._marks.end),Hf.clearMeasures(this._marks.measure)),e},i.Actor=wl,i.AlphaImage=ks,i.CanonicalTileID=fh,i.CollisionBoxArray=a,i.Color=ha,i.DEMData=Vf,i.DataConstantProperty=Jn,i.DictionaryCoder=Gh,i.EXTENT=8192,i.ErrorEvent=wt,i.EvaluationParameters=Pa,i.Event=ut,i.Evented=Bt,i.FeatureIndex=Gf,i.FillBucket=Yt,i.FillExtrusionBucket=qa,i.ImageAtlas=Xn,i.ImagePosition=Vr,i.LineBucket=Lu,i.LngLat=li,i.LngLatBounds=za,i.MercatorCoordinate=ch,i.ONE_EM=24,i.OverscaledTileID=Zs,i.Point=re,i.Point$1=re,i.Properties=vo,i.Protobuf=je,i.RGBAImage=go,i.RequestManager=R,i.RequestPerformance=cd,i.ResourceType=Zr,i.SegmentVector=rt,i.SourceFeatureState=_h,i.StructArrayLayout1ui2=nc,i.StructArrayLayout2f1f2i16=Bu,i.StructArrayLayout2i4=mu,i.StructArrayLayout3ui6=Al,i.StructArrayLayout4i8=cl,i.SymbolBucket=rr,i.Texture=Xu,i.Tile=bs,i.Transitionable=So,i.Uniform1f=an,i.Uniform1i=Cr,i.Uniform2f=Yr,i.Uniform3f=vn,i.Uniform4f=Pn,i.UniformColor=qn,i.UniformMatrix4f=Aa,i.UnwrappedTileID=qh,i.ValidationError=Rt,i.WritingMode=na,i.ZoomHistory=sl,i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},i.addDynamicAttributes=De,i.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),m=null;e.forEach(function(S,P){t(S,function(V,te){V&&(m=V),f[P]=te,--u==0&&r(m,f)})})},i.bezier=Xe,i.bindAll=Ct,i.browser=ve,i.cacheEntryPossiblyAdded=function(e){++Ht>xt&&(e.getActor().send("enforceCacheSizeLimit",yt),Ht=0)},i.clamp=Ce,i.clearTileCache=function(e){var t=X.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},i.clipLine=An,i.clone=function(e){var t=new No(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.clone$1=Be,i.clone$2=function(e){var t=new No(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.collisionCircleLayout=Bf,i.config=ge,i.create=function(){var e=new No(16);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},i.create$1=function(){var e=new No(9);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},i.create$2=function(){var e=new No(4);return No!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},i.createCommonjsModule=Z,i.createExpression=Jl,i.createLayout=no,i.createStyleLayer=function(e){return e.type==="custom"?new ri(e):new co[e.type](e)},i.cross=function(e,t,r){var u=t[0],f=t[1],m=t[2],S=r[0],P=r[1],V=r[2];return e[0]=f*V-m*P,e[1]=m*S-u*V,e[2]=u*P-f*S,e},i.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.ease=pe,i.emitValidationErrors=il,i.endsWith=Ot,i.enforceCacheSizeLimit=function(e){ze(),Qe&&Qe.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},i.evaluateSizeForFeature=vs,i.evaluateSizeForZoom=Fo,i.evaluateVariableOffset=Q,i.evented=rf,i.extend=Ne,i.featureFilter=gc,i.filterObject=Ie,i.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.getAnchorAlignment=zo,i.getAnchorJustification=We,i.getArrayBuffer=Kn,i.getImage=W,i.getJSON=function(e,t){return $n(Ne(e,{type:"json"}),t)},i.getRTLTextPluginStatus=jc,i.getReferrer=Vn,i.getVideo=function(e,t){var r,u,f=X.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var S=X.document.createElement("source");r=e[m],u=void 0,(u=X.document.createElement("a")).href=r,(u.protocol!==X.document.location.protocol||u.host!==X.document.location.host)&&(f.crossOrigin="Anonymous"),S.src=e[m],f.appendChild(S)}return{cancel:function(){}}},i.identity=ko,i.invert=function(e,t){var r=t[0],u=t[1],f=t[2],m=t[3],S=t[4],P=t[5],V=t[6],te=t[7],he=t[8],Te=t[9],we=t[10],lt=t[11],Lt=t[12],St=t[13],$t=t[14],Xt=t[15],ir=r*P-u*S,br=r*V-f*S,Sr=r*te-m*S,zr=u*V-f*P,Nr=u*te-m*P,mn=f*te-m*V,hn=he*St-Te*Lt,Ln=he*$t-we*Lt,Qn=he*Xt-lt*Lt,Yn=Te*$t-we*St,Nn=Te*Xt-lt*St,Ta=we*Xt-lt*$t,fa=ir*Ta-br*Nn+Sr*Yn+zr*Qn-Nr*Ln+mn*hn;return fa?(e[0]=(P*Ta-V*Nn+te*Yn)*(fa=1/fa),e[1]=(f*Nn-u*Ta-m*Yn)*fa,e[2]=(St*mn-$t*Nr+Xt*zr)*fa,e[3]=(we*Nr-Te*mn-lt*zr)*fa,e[4]=(V*Qn-S*Ta-te*Ln)*fa,e[5]=(r*Ta-f*Qn+m*Ln)*fa,e[6]=($t*Sr-Lt*mn-Xt*br)*fa,e[7]=(he*mn-we*Sr+lt*br)*fa,e[8]=(S*Nn-P*Qn+te*hn)*fa,e[9]=(u*Qn-r*Nn-m*hn)*fa,e[10]=(Lt*Nr-St*Sr+Xt*ir)*fa,e[11]=(Te*Sr-he*Nr-lt*ir)*fa,e[12]=(P*Ln-S*Yn-V*hn)*fa,e[13]=(r*Yn-u*Ln+f*hn)*fa,e[14]=(St*br-Lt*zr-$t*ir)*fa,e[15]=(he*zr-Te*br+we*ir)*fa,e):null},i.isChar=tn,i.isMapboxURL=q,i.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},i.makeRequest=$n,i.mapObject=Re,i.mercatorXfromLng=Dh,i.mercatorYfromLat=hc,i.mercatorZfromAltitude=rh,i.mul=uo,i.multiply=Ko,i.mvt=Co,i.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},i.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],m=r*r+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},i.number=Gi,i.offscreenCanvasSupported=hr,i.ortho=function(e,t,r,u,f,m,S){var P=1/(t-r),V=1/(u-f),te=1/(m-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*V,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*te,e[11]=0,e[12]=(t+r)*P,e[13]=(f+u)*V,e[14]=(S+m)*te,e[15]=1,e},i.parseGlyphPBF=function(e){return new je(e).readFields(Ir,[])},i.pbf=je,i.performSymbolLayout=function(e,t,r,u,f,m,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,V=e.layers[0]._unevaluatedLayout._values,te={};if(e.textSizeData.kind==="composite"){var he=e.textSizeData,Te=he.maxZoom;te.compositeTextSizes=[V["text-size"].possiblyEvaluate(new Pa(he.minZoom),S),V["text-size"].possiblyEvaluate(new Pa(Te),S)]}if(e.iconSizeData.kind==="composite"){var we=e.iconSizeData,lt=we.maxZoom;te.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new Pa(we.minZoom),S),V["icon-size"].possiblyEvaluate(new Pa(lt),S)]}te.layoutTextSize=V["text-size"].possiblyEvaluate(new Pa(e.zoom+1),S),te.layoutIconSize=V["icon-size"].possiblyEvaluate(new Pa(e.zoom+1),S),te.textMaxSize=V["text-size"].possiblyEvaluate(new Pa(18));for(var Lt=24*P.get("text-line-height"),St=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",$t=P.get("text-keep-upright"),Xt=P.get("text-size"),ir=function(){var Nr=Sr[br],mn=P.get("text-font").evaluate(Nr,{},S).join(","),hn=Xt.evaluate(Nr,{},S),Ln=te.layoutTextSize.evaluate(Nr,{},S),Qn=te.layoutIconSize.evaluate(Nr,{},S),Yn={horizontal:{},vertical:void 0},Nn=Nr.text,Ta=[0,0];if(Nn){var fa=Nn.toString(),ra=24*P.get("text-letter-spacing").evaluate(Nr,{},S),Ja=function(mi){for(var ii=0,Ji=mi;ii<Ji.length;ii+=1)if(fo=Ji[ii].charCodeAt(0),tn.Arabic(fo)||tn["Arabic Supplement"](fo)||tn["Arabic Extended-A"](fo)||tn["Arabic Presentation Forms-A"](fo)||tn["Arabic Presentation Forms-B"](fo))return!1;var fo;return!0}(fa)?ra:0,Da=P.get("text-anchor").evaluate(Nr,{},S),ji=P.get("text-variable-anchor");if(!ji){var va=P.get("text-radial-offset").evaluate(Nr,{},S);Ta=va?Q(Da,[24*va,k]):P.get("text-offset").evaluate(Nr,{},S).map(function(mi){return 24*mi})}var ai=St?"center":P.get("text-justify").evaluate(Nr,{},S),Go=P.get("symbol-placement"),bi=Go==="point"?24*P.get("text-max-width").evaluate(Nr,{},S):0,Ho=function(){e.allowVerticalPlacement&&bc(fa)&&(Yn.vertical=jr(Nn,t,r,f,mn,bi,Lt,Da,"left",Ja,Ta,na.vertical,!0,Go,Ln,hn))};if(!St&&ji){for(var Zo=ai==="auto"?ji.map(function(mi){return We(mi)}):[ai],ns=!1,gu=0;gu<Zo.length;gu++){var as=Zo[gu];if(!Yn.horizontal[as])if(ns)Yn.horizontal[as]=Yn.horizontal[0];else{var Yu=jr(Nn,t,r,f,mn,bi,Lt,"center",as,Ja,Ta,na.horizontal,!1,Go,Ln,hn);Yu&&(Yn.horizontal[as]=Yu,ns=Yu.positionedLines.length===1)}}Ho()}else{ai==="auto"&&(ai=We(Da));var su=jr(Nn,t,r,f,mn,bi,Lt,Da,ai,Ja,Ta,na.horizontal,!1,Go,Ln,hn);su&&(Yn.horizontal[ai]=su),Ho(),bc(fa)&&St&&$t&&(Yn.vertical=jr(Nn,t,r,f,mn,bi,Lt,Da,ai,Ja,Ta,na.vertical,!1,Go,Ln,hn))}}var Ku=void 0,uu=!1;if(Nr.icon&&Nr.icon.name){var Ws=u[Nr.icon.name];Ws&&(Ku=function(mi,ii,Ji){var fo=zo(Ji),yu=ii[0]-mi.displaySize[0]*fo.horizontalAlign,Eo=ii[1]-mi.displaySize[1]*fo.verticalAlign;return{image:mi,top:Eo,bottom:Eo+mi.displaySize[1],left:yu,right:yu+mi.displaySize[0]}}(f[Nr.icon.name],P.get("icon-offset").evaluate(Nr,{},S),P.get("icon-anchor").evaluate(Nr,{},S)),uu=Ws.sdf,e.sdfIcons===void 0?e.sdfIcons=Ws.sdf:e.sdfIcons!==Ws.sdf&&Me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ws.pixelRatio!==e.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var lu=Pe(Yn.horizontal)||Yn.vertical;e.iconsInText=!!lu&&lu.iconsInText,(lu||Ku)&&function(mi,ii,Ji,fo,yu,Eo,Wo,Ru,di,Zf,Zc){var cf=Eo.textMaxSize.evaluate(ii,{});cf===void 0&&(cf=Wo);var dc,Iu=mi.layers[0].layout,Pf=Iu.get("icon-offset").evaluate(ii,{},Zc),Lf=Pe(Ji.horizontal),Wf=Wo/24,Th=mi.tilePixelRatio*Wf,Tf=mi.tilePixelRatio*cf/24,Sh=mi.tilePixelRatio*Ru,Xf=mi.tilePixelRatio*Iu.get("symbol-spacing"),hh=Iu.get("text-padding")*mi.tilePixelRatio,Zh=Iu.get("icon-padding")*mi.tilePixelRatio,kh=Iu.get("text-max-angle")/180*Math.PI,Wh=Iu.get("text-rotation-alignment")==="map"&&Iu.get("symbol-placement")!=="point",dh=Iu.get("icon-rotation-alignment")==="map"&&Iu.get("symbol-placement")!=="point",Ah=Iu.get("symbol-placement"),Xh=Xf/2,ph=Iu.get("icon-text-fit");fo&&ph!=="none"&&(mi.allowVerticalPlacement&&Ji.vertical&&(dc=ei(fo,Ji.vertical,ph,Iu.get("icon-text-fit-padding"),Pf,Wf)),Lf&&(fo=ei(fo,Lf,ph,Iu.get("icon-text-fit-padding"),Pf,Wf)));var Yf=function(fd,Lh){Lh.x<0||Lh.x>=8192||Lh.y<0||Lh.y>=8192||function(xs,Wc,hd,Kf,od,h,T,E,b,A,M,U,ie,de,Ue,Ft,er,Mr,kr,xn,yn,zn,Sa,wa,Ri){var oi,si,Qi,Oa,qi,_o=xs.addToLineVertexArray(Wc,hd),Xs=0,Xa=0,Ms=0,$o=0,ff=-1,Rh=-1,wc={},bh=jt(""),ah=0,Xc=0;if(E._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ah=(oi=E.layout.get("text-offset").evaluate(yn,{},wa).map(function(Td){return 24*Td}))[0],Xc=oi[1]):(ah=24*E.layout.get("text-radial-offset").evaluate(yn,{},wa),Xc=k),xs.allowVerticalPlacement&&Kf.vertical){var dd=E.layout.get("text-rotate").evaluate(yn,{},wa)+90;Oa=new c(b,Wc,A,M,U,Kf.vertical,ie,de,Ue,dd),T&&(qi=new c(b,Wc,A,M,U,T,er,Mr,Ue,dd))}if(od){var sd=E.layout.get("icon-rotate").evaluate(yn,{}),pd=E.layout.get("icon-text-fit")!=="none",md=Ra(od,sd,Sa,pd),ud=T?Ra(T,sd,Sa,pd):void 0;Qi=new c(b,Wc,A,M,U,od,er,Mr,!1,sd),Xs=4*md.length;var vd=xs.iconSizeData,Bh=null;vd.kind==="source"?(Bh=[128*E.layout.get("icon-size").evaluate(yn,{})])[0]>32640&&Me(xs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):vd.kind==="composite"&&((Bh=[128*zn.compositeIconSizes[0].evaluate(yn,{},wa),128*zn.compositeIconSizes[1].evaluate(yn,{},wa)])[0]>32640||Bh[1]>32640)&&Me(xs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),xs.addSymbols(xs.icon,md,Bh,xn,kr,yn,!1,Wc,_o.lineStartIndex,_o.lineLength,-1,wa),ff=xs.icon.placedSymbolArray.length-1,ud&&(Xa=4*ud.length,xs.addSymbols(xs.icon,ud,Bh,xn,kr,yn,na.vertical,Wc,_o.lineStartIndex,_o.lineLength,-1,wa),Rh=xs.icon.placedSymbolArray.length-1)}for(var gd in Kf.horizontal){var Qh=Kf.horizontal[gd];if(!si){bh=jt(Qh.text);var ka=E.layout.get("text-rotate").evaluate(yn,{},wa);si=new c(b,Wc,A,M,U,Qh,ie,de,Ue,ka)}var zi=Qh.positionedLines.length===1;if(Ms+=tt(xs,Wc,Qh,h,E,Ue,yn,Ft,_o,Kf.vertical?na.horizontal:na.horizontalOnly,zi?Object.keys(Kf.horizontal):[gd],wc,ff,zn,wa),zi)break}Kf.vertical&&($o+=tt(xs,Wc,Kf.vertical,h,E,Ue,yn,Ft,_o,na.vertical,["vertical"],wc,Rh,zn,wa));var ci=si?si.boxStartIndex:xs.collisionBoxArray.length,In=si?si.boxEndIndex:xs.collisionBoxArray.length,Oc=Oa?Oa.boxStartIndex:xs.collisionBoxArray.length,Es=Oa?Oa.boxEndIndex:xs.collisionBoxArray.length,Yc=Qi?Qi.boxStartIndex:xs.collisionBoxArray.length,Kc=Qi?Qi.boxEndIndex:xs.collisionBoxArray.length,xh=qi?qi.boxStartIndex:xs.collisionBoxArray.length,yd=qi?qi.boxEndIndex:xs.collisionBoxArray.length,ih=-1,bd=function(xd,Sd){return xd&&xd.circleDiameter?Math.max(xd.circleDiameter,Sd):Sd};ih=bd(si,ih),ih=bd(Oa,ih),ih=bd(Qi,ih);var _d=(ih=bd(qi,ih))>-1?1:0;_d&&(ih*=Ri/24),xs.glyphOffsetArray.length>=rr.MAX_GLYPHS&&Me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),yn.sortKey!==void 0&&xs.addToSortKeyRanges(xs.symbolInstances.length,yn.sortKey),xs.symbolInstances.emplaceBack(Wc.x,Wc.y,wc.right>=0?wc.right:-1,wc.center>=0?wc.center:-1,wc.left>=0?wc.left:-1,wc.vertical||-1,ff,Rh,bh,ci,In,Oc,Es,Yc,Kc,xh,yd,A,Ms,$o,Xs,Xa,_d,0,ie,ah,Xc,ih)}(mi,Lh,fd,Ji,fo,yu,dc,mi.layers[0],mi.collisionBoxArray,ii.index,ii.sourceLayerIndex,mi.index,Th,hh,Wh,di,Sh,Zh,dh,Pf,ii,Eo,Zf,Zc,Wo)};if(Ah==="line")for(var nh=0,Yh=An(ii.geometry,0,0,8192,8192);nh<Yh.length;nh+=1)for(var jh=Yh[nh],mh=0,zh=yi(jh,Xf,kh,Ji.vertical||Lf,fo,24,Tf,mi.overscaling,8192);mh<zh.length;mh+=1){var Ch=zh[mh];Lf&&Je(mi,Lf.text,Xh,Ch)||Yf(jh,Ch)}else if(Ah==="line-center")for(var vh=0,Fh=ii.geometry;vh<Fh.length;vh+=1){var Uh=Fh[vh];if(Uh.length>1){var wh=ou(Uh,kh,Ji.vertical||Lf,fo,24,Tf);wh&&Yf(Uh,wh)}}else if(ii.type==="Polygon")for(var Oh=0,gh=N(ii.geometry,0);Oh<gh.length;Oh+=1){var Mh=gh[Oh],yh=I(Mh,16);Yf(Mh[0],new bo(yh.x,yh.y,0))}else if(ii.type==="LineString")for(var Rf=0,Ph=ii.geometry;Rf<Ph.length;Rf+=1){var Kh=Ph[Rf];Yf(Kh,new bo(Kh[0].x,Kh[0].y,0))}else if(ii.type==="Point")for(var $h=0,nd=ii.geometry;$h<nd.length;$h+=1)for(var ad=0,id=nd[$h];ad<id.length;ad+=1){var Jh=id[ad];Yf([Jh],new bo(Jh.x,Jh.y,0))}}(e,Nr,Yn,Ku,u,te,Ln,Qn,Ta,uu,S)},br=0,Sr=e.features;br<Sr.length;br+=1)ir();m&&e.generateCollisionDebugBuffers()},i.perspective=function(e,t,r,u,f){var m,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(m=1/(u-f)),e[14]=2*f*u*m):(e[10]=-1,e[14]=-2*u),e},i.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},i.plugin=ls,i.polygonIntersectsPolygon=vu,i.postMapLoadEvent=bt,i.postTurnstileEvent=pr,i.potpack=Fr,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=Rn,i.registerForPluginStateChange=function(e){return e({pluginStatus:Vs,pluginURL:Su}),rf.on("pluginStateChange",e),e},i.renderColorRamp=ms,i.rotate=function(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3],P=Math.sin(r),V=Math.cos(r);return e[0]=u*V+m*P,e[1]=f*V+S*P,e[2]=u*-P+m*V,e[3]=f*-P+S*V,e},i.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),m=t[4],S=t[5],P=t[6],V=t[7],te=t[8],he=t[9],Te=t[10],we=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+te*u,e[5]=S*f+he*u,e[6]=P*f+Te*u,e[7]=V*f+we*u,e[8]=te*f-m*u,e[9]=he*f-S*u,e[10]=Te*f-P*u,e[11]=we*f-V*u,e},i.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),m=t[0],S=t[1],P=t[2],V=t[3],te=t[4],he=t[5],Te=t[6],we=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+te*u,e[1]=S*f+he*u,e[2]=P*f+Te*u,e[3]=V*f+we*u,e[4]=te*f-m*u,e[5]=he*f-S*u,e[6]=Te*f-P*u,e[7]=we*f-V*u,e},i.scale=function(e,t,r){var u=r[0],f=r[1],m=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},i.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},i.setCacheLimits=function(e,t){yt=e,xt=t},i.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Vs==="deferred"||Vs==="loading"||Vs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Su=ve.resolveURL(e),Vs="deferred",kc=t,Fl(),r||Ro()},i.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},i.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},i.styleSpec=Ze,i.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},i.symbolSize=gs,i.transformMat3=function(e,t,r){var u=t[0],f=t[1],m=t[2];return e[0]=u*r[0]+f*r[3]+m*r[6],e[1]=u*r[1]+f*r[4]+m*r[7],e[2]=u*r[2]+f*r[5]+m*r[8],e},i.transformMat4=Ns,i.translate=function(e,t,r){var u,f,m,S,P,V,te,he,Te,we,lt,Lt,St=r[0],$t=r[1],Xt=r[2];return t===e?(e[12]=t[0]*St+t[4]*$t+t[8]*Xt+t[12],e[13]=t[1]*St+t[5]*$t+t[9]*Xt+t[13],e[14]=t[2]*St+t[6]*$t+t[10]*Xt+t[14],e[15]=t[3]*St+t[7]*$t+t[11]*Xt+t[15]):(f=t[1],m=t[2],S=t[3],P=t[4],V=t[5],te=t[6],he=t[7],Te=t[8],we=t[9],lt=t[10],Lt=t[11],e[0]=u=t[0],e[1]=f,e[2]=m,e[3]=S,e[4]=P,e[5]=V,e[6]=te,e[7]=he,e[8]=Te,e[9]=we,e[10]=lt,e[11]=Lt,e[12]=u*St+P*$t+Te*Xt+t[12],e[13]=f*St+V*$t+we*Xt+t[13],e[14]=m*St+te*$t+lt*Xt+t[14],e[15]=S*St+he*$t+Lt*Xt+t[15]),e},i.triggerPluginCompletionEvent=zl,i.uniqueId=Ye,i.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},i.validateLight=gf,i.validateStyle=al,i.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},i.vectorTile=Co,i.version="1.13.0",i.warnOnce=Me,i.webpSupported=Ve,i.window=X,i.wrap=mt}),z(["./shared"],function(i){"use strict";function Z(F){var W=typeof F;if(W==="number"||W==="boolean"||W==="string"||F==null)return JSON.stringify(F);if(Array.isArray(F)){for(var le="[",xe=0,ut=F;xe<ut.length;xe+=1)le+=Z(ut[xe])+",";return le+"]"}for(var wt=Object.keys(F).sort(),Bt="{",Ze=0;Ze<wt.length;Ze++)Bt+=JSON.stringify(wt[Ze])+":"+Z(F[wt[Ze]])+",";return Bt+"}"}function D(F){for(var W="",le=0,xe=i.refProperties;le<xe.length;le+=1)W+="/"+Z(F[xe[le]]);return W}var K=function(W){this.keyCache={},W&&this.replace(W)};K.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},K.prototype.update=function(F,W){for(var le=this,xe=0,ut=F;xe<ut.length;xe+=1){var wt=ut[xe];this._layerConfigs[wt.id]=wt;var Bt=this._layers[wt.id]=i.createStyleLayer(wt);Bt._featureFilter=i.featureFilter(Bt.filter),this.keyCache[wt.id]&&delete this.keyCache[wt.id]}for(var Ze=0,Rt=W;Ze<Rt.length;Ze+=1){var lr=Rt[Ze];delete this.keyCache[lr],delete this._layerConfigs[lr],delete this._layers[lr]}this.familiesBySource={};for(var Ur=0,Gr=function(dn,En){for(var bn={},gn=0;gn<dn.length;gn++){var Mn=En&&En[dn[gn].id]||D(dn[gn]);En&&(En[dn[gn].id]=Mn);var Ga=bn[Mn];Ga||(Ga=bn[Mn]=[]),Ga.push(dn[gn])}var ga=[];for(var Ma in bn)ga.push(bn[Ma]);return ga}(i.values(this._layerConfigs),this.keyCache);Ur<Gr.length;Ur+=1){var cr=Gr[Ur].map(function(dn){return le._layers[dn.id]}),Br=cr[0];if(Br.visibility!=="none"){var wn=Br.source||"",fn=this.familiesBySource[wn];fn||(fn=this.familiesBySource[wn]={});var tr=Br.sourceLayer||"_geojsonTileLayer",rn=fn[tr];rn||(rn=fn[tr]=[]),rn.push(cr)}}};var re=function(W){var le={},xe=[];for(var ut in W){var wt=W[ut],Bt=le[ut]={};for(var Ze in wt){var Rt=wt[+Ze];if(Rt&&Rt.bitmap.width!==0&&Rt.bitmap.height!==0){var lr={x:0,y:0,w:Rt.bitmap.width+2,h:Rt.bitmap.height+2};xe.push(lr),Bt[Ze]={rect:lr,metrics:Rt.metrics}}}}var Ur=i.potpack(xe),Gr=new i.AlphaImage({width:Ur.w||1,height:Ur.h||1});for(var cr in W){var Br=W[cr];for(var wn in Br){var fn=Br[+wn];if(fn&&fn.bitmap.width!==0&&fn.bitmap.height!==0){var tr=le[cr][wn].rect;i.AlphaImage.copy(fn.bitmap,Gr,{x:0,y:0},{x:tr.x+1,y:tr.y+1},fn.bitmap)}}}this.image=Gr,this.positions=le};i.register("GlyphAtlas",re);var fe=function(W){this.tileID=new i.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId};function X(F,W,le){for(var xe=new i.EvaluationParameters(W),ut=0,wt=F;ut<wt.length;ut+=1)wt[ut].recalculate(xe,le)}function He(F,W){var le=i.getArrayBuffer(F.request,function(xe,ut,wt,Bt){xe?W(xe):ut&&W(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(ut)),rawData:ut,cacheControl:wt,expires:Bt})});return function(){le.cancel(),W()}}fe.prototype.parse=function(F,W,le,xe,ut){var wt=this;this.status="parsing",this.data=F,this.collisionBoxArray=new i.CollisionBoxArray;var Bt=new i.DictionaryCoder(Object.keys(F.layers).sort()),Ze=new i.FeatureIndex(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];var Rt,lr,Ur,Gr,cr={},Br={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},wn=W.familiesBySource[this.source];for(var fn in wn){var tr=F.layers[fn];if(tr){tr.version===1&&i.warnOnce('Vector tile source "'+this.source+'" layer "'+fn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var rn=Bt.encode(fn),dn=[],En=0;En<tr.length;En++){var bn=tr.feature(En),gn=Ze.getId(bn,fn);dn.push({feature:bn,id:gn,index:En,sourceLayerIndex:rn})}for(var Mn=0,Ga=wn[fn];Mn<Ga.length;Mn+=1){var ga=Ga[Mn],Ma=ga[0];Ma.minzoom&&this.zoom<Math.floor(Ma.minzoom)||Ma.maxzoom&&this.zoom>=Ma.maxzoom||Ma.visibility!=="none"&&(X(ga,this.zoom,le),(cr[Ma.id]=Ma.createBucket({index:Ze.bucketLayerIDs.length,layers:ga,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:rn,sourceID:this.source})).populate(dn,Br,this.tileID.canonical),Ze.bucketLayerIDs.push(ga.map(function(ya){return ya.id})))}}}var Ia=i.mapObject(Br.glyphDependencies,function(ya){return Object.keys(ya).map(Number)});Object.keys(Ia).length?xe.send("getGlyphs",{uid:this.uid,stacks:Ia},function(ya,ba){Rt||(Rt=ya,lr=ba,vi.call(wt))}):lr={};var Wi=Object.keys(Br.iconDependencies);Wi.length?xe.send("getImages",{icons:Wi,source:this.source,tileID:this.tileID,type:"icons"},function(ya,ba){Rt||(Rt=ya,Ur=ba,vi.call(wt))}):Ur={};var da=Object.keys(Br.patternDependencies);function vi(){if(Rt)return ut(Rt);if(lr&&Ur&&Gr){var ya=new re(lr),ba=new i.ImageAtlas(Ur,Gr);for(var ha in cr){var wi=cr[ha];wi instanceof i.SymbolBucket?(X(wi.layers,this.zoom,le),i.performSymbolLayout(wi,lr,ya.positions,Ur,ba.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):wi.hasPattern&&(wi instanceof i.LineBucket||wi instanceof i.FillBucket||wi instanceof i.FillExtrusionBucket)&&(X(wi.layers,this.zoom,le),wi.addFeatures(Br,this.tileID.canonical,ba.patternPositions))}this.status="done",ut(null,{buckets:i.values(cr).filter(function(is){return!is.isEmpty()}),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ya.image,imageAtlas:ba,glyphMap:this.returnDependencies?lr:null,iconMap:this.returnDependencies?Ur:null,glyphPositions:this.returnDependencies?ya.positions:null})}}da.length?xe.send("getImages",{icons:da,source:this.source,tileID:this.tileID,type:"patterns"},function(ya,ba){Rt||(Rt=ya,Gr=ba,vi.call(wt))}):Gr={},vi.call(this)};var Xe=function(W,le,xe,ut){this.actor=W,this.layerIndex=le,this.availableImages=xe,this.loadVectorData=ut||He,this.loading={},this.loaded={}};Xe.prototype.loadTile=function(F,W){var le=this,xe=F.uid;this.loading||(this.loading={});var ut=!!(F&&F.request&&F.request.collectResourceTiming)&&new i.RequestPerformance(F.request),wt=this.loading[xe]=new fe(F);wt.abort=this.loadVectorData(F,function(Bt,Ze){if(delete le.loading[xe],Bt||!Ze)return wt.status="done",le.loaded[xe]=wt,W(Bt);var Rt=Ze.rawData,lr={};Ze.expires&&(lr.expires=Ze.expires),Ze.cacheControl&&(lr.cacheControl=Ze.cacheControl);var Ur={};if(ut){var Gr=ut.finish();Gr&&(Ur.resourceTiming=JSON.parse(JSON.stringify(Gr)))}wt.vectorTile=Ze.vectorTile,wt.parse(Ze.vectorTile,le.layerIndex,le.availableImages,le.actor,function(cr,Br){if(cr||!Br)return W(cr);W(null,i.extend({rawTileData:Rt.slice(0)},Br,lr,Ur))}),le.loaded=le.loaded||{},le.loaded[xe]=wt})},Xe.prototype.reloadTile=function(F,W){var le=this,xe=this.loaded,ut=F.uid,wt=this;if(xe&&xe[ut]){var Bt=xe[ut];Bt.showCollisionBoxes=F.showCollisionBoxes;var Ze=function(lr,Ur){var Gr=Bt.reloadCallback;Gr&&(delete Bt.reloadCallback,Bt.parse(Bt.vectorTile,wt.layerIndex,le.availableImages,wt.actor,Gr)),W(lr,Ur)};Bt.status==="parsing"?Bt.reloadCallback=Ze:Bt.status==="done"&&(Bt.vectorTile?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,Ze):Ze())}},Xe.prototype.abortTile=function(F,W){var le=this.loading,xe=F.uid;le&&le[xe]&&le[xe].abort&&(le[xe].abort(),delete le[xe]),W()},Xe.prototype.removeTile=function(F,W){var le=this.loaded,xe=F.uid;le&&le[xe]&&delete le[xe],W()};var pe=i.window.ImageBitmap,Ce=function(){this.loaded={}};function mt(F,W){if(F.length!==0){Ne(F[0],W);for(var le=1;le<F.length;le++)Ne(F[le],!W)}}function Ne(F,W){for(var le=0,xe=0,ut=F.length,wt=ut-1;xe<ut;wt=xe++)le+=(F[xe][0]-F[wt][0])*(F[wt][1]+F[xe][1]);le>=0!=!!W&&F.reverse()}Ce.prototype.loadTile=function(F,W){var le=F.uid,xe=F.encoding,ut=F.rawImageData,wt=pe&&ut instanceof pe?this.getImageData(ut):ut,Bt=new i.DEMData(le,wt,xe);this.loaded=this.loaded||{},this.loaded[le]=Bt,W(null,Bt)},Ce.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:W.width,height:W.height},W.data)},Ce.prototype.removeTile=function(F){var W=this.loaded,le=F.uid;W&&W[le]&&delete W[le]};var At=i.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ye=function(W){this._feature=W,this.extent=i.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))};Ye.prototype.loadGeometry=function(){if(this._feature.type===1){for(var F=[],W=0,le=this._feature.geometry;W<le.length;W+=1){var xe=le[W];F.push([new i.Point$1(xe[0],xe[1])])}return F}for(var ut=[],wt=0,Bt=this._feature.geometry;wt<Bt.length;wt+=1){for(var Ze=[],Rt=0,lr=Bt[wt];Rt<lr.length;Rt+=1){var Ur=lr[Rt];Ze.push(new i.Point$1(Ur[0],Ur[1]))}ut.push(Ze)}return ut},Ye.prototype.toGeoJSON=function(F,W,le){return At.call(this,F,W,le)};var Et=function(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=W.length,this._features=W};Et.prototype.feature=function(F){return new Ye(this._features[F])};var nt=i.vectorTile.VectorTileFeature,Ct=Ot;function Ot(F,W){this.options=W||{},this.features=F,this.length=F.length}function Re(F,W){this.id=typeof F.id=="number"?F.id:void 0,this.type=F.type,this.rawGeometry=F.type===1?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=W||4096}Ot.prototype.feature=function(F){return new Re(this.features[F],this.options.extent)},Re.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var W=0;W<F.length;W++){for(var le=F[W],xe=[],ut=0;ut<le.length;ut++)xe.push(new i.Point$1(le[ut][0],le[ut][1]));this.geometry.push(xe)}return this.geometry},Re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,W=1/0,le=-1/0,xe=1/0,ut=-1/0,wt=0;wt<F.length;wt++)for(var Bt=F[wt],Ze=0;Ze<Bt.length;Ze++){var Rt=Bt[Ze];W=Math.min(W,Rt.x),le=Math.max(le,Rt.x),xe=Math.min(xe,Rt.y),ut=Math.max(ut,Rt.y)}return[W,xe,le,ut]},Re.prototype.toGeoJSON=nt.prototype.toGeoJSON;var Ie=ft,Be=Ct;function ft(F){var W=new i.pbf;return function(le,xe){for(var ut in le.layers)xe.writeMessage(3,Me,le.layers[ut])}(F,W),W.finish()}function Me(F,W){var le;W.writeVarintField(15,F.version||1),W.writeStringField(1,F.name||""),W.writeVarintField(5,F.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<F.length;le++)xe.feature=F.feature(le),W.writeMessage(2,ht,xe);var ut=xe.keys;for(le=0;le<ut.length;le++)W.writeStringField(3,ut[le]);var wt=xe.values;for(le=0;le<wt.length;le++)W.writeMessage(4,J,wt[le])}function ht(F,W){var le=F.feature;le.id!==void 0&&W.writeVarintField(1,le.id),W.writeMessage(2,Wt,F),W.writeVarintField(3,le.type),W.writeMessage(4,oe,le)}function Wt(F,W){var le=F.feature,xe=F.keys,ut=F.values,wt=F.keycache,Bt=F.valuecache;for(var Ze in le.properties){var Rt=wt[Ze];Rt===void 0&&(xe.push(Ze),wt[Ze]=Rt=xe.length-1),W.writeVarint(Rt);var lr=le.properties[Ze],Ur=typeof lr;Ur!=="string"&&Ur!=="boolean"&&Ur!=="number"&&(lr=JSON.stringify(lr));var Gr=Ur+":"+lr,cr=Bt[Gr];cr===void 0&&(ut.push(lr),Bt[Gr]=cr=ut.length-1),W.writeVarint(cr)}}function Qt(F,W){return(W<<3)+(7&F)}function ur(F){return F<<1^F>>31}function oe(F,W){for(var le=F.loadGeometry(),xe=F.type,ut=0,wt=0,Bt=le.length,Ze=0;Ze<Bt;Ze++){var Rt=le[Ze],lr=1;xe===1&&(lr=Rt.length),W.writeVarint(Qt(1,lr));for(var Ur=xe===3?Rt.length-1:Rt.length,Gr=0;Gr<Ur;Gr++){Gr===1&&xe!==1&&W.writeVarint(Qt(2,Ur-1));var cr=Rt[Gr].x-ut,Br=Rt[Gr].y-wt;W.writeVarint(ur(cr)),W.writeVarint(ur(Br)),ut+=cr,wt+=Br}xe===3&&W.writeVarint(Qt(7,1))}}function J(F,W){var le=typeof F;le==="string"?W.writeStringField(1,F):le==="boolean"?W.writeBooleanField(7,F):le==="number"&&(F%1!=0?W.writeDoubleField(3,F):F<0?W.writeSVarintField(6,F):W.writeVarintField(5,F))}function H(F,W,le,xe){Se(F,le,xe),Se(W,2*le,2*xe),Se(W,2*le+1,2*xe+1)}function Se(F,W,le){var xe=F[W];F[W]=F[le],F[le]=xe}function be(F,W,le,xe){var ut=F-le,wt=W-xe;return ut*ut+wt*wt}Ie.fromVectorTileJs=ft,Ie.fromGeojsonVt=function(F,W){W=W||{};var le={};for(var xe in F)le[xe]=new Ct(F[xe].features,W),le[xe].name=xe,le[xe].version=W.version,le[xe].extent=W.extent;return ft({layers:le})},Ie.GeoJSONWrapper=Be;var _e=function(W){return W[0]},me=function(W){return W[1]},it=function(W,le,xe,ut,wt){le===void 0&&(le=_e),xe===void 0&&(xe=me),ut===void 0&&(ut=64),wt===void 0&&(wt=Float64Array),this.nodeSize=ut,this.points=W;for(var Bt=W.length<65536?Uint16Array:Uint32Array,Ze=this.ids=new Bt(W.length),Rt=this.coords=new wt(2*W.length),lr=0;lr<W.length;lr++)Ze[lr]=lr,Rt[2*lr]=le(W[lr]),Rt[2*lr+1]=xe(W[lr]);!function Ur(Gr,cr,Br,wn,fn,tr){if(!(fn-wn<=Br)){var rn=wn+fn>>1;!function dn(En,bn,gn,Mn,Ga,ga){for(;Ga>Mn;){if(Ga-Mn>600){var Ma=Ga-Mn+1,Ia=gn-Mn+1,Wi=Math.log(Ma),da=.5*Math.exp(2*Wi/3),vi=.5*Math.sqrt(Wi*da*(Ma-da)/Ma)*(Ia-Ma/2<0?-1:1);dn(En,bn,gn,Math.max(Mn,Math.floor(gn-Ia*da/Ma+vi)),Math.min(Ga,Math.floor(gn+(Ma-Ia)*da/Ma+vi)),ga)}var ya=bn[2*gn+ga],ba=Mn,ha=Ga;for(H(En,bn,Mn,gn),bn[2*Ga+ga]>ya&&H(En,bn,Mn,Ga);ba<ha;){for(H(En,bn,ba,ha),ba++,ha--;bn[2*ba+ga]<ya;)ba++;for(;bn[2*ha+ga]>ya;)ha--}bn[2*Mn+ga]===ya?H(En,bn,Mn,ha):H(En,bn,++ha,Ga),ha<=gn&&(Mn=ha+1),gn<=ha&&(Ga=ha-1)}}(Gr,cr,rn,wn,fn,tr%2),Ur(Gr,cr,Br,wn,rn-1,tr+1),Ur(Gr,cr,Br,rn+1,fn,tr+1)}}(Ze,Rt,ut,0,Ze.length-1,0)};it.prototype.range=function(F,W,le,xe){return function(ut,wt,Bt,Ze,Rt,lr,Ur){for(var Gr,cr,Br=[0,ut.length-1,0],wn=[];Br.length;){var fn=Br.pop(),tr=Br.pop(),rn=Br.pop();if(tr-rn<=Ur)for(var dn=rn;dn<=tr;dn++)cr=wt[2*dn+1],(Gr=wt[2*dn])>=Bt&&Gr<=Rt&&cr>=Ze&&cr<=lr&&wn.push(ut[dn]);else{var En=Math.floor((rn+tr)/2);cr=wt[2*En+1],(Gr=wt[2*En])>=Bt&&Gr<=Rt&&cr>=Ze&&cr<=lr&&wn.push(ut[En]);var bn=(fn+1)%2;(fn===0?Bt<=Gr:Ze<=cr)&&(Br.push(rn),Br.push(En-1),Br.push(bn)),(fn===0?Rt>=Gr:lr>=cr)&&(Br.push(En+1),Br.push(tr),Br.push(bn))}}return wn}(this.ids,this.coords,F,W,le,xe,this.nodeSize)},it.prototype.within=function(F,W,le){return function(xe,ut,wt,Bt,Ze,Rt){for(var lr=[0,xe.length-1,0],Ur=[],Gr=Ze*Ze;lr.length;){var cr=lr.pop(),Br=lr.pop(),wn=lr.pop();if(Br-wn<=Rt)for(var fn=wn;fn<=Br;fn++)be(ut[2*fn],ut[2*fn+1],wt,Bt)<=Gr&&Ur.push(xe[fn]);else{var tr=Math.floor((wn+Br)/2),rn=ut[2*tr],dn=ut[2*tr+1];be(rn,dn,wt,Bt)<=Gr&&Ur.push(xe[tr]);var En=(cr+1)%2;(cr===0?wt-Ze<=rn:Bt-Ze<=dn)&&(lr.push(wn),lr.push(tr-1),lr.push(En)),(cr===0?wt+Ze>=rn:Bt+Ze>=dn)&&(lr.push(tr+1),lr.push(Br),lr.push(En))}}return Ur}(this.ids,this.coords,F,W,le,this.nodeSize)};var qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(W){return W}},Pt=function(W){this.options=C(Object.create(qt),W),this.trees=new Array(this.options.maxZoom+1)};function ve(F,W,le,xe,ut){return{x:F,y:W,zoom:1/0,id:le,parentId:-1,numPoints:xe,properties:ut}}function ge(F,W){var le=F.geometry.coordinates,xe=le[1];return{x:Oe(le[0]),y:vt(xe),zoom:1/0,index:W,parentId:-1}}function Ve(F){return{type:"Feature",id:F.id,properties:st(F),geometry:{type:"Point",coordinates:[(xe=F.x,360*(xe-.5)),(W=F.y,le=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var W,le,xe}function st(F){var W=F.numPoints,le=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return C(C({},F.properties),{cluster:!0,cluster_id:F.id,point_count:W,point_count_abbreviated:le})}function Oe(F){return F/360+.5}function vt(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function C(F,W){for(var le in W)F[le]=W[le];return F}function R(F){return F.x}function q(F){return F.y}function ce(F,W,le,xe,ut,wt){var Bt=ut-le,Ze=wt-xe;if(Bt!==0||Ze!==0){var Rt=((F-le)*Bt+(W-xe)*Ze)/(Bt*Bt+Ze*Ze);Rt>1?(le=ut,xe=wt):Rt>0&&(le+=Bt*Rt,xe+=Ze*Rt)}return(Bt=F-le)*Bt+(Ze=W-xe)*Ze}function Ge(F,W,le,xe){var ut={id:F===void 0?null:F,type:W,geometry:le,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(wt){var Bt=wt.geometry,Ze=wt.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")qe(wt,Bt);else if(Ze==="Polygon"||Ze==="MultiLineString")for(var Rt=0;Rt<Bt.length;Rt++)qe(wt,Bt[Rt]);else if(Ze==="MultiPolygon")for(Rt=0;Rt<Bt.length;Rt++)for(var lr=0;lr<Bt[Rt].length;lr++)qe(wt,Bt[Rt][lr])}(ut),ut}function qe(F,W){for(var le=0;le<W.length;le+=3)F.minX=Math.min(F.minX,W[le]),F.minY=Math.min(F.minY,W[le+1]),F.maxX=Math.max(F.maxX,W[le]),F.maxY=Math.max(F.maxY,W[le+1])}function Tt(F,W,le,xe){if(W.geometry){var ut=W.geometry.coordinates,wt=W.geometry.type,Bt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Ze=[],Rt=W.id;if(le.promoteId?Rt=W.properties[le.promoteId]:le.generateId&&(Rt=xe||0),wt==="Point")ot(ut,Ze);else if(wt==="MultiPoint")for(var lr=0;lr<ut.length;lr++)ot(ut[lr],Ze);else if(wt==="LineString")Ut(ut,Ze,Bt,!1);else if(wt==="MultiLineString"){if(le.lineMetrics){for(lr=0;lr<ut.length;lr++)Ut(ut[lr],Ze=[],Bt,!1),F.push(Ge(Rt,"LineString",Ze,W.properties));return}$(ut,Ze,Bt,!1)}else if(wt==="Polygon")$(ut,Ze,Bt,!0);else{if(wt!=="MultiPolygon"){if(wt==="GeometryCollection"){for(lr=0;lr<W.geometry.geometries.length;lr++)Tt(F,{id:Rt,geometry:W.geometry.geometries[lr],properties:W.properties},le,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lr=0;lr<ut.length;lr++){var Ur=[];$(ut[lr],Ur,Bt,!0),Ze.push(Ur)}}F.push(Ge(Rt,wt,Ze,W.properties))}}function ot(F,W){W.push(Qe(F[0])),W.push(ae(F[1])),W.push(0)}function Ut(F,W,le,xe){for(var ut,wt,Bt=0,Ze=0;Ze<F.length;Ze++){var Rt=Qe(F[Ze][0]),lr=ae(F[Ze][1]);W.push(Rt),W.push(lr),W.push(0),Ze>0&&(Bt+=xe?(ut*lr-Rt*wt)/2:Math.sqrt(Math.pow(Rt-ut,2)+Math.pow(lr-wt,2))),ut=Rt,wt=lr}var Ur=W.length-3;W[2]=1,function Gr(cr,Br,wn,fn){for(var tr,rn=fn,dn=wn-Br>>1,En=wn-Br,bn=cr[Br],gn=cr[Br+1],Mn=cr[wn],Ga=cr[wn+1],ga=Br+3;ga<wn;ga+=3){var Ma=ce(cr[ga],cr[ga+1],bn,gn,Mn,Ga);if(Ma>rn)tr=ga,rn=Ma;else if(Ma===rn){var Ia=Math.abs(ga-dn);Ia<En&&(tr=ga,En=Ia)}}rn>fn&&(tr-Br>3&&Gr(cr,Br,tr,fn),cr[tr+2]=rn,wn-tr>3&&Gr(cr,tr,wn,fn))}(W,0,Ur,le),W[Ur+2]=1,W.size=Math.abs(Bt),W.start=0,W.end=W.size}function $(F,W,le,xe){for(var ut=0;ut<F.length;ut++){var wt=[];Ut(F[ut],wt,le,xe),W.push(wt)}}function Qe(F){return F/360+.5}function ae(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function et(F,W,le,xe,ut,wt,Bt,Ze){if(xe/=W,wt>=(le/=W)&&Bt<xe)return F;if(Bt<le||wt>=xe)return null;for(var Rt=[],lr=0;lr<F.length;lr++){var Ur=F[lr],Gr=Ur.geometry,cr=Ur.type,Br=ut===0?Ur.minX:Ur.minY,wn=ut===0?Ur.maxX:Ur.maxY;if(Br>=le&&wn<xe)Rt.push(Ur);else if(!(wn<le||Br>=xe)){var fn=[];if(cr==="Point"||cr==="MultiPoint")kt(Gr,fn,le,xe,ut);else if(cr==="LineString")pr(Gr,fn,le,xe,ut,!1,Ze.lineMetrics);else if(cr==="MultiLineString")bt(Gr,fn,le,xe,ut,!1);else if(cr==="Polygon")bt(Gr,fn,le,xe,ut,!0);else if(cr==="MultiPolygon")for(var tr=0;tr<Gr.length;tr++){var rn=[];bt(Gr[tr],rn,le,xe,ut,!0),rn.length&&fn.push(rn)}if(fn.length){if(Ze.lineMetrics&&cr==="LineString"){for(tr=0;tr<fn.length;tr++)Rt.push(Ge(Ur.id,cr,fn[tr],Ur.tags));continue}cr!=="LineString"&&cr!=="MultiLineString"||(fn.length===1?(cr="LineString",fn=fn[0]):cr="MultiLineString"),cr!=="Point"&&cr!=="MultiPoint"||(cr=fn.length===3?"Point":"MultiPoint"),Rt.push(Ge(Ur.id,cr,fn,Ur.tags))}}}return Rt.length?Rt:null}function kt(F,W,le,xe,ut){for(var wt=0;wt<F.length;wt+=3){var Bt=F[wt+ut];Bt>=le&&Bt<=xe&&(W.push(F[wt]),W.push(F[wt+1]),W.push(F[wt+2]))}}function pr(F,W,le,xe,ut,wt,Bt){for(var Ze,Rt,lr=Ke(F),Ur=ut===0?xt:ze,Gr=F.start,cr=0;cr<F.length-3;cr+=3){var Br=F[cr],wn=F[cr+1],fn=F[cr+2],tr=F[cr+3],rn=F[cr+4],dn=ut===0?Br:wn,En=ut===0?tr:rn,bn=!1;Bt&&(Ze=Math.sqrt(Math.pow(Br-tr,2)+Math.pow(wn-rn,2))),dn<le?En>le&&(Rt=Ur(lr,Br,wn,tr,rn,le),Bt&&(lr.start=Gr+Ze*Rt)):dn>xe?En<xe&&(Rt=Ur(lr,Br,wn,tr,rn,xe),Bt&&(lr.start=Gr+Ze*Rt)):yt(lr,Br,wn,fn),En<le&&dn>=le&&(Rt=Ur(lr,Br,wn,tr,rn,le),bn=!0),En>xe&&dn<=xe&&(Rt=Ur(lr,Br,wn,tr,rn,xe),bn=!0),!wt&&bn&&(Bt&&(lr.end=Gr+Ze*Rt),W.push(lr),lr=Ke(F)),Bt&&(Gr+=Ze)}var gn=F.length-3;Br=F[gn],wn=F[gn+1],fn=F[gn+2],(dn=ut===0?Br:wn)>=le&&dn<=xe&&yt(lr,Br,wn,fn),gn=lr.length-3,wt&&gn>=3&&(lr[gn]!==lr[0]||lr[gn+1]!==lr[1])&&yt(lr,lr[0],lr[1],lr[2]),lr.length&&W.push(lr)}function Ke(F){var W=[];return W.size=F.size,W.start=F.start,W.end=F.end,W}function bt(F,W,le,xe,ut,wt){for(var Bt=0;Bt<F.length;Bt++)pr(F[Bt],W,le,xe,ut,wt,!1)}function yt(F,W,le,xe){F.push(W),F.push(le),F.push(xe)}function xt(F,W,le,xe,ut,wt){var Bt=(wt-W)/(xe-W);return F.push(wt),F.push(le+(ut-le)*Bt),F.push(1),Bt}function ze(F,W,le,xe,ut,wt){var Bt=(wt-le)/(ut-le);return F.push(W+(xe-W)*Bt),F.push(wt),F.push(1),Bt}function dt(F,W){for(var le=[],xe=0;xe<F.length;xe++){var ut,wt=F[xe],Bt=wt.type;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")ut=gt(wt.geometry,W);else if(Bt==="MultiLineString"||Bt==="Polygon"){ut=[];for(var Ze=0;Ze<wt.geometry.length;Ze++)ut.push(gt(wt.geometry[Ze],W))}else if(Bt==="MultiPolygon")for(ut=[],Ze=0;Ze<wt.geometry.length;Ze++){for(var Rt=[],lr=0;lr<wt.geometry[Ze].length;lr++)Rt.push(gt(wt.geometry[Ze][lr],W));ut.push(Rt)}le.push(Ge(wt.id,Bt,ut,wt.tags))}return le}function gt(F,W){var le=[];le.size=F.size,F.start!==void 0&&(le.start=F.start,le.end=F.end);for(var xe=0;xe<F.length;xe+=3)le.push(F[xe]+W,F[xe+1],F[xe+2]);return le}function Ht(F,W){if(F.transformed)return F;var le,xe,ut,wt=1<<F.z,Bt=F.x,Ze=F.y;for(le=0;le<F.features.length;le++){var Rt=F.features[le],lr=Rt.geometry,Ur=Rt.type;if(Rt.geometry=[],Ur===1)for(xe=0;xe<lr.length;xe+=2)Rt.geometry.push(hr(lr[xe],lr[xe+1],W,wt,Bt,Ze));else for(xe=0;xe<lr.length;xe++){var Gr=[];for(ut=0;ut<lr[xe].length;ut+=2)Gr.push(hr(lr[xe][ut],lr[xe][ut+1],W,wt,Bt,Ze));Rt.geometry.push(Gr)}}return F.transformed=!0,F}function hr(F,W,le,xe,ut,wt){return[Math.round(le*(F*xe-ut)),Math.round(le*(W*xe-wt))]}function Zr(F,W,le,xe,ut){for(var wt=W===ut.maxZoom?0:ut.tolerance/((1<<W)*ut.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:xe,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<F.length;Ze++){Bt.numFeatures++,yr(Bt,F[Ze],wt,ut);var Rt=F[Ze].minX,lr=F[Ze].minY,Ur=F[Ze].maxX,Gr=F[Ze].maxY;Rt<Bt.minX&&(Bt.minX=Rt),lr<Bt.minY&&(Bt.minY=lr),Ur>Bt.maxX&&(Bt.maxX=Ur),Gr>Bt.maxY&&(Bt.maxY=Gr)}return Bt}function yr(F,W,le,xe){var ut=W.geometry,wt=W.type,Bt=[];if(wt==="Point"||wt==="MultiPoint")for(var Ze=0;Ze<ut.length;Ze+=3)Bt.push(ut[Ze]),Bt.push(ut[Ze+1]),F.numPoints++,F.numSimplified++;else if(wt==="LineString")Vn(Bt,ut,F,le,!1,!1);else if(wt==="MultiLineString"||wt==="Polygon")for(Ze=0;Ze<ut.length;Ze++)Vn(Bt,ut[Ze],F,le,wt==="Polygon",Ze===0);else if(wt==="MultiPolygon")for(var Rt=0;Rt<ut.length;Rt++){var lr=ut[Rt];for(Ze=0;Ze<lr.length;Ze++)Vn(Bt,lr[Ze],F,le,!0,Ze===0)}if(Bt.length){var Ur=W.tags||null;if(wt==="LineString"&&xe.lineMetrics){for(var Gr in Ur={},W.tags)Ur[Gr]=W.tags[Gr];Ur.mapbox_clip_start=ut.start/ut.size,Ur.mapbox_clip_end=ut.end/ut.size}var cr={geometry:Bt,type:wt==="Polygon"||wt==="MultiPolygon"?3:wt==="LineString"||wt==="MultiLineString"?2:1,tags:Ur};W.id!==null&&(cr.id=W.id),F.features.push(cr)}}function Vn(F,W,le,xe,ut,wt){var Bt=xe*xe;if(xe>0&&W.size<(ut?Bt:xe))le.numPoints+=W.length/3;else{for(var Ze=[],Rt=0;Rt<W.length;Rt+=3)(xe===0||W[Rt+2]>Bt)&&(le.numSimplified++,Ze.push(W[Rt]),Ze.push(W[Rt+1])),le.numPoints++;ut&&function(lr,Ur){for(var Gr=0,cr=0,Br=lr.length,wn=Br-2;cr<Br;wn=cr,cr+=2)Gr+=(lr[cr]-lr[wn])*(lr[cr+1]+lr[wn+1]);if(Gr>0===Ur)for(cr=0,Br=lr.length;cr<Br/2;cr+=2){var fn=lr[cr],tr=lr[cr+1];lr[cr]=lr[Br-2-cr],lr[cr+1]=lr[Br-1-cr],lr[Br-2-cr]=fn,lr[Br-1-cr]=tr}}(Ze,wt),F.push(Ze)}}function Fn(F,W){var le=(W=this.options=function(ut,wt){for(var Bt in wt)ut[Bt]=wt[Bt];return ut}(Object.create(this.options),W)).debug;if(le&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(ut,wt){var Bt=[];if(ut.type==="FeatureCollection")for(var Ze=0;Ze<ut.features.length;Ze++)Tt(Bt,ut.features[Ze],wt,Ze);else Tt(Bt,ut.type==="Feature"?ut:{geometry:ut},wt);return Bt}(F,W);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(ut,wt){var Bt=wt.buffer/wt.extent,Ze=ut,Rt=et(ut,1,-1-Bt,Bt,0,-1,2,wt),lr=et(ut,1,1-Bt,2+Bt,0,-1,2,wt);return(Rt||lr)&&(Ze=et(ut,1,-Bt,1+Bt,0,-1,2,wt)||[],Rt&&(Ze=dt(Rt,1).concat(Ze)),lr&&(Ze=Ze.concat(dt(lr,-1)))),Ze}(xe,W)).length&&this.splitTile(xe,0,0,0),le&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oa(F,W,le){return 32*((1<<F)*le+W)+F}function $n(F,W){var le=F.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var xe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!xe)return W(null,null);var ut=new Et(xe.features),wt=Ie(ut);wt.byteOffset===0&&wt.byteLength===wt.buffer.byteLength||(wt=new Uint8Array(wt)),W(null,{vectorTile:ut,rawData:wt.buffer})}Pt.prototype.load=function(F){var W=this.options,le=W.log,xe=W.minZoom,ut=W.maxZoom,wt=W.nodeSize;le&&console.time("total time");var Bt="prepare "+F.length+" points";le&&console.time(Bt),this.points=F;for(var Ze=[],Rt=0;Rt<F.length;Rt++)F[Rt].geometry&&Ze.push(ge(F[Rt],Rt));this.trees[ut+1]=new it(Ze,R,q,wt,Float32Array),le&&console.timeEnd(Bt);for(var lr=ut;lr>=xe;lr--){var Ur=+Date.now();Ze=this._cluster(Ze,lr),this.trees[lr]=new it(Ze,R,q,wt,Float32Array),le&&console.log("z%d: %d clusters in %dms",lr,Ze.length,+Date.now()-Ur)}return le&&console.timeEnd("total time"),this},Pt.prototype.getClusters=function(F,W){var le=((F[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,F[1])),ut=F[2]===180?180:((F[2]+180)%360+360)%360-180,wt=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)le=-180,ut=180;else if(le>ut){var Bt=this.getClusters([le,xe,180,wt],W),Ze=this.getClusters([-180,xe,ut,wt],W);return Bt.concat(Ze)}for(var Rt=this.trees[this._limitZoom(W)],lr=[],Ur=0,Gr=Rt.range(Oe(le),vt(wt),Oe(ut),vt(xe));Ur<Gr.length;Ur+=1){var cr=Rt.points[Gr[Ur]];lr.push(cr.numPoints?Ve(cr):this.points[cr.index])}return lr},Pt.prototype.getChildren=function(F){var W=this._getOriginId(F),le=this._getOriginZoom(F),xe="No cluster with the specified id.",ut=this.trees[le];if(!ut)throw new Error(xe);var wt=ut.points[W];if(!wt)throw new Error(xe);for(var Bt=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Ze=[],Rt=0,lr=ut.within(wt.x,wt.y,Bt);Rt<lr.length;Rt+=1){var Ur=ut.points[lr[Rt]];Ur.parentId===F&&Ze.push(Ur.numPoints?Ve(Ur):this.points[Ur.index])}if(Ze.length===0)throw new Error(xe);return Ze},Pt.prototype.getLeaves=function(F,W,le){var xe=[];return this._appendLeaves(xe,F,W=W||10,le=le||0,0),xe},Pt.prototype.getTile=function(F,W,le){var xe=this.trees[this._limitZoom(F)],ut=Math.pow(2,F),wt=this.options,Bt=wt.radius/wt.extent,Ze=(le-Bt)/ut,Rt=(le+1+Bt)/ut,lr={features:[]};return this._addTileFeatures(xe.range((W-Bt)/ut,Ze,(W+1+Bt)/ut,Rt),xe.points,W,le,ut,lr),W===0&&this._addTileFeatures(xe.range(1-Bt/ut,Ze,1,Rt),xe.points,ut,le,ut,lr),W===ut-1&&this._addTileFeatures(xe.range(0,Ze,Bt/ut,Rt),xe.points,-1,le,ut,lr),lr.features.length?lr:null},Pt.prototype.getClusterExpansionZoom=function(F){for(var W=this._getOriginZoom(F)-1;W<=this.options.maxZoom;){var le=this.getChildren(F);if(W++,le.length!==1)break;F=le[0].properties.cluster_id}return W},Pt.prototype._appendLeaves=function(F,W,le,xe,ut){for(var wt=0,Bt=this.getChildren(W);wt<Bt.length;wt+=1){var Ze=Bt[wt],Rt=Ze.properties;if(Rt&&Rt.cluster?ut+Rt.point_count<=xe?ut+=Rt.point_count:ut=this._appendLeaves(F,Rt.cluster_id,le,xe,ut):ut<xe?ut++:F.push(Ze),F.length===le)break}return ut},Pt.prototype._addTileFeatures=function(F,W,le,xe,ut,wt){for(var Bt=0,Ze=F;Bt<Ze.length;Bt+=1){var Rt=W[Ze[Bt]],lr=Rt.numPoints,Ur={type:1,geometry:[[Math.round(this.options.extent*(Rt.x*ut-le)),Math.round(this.options.extent*(Rt.y*ut-xe))]],tags:lr?st(Rt):this.points[Rt.index].properties},Gr=void 0;lr?Gr=Rt.id:this.options.generateId?Gr=Rt.index:this.points[Rt.index].id&&(Gr=this.points[Rt.index].id),Gr!==void 0&&(Ur.id=Gr),wt.features.push(Ur)}},Pt.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},Pt.prototype._cluster=function(F,W){for(var le=[],xe=this.options,ut=xe.reduce,wt=xe.minPoints,Bt=xe.radius/(xe.extent*Math.pow(2,W)),Ze=0;Ze<F.length;Ze++){var Rt=F[Ze];if(!(Rt.zoom<=W)){Rt.zoom=W;for(var lr=this.trees[W+1],Ur=lr.within(Rt.x,Rt.y,Bt),Gr=Rt.numPoints||1,cr=Gr,Br=0,wn=Ur;Br<wn.length;Br+=1){var fn=lr.points[wn[Br]];fn.zoom>W&&(cr+=fn.numPoints||1)}if(cr>=wt){for(var tr=Rt.x*Gr,rn=Rt.y*Gr,dn=ut&&Gr>1?this._map(Rt,!0):null,En=(Ze<<5)+(W+1)+this.points.length,bn=0,gn=Ur;bn<gn.length;bn+=1){var Mn=lr.points[gn[bn]];if(!(Mn.zoom<=W)){Mn.zoom=W;var Ga=Mn.numPoints||1;tr+=Mn.x*Ga,rn+=Mn.y*Ga,Mn.parentId=En,ut&&(dn||(dn=this._map(Rt,!0)),ut(dn,this._map(Mn)))}}Rt.parentId=En,le.push(ve(tr/cr,rn/cr,En,cr,dn))}else if(le.push(Rt),cr>1)for(var ga=0,Ma=Ur;ga<Ma.length;ga+=1){var Ia=lr.points[Ma[ga]];Ia.zoom<=W||(Ia.zoom=W,le.push(Ia))}}}return le},Pt.prototype._getOriginId=function(F){return F-this.points.length>>5},Pt.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},Pt.prototype._map=function(F,W){if(F.numPoints)return W?C({},F.properties):F.properties;var le=this.points[F.index].properties,xe=this.options.map(le);return W&&xe===le?C({},xe):xe},Fn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fn.prototype.splitTile=function(F,W,le,xe,ut,wt,Bt){for(var Ze=[F,W,le,xe],Rt=this.options,lr=Rt.debug;Ze.length;){xe=Ze.pop(),le=Ze.pop(),W=Ze.pop(),F=Ze.pop();var Ur=1<<W,Gr=oa(W,le,xe),cr=this.tiles[Gr];if(!cr&&(lr>1&&console.time("creation"),cr=this.tiles[Gr]=Zr(F,W,le,xe,Rt),this.tileCoords.push({z:W,x:le,y:xe}),lr)){lr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,le,xe,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));var Br="z"+W;this.stats[Br]=(this.stats[Br]||0)+1,this.total++}if(cr.source=F,ut){if(W===Rt.maxZoom||W===ut)continue;var wn=1<<ut-W;if(le!==Math.floor(wt/wn)||xe!==Math.floor(Bt/wn))continue}else if(W===Rt.indexMaxZoom||cr.numPoints<=Rt.indexMaxPoints)continue;if(cr.source=null,F.length!==0){lr>1&&console.time("clipping");var fn,tr,rn,dn,En,bn,gn=.5*Rt.buffer/Rt.extent,Mn=.5-gn,Ga=.5+gn,ga=1+gn;fn=tr=rn=dn=null,En=et(F,Ur,le-gn,le+Ga,0,cr.minX,cr.maxX,Rt),bn=et(F,Ur,le+Mn,le+ga,0,cr.minX,cr.maxX,Rt),F=null,En&&(fn=et(En,Ur,xe-gn,xe+Ga,1,cr.minY,cr.maxY,Rt),tr=et(En,Ur,xe+Mn,xe+ga,1,cr.minY,cr.maxY,Rt),En=null),bn&&(rn=et(bn,Ur,xe-gn,xe+Ga,1,cr.minY,cr.maxY,Rt),dn=et(bn,Ur,xe+Mn,xe+ga,1,cr.minY,cr.maxY,Rt),bn=null),lr>1&&console.timeEnd("clipping"),Ze.push(fn||[],W+1,2*le,2*xe),Ze.push(tr||[],W+1,2*le,2*xe+1),Ze.push(rn||[],W+1,2*le+1,2*xe),Ze.push(dn||[],W+1,2*le+1,2*xe+1)}}},Fn.prototype.getTile=function(F,W,le){var xe=this.options,ut=xe.extent,wt=xe.debug;if(F<0||F>24)return null;var Bt=1<<F,Ze=oa(F,W=(W%Bt+Bt)%Bt,le);if(this.tiles[Ze])return Ht(this.tiles[Ze],ut);wt>1&&console.log("drilling down to z%d-%d-%d",F,W,le);for(var Rt,lr=F,Ur=W,Gr=le;!Rt&&lr>0;)lr--,Ur=Math.floor(Ur/2),Gr=Math.floor(Gr/2),Rt=this.tiles[oa(lr,Ur,Gr)];return Rt&&Rt.source?(wt>1&&console.log("found parent tile z%d-%d-%d",lr,Ur,Gr),wt>1&&console.time("drilling down"),this.splitTile(Rt.source,lr,Ur,Gr,F,W,le),wt>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Ht(this.tiles[Ze],ut):null):null};var Kn=function(F){function W(le,xe,ut,wt){F.call(this,le,xe,ut,$n),wt&&(this.loadGeoJSON=wt)}return F&&(W.__proto__=F),(W.prototype=Object.create(F&&F.prototype)).constructor=W,W.prototype.loadData=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,ut=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var wt=!!(ut&&ut.request&&ut.request.collectResourceTiming)&&new i.RequestPerformance(ut.request);this.loadGeoJSON(ut,function(Bt,Ze){if(Bt||!Ze)return xe(Bt);if(typeof Ze!="object")return xe(new Error("Input data given to '"+ut.source+"' is not a valid GeoJSON object."));!function cr(Br,wn){var fn,tr=Br&&Br.type;if(tr==="FeatureCollection")for(fn=0;fn<Br.features.length;fn++)cr(Br.features[fn],wn);else if(tr==="GeometryCollection")for(fn=0;fn<Br.geometries.length;fn++)cr(Br.geometries[fn],wn);else if(tr==="Feature")cr(Br.geometry,wn);else if(tr==="Polygon")mt(Br.coordinates,wn);else if(tr==="MultiPolygon")for(fn=0;fn<Br.coordinates.length;fn++)mt(Br.coordinates[fn],wn);return Br}(Ze,!0);try{if(ut.filter){var Rt=i.createExpression(ut.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Rt.result==="error")throw new Error(Rt.value.map(function(cr){return cr.key+": "+cr.message}).join(", "));var lr=Ze.features.filter(function(cr){return Rt.value.evaluate({zoom:0},cr)});Ze={type:"FeatureCollection",features:lr}}le._geoJSONIndex=ut.cluster?new Pt(function(cr){var Br=cr.superclusterOptions,wn=cr.clusterProperties;if(!wn||!Br)return Br;for(var fn={},tr={},rn={accumulated:null,zoom:0},dn={properties:null},En=Object.keys(wn),bn=0,gn=En;bn<gn.length;bn+=1){var Mn=gn[bn],Ga=wn[Mn],ga=Ga[0],Ma=i.createExpression(Ga[1]),Ia=i.createExpression(typeof ga=="string"?[ga,["accumulated"],["get",Mn]]:ga);fn[Mn]=Ma.value,tr[Mn]=Ia.value}return Br.map=function(Wi){dn.properties=Wi;for(var da={},vi=0,ya=En;vi<ya.length;vi+=1){var ba=ya[vi];da[ba]=fn[ba].evaluate(rn,dn)}return da},Br.reduce=function(Wi,da){dn.properties=da;for(var vi=0,ya=En;vi<ya.length;vi+=1){var ba=ya[vi];rn.accumulated=Wi[ba],Wi[ba]=tr[ba].evaluate(rn,dn)}},Br}(ut)).load(Ze.features):function(cr,Br){return new Fn(cr,Br)}(Ze,ut.geojsonVtOptions)}catch(cr){return xe(cr)}le.loaded={};var Ur={};if(wt){var Gr=wt.finish();Gr&&(Ur.resourceTiming={},Ur.resourceTiming[ut.source]=JSON.parse(JSON.stringify(Gr)))}xe(null,Ur)})}},W.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(le,xe){var ut=this.loaded;return ut&&ut[le.uid]?F.prototype.reloadTile.call(this,le,xe):this.loadTile(le,xe)},W.prototype.loadGeoJSON=function(le,xe){if(le.request)i.getJSON(le.request,xe);else{if(typeof le.data!="string")return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(le.data))}catch(ut){return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},W.prototype.getClusterExpansionZoom=function(le,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(ut){xe(ut)}},W.prototype.getClusterChildren=function(le,xe){try{xe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(ut){xe(ut)}},W.prototype.getClusterLeaves=function(le,xe){try{xe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(ut){xe(ut)}},W}(Xe),Cn=function(W){var le=this;this.self=W,this.actor=new i.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Xe,geojson:Kn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(xe,ut){if(le.workerSourceTypes[xe])throw new Error('Worker source with name "'+xe+'" already registered.');le.workerSourceTypes[xe]=ut},this.self.registerRTLTextPlugin=function(xe){if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=xe.applyArabicShaping,i.plugin.processBidirectionalText=xe.processBidirectionalText,i.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}};return Cn.prototype.setReferrer=function(F,W){this.referrer=W},Cn.prototype.setImages=function(F,W,le){for(var xe in this.availableImages[F]=W,this.workerSources[F]){var ut=this.workerSources[F][xe];for(var wt in ut)ut[wt].availableImages=W}le()},Cn.prototype.setLayers=function(F,W,le){this.getLayerIndex(F).replace(W),le()},Cn.prototype.updateLayers=function(F,W,le){this.getLayerIndex(F).update(W.layers,W.removedIds),le()},Cn.prototype.loadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).loadTile(W,le)},Cn.prototype.loadDEMTile=function(F,W,le){this.getDEMWorkerSource(F,W.source).loadTile(W,le)},Cn.prototype.reloadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).reloadTile(W,le)},Cn.prototype.abortTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).abortTile(W,le)},Cn.prototype.removeTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).removeTile(W,le)},Cn.prototype.removeDEMTile=function(F,W){this.getDEMWorkerSource(F,W.source).removeTile(W)},Cn.prototype.removeSource=function(F,W,le){if(this.workerSources[F]&&this.workerSources[F][W.type]&&this.workerSources[F][W.type][W.source]){var xe=this.workerSources[F][W.type][W.source];delete this.workerSources[F][W.type][W.source],xe.removeSource!==void 0?xe.removeSource(W,le):le()}},Cn.prototype.loadWorkerSource=function(F,W,le){try{this.self.importScripts(W.url),le()}catch(xe){le(xe.toString())}},Cn.prototype.syncRTLPluginState=function(F,W,le){try{i.plugin.setState(W);var xe=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var ut=i.plugin.isParsed();le(ut?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),ut)}}catch(wt){le(wt.toString())}},Cn.prototype.getAvailableImages=function(F){var W=this.availableImages[F];return W||(W=[]),W},Cn.prototype.getLayerIndex=function(F){var W=this.layerIndexes[F];return W||(W=this.layerIndexes[F]=new K),W},Cn.prototype.getWorkerSource=function(F,W,le){var xe=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][W]||(this.workerSources[F][W]={}),this.workerSources[F][W][le]||(this.workerSources[F][W][le]=new this.workerSourceTypes[W]({send:function(wt,Bt,Ze){xe.actor.send(wt,Bt,Ze,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][W][le]},Cn.prototype.getDEMWorkerSource=function(F,W){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][W]||(this.demWorkerSources[F][W]=new Ce),this.demWorkerSources[F][W]},Cn.prototype.enforceCacheSizeLimit=function(F,W){i.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Cn(self)),Cn}),z(["./shared"],function(i){"use strict";var Z=i.createCommonjsModule(function(s){function a(v){return!n(v)}function n(v){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,j,ue=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ue);try{j=new Worker(Ee),L=!0}catch($e){L=!1}return j&&j.terminate(),URL.revokeObjectURL(Ee),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var j=L.getContext("2d");if(!j)return!1;var ue=j.getImageData(0,0,1,1);return ue&&ue.width===L.width}()?(l[O=v&&v.failIfMajorPerformanceCaveat]===void 0&&(l[O]=function(L){var j=function(Ee){var $e=document.createElement("canvas"),rt=Object.create(a.webGLContextAttributes);return rt.failIfMajorPerformanceCaveat=Ee,$e.probablySupportsContext?$e.probablySupportsContext("webgl",rt)||$e.probablySupportsContext("experimental-webgl",rt):$e.supportsContext?$e.supportsContext("webgl",rt)||$e.supportsContext("experimental-webgl",rt):$e.getContext("webgl",rt)||$e.getContext("experimental-webgl",rt)}(L);if(!j)return!1;var ue=j.createShader(j.VERTEX_SHADER);return!(!ue||j.isContextLost())&&(j.shaderSource(ue,"void main() {}"),j.compileShader(ue),j.getShaderParameter(ue,j.COMPILE_STATUS)===!0)}(O)),l[O]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var O}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var v=i.window.document.createElement(a);return n!==void 0&&(v.className=n),l&&l.appendChild(v),v},createNS:function(a,n){return i.window.document.createElementNS(a,n)}},K=i.window.document&&i.window.document.documentElement.style;function re(s){if(!K)return s[0];for(var a=0;a<s.length;a++)if(s[a]in K)return s[a];return s[0]}var fe,X=re(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){K&&X&&(fe=K[X],K[X]="none")},D.enableDrag=function(){K&&X&&(K[X]=fe)};var He=re(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[He]=a};var Xe=!1;try{var pe=Object.defineProperty({},"passive",{get:function(){Xe=!0}});i.window.addEventListener("test",pe,pe),i.window.removeEventListener("test",pe,pe)}catch(s){Xe=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&Xe?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&Xe?l:l.capture)};var Ce=function s(a){a.preventDefault(),a.stopPropagation(),i.window.removeEventListener("click",s,!0)};function mt(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){i.window.addEventListener("click",Ce,!0),i.window.setTimeout(function(){i.window.removeEventListener("click",Ce,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new i.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],v=0;v<a.length;v++)l.push(new i.Point(a[v].clientX-n.left-s.clientLeft,a[v].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return i.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var Ne=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,v=this.requestors;l<v.length;l+=1){var O=v[l];this._notify(O.ids,O.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var v=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),v=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),v=!1),this._validateContent(l.content,l)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),v=!1),v},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var v=0,O=0,L=n;O<L.length;O+=1){var j=L[O];if(j[0]<v||j[1]<j[0]||l<j[1])return!1;v=j[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var v=!0;if(!this.isLoaded())for(var O=0,L=n;O<L.length;O+=1)this.images[L[O]]||(v=!1);this.isLoaded()||v?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var v={},O=0,L=n;O<L.length;O+=1){var j=L[O];this.images[j]||this.fire(new i.Event("styleimagemissing",{id:j}));var ue=this.images[j];ue?v[j]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:i.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,v)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],v=this.getImage(n);if(!v)return null;if(l&&l.position.version===v.version)return l.position;if(l)l.position.version=v.version;else{var O={w:v.data.width+2,h:v.data.height+2,x:0,y:0},L=new i.ImagePosition(O,v);this.patterns[n]={bin:O,position:L}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var v=i.potpack(n),O=v.w,L=v.h,j=this.atlasImage;for(var ue in j.resize({width:O||1,height:L||1}),this.patterns){var Ee=this.patterns[ue].bin,$e=Ee.x+1,rt=Ee.y+1,at=this.images[ue].data,zt=at.width,Nt=at.height;i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e,y:rt},{width:zt,height:Nt}),i.RGBAImage.copy(at,j,{x:0,y:Nt-1},{x:$e,y:rt-1},{width:zt,height:1}),i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e,y:rt+Nt},{width:zt,height:1}),i.RGBAImage.copy(at,j,{x:zt-1,y:0},{x:$e-1,y:rt},{width:1,height:Nt}),i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e+zt,y:rt},{width:1,height:Nt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,v=n;l<v.length;l+=1){var O=v[l];if(!this.callbackDispatchedThisFrame[O]){this.callbackDispatchedThisFrame[O]=!0;var L=this.images[O];mt(L)&&this.updateImage(O,L)}}},a}(i.Evented),At=nt,Ye=nt,Et=1e20;function nt(s,a,n,l,v,O){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=v||"sans-serif",this.fontWeight=O||"normal",this.radius=n||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Ct(s,a,n,l,v,O,L){for(var j=0;j<a;j++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+j];for(Ot(l,v,O,L,n),ue=0;ue<n;ue++)s[ue*a+j]=v[ue]}for(ue=0;ue<n;ue++){for(j=0;j<a;j++)l[j]=s[ue*a+j];for(Ot(l,v,O,L,a),j=0;j<a;j++)s[ue*a+j]=Math.sqrt(v[j])}}function Ot(s,a,n,l,v){n[0]=0,l[0]=-Et,l[1]=+Et;for(var O=1,L=0;O<v;O++){for(var j=(s[O]+O*O-(s[n[L]]+n[L]*n[L]))/(2*O-2*n[L]);j<=l[L];)L--,j=(s[O]+O*O-(s[n[L]]+n[L]*n[L]))/(2*O-2*n[L]);n[++L]=O,l[L]=j,l[L+1]=+Et}for(O=0,L=0;O<v;O++){for(;l[L+1]<O;)L++;a[O]=(O-n[L])*(O-n[L])+s[n[L]]}}nt.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var v=a.data[4*l+3]/255;this.gridOuter[l]=v===1?0:v===0?Et:Math.pow(Math.max(0,.5-v),2),this.gridInner[l]=v===1?Et:v===0?0:Math.pow(Math.max(0,v-.5),2)}for(Ct(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Ct(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},At.default=Ye;var Re=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};Re.prototype.setURL=function(s){this.url=s},Re.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var v in s)for(var O=0,L=s[v];O<L.length;O+=1)l.push({stack:v,id:L[O]});i.asyncAll(l,function(j,ue){var Ee=j.stack,$e=j.id,rt=n.entries[Ee];rt||(rt=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var at=rt.glyphs[$e];if(at===void 0){if(at=n._tinySDF(rt,Ee,$e))return rt.glyphs[$e]=at,void ue(null,{stack:Ee,id:$e,glyph:at});var zt=Math.floor($e/256);if(256*zt>65535)ue(new Error("glyphs > 65535 not supported"));else if(rt.ranges[zt])ue(null,{stack:Ee,id:$e,glyph:at});else{var Nt=rt.requests[zt];Nt||(Nt=rt.requests[zt]=[],Re.loadGlyphRange(Ee,zt,n.url,n.requestManager,function(Jt,jt){if(jt){for(var Gt in jt)n._doesCharSupportLocalGlyph(+Gt)||(rt.glyphs[+Gt]=jt[+Gt]);rt.ranges[zt]=!0}for(var ar=0,nr=Nt;ar<nr.length;ar+=1)(0,nr[ar])(Jt,jt);delete rt.requests[zt]})),Nt.push(function(Jt,jt){Jt?ue(Jt):jt&&ue(null,{stack:Ee,id:$e,glyph:jt[$e]||null})})}}else ue(null,{stack:Ee,id:$e,glyph:at})},function(j,ue){if(j)a(j);else if(ue){for(var Ee={},$e=0,rt=ue;$e<rt.length;$e+=1){var at=rt[$e],zt=at.stack,Nt=at.id,Jt=at.glyph;(Ee[zt]||(Ee[zt]={}))[Nt]=Jt&&{id:Jt.id,bitmap:Jt.bitmap.clone(),metrics:Jt.metrics}}a(null,Ee)}})},Re.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(i.isChar["CJK Unified Ideographs"](s)||i.isChar["Hangul Syllables"](s)||i.isChar.Hiragana(s)||i.isChar.Katakana(s))},Re.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var v=s.tinySDF;if(!v){var O="400";/bold/i.test(a)?O="900":/medium/i.test(a)?O="500":/light/i.test(a)&&(O="200"),v=s.tinySDF=new Re.TinySDF(24,3,8,.25,l,O)}return{id:n,bitmap:new i.AlphaImage({width:30,height:30},v.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Re.loadGlyphRange=function(s,a,n,l,v){var O=256*a,L=O+255,j=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",O+"-"+L),i.ResourceType.Glyphs);i.getArrayBuffer(j,function(ue,Ee){if(ue)v(ue);else if(Ee){for(var $e={},rt=0,at=i.parseGlyphPBF(Ee);rt<at.length;rt+=1){var zt=at[rt];$e[zt.id]=zt}v(null,$e)}})},Re.TinySDF=At;var Ie=function(){this.specification=i.styleSpec.light.position};Ie.prototype.possiblyEvaluate=function(s,a){return i.sphericalToCartesian(s.expression.evaluate(a))},Ie.prototype.interpolate=function(s,a,n){return{x:i.number(s.x,a.x,n),y:i.number(s.y,a.y,n),z:i.number(s.z,a.z,n)}};var Be=new i.Properties({anchor:new i.DataConstantProperty(i.styleSpec.light.anchor),position:new Ie,color:new i.DataConstantProperty(i.styleSpec.light.color),intensity:new i.DataConstantProperty(i.styleSpec.light.intensity)}),ft=function(s){function a(n){s.call(this),this._transitionable=new i.Transitionable(Be),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(i.validateLight,n,l))for(var v in n){var O=n[v];i.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-"-transition".length),O):this._transitionable.setValue(v,O)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,v){return(!v||v.validate!==!1)&&i.emitValidationErrors(this,n.call(i.validateStyle,i.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.styleSpec})))},a}(i.Evented),Me=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Me.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Me.prototype.getDashRanges=function(s,a,n){var l=[],v=s.length%2==1?-s[s.length-1]*n:0,O=s[0]*n,L=!0;l.push({left:v,right:O,isDash:L,zeroLength:s[0]===0});for(var j=s[0],ue=1;ue<s.length;ue++){var Ee=s[ue];l.push({left:v=j*n,right:O=(j+=Ee)*n,isDash:L=!L,zeroLength:Ee===0})}return l},Me.prototype.addRoundDash=function(s,a,n){for(var l=a/2,v=-n;v<=n;v++)for(var O=this.width*(this.nextRow+n+v),L=0,j=s[L],ue=0;ue<this.width;ue++){ue/j.right>1&&(j=s[++L]);var Ee=Math.abs(ue-j.left),$e=Math.abs(ue-j.right),rt=Math.min(Ee,$e),at=void 0,zt=v/n*(l+1);if(j.isDash){var Nt=l-Math.abs(zt);at=Math.sqrt(rt*rt+Nt*Nt)}else at=l-Math.sqrt(rt*rt+zt*zt);this.data[O+ue]=Math.max(0,Math.min(255,at+128))}},Me.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var v=s[0],O=s[s.length-1];v.isDash===O.isDash&&(v.left=O.left-this.width,O.right=v.right+this.width);for(var L=this.width*this.nextRow,j=0,ue=s[j],Ee=0;Ee<this.width;Ee++){Ee/ue.right>1&&(ue=s[++j]);var $e=Math.abs(Ee-ue.left),rt=Math.abs(Ee-ue.right),at=Math.min($e,rt);this.data[L+Ee]=Math.max(0,Math.min(255,(ue.isDash?at:-at)+128))}},Me.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var v=0,O=0;O<s.length;O++)v+=s[O];if(v!==0){var L=this.width/v,j=this.getDashRanges(s,this.width,L);a?this.addRoundDash(j,L,n):this.addRegularDash(j)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:v};return this.nextRow+=l,this.dirty=!0,ue},Me.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ht=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var l=this.workerPool.acquire(this.id),v=0;v<l.length;v++){var O=new s.Actor(l[v],n,this.id);O.name="Worker "+v,this.actors.push(O)}};function Wt(s,a,n){var l=function(O,L){if(O)return n(O);if(L){var j=i.pick(i.extend(L,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(j.vectorLayers=L.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(ue){return ue.id})),j.tiles=a.canonicalizeTileset(j,s.url),n(null,j)}};return s.url?i.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),i.ResourceType.Source),l):i.browser.frame(function(){return l(null,s)})}ht.prototype.broadcast=function(s,a,n){i.asyncAll(this.actors,function(l,v){l.send(s,a,v)},n=n||function(){})},ht.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ht.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ht.Actor=i.Actor;var Qt=function(a,n,l){this.bounds=i.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Qt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Qt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*a),v=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*a),O=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<v&&s.y>=l&&s.y<O};var ur=function(s){function a(n,l,v,O){if(s.call(this),this.id=n,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(l,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,v){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):v&&(i.extend(n,v),v.bounds&&(n.tileBounds=new Qt(v.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(v.tiles,n.map._requestManager._customAccessToken),i.postMapLoadEvent(v.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.loadTile=function(n,l){var v=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),O={request:this.map._requestManager.transformRequest(v,i.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(j,ue){return delete n.request,n.aborted?l(null):j&&j.status!==404?l(j):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",O,L.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",O,L.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(i.Evented),oe=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.dispatcher=v,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},l),i.extend(this,i.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,v){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):v&&(i.extend(n,v),v.bounds&&(n.tileBounds=new Qt(v.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(v.tiles),i.postMapLoadEvent(v.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var v=this,O=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=i.getImage(this.map._requestManager.transformRequest(O,i.ResourceType.Tile),function(L,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(j){v.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=v.map.painter.context,Ee=ue.gl;n.texture=v.map.painter.getTileTexture(j.width),n.texture?n.texture.update(j,{useMipmap:!0}):(n.texture=new i.Texture(ue,j,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",i.cacheEntryPossiblyAdded(v.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(i.Evented),J=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var v=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function O(L,j){L&&(n.state="errored",l(L)),j&&(n.dem=j,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=i.getImage(this.map._requestManager.transformRequest(v,i.ResourceType.Tile),function(L,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(j){this.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=i.window.ImageBitmap&&j instanceof i.window.ImageBitmap&&i.offscreenCanvasSupported()?j:i.browser.getImageData(j,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,O.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,v=Math.pow(2,l.z),O=(l.x-1+v)%v,L=l.x===0?n.wrap-1:n.wrap,j=(l.x+1+v)%v,ue=l.x+1===v?n.wrap+1:n.wrap,Ee={};return Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y).key]={backfilled:!1},l.y>0&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y-1).key]={backfilled:!1}),l.y+1<v&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y+1).key]={backfilled:!1}),Ee},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(O),this._data=l.data,this._options=i.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var L=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*L,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*L,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.EXTENT,radius:(l.clusterRadius||50)*L,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new i.ErrorEvent(l));else{var v={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(v.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new i.Event("data",v))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)l.fire(new i.ErrorEvent(v));else{var O={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(O.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new i.Event("data",O))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,v,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:v},O),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var v=i.extend({},this.workerOptions),O=this._data;typeof O=="string"?(v.request=this.map._requestManager.transformRequest(i.browser.resolveURL(O),i.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(O),this.actor.send(this.type+".loadData",v,function(L,j){l._removed||j&&j.abandoned||(l._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[l.id]&&(l._resourceTiming=j.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:v.source},null),n(L))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var v=this,O=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(O,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,j){return delete n.request,n.unloadVectorData(),n.aborted?l(null):L?l(L):(n.loadVectorData(j,v.map.painter,O==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return i.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Se=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),be=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.dispatcher=v,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var v=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),function(O,L){v._loaded=!0,O?v.fire(new i.ErrorEvent(O)):L&&(v.image=L,n&&(v.coordinates=n),l&&l(),v._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var v=n.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var j=1/0,ue=1/0,Ee=-1/0,$e=-1/0,rt=0,at=L;rt<at.length;rt+=1){var zt=at[rt];j=Math.min(j,zt.x),ue=Math.min(ue,zt.y),Ee=Math.max(Ee,zt.x),$e=Math.max($e,zt.y)}var Nt=Math.max(Ee-j,$e-ue),Jt=Math.max(0,Math.floor(-Math.log(Nt)/Math.LN2)),jt=Math.pow(2,Jt);return new i.CanonicalTileID(Jt,Math.floor((j+Ee)/2*jt),Math.floor((ue+$e)/2*jt))}(v),this.minzoom=this.maxzoom=this.tileID.z;var O=v.map(function(L){return l.tileID.getTilePoint(L)._round()});return this._boundsArray=new i.StructArrayLayout4i8,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(O[2].x,O[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new i.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[v];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(i.Evented),_e=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var v=0,O=l.urls;v<O.length;v+=1)this.urls.push(this.map._requestManager.transformRequest(O[v],i.ResourceType.Source).url);i.getVideo(this.urls,function(L,j){n._loaded=!0,L?n.fire(new i.ErrorEvent(L)):j&&(n.video=j,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[v];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(be),me=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(j){return typeof j!="number"})})||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,v=l.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(l,this.canvas,v.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[O];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var v=l[n];if(isNaN(v)||v<=0)return!0}return!1},a}(be),it={vector:ur,raster:oe,"raster-dem":J,geojson:H,video:_e,image:be,canvas:me};function qt(s,a){var n=i.identity([]);return i.translate(n,n,[1,1,0]),i.scale(n,n,[.5*s.width,.5*s.height,1]),i.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function Pt(s,a,n,l,v,O){var L=function(Jt,jt,Gt){if(Jt)for(var ar=0,nr=Jt;ar<nr.length;ar+=1){var Rr=jt[nr[ar]];if(Rr&&Rr.source===Gt&&Rr.type==="fill-extrusion")return!0}else for(var gr in jt){var Ar=jt[gr];if(Ar.source===Gt&&Ar.type==="fill-extrusion")return!0}return!1}(v&&v.layers,a,s.id),j=O.maxPitchScaleFactor(),ue=s.tilesIn(l,j,L);ue.sort(ve);for(var Ee=[],$e=0,rt=ue;$e<rt.length;$e+=1){var at=rt[$e];Ee.push({wrappedTileID:at.tileID.wrapped().key,queryResults:at.tile.queryRenderedFeatures(a,n,s._state,at.queryGeometry,at.cameraQueryGeometry,at.scale,v,O,j,qt(s.transform,at.tileID))})}var zt=function(Jt){for(var jt={},Gt={},ar=0,nr=Jt;ar<nr.length;ar+=1){var Rr=nr[ar],gr=Rr.queryResults,Ar=Rr.wrappedTileID,Cr=Gt[Ar]=Gt[Ar]||{};for(var an in gr)for(var Yr=gr[an],vn=Cr[an]=Cr[an]||{},Pn=jt[an]=jt[an]||[],qn=0,sa=Yr;qn<sa.length;qn+=1){var Aa=sa[qn];vn[Aa.featureIndex]||(vn[Aa.featureIndex]=!0,Pn.push(Aa))}}return jt}(Ee);for(var Nt in zt)zt[Nt].forEach(function(Jt){var jt=Jt.feature,Gt=s.getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=Gt});return zt}function ve(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var ge=function(a,n){this.max=a,this.onRemove=n,this.reset()};ge.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ge.prototype.add=function(s,a,n){var l=this,v=s.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);var O={value:a,timeout:void 0};if(n!==void 0&&(O.timeout=setTimeout(function(){l.remove(s,O)},n)),this.data[v].push(O),this.order.push(v),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},ge.prototype.has=function(s){return s.wrapped().key in this.data},ge.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},ge.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},ge.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},ge.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},ge.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),v=this.data[n][l];return this.data[n].splice(l,1),v.timeout&&clearTimeout(v.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(v.value),this.order.splice(this.order.indexOf(n),1),this},ge.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},ge.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,v=this.data[n];l<v.length;l+=1){var O=v[l];s(O.value)||a.push(O)}for(var L=0,j=a;L<j.length;L+=1){var ue=j[L];this.remove(ue.value.tileID,ue)}};var Ve=function(a,n,l){this.context=a;var v=a.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ve.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ve.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Ve.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var st={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Oe=function(a,n,l,v){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=v,this.context=a;var O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Oe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Oe.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Oe.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Oe.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var v=this.attributes[l],O=a.attributes[v.name];O!==void 0&&s.vertexAttribPointer(O,v.components,s[st[v.type]],!1,this.itemSize,v.offset+this.itemSize*(n||0))}},Oe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var vt=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};vt.prototype.get=function(){return this.current},vt.prototype.set=function(s){},vt.prototype.getDefault=function(){return this.default},vt.prototype.setDefault=function(){this.set(this.default)};var C=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(vt),R=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(vt),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(vt),ce=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(vt),Ge=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(vt),qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(vt),Tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(vt),ot=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(vt),Ut=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(vt),$=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(vt),Qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(vt),ae=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(vt),et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(vt),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(vt),pr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(vt),Ke=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(vt),bt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(vt),yt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(vt),xt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(vt),ze=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(vt),dt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(vt),gt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(vt),Ht=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(vt),hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(vt),Zr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(vt),yr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(vt),Vn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(vt),Fn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(vt),oa=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(vt),$n=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(vt),Kn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(vt),Cn=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(vt),F=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(Cn),W=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(Cn),le=function(a,n,l,v){this.context=a,this.width=n,this.height=l;var O=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new F(a,O),v&&(this.depthAttachment=new W(a,O))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var xe=function(a,n,l){this.func=a,this.mask=n,this.range=l};xe.ReadOnly=!1,xe.ReadWrite=!0,xe.disabled=new xe(519,xe.ReadOnly,[0,1]);var ut=function(a,n,l,v,O,L){this.test=a,this.ref=n,this.mask=l,this.fail=v,this.depthFail=O,this.pass=L};ut.disabled=new ut({func:519,mask:0},0,0,7680,7680,7680);var wt=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};wt.disabled=new wt(wt.Replace=[1,0],i.Color.transparent,[!1,!1,!1,!1]),wt.unblended=new wt(wt.Replace,i.Color.transparent,[!0,!0,!0,!0]),wt.alphaBlended=new wt([1,771],i.Color.transparent,[!0,!0,!0,!0]);var Bt=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};Bt.disabled=new Bt(!1,1029,2305),Bt.backCCW=new Bt(!0,1029,2305);var Ze=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new C(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new ce(this),this.depthMask=new Ge(this),this.stencilMask=new qe(this),this.stencilFunc=new Tt(this),this.stencilOp=new ot(this),this.stencilTest=new Ut(this),this.depthRange=new $(this),this.depthTest=new Qe(this),this.depthFunc=new ae(this),this.blend=new et(this),this.blendFunc=new kt(this),this.blendColor=new pr(this),this.blendEquation=new Ke(this),this.cullFace=new bt(this),this.cullFaceSide=new yt(this),this.frontFace=new xt(this),this.program=new ze(this),this.activeTexture=new dt(this),this.viewport=new gt(this),this.bindFramebuffer=new Ht(this),this.bindRenderbuffer=new hr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new yr(this),this.bindElementBuffer=new Vn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Fn(this),this.pixelStoreUnpack=new oa(this),this.pixelStoreUnpackPremultiplyAlpha=new $n(this),this.pixelStoreUnpackFlipY=new Kn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};Ze.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ze.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ze.prototype.createIndexBuffer=function(s,a){return new Ve(this,s,a)},Ze.prototype.createVertexBuffer=function(s,a,n){return new Oe(this,s,a,n)},Ze.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,v=l.createRenderbuffer();return this.bindRenderbuffer.set(v),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),v},Ze.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},Ze.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,v=0;a&&(v|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(v|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(v)},Ze.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Ze.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Ze.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Ze.prototype.setColorMode=function(s){i.deepEqual(s.blendFunction,wt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Ze.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Rt=function(s){function a(n,l,v){var O=this;s.call(this),this.id=n,this.dispatcher=v,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(O._sourceLoaded=!0),O._sourceLoaded&&!O._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(O.reload(),O.transform&&O.update(O.transform))}),this.on("error",function(){O._sourceErrored=!0}),this._source=function(L,j,ue,Ee){var $e=new it[j.type](L,j,ue,Ee);if($e.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+$e.id);return i.bindAll(["load","abort","unload","serialize","prepare"],$e),$e}(n,l,v,this),this._tiles={},this._cache=new ge(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new i.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var v=this._tiles[l];v.upload(n),v.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return i.values(this._tiles).map(function(n){return n.tileID}).sort(lr).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,v=[];for(var O in this._tiles)this._isIdRenderable(O,n)&&v.push(this._tiles[O]);return n?v.sort(function(L,j){var ue=L.tileID,Ee=j.tileID,$e=new i.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),rt=new i.Point(Ee.canonical.x,Ee.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Ee.overscaledZ||rt.y-$e.y||rt.x-$e.x}).map(function(L){return L.tileID.key}):v.map(function(L){return L.tileID}).sort(lr).map(function(L){return L.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var v=this._tiles[n];v&&(v.state!=="loading"&&(v.state=l),this._loadTile(v,this._tileLoaded.bind(this,v,n,l)))},a.prototype._tileLoaded=function(n,l,v,O){if(O)return n.state="errored",void(O.status!==404?this._source.fire(new i.ErrorEvent(O,{tile:n})):this.update(this.transform));n.timeAdded=i.browser.now(),v==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),v=0;v<l.length;v++){var O=l[v];if(n.neighboringTiles&&n.neighboringTiles[O]){var L=this.getTileByID(O);j(n,L),j(L,n)}}function j(ue,Ee){ue.needsHillshadePrepare=!0;var $e=Ee.tileID.canonical.x-ue.tileID.canonical.x,rt=Ee.tileID.canonical.y-ue.tileID.canonical.y,at=Math.pow(2,ue.tileID.canonical.z),zt=Ee.tileID.key;$e===0&&rt===0||Math.abs(rt)>1||(Math.abs($e)>1&&(Math.abs($e+at)===1?$e+=at:Math.abs($e-at)===1&&($e-=at)),Ee.dem&&ue.dem&&(ue.dem.backfillBorder(Ee.dem,$e,rt),ue.neighboringTiles&&ue.neighboringTiles[zt]&&(ue.neighboringTiles[zt].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,v,O){for(var L in this._tiles){var j=this._tiles[L];if(!(O[L]||!j.hasData()||j.tileID.overscaledZ<=l||j.tileID.overscaledZ>v)){for(var ue=j.tileID;j&&j.tileID.overscaledZ>l+1;){var Ee=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[Ee.key])&&j.hasData()&&(ue=Ee)}for(var $e=ue;$e.overscaledZ>l;)if(n[($e=$e.scaledTo($e.overscaledZ-1)).key]){O[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var v=this._loadedParentTiles[n.key];return v&&v.tileID.overscaledZ>=l?v:null}for(var O=n.overscaledZ-1;O>=l;O--){var L=n.scaledTo(O),j=this._getLoadedTile(L);if(j)return j}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,v=Math.ceil(n.height/this._source.tileSize)+1,O=Math.floor(l*v*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(L)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var v={};for(var O in this._tiles){var L=this._tiles[O];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),v[L.tileID.key]=L}for(var j in this._tiles=v,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var v;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?v=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Cr){return new i.OverscaledTileID(Cr.canonical.z,Cr.wrap,Cr.canonical.z,Cr.canonical.x,Cr.canonical.y)}):(v=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(v=v.filter(function(Cr){return l._source.hasTile(Cr)}))):v=[];var O=n.coveringZoomLevel(this._source),L=Math.max(O-a.maxOverzooming,this._source.minzoom),j=Math.max(O+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(v,O);if(Ur(this._source.type)){for(var Ee={},$e={},rt=0,at=Object.keys(ue);rt<at.length;rt+=1){var zt=at[rt],Nt=ue[zt],Jt=this._tiles[zt];if(Jt&&!(Jt.fadeEndTime&&Jt.fadeEndTime<=i.browser.now())){var jt=this.findLoadedParent(Nt,L);jt&&(this._addTile(jt.tileID),Ee[jt.tileID.key]=jt.tileID),$e[zt]=Nt}}for(var Gt in this._retainLoadedChildren($e,O,j,ue),Ee)ue[Gt]||(this._coveredTiles[Gt]=!0,ue[Gt]=Ee[Gt])}for(var ar in ue)this._tiles[ar].clearFadeHold();for(var nr=0,Rr=i.keysDifference(this._tiles,ue);nr<Rr.length;nr+=1){var gr=Rr[nr],Ar=this._tiles[gr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var v={},O={},L=Math.max(l-a.maxOverzooming,this._source.minzoom),j=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Ee=0,$e=n;Ee<$e.length;Ee+=1){var rt=$e[Ee],at=this._addTile(rt);v[rt.key]=rt,at.hasData()||l<this._source.maxzoom&&(ue[rt.key]=rt)}this._retainLoadedChildren(ue,l,j,v);for(var zt=0,Nt=n;zt<Nt.length;zt+=1){var Jt=Nt[zt],jt=this._tiles[Jt.key];if(!jt.hasData()){if(l+1>this._source.maxzoom){var Gt=Jt.children(this._source.maxzoom)[0],ar=this.getTile(Gt);if(ar&&ar.hasData()){v[Gt.key]=Gt;continue}}else{var nr=Jt.children(this._source.maxzoom);if(v[nr[0].key]&&v[nr[1].key]&&v[nr[2].key]&&v[nr[3].key])continue}for(var Rr=jt.wasRequested(),gr=Jt.overscaledZ-1;gr>=L;--gr){var Ar=Jt.scaledTo(gr);if(O[Ar.key])break;if(O[Ar.key]=!0,!(jt=this.getTile(Ar))&&Rr&&(jt=this._addTile(Ar)),jt&&(v[Ar.key]=Ar,Rr=jt.wasRequested(),jt.hasData()))break}}}return v},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],v=void 0,O=this._tiles[n].tileID;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){v=this._loadedParentTiles[O.key];break}l.push(O.key);var L=O.scaledTo(O.overscaledZ-1);if(v=this._getLoadedTile(L))break;O=L}for(var j=0,ue=l;j<ue.length;j+=1)this._loadedParentTiles[ue[j]]=v}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var v=Boolean(l);return v||(l=new i.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,v||this._source.fire(new i.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var v=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var O=l.getExpiryTimeout();O&&(this._timers[n]=setTimeout(function(){v._reloadTile(n,"expired"),delete v._timers[n]},O))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,v){var O=this,L=[],j=this.transform;if(!j)return L;for(var ue=v?j.getCameraQueryGeometry(n):n,Ee=n.map(function(gr){return j.pointCoordinate(gr)}),$e=ue.map(function(gr){return j.pointCoordinate(gr)}),rt=this.getIds(),at=1/0,zt=1/0,Nt=-1/0,Jt=-1/0,jt=0,Gt=$e;jt<Gt.length;jt+=1){var ar=Gt[jt];at=Math.min(at,ar.x),zt=Math.min(zt,ar.y),Nt=Math.max(Nt,ar.x),Jt=Math.max(Jt,ar.y)}for(var nr=function(Ar){var Cr=O._tiles[rt[Ar]];if(!Cr.holdingForFade()){var an=Cr.tileID,Yr=Math.pow(2,j.zoom-Cr.tileID.overscaledZ),vn=l*Cr.queryPadding*i.EXTENT/Cr.tileSize/Yr,Pn=[an.getTilePoint(new i.MercatorCoordinate(at,zt)),an.getTilePoint(new i.MercatorCoordinate(Nt,Jt))];if(Pn[0].x-vn<i.EXTENT&&Pn[0].y-vn<i.EXTENT&&Pn[1].x+vn>=0&&Pn[1].y+vn>=0){var qn=Ee.map(function(Aa){return an.getTilePoint(Aa)}),sa=$e.map(function(Aa){return an.getTilePoint(Aa)});L.push({tile:Cr,tileID:an,queryGeometry:qn,cameraQueryGeometry:sa,scale:Yr})}}},Rr=0;Rr<rt.length;Rr++)nr(Rr);return L},a.prototype.getVisibleCoordinates=function(n){for(var l=this,v=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),O=0,L=v;O<L.length;O+=1){var j=L[O];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return v},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ur(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,v){this._state.updateState(n=n||"_geojsonTileLayer",l,v)},a.prototype.removeFeatureState=function(n,l,v){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,v)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,v){var O=this._tiles[n];O&&O.setDependencies(l,v)},a.prototype.reloadTilesForDependencies=function(n,l){for(var v in this._tiles)this._tiles[v].hasDependency(n,l)&&this._reloadTile(v,"reloading");this._cache.filter(function(O){return!O.hasDependency(n,l)})},a}(i.Evented);function lr(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function Ur(s){return s==="raster"||s==="image"||s==="video"}function Gr(){return new i.window.Worker(ac.workerUrl)}Rt.maxOverzooming=10,Rt.maxUnderzooming=3;var cr="mapboxgl_preloaded_worker_pool",Br=function(){this.active={}};Br.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Br.workerCount;)this.workers.push(new Gr);return this.active[s]=!0,this.workers.slice()},Br.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Br.prototype.isPreloaded=function(){return!!this.active[cr]},Br.prototype.numActive=function(){return Object.keys(this.active).length};var wn,fn=Math.floor(i.browser.hardwareConcurrency/2);function tr(){return wn||(wn=new Br),wn}function rn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return i.refProperties.forEach(function(v){v in a&&(n[v]=a[v])}),n}function dn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=rn(s[l],a[s[l].ref]));return s}Br.workerCount=Math.max(Math.min(fn,6),1);var En={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function bn(s,a,n){n.push({command:En.addSource,args:[s,a[s]]})}function gn(s,a,n){a.push({command:En.removeSource,args:[s]}),n[s]=!0}function Mn(s,a,n,l){gn(s,n,l),bn(s,a,n)}function Ga(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;return!0}function ga(s,a,n,l,v,O){var L;for(L in a=a||{},s=s||{})s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:O,args:[l,L,a[L],v]}));for(L in a)a.hasOwnProperty(L)&&!s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:O,args:[l,L,a[L],v]}))}function Ma(s){return s.id}function Ia(s,a){return s[a.id]=a,s}var Wi=function(a,n){this.reset(a,n)};Wi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Wi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=i.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var v=a-1,O=this._distances[v],L=n-O,j=L>0?(l-O)/L:0;return this.points[v].mult(1-j).add(this.points[a].mult(j))};var da=function(a,n,l){var v=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var L=0;L<this.xCellCount*this.yCellCount;L++)v.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function vi(s,a,n,l,v){var O=i.create();return a?(i.scale(O,O,[1/v,1/v,1]),n||i.rotateZ(O,O,l.angle)):i.multiply(O,l.labelPlaneMatrix,s),O}function ya(s,a,n,l,v){if(a){var O=i.clone(s);return i.scale(O,O,[v,v,1]),n||i.rotateZ(O,O,-l.angle),O}return l.glCoordMatrix}function ba(s,a){var n=[s.x,s.y,0,1];Yi(n,n,a);var l=n[3];return{point:new i.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function ha(s,a){return .5+s/a*.5}function wi(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function is(s,a,n,l,v,O,L,j){var ue=l?s.textSizeData:s.iconSizeData,Ee=i.evaluateSizeForZoom(ue,n.transform.zoom),$e=[256/n.width*2+1,256/n.height*2+1],rt=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;rt.clear();for(var at=s.lineVertexArray,zt=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Nt=n.transform.width/n.transform.height,Jt=!1,jt=0;jt<zt.length;jt++){var Gt=zt.get(jt);if(Gt.hidden||Gt.writingMode===i.WritingMode.vertical&&!Jt)ui(Gt.numGlyphs,rt);else{Jt=!1;var ar=[Gt.anchorX,Gt.anchorY,0,1];if(i.transformMat4(ar,ar,a),wi(ar,$e)){var nr=ha(n.transform.cameraToCenterDistance,ar[3]),Rr=i.evaluateSizeForFeature(ue,Ee,Gt),gr=L?Rr/nr:Rr*nr,Ar=new i.Point(Gt.anchorX,Gt.anchorY),Cr=ba(Ar,v).point,an={},Yr=Du(Gt,gr,!1,j,a,v,O,s.glyphOffsetArray,at,rt,Cr,Ar,an,Nt);Jt=Yr.useVertical,(Yr.notEnoughRoom||Jt||Yr.needsFlipping&&Du(Gt,gr,!0,j,a,v,O,s.glyphOffsetArray,at,rt,Cr,Ar,an,Nt).notEnoughRoom)&&ui(Gt.numGlyphs,rt)}else ui(Gt.numGlyphs,rt)}}l?s.text.dynamicLayoutVertexBuffer.updateData(rt):s.icon.dynamicLayoutVertexBuffer.updateData(rt)}function Xi(s,a,n,l,v,O,L,j,ue,Ee,$e){var rt=j.glyphStartIndex+j.numGlyphs,at=j.lineStartIndex,zt=j.lineStartIndex+j.lineLength,Nt=a.getoffsetX(j.glyphStartIndex),Jt=a.getoffsetX(rt-1),jt=Oi(s*Nt,n,l,v,O,L,j.segment,at,zt,ue,Ee,$e);if(!jt)return null;var Gt=Oi(s*Jt,n,l,v,O,L,j.segment,at,zt,ue,Ee,$e);return Gt?{first:jt,last:Gt}:null}function Xo(s,a,n,l){return s===i.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===i.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function Du(s,a,n,l,v,O,L,j,ue,Ee,$e,rt,at,zt){var Nt,Jt=a/24,jt=s.lineOffsetX*Jt,Gt=s.lineOffsetY*Jt;if(s.numGlyphs>1){var ar=s.glyphStartIndex+s.numGlyphs,nr=s.lineStartIndex,Rr=s.lineStartIndex+s.lineLength,gr=Xi(Jt,j,jt,Gt,n,$e,rt,s,ue,O,at);if(!gr)return{notEnoughRoom:!0};var Ar=ba(gr.first.point,L).point,Cr=ba(gr.last.point,L).point;if(l&&!n){var an=Xo(s.writingMode,Ar,Cr,zt);if(an)return an}Nt=[gr.first];for(var Yr=s.glyphStartIndex+1;Yr<ar-1;Yr++)Nt.push(Oi(Jt*j.getoffsetX(Yr),jt,Gt,n,$e,rt,s.segment,nr,Rr,ue,O,at));Nt.push(gr.last)}else{if(l&&!n){var vn=ba(rt,v).point,Pn=s.lineStartIndex+s.segment+1,qn=new i.Point(ue.getx(Pn),ue.gety(Pn)),sa=ba(qn,v),Aa=sa.signedDistanceFromCamera>0?sa.point:Ha(rt,qn,vn,1,v),Wa=Xo(s.writingMode,vn,Aa,zt);if(Wa)return Wa}var Tn=Oi(Jt*j.getoffsetX(s.glyphStartIndex),jt,Gt,n,$e,rt,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,O,at);if(!Tn)return{notEnoughRoom:!0};Nt=[Tn]}for(var ua=0,xa=Nt;ua<xa.length;ua+=1){var Zn=xa[ua];i.addDynamicAttributes(Ee,Zn.point,Zn.angle)}return{}}function Ha(s,a,n,l,v){var O=ba(s.add(s.sub(a)._unit()),v).point,L=n.sub(O);return n.add(L._mult(l/L.mag()))}function Oi(s,a,n,l,v,O,L,j,ue,Ee,$e,rt){var at=l?s-a:s+a,zt=at>0?1:-1,Nt=0;l&&(zt*=-1,Nt=Math.PI),zt<0&&(Nt+=Math.PI);for(var Jt=zt>0?j+L:j+L+1,jt=v,Gt=v,ar=0,nr=0,Rr=Math.abs(at),gr=[];ar+nr<=Rr;){if((Jt+=zt)<j||Jt>=ue)return null;if(Gt=jt,gr.push(jt),(jt=rt[Jt])===void 0){var Ar=new i.Point(Ee.getx(Jt),Ee.gety(Jt)),Cr=ba(Ar,$e);if(Cr.signedDistanceFromCamera>0)jt=rt[Jt]=Cr.point;else{var an=Jt-zt;jt=Ha(ar===0?O:new i.Point(Ee.getx(an),Ee.gety(an)),Ar,Gt,Rr-ar+1,$e)}}ar+=nr,nr=Gt.dist(jt)}var Yr=(Rr-ar)/nr,vn=jt.sub(Gt),Pn=vn.mult(Yr)._add(Gt);Pn._add(vn._unit()._perp()._mult(n*zt));var qn=Nt+Math.atan2(jt.y-Gt.y,jt.x-Gt.x);return gr.push(Pn),{point:Pn,angle:qn,path:gr}}da.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},da.prototype.insert=function(s,a,n,l,v){this._forEachCell(a,n,l,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(v)},da.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},da.prototype._insertBoxCell=function(s,a,n,l,v,O){this.boxCells[v].push(O)},da.prototype._insertCircleCell=function(s,a,n,l,v,O){this.circleCells[v].push(O)},da.prototype._query=function(s,a,n,l,v,O){if(n<0||s>this.width||l<0||a>this.height)return!v&&[];var L=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(v)return!0;for(var j=0;j<this.boxKeys.length;j++)L.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ee=this.circles[3*ue],$e=this.circles[3*ue+1],rt=this.circles[3*ue+2];L.push({key:this.circleKeys[ue],x1:Ee-rt,y1:$e-rt,x2:Ee+rt,y2:$e+rt})}return O?L.filter(O):L}return this._forEachCell(s,a,n,l,this._queryCell,L,{hitTest:v,seenUids:{box:{},circle:{}}},O),v?L.length>0:L},da.prototype._queryCircle=function(s,a,n,l,v){var O=s-n,L=s+n,j=a-n,ue=a+n;if(L<0||O>this.width||ue<0||j>this.height)return!l&&[];var Ee=[];return this._forEachCell(O,j,L,ue,this._queryCellCircle,Ee,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},v),l?Ee.length>0:Ee},da.prototype.query=function(s,a,n,l,v){return this._query(s,a,n,l,!1,v)},da.prototype.hitTest=function(s,a,n,l,v){return this._query(s,a,n,l,!0,v)},da.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},da.prototype._queryCell=function(s,a,n,l,v,O,L,j){var ue=L.seenUids,Ee=this.boxCells[v];if(Ee!==null)for(var $e=this.bboxes,rt=0,at=Ee;rt<at.length;rt+=1){var zt=at[rt];if(!ue.box[zt]){ue.box[zt]=!0;var Nt=4*zt;if(s<=$e[Nt+2]&&a<=$e[Nt+3]&&n>=$e[Nt+0]&&l>=$e[Nt+1]&&(!j||j(this.boxKeys[zt]))){if(L.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[zt],x1:$e[Nt],y1:$e[Nt+1],x2:$e[Nt+2],y2:$e[Nt+3]})}}}var Jt=this.circleCells[v];if(Jt!==null)for(var jt=this.circles,Gt=0,ar=Jt;Gt<ar.length;Gt+=1){var nr=ar[Gt];if(!ue.circle[nr]){ue.circle[nr]=!0;var Rr=3*nr;if(this._circleAndRectCollide(jt[Rr],jt[Rr+1],jt[Rr+2],s,a,n,l)&&(!j||j(this.circleKeys[nr]))){if(L.hitTest)return O.push(!0),!0;var gr=jt[Rr],Ar=jt[Rr+1],Cr=jt[Rr+2];O.push({key:this.circleKeys[nr],x1:gr-Cr,y1:Ar-Cr,x2:gr+Cr,y2:Ar+Cr})}}}},da.prototype._queryCellCircle=function(s,a,n,l,v,O,L,j){var ue=L.circle,Ee=L.seenUids,$e=this.boxCells[v];if($e!==null)for(var rt=this.bboxes,at=0,zt=$e;at<zt.length;at+=1){var Nt=zt[at];if(!Ee.box[Nt]){Ee.box[Nt]=!0;var Jt=4*Nt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,rt[Jt+0],rt[Jt+1],rt[Jt+2],rt[Jt+3])&&(!j||j(this.boxKeys[Nt])))return O.push(!0),!0}}var jt=this.circleCells[v];if(jt!==null)for(var Gt=this.circles,ar=0,nr=jt;ar<nr.length;ar+=1){var Rr=nr[ar];if(!Ee.circle[Rr]){Ee.circle[Rr]=!0;var gr=3*Rr;if(this._circlesCollide(Gt[gr],Gt[gr+1],Gt[gr+2],ue.x,ue.y,ue.radius)&&(!j||j(this.circleKeys[Rr])))return O.push(!0),!0}}},da.prototype._forEachCell=function(s,a,n,l,v,O,L,j){for(var ue=this._convertToXCellCoord(s),Ee=this._convertToYCellCoord(a),$e=this._convertToXCellCoord(n),rt=this._convertToYCellCoord(l),at=ue;at<=$e;at++)for(var zt=Ee;zt<=rt;zt++)if(v.call(this,s,a,n,l,this.xCellCount*zt+at,O,L,j))return},da.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},da.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},da.prototype._circlesCollide=function(s,a,n,l,v,O){var L=l-s,j=v-a,ue=n+O;return ue*ue>L*L+j*j},da.prototype._circleAndRectCollide=function(s,a,n,l,v,O,L){var j=(O-l)/2,ue=Math.abs(s-(l+j));if(ue>j+n)return!1;var Ee=(L-v)/2,$e=Math.abs(a-(v+Ee));if($e>Ee+n)return!1;if(ue<=j||$e<=Ee)return!0;var rt=ue-j,at=$e-Ee;return rt*rt+at*at<=n*n};var Jo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ui(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(Jo,3*l)}}function Yi(s,a,n){var l=a[0],v=a[1];return s[0]=n[0]*l+n[4]*v+n[12],s[1]=n[1]*l+n[5]*v+n[13],s[3]=n[3]*l+n[7]*v+n[15],s}var Oo=function(a,n,l){n===void 0&&(n=new da(a.width+200,a.height+200,25)),l===void 0&&(l=new da(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function Za(s,a,n){return a*(i.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}Oo.prototype.placeCollisionBox=function(s,a,n,l,v){var O=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),L=n*O.perspectiveRatio,j=s.x1*L+O.point.x,ue=s.y1*L+O.point.y,Ee=s.x2*L+O.point.x,$e=s.y2*L+O.point.y;return!this.isInsideGrid(j,ue,Ee,$e)||!a&&this.grid.hitTest(j,ue,Ee,$e,v)?{box:[],offscreen:!1}:{box:[j,ue,Ee,$e],offscreen:this.isOffscreen(j,ue,Ee,$e)}},Oo.prototype.placeCollisionCircles=function(s,a,n,l,v,O,L,j,ue,Ee,$e,rt,at){var zt=[],Nt=new i.Point(a.anchorX,a.anchorY),Jt=ba(Nt,O),jt=ha(this.transform.cameraToCenterDistance,Jt.signedDistanceFromCamera),Gt=(Ee?v/jt:v*jt)/i.ONE_EM,ar=ba(Nt,L).point,nr=Xi(Gt,l,a.lineOffsetX*Gt,a.lineOffsetY*Gt,!1,ar,Nt,a,n,L,{}),Rr=!1,gr=!1,Ar=!0;if(nr){for(var Cr=.5*rt*jt+at,an=new i.Point(-100,-100),Yr=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),vn=new Wi,Pn=nr.first,qn=nr.last,sa=[],Aa=Pn.path.length-1;Aa>=1;Aa--)sa.push(Pn.path[Aa]);for(var Wa=1;Wa<qn.path.length;Wa++)sa.push(qn.path[Wa]);var Tn=2.5*Cr;if(j){var ua=sa.map(function(Hs){return ba(Hs,j)});sa=ua.some(function(Hs){return Hs.signedDistanceFromCamera<=0})?[]:ua.map(function(Hs){return Hs.point})}var xa=[];if(sa.length>0){for(var Zn=sa[0].clone(),Ca=sa[0].clone(),ia=1;ia<sa.length;ia++)Zn.x=Math.min(Zn.x,sa[ia].x),Zn.y=Math.min(Zn.y,sa[ia].y),Ca.x=Math.max(Ca.x,sa[ia].x),Ca.y=Math.max(Ca.y,sa[ia].y);xa=Zn.x>=an.x&&Ca.x<=Yr.x&&Zn.y>=an.y&&Ca.y<=Yr.y?[sa]:Ca.x<an.x||Zn.x>Yr.x||Ca.y<an.y||Zn.y>Yr.y?[]:i.clipLine([sa],an.x,an.y,Yr.x,Yr.y)}for(var La=0,Fa=xa;La<Fa.length;La+=1){var Hi;vn.reset(Fa[La],.25*Cr),Hi=vn.length<=.5*Cr?1:Math.ceil(vn.paddedLength/Tn)+1;for(var Ai=0;Ai<Hi;Ai++){var Ni=Ai/Math.max(Hi-1,1),Ei=vn.lerp(Ni),Bi=Ei.x+100,es=Ei.y+100;zt.push(Bi,es,Cr,0);var ts=Bi-Cr,vu=es-Cr,wu=Bi+Cr,hs=es+Cr;if(Ar=Ar&&this.isOffscreen(ts,vu,wu,hs),gr=gr||this.isInsideGrid(ts,vu,wu,hs),!s&&this.grid.hitTestCircle(Bi,es,Cr,$e)&&(Rr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Rr}}}}return{circles:!ue&&Rr||!gr?[]:zt,offscreen:Ar,collisionDetected:Rr}},Oo.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,v=-1/0,O=-1/0,L=0,j=s;L<j.length;L+=1){var ue=j[L],Ee=new i.Point(ue.x+100,ue.y+100);n=Math.min(n,Ee.x),l=Math.min(l,Ee.y),v=Math.max(v,Ee.x),O=Math.max(O,Ee.y),a.push(Ee)}for(var $e={},rt={},at=0,zt=this.grid.query(n,l,v,O).concat(this.ignoredGrid.query(n,l,v,O));at<zt.length;at+=1){var Nt=zt[at],Jt=Nt.key;if($e[Jt.bucketInstanceId]===void 0&&($e[Jt.bucketInstanceId]={}),!$e[Jt.bucketInstanceId][Jt.featureIndex]){var jt=[new i.Point(Nt.x1,Nt.y1),new i.Point(Nt.x2,Nt.y1),new i.Point(Nt.x2,Nt.y2),new i.Point(Nt.x1,Nt.y2)];i.polygonIntersectsPolygon(a,jt)&&($e[Jt.bucketInstanceId][Jt.featureIndex]=!0,rt[Jt.bucketInstanceId]===void 0&&(rt[Jt.bucketInstanceId]=[]),rt[Jt.bucketInstanceId].push(Jt.featureIndex))}}return rt},Oo.prototype.insertCollisionBox=function(s,a,n,l,v){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:v},s[0],s[1],s[2],s[3])},Oo.prototype.insertCollisionCircles=function(s,a,n,l,v){for(var O=a?this.ignoredGrid:this.grid,L={bucketInstanceId:n,featureIndex:l,collisionGroupID:v},j=0;j<s.length;j+=4)O.insertCircle(L,s[j],s[j+1],s[j+2])},Oo.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Yi(l,l,s),{point:new i.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Oo.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Oo.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Oo.prototype.getViewportMatrix=function(){var s=i.identity([]);return i.translate(s,s,[-100,-100,0]),s};var oo=function(a,n,l,v){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):v&&l?1:0,this.placed=l};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(a,n,l,v,O){this.text=new oo(a?a.text:null,n,l,O),this.icon=new oo(a?a.icon:null,n,v,O)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var bu=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},Qo=function(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]},Xl=function(a,n,l,v,O){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=v,this.tileID=O},js=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function ho(s,a,n,l,v){var O=i.getAnchorAlignment(s),L=-(O.horizontalAlign-.5)*a,j=-(O.verticalAlign-.5)*n,ue=i.evaluateVariableOffset(s,l);return new i.Point(L+ue[0]*v,j+ue[1]*v)}function Vt(s,a,n,l,v,O){var L=s.x1,j=s.x2,ue=s.y1,Ee=s.y2,$e=s.anchorPointX,rt=s.anchorPointY,at=new i.Point(a,n);return l&&at._rotate(v?O:-O),{x1:L+at.x,y1:ue+at.y,x2:j+at.x,y2:Ee+at.y,anchorPointX:$e,anchorPointY:rt}}js.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Le=function(a,n,l,v){this.transform=a.clone(),this.collisionIndex=new Oo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new js(l),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}};function Dt(s,a,n,l,v){s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0)}Le.prototype.getBucketParts=function(s,a,n,l){var v=n.getBucket(a),O=n.latestFeatureIndex;if(v&&O&&a.id===v.layerIds[0]){var L=n.collisionBoxArray,j=v.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/i.EXTENT,$e=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),rt=j.get("text-pitch-alignment")==="map",at=j.get("text-rotation-alignment")==="map",zt=Za(n,1,this.transform.zoom),Nt=vi($e,rt,at,this.transform,zt),Jt=null;if(rt){var jt=ya($e,rt,at,this.transform,zt);Jt=i.multiply([],this.transform.labelPlaneMatrix,jt)}this.retainedQueryData[v.bucketInstanceId]=new Xl(v.bucketInstanceId,O,v.sourceLayerIndex,v.index,n.tileID);var Gt={bucket:v,layout:j,posMatrix:$e,textLabelPlaneMatrix:Nt,labelToScreenMatrix:Jt,scale:ue,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(l)for(var ar=0,nr=v.sortKeyRanges;ar<nr.length;ar+=1){var Rr=nr[ar];s.push({sortKey:Rr.sortKey,symbolInstanceStart:Rr.symbolInstanceStart,symbolInstanceEnd:Rr.symbolInstanceEnd,parameters:Gt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Gt})}},Le.prototype.attemptAnchorPlacement=function(s,a,n,l,v,O,L,j,ue,Ee,$e,rt,at,zt,Nt){var Jt,jt=[rt.textOffset0,rt.textOffset1],Gt=ho(s,n,l,jt,v),ar=this.collisionIndex.placeCollisionBox(Vt(a,Gt.x,Gt.y,O,L,this.transform.angle),$e,j,ue,Ee.predicate);if(!Nt||this.collisionIndex.placeCollisionBox(Vt(Nt,Gt.x,Gt.y,O,L,this.transform.angle),$e,j,ue,Ee.predicate).box.length!==0)return ar.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[rt.crossTileID]&&this.prevPlacement.placements[rt.crossTileID]&&this.prevPlacement.placements[rt.crossTileID].text&&(Jt=this.prevPlacement.variableOffsets[rt.crossTileID].anchor),this.variableOffsets[rt.crossTileID]={textOffset:jt,width:n,height:l,anchor:s,textBoxScale:v,prevAnchor:Jt},this.markUsedJustification(at,s,rt,zt),at.allowVerticalPlacement&&(this.markUsedOrientation(at,zt,rt),this.placedOrientations[rt.crossTileID]=zt),{shift:Gt,placedGlyphBoxes:ar}):void 0},Le.prototype.placeLayerBucketPart=function(s,a,n){var l=this,v=s.parameters,O=v.bucket,L=v.layout,j=v.posMatrix,ue=v.textLabelPlaneMatrix,Ee=v.labelToScreenMatrix,$e=v.textPixelRatio,rt=v.holdingForFade,at=v.collisionBoxArray,zt=v.partiallyEvaluatedTextSize,Nt=v.collisionGroup,Jt=L.get("text-optional"),jt=L.get("icon-optional"),Gt=L.get("text-allow-overlap"),ar=L.get("icon-allow-overlap"),nr=L.get("text-rotation-alignment")==="map",Rr=L.get("text-pitch-alignment")==="map",gr=L.get("icon-text-fit")!=="none",Ar=L.get("symbol-z-order")==="viewport-y",Cr=Gt&&(ar||!O.hasIconData()||jt),an=ar&&(Gt||!O.hasTextData()||Jt);!O.collisionArrays&&at&&O.deserializeCollisionBoxes(at);var Yr=function(Tn,ua){if(!a[Tn.crossTileID])if(rt)l.placements[Tn.crossTileID]=new bu(!1,!1,!1);else{var xa,Zn=!1,Ca=!1,ia=!0,La=null,Fa={box:null,offscreen:null},Hi={box:null,offscreen:null},Ai=null,Ni=null,Ei=0,Bi=0,es=0;ua.textFeatureIndex?Ei=ua.textFeatureIndex:Tn.useRuntimeCollisionCircles&&(Ei=Tn.featureIndex),ua.verticalTextFeatureIndex&&(Bi=ua.verticalTextFeatureIndex);var ts=ua.textBox;if(ts){var vu=function(Ko){var Ao=i.WritingMode.horizontal;if(O.allowVerticalPlacement&&!Ko&&l.prevPlacement){var uo=l.prevPlacement.placedOrientations[Tn.crossTileID];uo&&(l.placedOrientations[Tn.crossTileID]=uo,l.markUsedOrientation(O,Ao=uo,Tn))}return Ao},wu=function(Ko,Ao){if(O.allowVerticalPlacement&&Tn.numVerticalGlyphVertices>0&&ua.verticalTextBox)for(var uo=0,Ns=O.writingModes;uo<Ns.length&&(Ns[uo]===i.WritingMode.vertical?(Fa=Ao(),Hi=Fa):Fa=Ko(),!(Fa&&Fa.box&&Fa.box.length));uo+=1);else Fa=Ko()};if(L.get("text-variable-anchor")){var hs=L.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Tn.crossTileID]){var Hs=l.prevPlacement.variableOffsets[Tn.crossTileID];hs.indexOf(Hs.anchor)>0&&(hs=hs.filter(function(ko){return ko!==Hs.anchor})).unshift(Hs.anchor)}var Ou=function(Ko,Ao,uo){for(var Ns=Ko.x2-Ko.x1,nu=Ko.y2-Ko.y1,Gl=Tn.textBoxScale,Uc=gr&&!ar?Ao:null,fl={box:[],offscreen:!1},sc=Gt?2*hs.length:hs.length,hl=0;hl<sc;++hl){var ks=l.attemptAnchorPlacement(hs[hl%hs.length],Ko,Ns,nu,Gl,nr,Rr,$e,j,Nt,hl>=hs.length,Tn,O,uo,Uc);if(ks&&(fl=ks.placedGlyphBoxes)&&fl.box&&fl.box.length){Zn=!0,La=ks.shift;break}}return fl};wu(function(){return Ou(ts,ua.iconBox,i.WritingMode.horizontal)},function(){var ko=ua.verticalTextBox;return O.allowVerticalPlacement&&!(Fa&&Fa.box&&Fa.box.length)&&Tn.numVerticalGlyphVertices>0&&ko?Ou(ko,ua.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),Fa&&(Zn=Fa.box,ia=Fa.offscreen);var ic=vu(Fa&&Fa.box);if(!Zn&&l.prevPlacement){var tu=l.prevPlacement.variableOffsets[Tn.crossTileID];tu&&(l.variableOffsets[Tn.crossTileID]=tu,l.markUsedJustification(O,tu.anchor,Tn,ic))}}else{var Hu=function(Ko,Ao){var uo=l.collisionIndex.placeCollisionBox(Ko,Gt,$e,j,Nt.predicate);return uo&&uo.box&&uo.box.length&&(l.markUsedOrientation(O,Ao,Tn),l.placedOrientations[Tn.crossTileID]=Ao),uo};wu(function(){return Hu(ts,i.WritingMode.horizontal)},function(){var ko=ua.verticalTextBox;return O.allowVerticalPlacement&&Tn.numVerticalGlyphVertices>0&&ko?Hu(ko,i.WritingMode.vertical):{box:null,offscreen:null}}),vu(Fa&&Fa.box&&Fa.box.length)}}if(Zn=(xa=Fa)&&xa.box&&xa.box.length>0,ia=xa&&xa.offscreen,Tn.useRuntimeCollisionCircles){var oc=O.text.placedSymbolArray.get(Tn.centerJustifiedTextSymbolIndex),ru=i.evaluateSizeForFeature(O.textSizeData,zt,oc),Mu=L.get("text-padding");Ai=l.collisionIndex.placeCollisionCircles(Gt,oc,O.lineVertexArray,O.glyphOffsetArray,ru,j,ue,Ee,n,Rr,Nt.predicate,Tn.collisionCircleDiameter,Mu),Zn=Gt||Ai.circles.length>0&&!Ai.collisionDetected,ia=ia&&Ai.offscreen}if(ua.iconFeatureIndex&&(es=ua.iconFeatureIndex),ua.iconBox){var ds=function(Ko){var Ao=gr&&La?Vt(Ko,La.x,La.y,nr,Rr,l.transform.angle):Ko;return l.collisionIndex.placeCollisionBox(Ao,ar,$e,j,Nt.predicate)};Ca=Hi&&Hi.box&&Hi.box.length&&ua.verticalIconBox?(Ni=ds(ua.verticalIconBox)).box.length>0:(Ni=ds(ua.iconBox)).box.length>0,ia=ia&&Ni.offscreen}var ao=Jt||Tn.numHorizontalGlyphVertices===0&&Tn.numVerticalGlyphVertices===0,Zu=jt||Tn.numIconVertices===0;if(ao||Zu?Zu?ao||(Ca=Ca&&Zn):Zn=Ca&&Zn:Ca=Zn=Ca&&Zn,Zn&&xa&&xa.box&&l.collisionIndex.insertCollisionBox(xa.box,L.get("text-ignore-placement"),O.bucketInstanceId,Hi&&Hi.box&&Bi?Bi:Ei,Nt.ID),Ca&&Ni&&l.collisionIndex.insertCollisionBox(Ni.box,L.get("icon-ignore-placement"),O.bucketInstanceId,es,Nt.ID),Ai&&(Zn&&l.collisionIndex.insertCollisionCircles(Ai.circles,L.get("text-ignore-placement"),O.bucketInstanceId,Ei,Nt.ID),n)){var Vl=O.bucketInstanceId,ps=l.collisionCircleArrays[Vl];ps===void 0&&(ps=l.collisionCircleArrays[Vl]=new Qo);for(var No=0;No<Ai.circles.length;No+=4)ps.circles.push(Ai.circles[No+0]),ps.circles.push(Ai.circles[No+1]),ps.circles.push(Ai.circles[No+2]),ps.circles.push(Ai.collisionDetected?1:0)}l.placements[Tn.crossTileID]=new bu(Zn||Cr,Ca||an,ia||O.justReloaded),a[Tn.crossTileID]=!0}};if(Ar)for(var vn=O.getSortedSymbolIndexes(this.transform.angle),Pn=vn.length-1;Pn>=0;--Pn){var qn=vn[Pn];Yr(O.symbolInstances.get(qn),O.collisionArrays[qn])}else for(var sa=s.symbolInstanceStart;sa<s.symbolInstanceEnd;sa++)Yr(O.symbolInstances.get(sa),O.collisionArrays[sa]);if(n&&O.bucketInstanceId in this.collisionCircleArrays){var Aa=this.collisionCircleArrays[O.bucketInstanceId];i.invert(Aa.invProjMatrix,j),Aa.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Le.prototype.markUsedJustification=function(s,a,n,l){var v;v=l===i.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[i.getAnchorJustification(a)];for(var O=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];O<L.length;O+=1){var j=L[O];j>=0&&(s.text.placedSymbolArray.get(j).crossTileID=v>=0&&j!==v?0:n.crossTileID)}},Le.prototype.markUsedOrientation=function(s,a,n){for(var l=a===i.WritingMode.horizontal||a===i.WritingMode.horizontalOnly?a:0,v=a===i.WritingMode.vertical?a:0,O=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];O<L.length;O+=1)s.text.placedSymbolArray.get(L[O]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=v)},Le.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,v=a?a.opacities:{},O=a?a.variableOffsets:{},L=a?a.placedOrientations:{};for(var j in this.placements){var ue=this.placements[j],Ee=v[j];Ee?(this.opacities[j]=new so(Ee,l,ue.text,ue.icon),n=n||ue.text!==Ee.text.placed||ue.icon!==Ee.icon.placed):(this.opacities[j]=new so(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var $e in v){var rt=v[$e];if(!this.opacities[$e]){var at=new so(rt,l,!1,!1);at.isHidden()||(this.opacities[$e]=at,n=n||rt.text.placed||rt.icon.placed)}}for(var zt in O)this.variableOffsets[zt]||!this.opacities[zt]||this.opacities[zt].isHidden()||(this.variableOffsets[zt]=O[zt]);for(var Nt in L)this.placedOrientations[Nt]||!this.opacities[Nt]||this.opacities[Nt].isHidden()||(this.placedOrientations[Nt]=L[Nt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Le.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,v=a;l<v.length;l+=1){var O=v[l],L=O.getBucket(s);L&&O.latestFeatureIndex&&s.id===L.layerIds[0]&&this.updateBucketOpacities(L,n,O.collisionBoxArray)}},Le.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var v=s.layers[0].layout,O=new so(null,0,!1,!1,!0),L=v.get("text-allow-overlap"),j=v.get("icon-allow-overlap"),ue=v.get("text-variable-anchor"),Ee=v.get("text-rotation-alignment")==="map",$e=v.get("text-pitch-alignment")==="map",rt=v.get("icon-text-fit")!=="none",at=new so(null,0,L&&(j||!s.hasIconData()||v.get("icon-optional")),j&&(L||!s.hasTextData()||v.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var zt=function(ar,nr,Rr){for(var gr=0;gr<nr/4;gr++)ar.opacityVertexArray.emplaceBack(Rr)},Nt=function(ar){var nr=s.symbolInstances.get(ar),Rr=nr.numHorizontalGlyphVertices,gr=nr.numVerticalGlyphVertices,Ar=nr.crossTileID,Cr=l.opacities[Ar];a[Ar]?Cr=O:Cr||(l.opacities[Ar]=Cr=at),a[Ar]=!0;var an=nr.numIconVertices>0,Yr=l.placedOrientations[nr.crossTileID],vn=Yr===i.WritingMode.vertical,Pn=Yr===i.WritingMode.horizontal||Yr===i.WritingMode.horizontalOnly;if(Rr>0||gr>0){var qn=Mo(Cr.text);zt(s.text,Rr,vn?Nu:qn),zt(s.text,gr,Pn?Nu:qn);var sa=Cr.text.isHidden();[nr.rightJustifiedTextSymbolIndex,nr.centerJustifiedTextSymbolIndex,nr.leftJustifiedTextSymbolIndex].forEach(function(Fa){Fa>=0&&(s.text.placedSymbolArray.get(Fa).hidden=sa||vn?1:0)}),nr.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(nr.verticalPlacedTextSymbolIndex).hidden=sa||Pn?1:0);var Aa=l.variableOffsets[nr.crossTileID];Aa&&l.markUsedJustification(s,Aa.anchor,nr,Yr);var Wa=l.placedOrientations[nr.crossTileID];Wa&&(l.markUsedJustification(s,"left",nr,Wa),l.markUsedOrientation(s,Wa,nr))}if(an){var Tn=Mo(Cr.icon),ua=!(rt&&nr.verticalPlacedIconSymbolIndex&&vn);nr.placedIconSymbolIndex>=0&&(zt(s.icon,nr.numIconVertices,ua?Tn:Nu),s.icon.placedSymbolArray.get(nr.placedIconSymbolIndex).hidden=Cr.icon.isHidden()),nr.verticalPlacedIconSymbolIndex>=0&&(zt(s.icon,nr.numVerticalIconVertices,ua?Nu:Tn),s.icon.placedSymbolArray.get(nr.verticalPlacedIconSymbolIndex).hidden=Cr.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var xa=s.collisionArrays[ar];if(xa){var Zn=new i.Point(0,0);if(xa.textBox||xa.verticalTextBox){var Ca=!0;if(ue){var ia=l.variableOffsets[Ar];ia?(Zn=ho(ia.anchor,ia.width,ia.height,ia.textOffset,ia.textBoxScale),Ee&&Zn._rotate($e?l.transform.angle:-l.transform.angle)):Ca=!1}xa.textBox&&Dt(s.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ca||vn,Zn.x,Zn.y),xa.verticalTextBox&&Dt(s.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ca||Pn,Zn.x,Zn.y)}var La=Boolean(!Pn&&xa.verticalIconBox);xa.iconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Cr.icon.placed,La,rt?Zn.x:0,rt?Zn.y:0),xa.verticalIconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Cr.icon.placed,!La,rt?Zn.x:0,rt?Zn.y:0)}}},Jt=0;Jt<s.symbolInstances.length;Jt++)Nt(Jt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var jt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=jt.invProjMatrix,s.placementViewportMatrix=jt.viewportMatrix,s.collisionCircleArray=jt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Le.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Le.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Le.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Le.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Le.prototype.setStale=function(){this.stale=!0};var vr=Math.pow(2,25),en=Math.pow(2,24),_n=Math.pow(2,17),Gn=Math.pow(2,16),Mi=Math.pow(2,9),po=Math.pow(2,8),mo=Math.pow(2,1);function Mo(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*vr+a*en+n*_n+a*Gn+n*Mi+a*po+n*mo+a}var Nu=0,Ol=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ol.prototype.continuePlacement=function(s,a,n,l,v){for(var O=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(O,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(function(L,j){return L.sortKey-j.sortKey}));this._currentPartIndex<O.length;)if(a.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,v())return!0;return!1};var _s=function(a,n,l,v,O,L,j){this.placement=new Le(a,O,L,j),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=v,this._done=!1};_s.prototype.isDone=function(){return this._done},_s.prototype.continuePlacement=function(s,a,n){for(var l=this,v=i.browser.now(),O=function(){var Ee=i.browser.now()-v;return!l._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var L=a[s[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=j)&&(!L.maxzoom||L.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new Ol(L)),this._inProgressLayer.continuePlacement(n[L.source],this.placement,this._showCollisionBoxes,L,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},_s.prototype.commit=function(s){return this.placement.commit(s),this.placement};var pc=512/i.EXTENT/2,xu=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var v=0;v<n.length;v++){var O=n.get(v),L=O.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,a)})}};xu.prototype.getScaledCoordinates=function(s,a){var n=pc/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*i.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*i.EXTENT+s.anchorY)*n)}},xu.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),v=0;v<s.length;v++){var O=s.get(v);if(!O.crossTileID){var L=this.indexedSymbolInstances[O.key];if(L)for(var j=this.getScaledCoordinates(O,a),ue=0,Ee=L;ue<Ee.length;ue+=1){var $e=Ee[ue];if(Math.abs($e.coord.x-j.x)<=l&&Math.abs($e.coord.y-j.y)<=l&&!n[$e.crossTileID]){n[$e.crossTileID]=!0,O.crossTileID=$e.crossTileID;break}}}}};var Po=function(){this.maxCrossTileID=0};Po.prototype.generate=function(){return++this.maxCrossTileID};var ku=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ku.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],v={};for(var O in l){var L=l[O];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+a),v[L.tileID.key]=L}this.indexes[n]=v}this.lng=s},ku.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var v=this.usedCrossTileIDs[s.overscaledZ];for(var O in this.indexes){var L=this.indexes[O];if(Number(O)>s.overscaledZ)for(var j in L){var ue=L[j];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,v)}else{var Ee=L[s.scaledTo(Number(O)).key];Ee&&Ee.findMatches(a.symbolInstances,s,v)}}for(var $e=0;$e<a.symbolInstances.length;$e++){var rt=a.symbolInstances.get($e);rt.crossTileID||(rt.crossTileID=n.generate(),v[rt.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new xu(s,a.symbolInstances,a.bucketInstanceId),!0},ku.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,v=a.indexedSymbolInstances[n];l<v.length;l+=1)delete this.usedCrossTileIDs[s][v[l].crossTileID]},ku.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var v in l)s[l[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[v]),delete l[v],a=!0)}return a};var To=function(){this.layerIndexes={},this.crossTileIDs=new Po,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};To.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new ku);var v=!1,O={};l.handleWrapJump(n);for(var L=0,j=a;L<j.length;L+=1){var ue=j[L],Ee=ue.getBucket(s);Ee&&s.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Ee,this.crossTileIDs)&&(v=!0),O[Ee.bucketInstanceId]=!0)}return l.removeStaleBuckets(O)&&(v=!0),v},To.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var Fi=function(a,n){return i.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Ys=i.pick(En,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ks=i.pick(En,["setCenter","setZoom","setBearing","setPitch"]),zs=function(){var s={},a=i.styleSpec.$version;for(var n in i.styleSpec.$root){var l,v=i.styleSpec.$root[n];v.required&&((l=n==="version"?a:v.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),Ii=function(s){function a(n,l){var v=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ht(tr(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new Re(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Me(256,512),this.crossTileSymbolIndex=new To,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());var O=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(L){O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(j,ue){if(i.triggerPluginCompletionEvent(j),ue&&ue.every(function($e){return $e}))for(var Ee in O.sourceCaches)O.sourceCaches[Ee].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var j=v.sourceCaches[L.sourceId];if(j){var ue=j.getSource();if(ue&&ue.vectorLayerIds)for(var Ee in v._layers){var $e=v._layers[Ee];$e.source===ue.id&&v._validateLayer($e)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var v=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"}));var O=typeof l.validate=="boolean"?l.validate:!i.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var L=this.map._requestManager.transformRequest(n,i.ResourceType.Style);this._request=i.getJSON(L,function(j,ue){v._request=null,j?v.fire(new i.ErrorEvent(j)):ue&&v._load(ue,O)})},a.prototype.loadJSON=function(n,l){var v=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.browser.frame(function(){v._request=null,v._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(zs,!1)},a.prototype._load=function(n,l){if(!l||!Fi(this,i.validateStyle(n))){for(var v in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(v,n.sources[v],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var O=dn(this.stylesheet.layers);this._order=O.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var L=0,j=O;L<j.length;L+=1){var ue=j[L];(ue=i.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ft(this.stylesheet.light),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(v,O,L){var j,ue,Ee,$e=i.browser.devicePixelRatio>1?"@2x":"",rt=i.getJSON(O.transformRequest(O.normalizeSpriteURL(v,$e,".json"),i.ResourceType.SpriteJSON),function(Nt,Jt){rt=null,Ee||(Ee=Nt,j=Jt,zt())}),at=i.getImage(O.transformRequest(O.normalizeSpriteURL(v,$e,".png"),i.ResourceType.SpriteImage),function(Nt,Jt){at=null,Ee||(Ee=Nt,ue=Jt,zt())});function zt(){if(Ee)L(Ee);else if(j&&ue){var Nt=i.browser.getImageData(ue),Jt={};for(var jt in j){var Gt=j[jt],ar=Gt.width,nr=Gt.height,Rr=Gt.x,gr=Gt.y,Ar=Gt.sdf,Cr=Gt.pixelRatio,an=Gt.stretchX,Yr=Gt.stretchY,vn=Gt.content,Pn=new i.RGBAImage({width:ar,height:nr});i.RGBAImage.copy(Nt,Pn,{x:Rr,y:gr},{x:0,y:0},{width:ar,height:nr}),Jt[jt]={data:Pn,pixelRatio:Cr,sdf:Ar,stretchX:an,stretchY:Yr,content:vn}}L(null,Jt)}}return{cancel:function(){rt&&(rt.cancel(),rt=null),at&&(at.cancel(),at=null)}}}(n,this.map._requestManager,function(v,O){if(l._spriteRequest=null,v)l.fire(new i.ErrorEvent(v));else if(O)for(var L in O)l.imageManager.addImage(L,O[L]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new i.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var v=n.sourceLayer;if(v){var O=l.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(v)===-1)&&this.fire(new i.ErrorEvent(new Error('Source layer "'+v+'" does not exist on source "'+O.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],v=0,O=n;v<O.length;v+=1){var L=this._layers[O[v]];L.type!=="custom"&&l.push(L.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var v=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);for(var L in(v.length||O.length)&&this._updateWorkerLayers(v,O),this._updatedSources){var j=this._updatedSources[L];j==="reload"?this._reloadSource(L):j==="clear"&&this._clearSource(L)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ee={};for(var $e in this.sourceCaches){var rt=this.sourceCaches[$e];Ee[$e]=rt.used,rt.used=!1}for(var at=0,zt=this._order;at<zt.length;at+=1){var Nt=this._layers[zt[at]];Nt.recalculate(n,this._availableImages),!Nt.isHidden(n.zoom)&&Nt.source&&(this.sourceCaches[Nt.source].used=!0)}for(var Jt in Ee){var jt=this.sourceCaches[Jt];Ee[Jt]!==jt.used&&jt.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Jt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new i.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),Fi(this,i.validateStyle(n)))return!1;(n=i.clone$1(n)).layers=dn(n.layers);var v=function(L,j){if(!L)return[{command:En.setStyle,args:[j]}];var ue=[];try{if(!i.deepEqual(L.version,j.version))return[{command:En.setStyle,args:[j]}];i.deepEqual(L.center,j.center)||ue.push({command:En.setCenter,args:[j.center]}),i.deepEqual(L.zoom,j.zoom)||ue.push({command:En.setZoom,args:[j.zoom]}),i.deepEqual(L.bearing,j.bearing)||ue.push({command:En.setBearing,args:[j.bearing]}),i.deepEqual(L.pitch,j.pitch)||ue.push({command:En.setPitch,args:[j.pitch]}),i.deepEqual(L.sprite,j.sprite)||ue.push({command:En.setSprite,args:[j.sprite]}),i.deepEqual(L.glyphs,j.glyphs)||ue.push({command:En.setGlyphs,args:[j.glyphs]}),i.deepEqual(L.transition,j.transition)||ue.push({command:En.setTransition,args:[j.transition]}),i.deepEqual(L.light,j.light)||ue.push({command:En.setLight,args:[j.light]});var Ee={},$e=[];!function(at,zt,Nt,Jt){var jt;for(jt in zt=zt||{},at=at||{})at.hasOwnProperty(jt)&&(zt.hasOwnProperty(jt)||gn(jt,Nt,Jt));for(jt in zt)zt.hasOwnProperty(jt)&&(at.hasOwnProperty(jt)?i.deepEqual(at[jt],zt[jt])||(at[jt].type==="geojson"&&zt[jt].type==="geojson"&&Ga(at,zt,jt)?Nt.push({command:En.setGeoJSONSourceData,args:[jt,zt[jt].data]}):Mn(jt,zt,Nt,Jt)):bn(jt,zt,Nt))}(L.sources,j.sources,$e,Ee);var rt=[];L.layers&&L.layers.forEach(function(at){Ee[at.source]?ue.push({command:En.removeLayer,args:[at.id]}):rt.push(at)}),ue=ue.concat($e),function(at,zt,Nt){zt=zt||[];var Jt,jt,Gt,ar,nr,Rr,gr,Ar=(at=at||[]).map(Ma),Cr=zt.map(Ma),an=at.reduce(Ia,{}),Yr=zt.reduce(Ia,{}),vn=Ar.slice(),Pn=Object.create(null);for(Jt=0,jt=0;Jt<Ar.length;Jt++)Yr.hasOwnProperty(Gt=Ar[Jt])?jt++:(Nt.push({command:En.removeLayer,args:[Gt]}),vn.splice(vn.indexOf(Gt,jt),1));for(Jt=0,jt=0;Jt<Cr.length;Jt++)vn[vn.length-1-Jt]!==(Gt=Cr[Cr.length-1-Jt])&&(an.hasOwnProperty(Gt)?(Nt.push({command:En.removeLayer,args:[Gt]}),vn.splice(vn.lastIndexOf(Gt,vn.length-jt),1)):jt++,Nt.push({command:En.addLayer,args:[Yr[Gt],Rr=vn[vn.length-Jt]]}),vn.splice(vn.length-Jt,0,Gt),Pn[Gt]=!0);for(Jt=0;Jt<Cr.length;Jt++)if(ar=an[Gt=Cr[Jt]],nr=Yr[Gt],!Pn[Gt]&&!i.deepEqual(ar,nr))if(i.deepEqual(ar.source,nr.source)&&i.deepEqual(ar["source-layer"],nr["source-layer"])&&i.deepEqual(ar.type,nr.type)){for(gr in ga(ar.layout,nr.layout,Nt,Gt,null,En.setLayoutProperty),ga(ar.paint,nr.paint,Nt,Gt,null,En.setPaintProperty),i.deepEqual(ar.filter,nr.filter)||Nt.push({command:En.setFilter,args:[Gt,nr.filter]}),i.deepEqual(ar.minzoom,nr.minzoom)&&i.deepEqual(ar.maxzoom,nr.maxzoom)||Nt.push({command:En.setLayerZoomRange,args:[Gt,nr.minzoom,nr.maxzoom]}),ar)ar.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ga(ar[gr],nr[gr],Nt,Gt,gr.slice(6),En.setPaintProperty):i.deepEqual(ar[gr],nr[gr])||Nt.push({command:En.setLayerProperty,args:[Gt,gr,nr[gr]]}));for(gr in nr)nr.hasOwnProperty(gr)&&!ar.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ga(ar[gr],nr[gr],Nt,Gt,gr.slice(6),En.setPaintProperty):i.deepEqual(ar[gr],nr[gr])||Nt.push({command:En.setLayerProperty,args:[Gt,gr,nr[gr]]}))}else Nt.push({command:En.removeLayer,args:[Gt]}),Rr=vn[vn.lastIndexOf(Gt)+1],Nt.push({command:En.addLayer,args:[nr,Rr]})}(rt,j.layers,ue)}catch(at){console.warn("Unable to compute style diff:",at),ue=[{command:En.setStyle,args:[j]}]}return ue}(this.serialize(),n).filter(function(L){return!(L.command in Ks)});if(v.length===0)return!1;var O=v.filter(function(L){return!(L.command in Ys)});if(O.length>0)throw new Error("Unimplemented: "+O.map(function(L){return L.command}).join(", ")+".");return v.forEach(function(L){L.command!=="setTransition"&&l[L.command].apply(l,L.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new i.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new i.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,v){var O=this;if(v===void 0&&(v={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(i.validateStyle.source,"sources."+n,l,null,v))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var L=this.sourceCaches[n]=new Rt(n,l,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:O.loaded(),source:L.serialize(),sourceId:n}}),L.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new i.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var v=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],v.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),v.setEventedParent(null),v.clearTiles(),v.onRemove&&v.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,v){v===void 0&&(v={}),this._checkLoaded();var O=n.id;if(this.getLayer(O))this.fire(new i.ErrorEvent(new Error('Layer with id "'+O+'" already exists on this map')));else{var L;if(n.type==="custom"){if(Fi(this,i.validateCustomStyleLayer(n)))return;L=i.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(O,n.source),n=i.clone$1(n),n=i.extend(n,{source:O})),this._validate(i.validateStyle.layer,"layers."+O,n,{arrayIndex:-1},v))return;L=i.createStyleLayer(n),this._validateLayer(L),L.setEventedParent(this,{layer:{id:O}}),this._serializedLayers[L.id]=L.serialize()}var j=l?this._order.indexOf(l):this._order.length;if(l&&j===-1)this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(j,0,O),this._layerOrderChanged=!0,this._layers[O]=L,this._removedLayers[O]&&L.source&&L.type!=="custom"){var ue=this._removedLayers[O];delete this._removedLayers[O],ue.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var v=this._order.indexOf(n);this._order.splice(v,1);var O=l?this._order.indexOf(l):this._order.length;l&&O===-1?this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(O,0,n),this._layerOrderChanged=!0)}}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var v=this._order.indexOf(n);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,v){this._checkLoaded();var O=this.getLayer(n);O?O.minzoom===l&&O.maxzoom===v||(l!=null&&(O.minzoom=l),v!=null&&(O.maxzoom=v),this._updateLayer(O)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,v){v===void 0&&(v={}),this._checkLoaded();var O=this.getLayer(n);if(O){if(!i.deepEqual(O.filter,l))return l==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(i.validateStyle.filter,"layers."+O.id+".filter",l,null,v)||(O.filter=i.clone$1(l),this._updateLayer(O)))}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return i.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,v,O){O===void 0&&(O={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getLayoutProperty(l),v)||(L.setLayoutProperty(l,v,O),this._updateLayer(L)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var v=this.getLayer(n);if(v)return v.getLayoutProperty(l);this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,v,O){O===void 0&&(O={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getPaintProperty(l),v)||(L.setPaintProperty(l,v,O)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var v=n.source,O=n.sourceLayer,L=this.sourceCaches[v];if(L!==void 0){var j=L.getSource().type;j==="geojson"&&O?this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||O?(n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(O,n.id,l)):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var v=n.source,O=this.sourceCaches[v];if(O!==void 0){var L=O.getSource().type,j=L==="vector"?n.sourceLayer:void 0;L!=="vector"||j?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(j,n.id,l):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,v=n.sourceLayer,O=this.sourceCaches[l];if(O!==void 0){if(O.getSource().type!=="vector"||v)return n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),O.getFeatureState(v,n.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,v=function(Yr){return l._layers[Yr].type==="fill-extrusion"},O={},L=[],j=this._order.length-1;j>=0;j--){var ue=this._order[j];if(v(ue)){O[ue]=j;for(var Ee=0,$e=n;Ee<$e.length;Ee+=1){var rt=$e[Ee][ue];if(rt)for(var at=0,zt=rt;at<zt.length;at+=1)L.push(zt[at])}}}L.sort(function(an,Yr){return Yr.intersectionZ-an.intersectionZ});for(var Nt=[],Jt=this._order.length-1;Jt>=0;Jt--){var jt=this._order[Jt];if(v(jt))for(var Gt=L.length-1;Gt>=0;Gt--){var ar=L[Gt].feature;if(O[ar.layer.id]<Jt)break;Nt.push(ar),L.pop()}else for(var nr=0,Rr=n;nr<Rr.length;nr+=1){var gr=Rr[nr][jt];if(gr)for(var Ar=0,Cr=gr;Ar<Cr.length;Ar+=1)Nt.push(Cr[Ar].feature)}}return Nt},a.prototype.queryRenderedFeatures=function(n,l,v){l&&l.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var O={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,j=l.layers;L<j.length;L+=1){var ue=j[L],Ee=this._layers[ue];if(!Ee)return this.fire(new i.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];O[Ee.source]=!0}}var $e=[];for(var rt in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!O[rt]||$e.push(Pt(this.sourceCaches[rt],this._layers,this._serializedLayers,n,l,v));return this.placement&&$e.push(function(at,zt,Nt,Jt,jt,Gt,ar){for(var nr={},Rr=Gt.queryRenderedSymbols(Jt),gr=[],Ar=0,Cr=Object.keys(Rr).map(Number);Ar<Cr.length;Ar+=1)gr.push(ar[Cr[Ar]]);gr.sort(ve);for(var an=function(){var Aa=vn[Yr],Wa=Aa.featureIndex.lookupSymbolFeatures(Rr[Aa.bucketInstanceId],zt,Aa.bucketIndex,Aa.sourceLayerIndex,jt.filter,jt.layers,jt.availableImages,at);for(var Tn in Wa){var ua=nr[Tn]=nr[Tn]||[],xa=Wa[Tn];xa.sort(function(ia,La){var Fa=Aa.featureSortOrder;if(Fa){var Hi=Fa.indexOf(ia.featureIndex);return Fa.indexOf(La.featureIndex)-Hi}return La.featureIndex-ia.featureIndex});for(var Zn=0,Ca=xa;Zn<Ca.length;Zn+=1)ua.push(Ca[Zn])}},Yr=0,vn=gr;Yr<vn.length;Yr+=1)an();var Pn=function(Aa){nr[Aa].forEach(function(Wa){var Tn=Wa.feature,ua=Nt[at[Aa].source].getFeatureState(Tn.layer["source-layer"],Tn.id);Tn.source=Tn.layer.source,Tn.layer["source-layer"]&&(Tn.sourceLayer=Tn.layer["source-layer"]),Tn.state=ua})};for(var qn in nr)Pn(qn);return nr}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($e)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var v=this.sourceCaches[n];return v?function(O,L){for(var j=O.getRenderableIds().map(function(zt){return O.getTileByID(zt)}),ue=[],Ee={},$e=0;$e<j.length;$e++){var rt=j[$e],at=rt.tileID.canonical.key;Ee[at]||(Ee[at]=!0,rt.querySourceFeatures(ue,L))}return ue}(v,l):[]},a.prototype.addSourceType=function(n,l,v){return a.getSourceType(n)?v(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},v):v(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var v=this.light.getLight(),O=!1;for(var L in n)if(!i.deepEqual(n[L],v[L])){O=!0;break}if(O){var j={now:i.browser.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(j)}},a.prototype._validate=function(n,l,v,O,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&Fi(this,n.call(i.validateStyle,i.extend({key:l,style:this.serialize(),value:v,styleSpec:i.styleSpec},O)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,v,O,L){L===void 0&&(L=!1);for(var j=!1,ue=!1,Ee={},$e=0,rt=this._order;$e<rt.length;$e+=1){var at=this._layers[rt[$e]];if(at.type==="symbol"){if(!Ee[at.source]){var zt=this.sourceCaches[at.source];Ee[at.source]=zt.getRenderableIds(!0).map(function(ar){return zt.getTileByID(ar)}).sort(function(ar,nr){return nr.tileID.overscaledZ-ar.tileID.overscaledZ||(ar.tileID.isLessThan(nr.tileID)?-1:1)})}var Nt=this.crossTileSymbolIndex.addLayer(at,Ee[at.source],n.center.lng);j=j||Nt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.browser.now(),n.zoom))&&(this.pauseablePlacement=new _s(n,this._order,L,l,v,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.browser.now()),ue=!0),j&&this.pauseablePlacement.placement.setStale()),ue||j)for(var Jt=0,jt=this._order;Jt<jt.length;Jt+=1){var Gt=this._layers[jt[Jt]];Gt.type==="symbol"&&this.placement.updateLayerOpacities(Gt,Ee[Gt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,v){this.imageManager.getImages(l.icons,v),this._updateTilesForChangedImages();var O=this.sourceCaches[l.source];O&&O.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,v){this.glyphManager.getGlyphs(l.stacks,v)},a.prototype.getResource=function(n,l,v){return i.makeRequest(l,v)},a}(i.Evented);Ii.getSourceType=function(s){return it[s]},Ii.setSourceType=function(s,a){it[s]=a},Ii.registerForPluginStateChange=i.registerForPluginStateChange;var Gi=i.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ts=pi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ml=pi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$u=pi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),It=pi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),fr=pi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pr=pi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Wn=pi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ya=pi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),xi=pi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ki=pi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ka=pi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Di=pi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Yo=pi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ps=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),gi=pi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Ml=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),$s=pi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ss=pi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),vl=pi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cu=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Eu=pi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fu=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ju=pi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Js=pi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Mc=pi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),hf=pi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function pi(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),v=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=O?O.concat(v):v,j={};return{fragmentSource:s=s.replace(n,function(ue,Ee,$e,rt,at){return j[at]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
varying `+$e+" "+rt+" "+at+`;
#else
uniform `+$e+" "+rt+" u_"+at+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+at+`
    `+$e+" "+rt+" "+at+" = u_"+at+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Ee,$e,rt,at){var zt=rt==="float"?"vec2":"vec4",Nt=at.match(/color/)?"color":zt;return j[at]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
uniform lowp float u_`+at+`_t;
attribute `+$e+" "+zt+" a_"+at+`;
varying `+$e+" "+rt+" "+at+`;
#else
uniform `+$e+" "+rt+" u_"+at+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+at+`
    `+at+" = a_"+at+`;
#else
    `+$e+" "+rt+" "+at+" = u_"+at+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+at+`
    `+at+" = unpack_mix_"+Nt+"(a_"+at+", u_"+at+`_t);
#else
    `+$e+" "+rt+" "+at+" = u_"+at+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
uniform lowp float u_`+at+`_t;
attribute `+$e+" "+zt+" a_"+at+`;
#else
uniform `+$e+" "+rt+" u_"+at+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+at+`
    `+$e+" "+rt+" "+at+" = a_"+at+`;
#else
    `+$e+" "+rt+" "+at+" = u_"+at+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+at+`
    `+$e+" "+rt+" "+at+" = unpack_mix_"+Nt+"(a_"+at+", u_"+at+`_t);
#else
    `+$e+" "+rt+" "+at+" = u_"+at+`;
#endif
`}),staticAttributes:l,staticUniforms:L}}var Pc=Object.freeze({__proto__:null,prelude:Ts,background:ml,backgroundPattern:$u,circle:It,clippingMask:fr,heatmap:Pr,heatmapTexture:Wn,collisionBox:Ya,collisionCircle:xi,debug:Ki,fill:Ka,fillOutline:Di,fillOutlinePattern:Yo,fillPattern:Ps,fillExtrusion:gi,fillExtrusionPattern:Ml,hillshadePrepare:$s,hillshade:Ss,line:vl,lineGradient:cu,linePattern:Eu,lineSDF:fu,raster:ju,symbolIcon:Js,symbolSDF:Mc,symbolTextAndIcon:hf}),mc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function $c(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}mc.prototype.bind=function(s,a,n,l,v,O,L,j){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Ee=0;!ue&&Ee<l.length;Ee++)this.boundPaintVertexBuffers[Ee]!==l[Ee]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===v&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===j?(s.bindVertexArrayOES.set(this.vao),L&&L.bind(),v&&v.dynamicDraw&&v.bind(),j&&j.bind()):this.freshBind(a,n,l,v,O,L,j)},mc.prototype.freshBind=function(s,a,n,l,v,O,L){var j,ue=s.numAttributes,Ee=this.context,$e=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=L;else{j=Ee.currentNumAttributes||0;for(var rt=ue;rt<j;rt++)$e.disableVertexAttribArray(rt)}a.enableAttributes($e,s);for(var at=0,zt=n;at<zt.length;at+=1)zt[at].enableAttributes($e,s);O&&O.enableAttributes($e,s),L&&L.enableAttributes($e,s),a.bind(),a.setVertexAttribPointers($e,s,v);for(var Nt=0,Jt=n;Nt<Jt.length;Nt+=1){var jt=Jt[Nt];jt.bind(),jt.setVertexAttribPointers($e,s,v)}O&&(O.bind(),O.setVertexAttribPointers($e,s,v)),l&&l.bind(),L&&(L.bind(),L.setVertexAttribPointers($e,s,v)),Ee.currentNumAttributes=ue},mc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var gl=function(a,n,l,v,O,L){var j=a.gl;this.program=j.createProgram();for(var ue=$c(l.staticAttributes),Ee=v?v.getBinderAttributes():[],$e=ue.concat(Ee),rt=l.staticUniforms?$c(l.staticUniforms):[],at=v?v.getBinderUniforms():[],zt=[],Nt=0,Jt=rt.concat(at);Nt<Jt.length;Nt+=1){var jt=Jt[Nt];zt.indexOf(jt)<0&&zt.push(jt)}var Gt=v?v.defines():[];L&&Gt.push("#define OVERDRAW_INSPECTOR;");var ar=Gt.concat(Ts.fragmentSource,l.fragmentSource).join(`
`),nr=Gt.concat(Ts.vertexSource,l.vertexSource).join(`
`),Rr=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(Rr,ar),j.compileShader(Rr),j.attachShader(this.program,Rr);var gr=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(gr,nr),j.compileShader(gr),j.attachShader(this.program,gr),this.attributes={};var Ar={};this.numAttributes=$e.length;for(var Cr=0;Cr<this.numAttributes;Cr++)$e[Cr]&&(j.bindAttribLocation(this.program,Cr,$e[Cr]),this.attributes[$e[Cr]]=Cr);j.linkProgram(this.program),j.deleteShader(gr),j.deleteShader(Rr);for(var an=0;an<zt.length;an++){var Yr=zt[an];if(Yr&&!Ar[Yr]){var vn=j.getUniformLocation(this.program,Yr);vn&&(Ar[Yr]=vn)}}this.fixedUniforms=O(a,Ar),this.binderUniforms=v?v.getUniforms(a,Ar):[]}}};function Jc(s,a,n){var l=1/Za(n,1,a.transform.tileZoom),v=Math.pow(2,n.tileID.overscaledZ),O=n.tileSize*Math.pow(2,a.transform.tileZoom)/v,L=O*(n.tileID.canonical.x+n.tileID.wrap*v),j=O*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[L>>16,j>>16],u_pixel_coord_lower:[65535&L,65535&j]}}gl.prototype.draw=function(s,a,n,l,v,O,L,j,ue,Ee,$e,rt,at,zt,Nt,Jt){var jt,Gt=s.gl;if(!this.failedToCreate){for(var ar in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(v),s.setCullFace(O),this.fixedUniforms)this.fixedUniforms[ar].set(L[ar]);zt&&zt.setUniforms(s,this.binderUniforms,rt,{zoom:at});for(var nr=(jt={},jt[Gt.LINES]=2,jt[Gt.TRIANGLES]=3,jt[Gt.LINE_STRIP]=1,jt)[a],Rr=0,gr=$e.get();Rr<gr.length;Rr+=1){var Ar=gr[Rr],Cr=Ar.vaos||(Ar.vaos={});(Cr[j]||(Cr[j]=new mc)).bind(s,this,ue,zt?zt.getPaintVertexBuffers():[],Ee,Ar.vertexOffset,Nt,Jt),Gt.drawElements(a,Ar.primitiveLength*nr,Gt.UNSIGNED_SHORT,Ar.primitiveOffset*nr*2)}}};var $i=function(a,n,l,v){var O=n.style.light,L=O.properties.get("position"),j=[L.x,L.y,L.z],ue=i.create$1();O.properties.get("anchor")==="viewport"&&i.fromRotation(ue,-n.transform.angle),i.transformMat3(j,j,ue);var Ee=O.properties.get("color");return{u_matrix:a,u_lightpos:j,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+l,u_opacity:v}},_u=function(a,n,l,v,O,L,j){return i.extend($i(a,n,l,v),Jc(L,n,j),{u_height_factor:-Math.pow(2,O.overscaledZ)/j.tileSize/8})},yl=function(a){return{u_matrix:a}},os=function(a,n,l,v){return i.extend(yl(a),Jc(l,n,v))},Lc=function(a,n){return{u_matrix:a,u_world:n}},vc=function(a,n,l,v,O){return i.extend(os(a,n,l,v),{u_world:O})},Pl=function(a,n,l,v){var O,L,j=a.transform;if(v.paint.get("circle-pitch-alignment")==="map"){var ue=Za(l,1,j.zoom);O=!0,L=[ue,ue]}else O=!1,L=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:i.browser.devicePixelRatio,u_extrude_scale:L}},Ju=function(a,n,l){var v=Za(l,1,n.zoom),O=Math.pow(2,n.zoom-l.tileID.overscaledZ),L=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[n.pixelsToGLUnits[0]/(v*O),n.pixelsToGLUnits[1]/(v*O)],u_overscale_factor:L}},Rc=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},hu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},Tu=function(a){return{u_matrix:a}},Qc=function(a,n,l,v){return{u_matrix:a,u_extrude_scale:Za(n,1,l),u_intensity:v}},Yl=function(a,n,l){var v=a.transform;return{u_matrix:Ic(a,n,l),u_ratio:1/Za(n,1,v.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Si=function(a,n,l,v){return i.extend(Yl(a,n,l),{u_image:0,u_image_height:v})},qc=function(a,n,l,v){var O=a.transform,L=Kl(n,O);return{u_matrix:Ic(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Za(n,1,O.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_image:0,u_scale:[L,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},df=function(a,n,l,v,O){var L=a.lineAtlas,j=Kl(n,a.transform),ue=l.layout.get("line-cap")==="round",Ee=L.getDash(v.from,ue),$e=L.getDash(v.to,ue),rt=Ee.width*O.fromScale,at=$e.width*O.toScale;return i.extend(Yl(a,n,l),{u_patternscale_a:[j/rt,-Ee.height/2],u_patternscale_b:[j/at,-$e.height/2],u_sdfgamma:L.width/(256*Math.min(rt,at)*i.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:$e.y,u_mix:O.t})};function Kl(s,a){return 1/Za(s,1,a.tileZoom)}function Ic(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var $l=function(a,n,l,v,O){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(j=O.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(L=O.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:Qu(O.paint.get("raster-hue-rotate"))};var L,j};function Qu(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var zu,bl=function(a,n,l,v,O,L,j,ue,Ee,$e){var rt=O.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:rt.cameraToCenterDistance,u_pitch:rt.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:rt.width/rt.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:j,u_coord_matrix:ue,u_is_text:+Ee,u_pitch_with_map:+v,u_texsize:$e,u_texture:0}},Lo=function(a,n,l,v,O,L,j,ue,Ee,$e,rt){var at=O.transform;return i.extend(bl(a,n,l,v,O,L,j,ue,Ee,$e),{u_gamma_scale:v?Math.cos(at._pitch)*at.cameraToCenterDistance:1,u_device_pixel_ratio:i.browser.devicePixelRatio,u_is_halo:+rt})},Jl=function(a,n,l,v,O,L,j,ue,Ee,$e){return i.extend(Lo(a,n,l,v,O,L,j,ue,!0,Ee,!0),{u_texsize_icon:$e,u_texture_icon:1})},Ll=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Rl=function(a,n,l,v,O,L){return i.extend(function(j,ue,Ee,$e){var rt=Ee.imageManager.getPattern(j.from.toString()),at=Ee.imageManager.getPattern(j.to.toString()),zt=Ee.imageManager.getPixelSize(),Nt=zt.width,Jt=zt.height,jt=Math.pow(2,$e.tileID.overscaledZ),Gt=$e.tileSize*Math.pow(2,Ee.transform.tileZoom)/jt,ar=Gt*($e.tileID.canonical.x+$e.tileID.wrap*jt),nr=Gt*$e.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:rt.tl,u_pattern_br_a:rt.br,u_pattern_tl_b:at.tl,u_pattern_br_b:at.br,u_texsize:[Nt,Jt],u_mix:ue.t,u_pattern_size_a:rt.displaySize,u_pattern_size_b:at.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Za($e,1,Ee.transform.tileZoom),u_pixel_coord_upper:[ar>>16,nr>>16],u_pixel_coord_lower:[65535&ar,65535&nr]}}(v,L,l,O),{u_matrix:a,u_opacity:n})},Dc={fillExtrusion:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new i.Uniform1f(a,n.u_height_factor),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new i.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new i.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new i.UniformColor(a,n.u_color),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_overlay:new i.Uniform1i(a,n.u_overlay),u_overlay_scale:new i.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new i.Uniform1f(a,n.u_extrude_scale),u_intensity:new i.Uniform1f(a,n.u_intensity),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_color_ramp:new i.Uniform1i(a,n.u_color_ramp),u_opacity:new i.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_latrange:new i.Uniform2f(a,n.u_latrange),u_light:new i.Uniform2f(a,n.u_light),u_shadow:new i.UniformColor(a,n.u_shadow),u_highlight:new i.UniformColor(a,n.u_highlight),u_accent:new i.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_dimension:new i.Uniform2f(a,n.u_dimension),u_zoom:new i.Uniform1f(a,n.u_zoom),u_unpack:new i.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_image:new i.Uniform1i(a,n.u_image),u_image_height:new i.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_texsize:new i.Uniform2f(a,n.u_texsize),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_image:new i.Uniform1i(a,n.u_image),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new i.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new i.Uniform1f(a,n.u_sdfgamma),u_image:new i.Uniform1i(a,n.u_image),u_tex_y_a:new i.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new i.Uniform1f(a,n.u_tex_y_b),u_mix:new i.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new i.Uniform2f(a,n.u_tl_parent),u_scale_parent:new i.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new i.Uniform1f(a,n.u_buffer_scale),u_fade_t:new i.Uniform1f(a,n.u_fade_t),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image0:new i.Uniform1i(a,n.u_image0),u_image1:new i.Uniform1i(a,n.u_image1),u_brightness_low:new i.Uniform1f(a,n.u_brightness_low),u_brightness_high:new i.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new i.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new i.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new i.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texsize_icon:new i.Uniform2f(a,n.u_texsize_icon),u_texture:new i.Uniform1i(a,n.u_texture),u_texture_icon:new i.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_color:new i.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image:new i.Uniform1i(a,n.u_image),u_pattern_tl_a:new i.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(a,n.u_pattern_br_b),u_texsize:new i.Uniform2f(a,n.u_texsize),u_mix:new i.Uniform1f(a,n.u_mix),u_pattern_size_a:new i.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new i.Uniform1f(a,n.u_scale_a),u_scale_b:new i.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(a,n.u_tile_units_to_pixels)}}};function xl(s,a,n,l,v,O,L){for(var j=s.context,ue=j.gl,Ee=s.useProgram("collisionBox"),$e=[],rt=0,at=0,zt=0;zt<l.length;zt++){var Nt=l[zt],Jt=a.getTile(Nt),jt=Jt.getBucket(n);if(jt){var Gt=Nt.posMatrix;v[0]===0&&v[1]===0||(Gt=s.translatePosMatrix(Nt.posMatrix,Jt,v,O));var ar=L?jt.textCollisionBox:jt.iconCollisionBox,nr=jt.collisionCircleArray;if(nr.length>0){var Rr=i.create(),gr=Gt;i.mul(Rr,jt.placementInvProjMatrix,s.transform.glCoordMatrix),i.mul(Rr,Rr,jt.placementViewportMatrix),$e.push({circleArray:nr,circleOffset:at,transform:gr,invTransform:Rr}),at=rt+=nr.length/4}ar&&Ee.draw(j,ue.LINES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,Ju(Gt,s.transform,Jt),n.id,ar.layoutVertexBuffer,ar.indexBuffer,ar.segments,null,s.transform.zoom,null,null,ar.collisionVertexBuffer)}}if(L&&$e.length){var Ar=s.useProgram("collisionCircle"),Cr=new i.StructArrayLayout2f1f2i16;Cr.resize(4*rt),Cr._trim();for(var an=0,Yr=0,vn=$e;Yr<vn.length;Yr+=1)for(var Pn=vn[Yr],qn=0;qn<Pn.circleArray.length/4;qn++){var sa=4*qn,Aa=Pn.circleArray[sa+0],Wa=Pn.circleArray[sa+1],Tn=Pn.circleArray[sa+2],ua=Pn.circleArray[sa+3];Cr.emplace(an++,Aa,Wa,Tn,ua,0),Cr.emplace(an++,Aa,Wa,Tn,ua,1),Cr.emplace(an++,Aa,Wa,Tn,ua,2),Cr.emplace(an++,Aa,Wa,Tn,ua,3)}(!zu||zu.length<2*rt)&&(zu=function(Hi){var Ai=2*Hi,Ni=new i.StructArrayLayout3ui6;Ni.resize(Ai),Ni._trim();for(var Ei=0;Ei<Ai;Ei++){var Bi=6*Ei;Ni.uint16[Bi+0]=4*Ei+0,Ni.uint16[Bi+1]=4*Ei+1,Ni.uint16[Bi+2]=4*Ei+2,Ni.uint16[Bi+3]=4*Ei+2,Ni.uint16[Bi+4]=4*Ei+3,Ni.uint16[Bi+5]=4*Ei+0}return Ni}(rt));for(var xa=j.createIndexBuffer(zu,!0),Zn=j.createVertexBuffer(Cr,i.collisionCircleLayout.members,!0),Ca=0,ia=$e;Ca<ia.length;Ca+=1){var La=ia[Ca],Fa=Rc(La.transform,La.invTransform,s.transform);Ar.draw(j,ue.TRIANGLES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,Fa,n.id,Zn,xa,i.SegmentVector.simpleSegment(0,2*La.circleOffset,La.circleArray.length,La.circleArray.length/2),null,s.transform.zoom,null,null,null)}Zn.destroy(),xa.destroy()}}var Qs=i.identity(new Float32Array(16));function eo(s,a,n,l,v,O){var L=i.getAnchorAlignment(s),j=-(L.horizontalAlign-.5)*a,ue=-(L.verticalAlign-.5)*n,Ee=i.evaluateVariableOffset(s,l);return new i.Point((j/v+Ee[0])*O,(ue/v+Ee[1])*O)}function pf(s,a,n,l,v,O,L,j,ue,Ee,$e){var rt=s.text.placedSymbolArray,at=s.text.dynamicLayoutVertexArray,zt=s.icon.dynamicLayoutVertexArray,Nt={};at.clear();for(var Jt=0;Jt<rt.length;Jt++){var jt=rt.get(Jt),Gt=jt.hidden||!jt.crossTileID||s.allowVerticalPlacement&&!jt.placedOrientation?null:l[jt.crossTileID];if(Gt){var ar=new i.Point(jt.anchorX,jt.anchorY),nr=ba(ar,n?j:L),Rr=ha(O.cameraToCenterDistance,nr.signedDistanceFromCamera),gr=v.evaluateSizeForFeature(s.textSizeData,Ee,jt)*Rr/i.ONE_EM;n&&(gr*=s.tilePixelRatio/ue);for(var Ar=eo(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textBoxScale,gr),Cr=n?ba(ar.add(Ar),L).point:nr.point.add(a?Ar.rotate(-O.angle):Ar),an=s.allowVerticalPlacement&&jt.placedOrientation===i.WritingMode.vertical?Math.PI/2:0,Yr=0;Yr<jt.numGlyphs;Yr++)i.addDynamicAttributes(at,Cr,an);$e&&jt.associatedIconIndex>=0&&(Nt[jt.associatedIconIndex]={shiftedAnchor:Cr,angle:an})}else ui(jt.numGlyphs,at)}if($e){zt.clear();for(var vn=s.icon.placedSymbolArray,Pn=0;Pn<vn.length;Pn++){var qn=vn.get(Pn);if(qn.hidden)ui(qn.numGlyphs,zt);else{var sa=Nt[Pn];if(sa)for(var Aa=0;Aa<qn.numGlyphs;Aa++)i.addDynamicAttributes(zt,sa.shiftedAnchor,sa.angle);else ui(qn.numGlyphs,zt)}}s.icon.dynamicLayoutVertexBuffer.updateData(zt)}s.text.dynamicLayoutVertexBuffer.updateData(at)}function mf(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function El(s,a,n,l,v,O,L,j,ue,Ee,$e,rt){for(var at=s.context,zt=at.gl,Nt=s.transform,Jt=j==="map",jt=ue==="map",Gt=Jt&&n.layout.get("symbol-placement")!=="point",ar=Jt&&!jt&&!Gt,nr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Rr=!1,gr=s.depthModeForSublayer(0,xe.ReadOnly),Ar=n.layout.get("text-variable-anchor"),Cr=[],an=0,Yr=l;an<Yr.length;an+=1){var vn=Yr[an],Pn=a.getTile(vn),qn=Pn.getBucket(n);if(qn){var sa=v?qn.text:qn.icon;if(sa&&sa.segments.get().length){var Aa=sa.programConfigurations.get(n.id),Wa=v||qn.sdfIcons,Tn=v?qn.textSizeData:qn.iconSizeData,ua=jt||Nt.pitch!==0,xa=s.useProgram(mf(Wa,v,qn),Aa),Zn=i.evaluateSizeForZoom(Tn,Nt.zoom),Ca=void 0,ia=[0,0],La=void 0,Fa=void 0,Hi=null,Ai=void 0;if(v)La=Pn.glyphAtlasTexture,Fa=zt.LINEAR,Ca=Pn.glyphAtlasTexture.size,qn.iconsInText&&(ia=Pn.imageAtlasTexture.size,Hi=Pn.imageAtlasTexture,Ai=ua||s.options.rotating||s.options.zooming||Tn.kind==="composite"||Tn.kind==="camera"?zt.LINEAR:zt.NEAREST);else{var Ni=n.layout.get("icon-size").constantOr(0)!==1||qn.iconsNeedLinear;La=Pn.imageAtlasTexture,Fa=Wa||s.options.rotating||s.options.zooming||Ni||ua?zt.LINEAR:zt.NEAREST,Ca=Pn.imageAtlasTexture.size}var Ei=Za(Pn,1,s.transform.zoom),Bi=vi(vn.posMatrix,jt,Jt,s.transform,Ei),es=ya(vn.posMatrix,jt,Jt,s.transform,Ei),ts=Ar&&qn.hasTextData(),vu=n.layout.get("icon-text-fit")!=="none"&&ts&&qn.hasIconData();Gt&&is(qn,vn.posMatrix,s,v,Bi,es,jt,Ee);var wu=s.translatePosMatrix(vn.posMatrix,Pn,O,L),hs=Gt||v&&Ar||vu?Qs:Bi,Hs=s.translatePosMatrix(es,Pn,O,L,!0),Ou=Wa&&n.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ic={program:xa,buffers:sa,uniformValues:Wa?qn.iconsInText?Jl(Tn.kind,Zn,ar,jt,s,wu,hs,Hs,Ca,ia):Lo(Tn.kind,Zn,ar,jt,s,wu,hs,Hs,v,Ca,!0):bl(Tn.kind,Zn,ar,jt,s,wu,hs,Hs,v,Ca),atlasTexture:La,atlasTextureIcon:Hi,atlasInterpolation:Fa,atlasInterpolationIcon:Ai,isSDF:Wa,hasHalo:Ou};if(nr&&qn.canOverlap){Rr=!0;for(var tu=0,Hu=sa.segments.get();tu<Hu.length;tu+=1){var oc=Hu[tu];Cr.push({segments:new i.SegmentVector([oc]),sortKey:oc.sortKey,state:ic})}}else Cr.push({segments:sa.segments,sortKey:0,state:ic})}}}Rr&&Cr.sort(function(Vl,ps){return Vl.sortKey-ps.sortKey});for(var ru=0,Mu=Cr;ru<Mu.length;ru+=1){var ds=Mu[ru],ao=ds.state;if(at.activeTexture.set(zt.TEXTURE0),ao.atlasTexture.bind(ao.atlasInterpolation,zt.CLAMP_TO_EDGE),ao.atlasTextureIcon&&(at.activeTexture.set(zt.TEXTURE1),ao.atlasTextureIcon&&ao.atlasTextureIcon.bind(ao.atlasInterpolationIcon,zt.CLAMP_TO_EDGE)),ao.isSDF){var Zu=ao.uniformValues;ao.hasHalo&&(Zu.u_is_halo=1,Ql(ao.buffers,ds.segments,n,s,ao.program,gr,$e,rt,Zu)),Zu.u_is_halo=0}Ql(ao.buffers,ds.segments,n,s,ao.program,gr,$e,rt,ao.uniformValues)}}function Ql(s,a,n,l,v,O,L,j,ue){var Ee=l.context;v.draw(Ee,Ee.gl.TRIANGLES,O,L,j,Bt.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function qu(s,a,n,l,v,O,L){var j,ue,Ee,$e,rt,at=s.context.gl,zt=n.paint.get("fill-pattern"),Nt=zt&&zt.constantOr(1),Jt=n.getCrossfadeParameters();L?(ue=Nt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=at.LINES):(ue=Nt?"fillPattern":"fill",j=at.TRIANGLES);for(var jt=0,Gt=l;jt<Gt.length;jt+=1){var ar=Gt[jt],nr=a.getTile(ar);if(!Nt||nr.patternsLoaded()){var Rr=nr.getBucket(n);if(Rr){var gr=Rr.programConfigurations.get(n.id),Ar=s.useProgram(ue,gr);Nt&&(s.context.activeTexture.set(at.TEXTURE0),nr.imageAtlasTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE),gr.updatePaintBuffers(Jt));var Cr=zt.constantOr(null);if(Cr&&nr.imageAtlas){var an=nr.imageAtlas,Yr=an.patternPositions[Cr.to.toString()],vn=an.patternPositions[Cr.from.toString()];Yr&&vn&&gr.setConstantPatternPositions(Yr,vn)}var Pn=s.translatePosMatrix(ar.posMatrix,nr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(L){$e=Rr.indexBuffer2,rt=Rr.segments2;var qn=[at.drawingBufferWidth,at.drawingBufferHeight];Ee=ue==="fillOutlinePattern"&&Nt?vc(Pn,s,Jt,nr,qn):Lc(Pn,qn)}else $e=Rr.indexBuffer,rt=Rr.segments,Ee=Nt?os(Pn,s,Jt,nr):yl(Pn);Ar.draw(s.context,j,v,s.stencilModeForClipping(ar),O,Bt.disabled,Ee,n.id,Rr.layoutVertexBuffer,$e,rt,n.paint,s.transform.zoom,gr)}}}}function Il(s,a,n,l,v,O,L){for(var j=s.context,ue=j.gl,Ee=n.paint.get("fill-extrusion-pattern"),$e=Ee.constantOr(1),rt=n.getCrossfadeParameters(),at=n.paint.get("fill-extrusion-opacity"),zt=0,Nt=l;zt<Nt.length;zt+=1){var Jt=Nt[zt],jt=a.getTile(Jt),Gt=jt.getBucket(n);if(Gt){var ar=Gt.programConfigurations.get(n.id),nr=s.useProgram($e?"fillExtrusionPattern":"fillExtrusion",ar);$e&&(s.context.activeTexture.set(ue.TEXTURE0),jt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),ar.updatePaintBuffers(rt));var Rr=Ee.constantOr(null);if(Rr&&jt.imageAtlas){var gr=jt.imageAtlas,Ar=gr.patternPositions[Rr.to.toString()],Cr=gr.patternPositions[Rr.from.toString()];Ar&&Cr&&ar.setConstantPatternPositions(Ar,Cr)}var an=s.translatePosMatrix(Jt.posMatrix,jt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Yr=n.paint.get("fill-extrusion-vertical-gradient"),vn=$e?_u(an,s,Yr,at,Jt,rt,jt):$i(an,s,Yr,at);nr.draw(j,j.gl.TRIANGLES,v,O,L,Bt.backCCW,vn,n.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,n.paint,s.transform.zoom,ar)}}}function gc(s,a,n,l,v,O){var L=s.context,j=L.gl,ue=a.fbo;if(ue){var Ee=s.useProgram("hillshade");L.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ue.colorAttachment.get());var $e=function(rt,at,zt){var Nt=zt.paint.get("hillshade-shadow-color"),Jt=zt.paint.get("hillshade-highlight-color"),jt=zt.paint.get("hillshade-accent-color"),Gt=zt.paint.get("hillshade-illumination-direction")*(Math.PI/180);zt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Gt-=rt.transform.angle);var ar,nr,Rr,gr=!rt.options.moving;return{u_matrix:rt.transform.calculatePosMatrix(at.tileID.toUnwrapped(),gr),u_image:0,u_latrange:(ar=at.tileID,nr=Math.pow(2,ar.canonical.z),Rr=ar.canonical.y,[new i.MercatorCoordinate(0,Rr/nr).toLngLat().lat,new i.MercatorCoordinate(0,(Rr+1)/nr).toLngLat().lat]),u_light:[zt.paint.get("hillshade-exaggeration"),Gt],u_shadow:Nt,u_highlight:Jt,u_accent:jt}}(s,a,n);Ee.draw(L,j.TRIANGLES,l,v,O,Bt.disabled,$e,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function yc(s,a,n,l,v,O){var L=s.context,j=L.gl,ue=a.dem;if(ue&&ue.data){var Ee=ue.dim,$e=ue.stride,rt=ue.getPixels();if(L.activeTexture.set(j.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture($e),a.demTexture){var at=a.demTexture;at.update(rt,{premultiply:!1}),at.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else a.demTexture=new i.Texture(L,rt,j.RGBA,{premultiply:!1}),a.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);L.activeTexture.set(j.TEXTURE0);var zt=a.fbo;if(!zt){var Nt=new i.Texture(L,{width:Ee,height:Ee,data:null},j.RGBA);Nt.bind(j.LINEAR,j.CLAMP_TO_EDGE),(zt=a.fbo=L.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Nt.texture)}L.bindFramebuffer.set(zt.framebuffer),L.viewport.set([0,0,Ee,Ee]),s.useProgram("hillshadePrepare").draw(L,j.TRIANGLES,l,v,O,Bt.disabled,function(Jt,jt){var Gt=jt.stride,ar=i.create();return i.ortho(ar,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(ar,ar,[0,-i.EXTENT,0]),{u_matrix:ar,u_image:1,u_dimension:[Gt,Gt],u_zoom:Jt.overscaledZ,u_unpack:jt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function el(s,a,n,l,v){var O=l.paint.get("raster-fade-duration");if(O>0){var L=i.browser.now(),j=(L-s.timeAdded)/O,ue=a?(L-a.timeAdded)/O:-1,Ee=n.getSource(),$e=v.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),rt=!a||Math.abs(a.tileID.overscaledZ-$e)>Math.abs(s.tileID.overscaledZ-$e),at=rt&&s.refreshedUponExpiration?1:i.clamp(rt?j:1-ue,0,1);return s.refreshedUponExpiration&&j>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-at}:{opacity:at,mix:0}}return{opacity:1,mix:0}}var ef=new i.Color(1,0,0,1),tl=new i.Color(0,1,0,1),qs=new i.Color(0,0,1,1),_l=new i.Color(1,0,1,1),ql=new i.Color(0,1,1,1);function Nc(s,a,n,l){Fs(s,0,a+n/2,s.transform.width,n,l)}function tf(s,a,n,l){Fs(s,a-n/2,0,n,s.transform.height,l)}function Fs(s,a,n,l,v,O){var L=s.context,j=L.gl;j.enable(j.SCISSOR_TEST),j.scissor(a*i.browser.devicePixelRatio,n*i.browser.devicePixelRatio,l*i.browser.devicePixelRatio,v*i.browser.devicePixelRatio),L.clear({color:O}),j.disable(j.SCISSOR_TEST)}function vf(s,a,n){var l=s.context,v=l.gl,O=n.posMatrix,L=s.useProgram("debug"),j=xe.disabled,ue=ut.disabled,Ee=s.colorModeForRenderPass();l.activeTexture.set(v.TEXTURE0),s.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),L.draw(l,v.LINE_STRIP,j,ue,Ee,Bt.disabled,hu(O,i.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var $e=a.getTileByID(n.key).latestRawTileData,rt=Math.floor(($e&&$e.byteLength||0)/1024),at=a.getTile(n).tileSize,zt=512/Math.min(at,512)*(n.overscaledZ/s.transform.zoom)*.5,Nt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Nt+=" => "+n.overscaledZ),function(Jt,jt){Jt.initDebugOverlayCanvas();var Gt=Jt.debugOverlayCanvas,ar=Jt.context.gl,nr=Jt.debugOverlayCanvas.getContext("2d");nr.clearRect(0,0,Gt.width,Gt.height),nr.shadowColor="white",nr.shadowBlur=2,nr.lineWidth=1.5,nr.strokeStyle="white",nr.textBaseline="top",nr.font="bold 36px Open Sans, sans-serif",nr.fillText(jt,5,5),nr.strokeText(jt,5,5),Jt.debugOverlayTexture.update(Gt),Jt.debugOverlayTexture.bind(ar.LINEAR,ar.CLAMP_TO_EDGE)}(s,Nt+" "+rt+"kb"),L.draw(l,v.TRIANGLES,j,ue,wt.alphaBlended,Bt.disabled,hu(O,i.Color.transparent,zt),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var rl={symbol:function(a,n,l,v,O){if(a.renderPass==="translucent"){var L=ut.disabled,j=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Ee,$e,rt,at,zt,Nt){for(var Jt=Ee.transform,jt=at==="map",Gt=zt==="map",ar=0,nr=ue;ar<nr.length;ar+=1){var Rr=nr[ar],gr=rt.getTile(Rr),Ar=gr.getBucket($e);if(Ar&&Ar.text&&Ar.text.segments.get().length){var Cr=i.evaluateSizeForZoom(Ar.textSizeData,Jt.zoom),an=Za(gr,1,Ee.transform.zoom),Yr=vi(Rr.posMatrix,Gt,jt,Ee.transform,an),vn=$e.layout.get("icon-text-fit")!=="none"&&Ar.hasIconData();if(Cr){var Pn=Math.pow(2,Jt.zoom-gr.tileID.overscaledZ);pf(Ar,jt,Gt,Nt,i.symbolSize,Jt,Yr,Rr.posMatrix,Pn,Cr,vn)}}}}(v,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),O),l.paint.get("icon-opacity").constantOr(1)!==0&&El(a,n,l,v,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),L,j),l.paint.get("text-opacity").constantOr(1)!==0&&El(a,n,l,v,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),L,j),n.map.showCollisionBoxes&&(xl(a,n,l,v,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),xl(a,n,l,v,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,v){if(a.renderPass==="translucent"){var O=l.paint.get("circle-opacity"),L=l.paint.get("circle-stroke-width"),j=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||L.constantOr(1)!==0&&j.constantOr(1)!==0){for(var Ee=a.context,$e=Ee.gl,rt=a.depthModeForSublayer(0,xe.ReadOnly),at=ut.disabled,zt=a.colorModeForRenderPass(),Nt=[],Jt=0;Jt<v.length;Jt++){var jt=v[Jt],Gt=n.getTile(jt),ar=Gt.getBucket(l);if(ar){var nr=ar.programConfigurations.get(l.id),Rr={programConfiguration:nr,program:a.useProgram("circle",nr),layoutVertexBuffer:ar.layoutVertexBuffer,indexBuffer:ar.indexBuffer,uniformValues:Pl(a,jt,Gt,l)};if(ue)for(var gr=0,Ar=ar.segments.get();gr<Ar.length;gr+=1){var Cr=Ar[gr];Nt.push({segments:new i.SegmentVector([Cr]),sortKey:Cr.sortKey,state:Rr})}else Nt.push({segments:ar.segments,sortKey:0,state:Rr})}}ue&&Nt.sort(function(qn,sa){return qn.sortKey-sa.sortKey});for(var an=0,Yr=Nt;an<Yr.length;an+=1){var vn=Yr[an],Pn=vn.state;Pn.program.draw(Ee,$e.TRIANGLES,rt,at,zt,Bt.disabled,Pn.uniformValues,l.id,Pn.layoutVertexBuffer,Pn.indexBuffer,vn.segments,l.paint,a.transform.zoom,Pn.programConfiguration)}}}},heatmap:function(a,n,l,v){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var O=a.context,L=O.gl,j=ut.disabled,ue=new wt([L.ONE,L.ONE],i.Color.transparent,[!0,!0,!0,!0]);!function(Nt,Jt,jt){var Gt=Nt.gl;Nt.activeTexture.set(Gt.TEXTURE1),Nt.viewport.set([0,0,Jt.width/4,Jt.height/4]);var ar=jt.heatmapFbo;if(ar)Gt.bindTexture(Gt.TEXTURE_2D,ar.colorAttachment.get()),Nt.bindFramebuffer.set(ar.framebuffer);else{var nr=Gt.createTexture();Gt.bindTexture(Gt.TEXTURE_2D,nr),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_S,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_T,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MIN_FILTER,Gt.LINEAR),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MAG_FILTER,Gt.LINEAR),ar=jt.heatmapFbo=Nt.createFramebuffer(Jt.width/4,Jt.height/4,!1),function(Rr,gr,Ar,Cr){var an=Rr.gl;an.texImage2D(an.TEXTURE_2D,0,an.RGBA,gr.width/4,gr.height/4,0,an.RGBA,Rr.extRenderToTextureHalfFloat?Rr.extTextureHalfFloat.HALF_FLOAT_OES:an.UNSIGNED_BYTE,null),Cr.colorAttachment.set(Ar)}(Nt,Jt,nr,ar)}}(O,a,l),O.clear({color:i.Color.transparent});for(var Ee=0;Ee<v.length;Ee++){var $e=v[Ee];if(!n.hasRenderableParent($e)){var rt=n.getTile($e),at=rt.getBucket(l);if(at){var zt=at.programConfigurations.get(l.id);a.useProgram("heatmap",zt).draw(O,L.TRIANGLES,xe.disabled,j,ue,Bt.disabled,Qc($e.posMatrix,rt,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,l.paint,a.transform.zoom,zt)}}}O.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Nt,Jt){var jt=Nt.context,Gt=jt.gl,ar=Jt.heatmapFbo;if(ar){jt.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,ar.colorAttachment.get()),jt.activeTexture.set(Gt.TEXTURE1);var nr=Jt.colorRampTexture;nr||(nr=Jt.colorRampTexture=new i.Texture(jt,Jt.colorRamp,Gt.RGBA)),nr.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Nt.useProgram("heatmapTexture").draw(jt,Gt.TRIANGLES,xe.disabled,ut.disabled,Nt.colorModeForRenderPass(),Bt.disabled,function(Rr,gr,Ar,Cr){var an=i.create();i.ortho(an,0,Rr.width,Rr.height,0,0,1);var Yr=Rr.context.gl;return{u_matrix:an,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:gr.paint.get("heatmap-opacity")}}(Nt,Jt),Jt.id,Nt.viewportBuffer,Nt.quadTriangleIndexBuffer,Nt.viewportSegments,Jt.paint,Nt.transform.zoom)}}(a,l))},line:function(a,n,l,v){if(a.renderPass==="translucent"){var O=l.paint.get("line-opacity"),L=l.paint.get("line-width");if(O.constantOr(1)!==0&&L.constantOr(1)!==0)for(var j=a.depthModeForSublayer(0,xe.ReadOnly),ue=a.colorModeForRenderPass(),Ee=l.paint.get("line-dasharray"),$e=l.paint.get("line-pattern"),rt=$e.constantOr(1),at=l.paint.get("line-gradient"),zt=l.getCrossfadeParameters(),Nt=rt?"linePattern":Ee?"lineSDF":at?"lineGradient":"line",Jt=a.context,jt=Jt.gl,Gt=!0,ar=0,nr=v;ar<nr.length;ar+=1){var Rr=nr[ar],gr=n.getTile(Rr);if(!rt||gr.patternsLoaded()){var Ar=gr.getBucket(l);if(Ar){var Cr=Ar.programConfigurations.get(l.id),an=a.context.program.get(),Yr=a.useProgram(Nt,Cr),vn=Gt||Yr.program!==an,Pn=$e.constantOr(null);if(Pn&&gr.imageAtlas){var qn=gr.imageAtlas,sa=qn.patternPositions[Pn.to.toString()],Aa=qn.patternPositions[Pn.from.toString()];sa&&Aa&&Cr.setConstantPatternPositions(sa,Aa)}var Wa=rt?qc(a,gr,l,zt):Ee?df(a,gr,l,Ee,zt):at?Si(a,gr,l,Ar.lineClipsArray.length):Yl(a,gr,l);if(rt)Jt.activeTexture.set(jt.TEXTURE0),gr.imageAtlasTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Cr.updatePaintBuffers(zt);else if(Ee&&(vn||a.lineAtlas.dirty))Jt.activeTexture.set(jt.TEXTURE0),a.lineAtlas.bind(Jt);else if(at){var Tn=Ar.gradients[l.id],ua=Tn.texture;if(l.gradientVersion!==Tn.version){var xa=256;if(l.stepInterpolant){var Zn=n.getSource().maxzoom,Ca=Rr.canonical.z===Zn?Math.ceil(1<<a.transform.maxZoom-Rr.canonical.z):1;xa=i.clamp(i.nextPowerOfTwo(Ar.maxLineLength/i.EXTENT*1024*Ca),256,Jt.maxTextureSize)}Tn.gradient=i.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:xa,image:Tn.gradient||void 0,clips:Ar.lineClipsArray}),Tn.texture?Tn.texture.update(Tn.gradient):Tn.texture=new i.Texture(Jt,Tn.gradient,jt.RGBA),Tn.version=l.gradientVersion,ua=Tn.texture}Jt.activeTexture.set(jt.TEXTURE0),ua.bind(l.stepInterpolant?jt.NEAREST:jt.LINEAR,jt.CLAMP_TO_EDGE)}Yr.draw(Jt,jt.TRIANGLES,j,a.stencilModeForClipping(Rr),ue,Bt.disabled,Wa,l.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,l.paint,a.transform.zoom,Cr,Ar.layoutVertexBuffer2),Gt=!1}}}}},fill:function(a,n,l,v){var O=l.paint.get("fill-color"),L=l.paint.get("fill-opacity");if(L.constantOr(1)!==0){var j=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Ee=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&O.constantOr(i.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Ee){var $e=a.depthModeForSublayer(1,a.renderPass==="opaque"?xe.ReadWrite:xe.ReadOnly);qu(a,n,l,v,$e,j,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var rt=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,xe.ReadOnly);qu(a,n,l,v,rt,j,!0)}}},"fill-extrusion":function(a,n,l,v){var O=l.paint.get("fill-extrusion-opacity");if(O!==0&&a.renderPass==="translucent"){var L=new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D);if(O!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Il(a,n,l,v,L,ut.disabled,wt.disabled),Il(a,n,l,v,L,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var j=a.colorModeForRenderPass();Il(a,n,l,v,L,ut.disabled,j)}}},hillshade:function(a,n,l,v){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var O=a.context,L=a.depthModeForSublayer(0,xe.ReadOnly),j=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(v):[{},v],Ee=ue[0],$e=0,rt=ue[1];$e<rt.length;$e+=1){var at=rt[$e],zt=n.getTile(at);zt.needsHillshadePrepare&&a.renderPass==="offscreen"?yc(a,zt,l,L,ut.disabled,j):a.renderPass==="translucent"&&gc(a,zt,l,L,Ee[at.overscaledZ],j)}O.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,v){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&v.length)for(var O=a.context,L=O.gl,j=n.getSource(),ue=a.useProgram("raster"),Ee=a.colorModeForRenderPass(),$e=j instanceof be?[{},v]:a.stencilConfigForOverlap(v),rt=$e[0],at=$e[1],zt=at[at.length-1].overscaledZ,Nt=!a.options.moving,Jt=0,jt=at;Jt<jt.length;Jt+=1){var Gt=jt[Jt],ar=a.depthModeForSublayer(Gt.overscaledZ-zt,l.paint.get("raster-opacity")===1?xe.ReadWrite:xe.ReadOnly,L.LESS),nr=n.getTile(Gt),Rr=a.transform.calculatePosMatrix(Gt.toUnwrapped(),Nt);nr.registerFadeDuration(l.paint.get("raster-fade-duration"));var gr=n.findLoadedParent(Gt,0),Ar=el(nr,gr,n,l,a.transform),Cr=void 0,an=void 0,Yr=l.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;O.activeTexture.set(L.TEXTURE0),nr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(L.TEXTURE1),gr?(gr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Cr=Math.pow(2,gr.tileID.overscaledZ-nr.tileID.overscaledZ),an=[nr.tileID.canonical.x*Cr%1,nr.tileID.canonical.y*Cr%1]):nr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var vn=$l(Rr,an||[0,0],Cr||1,Ar,l);j instanceof be?ue.draw(O,L.TRIANGLES,ar,ut.disabled,Ee,Bt.disabled,vn,l.id,j.boundsBuffer,a.quadTriangleIndexBuffer,j.boundsSegments):ue.draw(O,L.TRIANGLES,ar,rt[Gt.overscaledZ],Ee,Bt.disabled,vn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var v=l.paint.get("background-color"),O=l.paint.get("background-opacity");if(O!==0){var L=a.context,j=L.gl,ue=a.transform,Ee=ue.tileSize,$e=l.paint.get("background-pattern");if(!a.isPatternMissing($e)){var rt=!$e&&v.a===1&&O===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===rt){var at=ut.disabled,zt=a.depthModeForSublayer(0,rt==="opaque"?xe.ReadWrite:xe.ReadOnly),Nt=a.colorModeForRenderPass(),Jt=a.useProgram($e?"backgroundPattern":"background"),jt=ue.coveringTiles({tileSize:Ee});$e&&(L.activeTexture.set(j.TEXTURE0),a.imageManager.bind(a.context));for(var Gt=l.getCrossfadeParameters(),ar=0,nr=jt;ar<nr.length;ar+=1){var Rr=nr[ar],gr=a.transform.calculatePosMatrix(Rr.toUnwrapped()),Ar=$e?Rl(gr,O,a,$e,{tileID:Rr,tileSize:Ee},Gt):Ll(gr,O,v);Jt.draw(L,j.TRIANGLES,zt,at,Nt,Bt.disabled,Ar,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var v=0;v<l.length;v++)vf(a,n,l[v])},custom:function(a,n,l){var v=a.context,O=l.implementation;if(a.renderPass==="offscreen"){var L=O.prerender;L&&(a.setCustomLayerDefaults(),v.setColorMode(a.colorModeForRenderPass()),L.call(O,v.gl,a.transform.customLayerMatrix()),v.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),v.setColorMode(a.colorModeForRenderPass()),v.setStencilMode(ut.disabled);var j=O.renderingMode==="3d"?new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,xe.ReadOnly);v.setDepthMode(j),O.render(v.gl,a.transform.customLayerMatrix()),v.setDirty(),a.setBaseState(),v.bindFramebuffer.set(null)}}},Pi=function(a,n){this.context=new Ze(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Rt.maxUnderzooming+Rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new To,this.gpuTimers={}};Pi.prototype.resize=function(s,a){if(this.width=s*i.browser.devicePixelRatio,this.height=a*i.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},Pi.prototype.setup=function(){var s=this.context,a=new i.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(i.EXTENT,0),a.emplaceBack(0,i.EXTENT),a.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Gi.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);var n=new i.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(i.EXTENT,0),n.emplaceBack(0,i.EXTENT),n.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Gi.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);var l=new i.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(i.EXTENT,0,i.EXTENT,0),l.emplaceBack(0,i.EXTENT,0,i.EXTENT),l.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Se.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);var v=new i.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(v,Gi.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);var O=new i.StructArrayLayout1ui2;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(O);var L=new i.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new ut({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},Pi.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=i.create();i.ortho(n,0,this.width,this.height,0,0,1),i.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,xe.disabled,this.stencilClearMode,wt.disabled,Bt.disabled,Tu(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Pi.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(wt.disabled),n.setDepthMode(xe.disabled);var v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var O=0,L=a;O<L.length;O+=1){var j=L[O],ue=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;v.draw(n,l.TRIANGLES,xe.disabled,new ut({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),wt.disabled,Bt.disabled,Tu(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Pi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new ut({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},Pi.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new ut({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},Pi.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Ee){return Ee.overscaledZ-ue.overscaledZ}),v=l[l.length-1].overscaledZ,O=l[0].overscaledZ-v+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();for(var L={},j=0;j<O;j++)L[j+v]=new ut({func:n.GEQUAL,mask:255},j+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=O,[L,l]}return[(a={},a[v]=ut.disabled,a),l]},Pi.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new wt([s.CONSTANT_COLOR,s.ONE],new i.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?wt.unblended:wt.alphaBlended},Pi.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return xe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new xe(n||this.context.gl.LEQUAL,a,[l,l])},Pi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Pi.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.browser.now()),this.imageManager.beginFrame();var l=this.style._order,v=this.style.sourceCaches;for(var O in v){var L=v[O];L.used&&L.prepare(this.context)}var j,ue,Ee={},$e={},rt={};for(var at in v){var zt=v[at];Ee[at]=zt.getVisibleCoordinates(),$e[at]=Ee[at].slice().reverse(),rt[at]=zt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Nt=0;Nt<l.length;Nt++)if(this.style._layers[l[Nt]].is3D()){this.opaquePassCutoff=Nt;break}this.renderPass="offscreen";for(var Jt=0,jt=l;Jt<jt.length;Jt+=1){var Gt=this.style._layers[jt[Jt]];if(Gt.hasOffscreenPass()&&!Gt.isHidden(this.transform.zoom)){var ar=$e[Gt.source];(Gt.type==="custom"||ar.length)&&this.renderLayer(this,v[Gt.source],Gt,ar)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var nr=this.style._layers[l[this.currentLayer]],Rr=v[nr.source],gr=Ee[nr.source];this._renderTileClippingMasks(nr,gr),this.renderLayer(this,Rr,nr,gr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Ar=this.style._layers[l[this.currentLayer]],Cr=v[Ar.source],an=(Ar.type==="symbol"?rt:$e)[Ar.source];this._renderTileClippingMasks(Ar,Ee[Ar.source]),this.renderLayer(this,Cr,Ar,an)}this.options.showTileBoundaries&&(i.values(this.style._layers).forEach(function(Yr){Yr.source&&!Yr.isHidden(n.transform.zoom)&&(Yr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Yr.source]),(!j||j.getSource().maxzoom<ue.getSource().maxzoom)&&(j=ue))}),j&&rl.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Yr){var vn=Yr.transform.padding;Nc(Yr,Yr.transform.height-(vn.top||0),3,ef),Nc(Yr,vn.bottom||0,3,tl),tf(Yr,vn.left||0,3,qs),tf(Yr,Yr.transform.width-(vn.right||0),3,_l);var Pn=Yr.transform.centerPoint;!function(qn,sa,Aa,Wa){Fs(qn,sa-1,Aa-10,2,20,Wa),Fs(qn,sa-10,Aa-1,20,2,Wa)}(Yr,Pn.x,Yr.transform.height-Pn.y,ql)}(this),this.context.setDefault()},Pi.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),rl[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Pi.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},Pi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Pi.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Pi.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],v=this.context.extTimerQuery,O=v.getQueryObjectEXT(l.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(l.query),a[n]=O}return a},Pi.prototype.translatePosMatrix=function(s,a,n,l,v){if(!n[0]&&!n[1])return s;var O=v?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(O){var L=Math.sin(O),j=Math.cos(O);n=[n[0]*j-n[1]*L,n[0]*L+n[1]*j]}var ue=[v?n[0]:Za(a,n[0],this.transform.zoom),v?n[1]:Za(a,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return i.translate(Ee,s,ue),Ee},Pi.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},Pi.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},Pi.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},Pi.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new gl(this.context,s,Pc[s],a,Dc[s],this._showOverdrawInspector)),this.cache[n]},Pi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Pi.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Pi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Pi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var nl=function(a,n){this.points=a,this.planes=n};nl.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return i.transformMat4([],L,s)}).map(function(L){return i.scale$1([],L,1/L[3]/a*l)}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var j=i.sub([],v[L[0]],v[L[1]]),ue=i.sub([],v[L[2]],v[L[1]]),Ee=i.normalize([],i.cross([],j,ue)),$e=-i.dot(Ee,v[L[1]]);return Ee.concat($e)});return new nl(v,O)};var Fu=function(a,n){this.min=a,this.max=n,this.center=i.scale$2([],i.add([],this.min,this.max),.5)};Fu.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=i.clone$2(this.min),l=i.clone$2(this.max),v=0;v<a.length;v++)n[v]=a[v]?this.min[v]:this.center[v],l[v]=a[v]?this.center[v]:this.max[v];return l[2]=this.max[2],new Fu(n,l)},Fu.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Fu.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Fu.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var v=s.planes[l],O=0,L=0;L<a.length;L++)O+=i.dot$1(v,a[L])>=0;if(O===0)return 0;O!==a.length&&(n=!1)}if(n)return 2;for(var j=0;j<3;j++){for(var ue=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,$e=0;$e<s.points.length;$e++){var rt=s.points[$e][j]-this.min[j];ue=Math.min(ue,rt),Ee=Math.max(Ee,rt)}if(Ee<0||ue>this.max[j]-this.min[j])return 0}return 1};var fi=function(a,n,l,v){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),v===void 0&&(v=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=v};fi.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=i.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=i.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=i.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=i.number(s.right,a.right,n)),this},fi.prototype.getCenter=function(s,a){var n=i.clamp((this.left+s-this.right)/2,0,s),l=i.clamp((this.top+a-this.bottom)/2,0,a);return new i.Point(n,l)},fi.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},fi.prototype.clone=function(){return new fi(this.top,this.bottom,this.left,this.right)},fi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var kn=function(a,n,l,v,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=v==null?60:v,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Li={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};kn.prototype.clone=function(){var s=new kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Li.minZoom.get=function(){return this._minZoom},Li.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Li.maxZoom.get=function(){return this._maxZoom},Li.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Li.minPitch.get=function(){return this._minPitch},Li.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Li.maxPitch.get=function(){return this._maxPitch},Li.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Li.renderWorldCopies.get=function(){return this._renderWorldCopies},Li.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Li.worldSize.get=function(){return this.tileSize*this.scale},Li.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Li.size.get=function(){return new i.Point(this.width,this.height)},Li.bearing.get=function(){return-this.angle/Math.PI*180},Li.bearing.set=function(s){var a=-i.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=i.create$2(),i.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Li.pitch.get=function(){return this._pitch/Math.PI*180},Li.pitch.set=function(s){var a=i.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Li.fov.get=function(){return this._fov/Math.PI*180},Li.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Li.zoom.get=function(){return this._zoom},Li.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Li.center.get=function(){return this._center},Li.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Li.padding.get=function(){return this._edgeInsets.toJSON()},Li.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Li.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},kn.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},kn.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},kn.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},kn.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new i.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new i.Point(0,0)),l=this.pointCoordinate(new i.Point(this.width,0)),v=this.pointCoordinate(new i.Point(this.width,this.height)),O=this.pointCoordinate(new i.Point(0,this.height)),L=Math.floor(Math.min(n.x,l.x,v.x,O.x)),j=Math.floor(Math.max(n.x,l.x,v.x,O.x)),ue=L-1;ue<=j+1;ue++)ue!==0&&a.push(new i.UnwrappedTileID(ue,s));return a},kn.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=i.MercatorCoordinate.fromLngLat(this.center),v=Math.pow(2,a),O=[v*l.x,v*l.y,0],L=nl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),j=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=a);var ue=function(vn){return{aabb:new Fu([vn*v,0,0],[(vn+1)*v,v,0]),zoom:0,x:0,y:0,wrap:vn,fullyVisible:!1}},Ee=[],$e=[],rt=a,at=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var zt=1;zt<=3;zt++)Ee.push(ue(-zt)),Ee.push(ue(zt));for(Ee.push(ue(0));Ee.length>0;){var Nt=Ee.pop(),Jt=Nt.x,jt=Nt.y,Gt=Nt.fullyVisible;if(!Gt){var ar=Nt.aabb.intersects(L);if(ar===0)continue;Gt=ar===2}var nr=Nt.aabb.distanceX(O),Rr=Nt.aabb.distanceY(O),gr=Math.max(Math.abs(nr),Math.abs(Rr));if(Nt.zoom===rt||gr>3+(1<<rt-Nt.zoom)-2&&Nt.zoom>=j)$e.push({tileID:new i.OverscaledTileID(Nt.zoom===rt?at:Nt.zoom,Nt.wrap,Nt.zoom,Jt,jt),distanceSq:i.sqrLen([O[0]-.5-Jt,O[1]-.5-jt])});else for(var Ar=0;Ar<4;Ar++){var Cr=(Jt<<1)+Ar%2,an=(jt<<1)+(Ar>>1);Ee.push({aabb:Nt.aabb.quadrant(Ar),zoom:Nt.zoom+1,x:Cr,y:an,wrap:Nt.wrap,fullyVisible:Gt})}}return $e.sort(function(Yr,vn){return Yr.distanceSq-vn.distanceSq}).map(function(Yr){return Yr.tileID})},kn.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},Li.unmodified.get=function(){return this._unmodified},kn.prototype.zoomScale=function(s){return Math.pow(2,s)},kn.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},kn.prototype.project=function(s){var a=i.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.Point(i.mercatorXfromLng(s.lng)*this.worldSize,i.mercatorYfromLat(a)*this.worldSize)},kn.prototype.unproject=function(s){return new i.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Li.point.get=function(){return this.project(this.center)},kn.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(s),O=new i.MercatorCoordinate(v.x-(n.x-l.x),v.y-(n.y-l.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())},kn.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},kn.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},kn.prototype.locationCoordinate=function(s){return i.MercatorCoordinate.fromLngLat(s)},kn.prototype.coordinateLocation=function(s){return s.toLngLat()},kn.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];i.transformMat4(a,a,this.pixelMatrixInverse),i.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],v=n[3],O=a[1]/l,L=n[1]/v,j=a[2]/l,ue=n[2]/v,Ee=j===ue?0:(0-j)/(ue-j);return new i.MercatorCoordinate(i.number(a[0]/l,n[0]/v,Ee)/this.worldSize,i.number(O,L,Ee)/this.worldSize)},kn.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix),new i.Point(a[0]/a[3],a[1]/a[3])},kn.prototype.getBounds=function(){return new i.LngLatBounds().extend(this.pointLocation(new i.Point(0,0))).extend(this.pointLocation(new i.Point(this.width,0))).extend(this.pointLocation(new i.Point(this.width,this.height))).extend(this.pointLocation(new i.Point(0,this.height)))},kn.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},kn.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},kn.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var v=s.canonical,O=this.worldSize/this.zoomScale(v.z),L=v.x+Math.pow(2,v.z)*s.wrap,j=i.identity(new Float64Array(16));return i.translate(j,j,[L*O,v.y*O,0]),i.scale(j,j,[O/i.EXTENT,O/i.EXTENT,1]),i.multiply(j,a?this.alignedProjMatrix:this.projMatrix,j),l[n]=new Float32Array(j),l[n]},kn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},kn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,v=-90,O=90,L=-180,j=180,ue=this.size,Ee=this._unmodified;if(this.latRange){var $e=this.latRange;v=i.mercatorYfromLat($e[1])*this.worldSize,s=(O=i.mercatorYfromLat($e[0])*this.worldSize)-v<ue.y?ue.y/(O-v):0}if(this.lngRange){var rt=this.lngRange;L=i.mercatorXfromLng(rt[0])*this.worldSize,a=(j=i.mercatorXfromLng(rt[1])*this.worldSize)-L<ue.x?ue.x/(j-L):0}var at=this.point,zt=Math.max(a||0,s||0);if(zt)return this.center=this.unproject(new i.Point(a?(j+L)/2:at.x,s?(O+v)/2:at.y)),this.zoom+=this.scaleZoom(zt),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Nt=at.y,Jt=ue.y/2;Nt-Jt<v&&(l=v+Jt),Nt+Jt>O&&(l=O-Jt)}if(this.lngRange){var jt=at.x,Gt=ue.x/2;jt-Gt<L&&(n=L+Gt),jt+Gt>j&&(n=j-Gt)}n===void 0&&l===void 0||(this.center=this.unproject(new i.Point(n!==void 0?n:at.x,l!==void 0?l:at.y))),this._unmodified=Ee,this._constraining=!1}},kn.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(i.clamp(Math.PI-a-n,.01,Math.PI-.01)),v=this.point,O=v.x,L=v.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Ee=new Float64Array(16);i.perspective(Ee,this._fov,this.width/this.height,ue,j),Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),i.rotateX(Ee,Ee,this._pitch),i.rotateZ(Ee,Ee,this.angle),i.translate(Ee,Ee,[-O,-L,0]),this.mercatorMatrix=i.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),i.scale(Ee,Ee,[1,1,i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=i.invert([],this.projMatrix);var $e=this.width%2/2,rt=this.height%2/2,at=Math.cos(this.angle),zt=Math.sin(this.angle),Nt=O-Math.round(O)+at*$e+zt*rt,Jt=L-Math.round(L)+at*rt+zt*$e,jt=new Float64Array(Ee);if(i.translate(jt,jt,[Nt>.5?Nt-1:Nt,Jt>.5?Jt-1:Jt,0]),this.alignedProjMatrix=jt,Ee=i.create(),i.scale(Ee,Ee,[this.width/2,-this.height/2,1]),i.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=i.create(),i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[-1,-1,0]),i.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=i.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},kn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new i.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},kn.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,s))},kn.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,v=a.x,O=a.y,L=0,j=s;L<j.length;L+=1){var ue=j[L];n=Math.min(n,ue.x),l=Math.min(l,ue.y),v=Math.max(v,ue.x),O=Math.max(O,ue.y)}return[new i.Point(n,l),new i.Point(v,l),new i.Point(v,O),new i.Point(n,O),new i.Point(n,l)]},Object.defineProperties(kn.prototype,Li);var Ls=function(a){var n,l,v,O;this._hashName=a&&encodeURIComponent(a),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,v=null,O=function(){v=null,l&&(n(),v=setTimeout(O,300),l=!1)},function(){return l=!0,v||O(),v})};Ls.prototype.addTo=function(s){return this._map=s,i.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ls.prototype.remove=function(){return i.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ls.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,l),O=Math.round(a.lng*v)/v,L=Math.round(a.lat*v)/v,j=this._map.getBearing(),ue=this._map.getPitch(),Ee="";if(Ee+=s?"/"+O+"/"+L+"/"+n:n+"/"+L+"/"+O,(j||ue)&&(Ee+="/"+Math.round(10*j)/10),ue&&(Ee+="/"+Math.round(ue)),this._hashName){var $e=this._hashName,rt=!1,at=i.window.location.hash.slice(1).split("&").map(function(zt){var Nt=zt.split("=")[0];return Nt===$e?(rt=!0,Nt+"="+Ee):zt}).filter(function(zt){return zt});return rt||at.push($e+"="+Ee),"#"+at.join("&")}return"#"+Ee},Ls.prototype._getCurrentHash=function(){var s,a=this,n=i.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},Ls.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},Ls.prototype._updateHashUnthrottled=function(){var s=i.window.location.href.replace(/(#.+)?$/,this.getHashString());try{i.window.history.replaceState(i.window.history.state,null,s)}catch(a){}};var Dl={linearity:.3,easing:i.bezier(0,0,.3,1)},Uu=i.extend({deceleration:2500,maxSpeed:1400},Dl),al=i.extend({deceleration:20,maxSpeed:1400},Dl),gf=i.extend({deceleration:1e3,maxSpeed:360},Dl),ss=i.extend({deceleration:1e3,maxSpeed:90},Dl),Tl=function(a){this._map=a,this.clear()};function il(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function ol(s,a,n){var l=n.maxSpeed,v=n.linearity,O=n.deceleration,L=i.clamp(s*v/(a/1e3),-l,l),j=Math.abs(L)/(O*v);return{easing:n.easing,duration:1e3*j,amount:L*(j/2)}}Tl.prototype.clear=function(){this._inertiaBuffer=[]},Tl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.browser.now(),settings:s})},Tl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=i.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},Tl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var v=l[n].settings;a.zoom+=v.zoomDelta||0,a.bearing+=v.bearingDelta||0,a.pitch+=v.pitchDelta||0,v.panDelta&&a.pan._add(v.panDelta),v.around&&(a.around=v.around),v.pinchAround&&(a.pinchAround=v.pinchAround)}var O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(a.pan.mag()){var j=ol(a.pan.mag(),O,i.extend({},Uu,s||{}));L.offset=a.pan.mult(j.amount/a.pan.mag()),L.center=this._map.transform.center,il(L,j)}if(a.zoom){var ue=ol(a.zoom,O,al);L.zoom=this._map.transform.zoom+ue.amount,il(L,ue)}if(a.bearing){var Ee=ol(a.bearing,O,gf);L.bearing=this._map.transform.bearing+i.clamp(Ee.amount,-179,179),il(L,Ee)}if(a.pitch){var $e=ol(a.pitch,O,ss);L.pitch=this._map.transform.pitch+$e.amount,il(L,$e)}if(L.zoom||L.bearing){var rt=a.pinchAround===void 0?a.around:a.pinchAround;L.around=rt?this._map.unproject(rt):this._map.getCenter()}return this.clear(),i.extend(L,{noMoveStart:!0})}};var Ui=function(s){function a(l,v,O,L){L===void 0&&(L={});var j=D.mousePos(v.getCanvasContainer(),O),ue=v.unproject(j);s.call(this,l,i.extend({point:j,lngLat:ue,originalEvent:O},L)),this._defaultPrevented=!1,this.target=v}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),As=function(s){function a(l,v,O){var L=l==="touchend"?O.changedTouches:O.touches,j=D.touchPos(v.getCanvasContainer(),L),ue=j.map(function(rt){return v.unproject(rt)}),Ee=j.reduce(function(rt,at,zt,Nt){return rt.add(at.div(Nt.length))},new i.Point(0,0)),$e=v.unproject(Ee);s.call(this,l,{points:j,point:Ee,lngLats:ue,lngLat:$e,originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),Nl=function(s){function a(l,v,O){s.call(this,l,{originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),to=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};to.prototype.reset=function(){delete this._mousedownPos},to.prototype.wheel=function(s){return this._firePreventable(new Nl(s.type,this._map,s))},to.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new Ui(s.type,this._map,s))},to.prototype.mouseup=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ui(s.type,this._map,s))},to.prototype.dblclick=function(s){return this._firePreventable(new Ui(s.type,this._map,s))},to.prototype.mouseover=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.mouseout=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.touchstart=function(s){return this._firePreventable(new As(s.type,this._map,s))},to.prototype.touchmove=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype.touchend=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype.touchcancel=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},to.prototype.isEnabled=function(){return!0},to.prototype.isActive=function(){return!1},to.prototype.enable=function(){},to.prototype.disable=function(){};var Rn=function(a){this._map=a};Rn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Rn.prototype.mousemove=function(s){this._map.fire(new Ui(s.type,this._map,s))},Rn.prototype.mousedown=function(){this._delayContextMenu=!0},Rn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Rn.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Ui(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},Rn.prototype.isEnabled=function(){return!0},Rn.prototype.isActive=function(){return!1},Rn.prototype.enable=function(){},Rn.prototype.disable=function(){};var Us=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function ni(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}Us.prototype.isEnabled=function(){return!!this._enabled},Us.prototype.isActive=function(){return!!this._active},Us.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Us.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Us.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Us.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var v=Math.min(l.x,n.x),O=Math.max(l.x,n.x),L=Math.min(l.y,n.y),j=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+v+"px,"+L+"px)"),this._box.style.width=O-v+"px",this._box.style.height=j-L+"px"}}},Us.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,v=a;if(this.reset(),D.suppressClick(),l.x!==v.x||l.y!==v.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(L){return L.fitScreenCoordinates(l,v,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},Us.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},Us.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},Us.prototype._fireEvent=function(s,a){return this._map.fire(new i.Event(s,{originalEvent:a}))};var kl=function(a){this.reset(),this.numTouches=a.numTouches};kl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},kl.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var v=new i.Point(0,0),O=0,L=l;O<L.length;O+=1)v._add(L[O]);return v.div(l.length)}(a),this.touches=ni(n,a)))},kl.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=ni(n,a);for(var v in this.touches){var O=l[v];(!O||O.dist(this.touches[v])>30)&&(this.aborted=!0)}}},kl.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var du=function(a){this.singleTap=new kl(a),this.numTaps=a.numTaps,this.reset()};du.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},du.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},du.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},du.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var v=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(l)<30;if(v&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Bs=function(){this._zoomIn=new du({numTouches:1,numTaps:2}),this._zoomOut=new du({numTouches:2,numTaps:1}),this.reset()};Bs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Bs.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},Bs.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},Bs.prototype.touchend=function(s,a,n){var l=this,v=this._zoomIn.touchend(s,a,n),O=this._zoomOut.touchend(s,a,n);return v?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(v)},{originalEvent:s})}}):O?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(O)},{originalEvent:s})}}):void 0},Bs.prototype.touchcancel=function(){this.reset()},Bs.prototype.enable=function(){this._enabled=!0},Bs.prototype.disable=function(){this._enabled=!1,this.reset()},Bs.prototype.isEnabled=function(){return this._enabled},Bs.prototype.isActive=function(){return this._active};var sl={0:1,2:2},tn=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};tn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},tn.prototype._correctButton=function(s,a){return!1},tn.prototype._move=function(s,a){return{}},tn.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},tn.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,v){var O=sl[v];return l.buttons===void 0||(l.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},tn.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var bc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(tn),us=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var v=.8*(l.x-n.x);if(v)return this._active=!0,{bearingDelta:v}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(tn),ro=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var v=-.5*(l.y-n.y);if(v)return this._active=!0,{pitchDelta:v}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(tn),qo=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};qo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)},qo.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},qo.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},qo.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},qo.prototype.touchcancel=function(){this.reset()},qo.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=ni(n,a),v=new i.Point(0,0),O=new i.Point(0,0),L=0;for(var j in l){var ue=l[j],Ee=this._touches[j];Ee&&(v._add(ue),O._add(ue.sub(Ee)),L++,l[j]=ue)}if(this._touches=l,!(L<this._minTouches)&&O.mag()){var $e=O.div(L);if(this._sum._add($e),!(this._sum.mag()<this._clickTolerance))return{around:v.div(L),panDelta:$e}}},qo.prototype.enable=function(){this._enabled=!0},qo.prototype.disable=function(){this._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return this._enabled},qo.prototype.isActive=function(){return this._active};var Rs=function(){this.reset()};function jl(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function kc(s,a){return Math.log(s/a)/Math.LN2}Rs.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Rs.prototype._start=function(s){},Rs.prototype._move=function(s,a,n){return{}},Rs.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Rs.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,v=l[1],O=jl(n,a,l[0]),L=jl(n,a,v);if(O&&L){var j=this._aroundCenter?null:O.add(L).div(2);return this._move([O,L],j,s)}}},Rs.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,v=l[1],O=jl(n,a,l[0]),L=jl(n,a,v);O&&L||(this._active&&D.suppressClick(),this.reset())}},Rs.prototype.touchcancel=function(){this.reset()},Rs.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Rs.prototype.disable=function(){this._enabled=!1,this.reset()},Rs.prototype.isEnabled=function(){return this._enabled},Rs.prototype.isActive=function(){return this._active};var Vs=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var v=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(kc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:kc(this._distance,v),pinchAround:l}},a}(Rs);function Su(s,a){return 180*s.angleWith(a)/Math.PI}var zl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var v=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Su(this._vector,v),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,v=Su(n,this._startVector);return Math.abs(v)<l},a}(Rs);function Fl(s){return Math.abs(s.y)>Math.abs(s.x)}var rf=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,Fl(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,v){var O=n[0].sub(this._lastPoints[0]),L=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(O,L,v.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(O.y+L.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,v){if(this._valid!==void 0)return this._valid;var O=n.mag()>=2,L=l.mag()>=2;if(O||L){if(!O||!L)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;var j=n.y>0==l.y>0;return Fl(n)&&Fl(l)&&j}},a}(Rs),jc={panStep:100,bearingStep:15,pitchStep:10},Ro=function(){var a=jc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function ls(s){return s*(2-s)}Ro.prototype.reset=function(){this._active=!1},Ro.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,v=0,O=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),O=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),O=1);break;case 38:s.shiftKey?v=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?v=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(l=0,v=0),{cameraAnimation:function(ue){var Ee=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ls,zoom:n?Math.round(Ee)+n*(s.shiftKey?2:1):Ee,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+v*a._pitchStep,offset:[-O*a._panStep,-L*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},Ro.prototype.enable=function(){this._enabled=!0},Ro.prototype.disable=function(){this._enabled=!1,this.reset()},Ro.prototype.isEnabled=function(){return this._enabled},Ro.prototype.isActive=function(){return this._active},Ro.prototype.disableRotation=function(){this._rotationDisabled=!0},Ro.prototype.enableRotation=function(){this._rotationDisabled=!1};var Pa=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,i.bindAll(["_onTimeout"],this)};Pa.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Pa.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Pa.prototype.isEnabled=function(){return!!this._enabled},Pa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Pa.prototype.isZooming=function(){return!!this._zooming},Pa.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Pa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pa.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=i.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Pa.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Pa.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Pa.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var v=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(v*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var O,L=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,j=this._startZoom,ue=this._easing,Ee=!1;if(this._type==="wheel"&&j&&ue){var $e=Math.min((i.browser.now()-this._lastWheelEventTime)/200,1),rt=ue($e);O=i.number(j,L,rt),$e<1?this._frameId||(this._frameId=!0):Ee=!0}else O=L,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:O-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Pa.prototype._smoothOutEasing=function(s){var a=i.ease;if(this._prevEase){var n=this._prevEase,l=(i.browser.now()-n.start)/n.duration,v=n.easing(l+.01)-n.easing(l),O=.27/Math.sqrt(v*v+1e-4)*.01,L=Math.sqrt(.0729-O*O);a=i.bezier(O,L,.25,1)}return this._prevEase={start:i.browser.now(),duration:s,easing:a},a},Pa.prototype.reset=function(){this._active=!1};var eu=function(a,n){this._clickZoom=a,this._tapZoom=n};eu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},eu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},eu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},eu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Io=function(){this.reset()};Io.prototype.reset=function(){this._active=!1},Io.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},Io.prototype.enable=function(){this._enabled=!0},Io.prototype.disable=function(){this._enabled=!1,this.reset()},Io.prototype.isEnabled=function(){return this._enabled},Io.prototype.isActive=function(){return this._active};var So=function(){this._tap=new du({numTouches:1,numTaps:1}),this.reset()};So.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},So.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},So.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],v=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(s,a,n)},So.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},So.prototype.touchcancel=function(){this.reset()},So.prototype.enable=function(){this._enabled=!0},So.prototype.disable=function(){this._enabled=!1,this.reset()},So.prototype.isEnabled=function(){return this._enabled},So.prototype.isActive=function(){return this._active};var Sl=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};Sl.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Sl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Sl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Sl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ul=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};ul.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ul.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ul.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ul.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var pu=function(a,n,l,v){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0};pu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},pu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},pu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},pu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},pu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},pu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Cs=function(a){return a.zoom||a.drag||a.pitch||a.rotate},xc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(i.Event);function Jn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var jn=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tl(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),i.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[i.window,"blur",void 0]];for(var v=0,O=this._listeners;v<O.length;v+=1){var L=O[v],j=L[0];D.addEventListener(j,L[1],j===i.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};jn.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===i.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},jn.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new to(a,s));var l=a.boxZoom=new Us(a,s);this._add("boxZoom",l);var v=new Bs,O=new Io;a.doubleClickZoom=new eu(O,v),this._add("tapZoom",v),this._add("clickZoom",O);var L=new So;this._add("tapDragZoom",L);var j=a.touchPitch=new rf;this._add("touchPitch",j);var ue=new us(s),Ee=new ro(s);a.dragRotate=new ul(s,ue,Ee),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var $e=new bc(s),rt=new qo(s);a.dragPan=new Sl(n,$e,rt),this._add("mousePan",$e),this._add("touchPan",rt,["touchZoom","touchRotate"]);var at=new zl,zt=new Vs;a.touchZoomRotate=new pu(n,zt,at,L),this._add("touchRotate",at,["touchPan","touchZoom"]),this._add("touchZoom",zt,["touchPan","touchRotate"]);var Nt=a.scrollZoom=new Pa(a,this);this._add("scrollZoom",Nt,["mousePan"]);var Jt=a.keyboard=new Ro;this._add("keyboard",Jt),this._add("blockableMapEvent",new Rn(a));for(var jt=0,Gt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jt<Gt.length;jt+=1){var ar=Gt[jt];s.interactive&&s[ar]&&a[ar].enable(s[ar])}},jn.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},jn.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},jn.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},jn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},jn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},jn.prototype.isMoving=function(){return Boolean(Cs(this._eventsInProgress))||this.isZooming()},jn.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},jn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},jn.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var v=l[n];this._el.contains(v.target)&&a.push(v)}return a},jn.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},v={},O={},L=s.touches?this._getMapTouches(s.touches):void 0,j=L?D.touchPos(this._el,L):D.mousePos(this._el,s),ue=0,Ee=this._handlers;ue<Ee.length;ue+=1){var $e=Ee[ue],rt=$e.handlerName,at=$e.handler,zt=$e.allowed;if(at.isEnabled()){var Nt=void 0;this._blockedByActive(O,zt,rt)?at.reset():at[a||s.type]&&(Nt=at[a||s.type](s,j,L),this.mergeHandlerResult(l,v,Nt,rt,n),Nt&&Nt.needsRenderFrame&&this._triggerRenderFrame()),(Nt||at.isActive())&&(O[rt]=at)}}var Jt={};for(var jt in this._previousActiveHandlers)O[jt]||(Jt[jt]=n);this._previousActiveHandlers=O,(Object.keys(Jt).length||Jn(l))&&(this._changes.push([l,v,Jt]),this._triggerRenderFrame()),(Object.keys(O).length||Jn(l))&&this._map._stop(!0),this._updatingCamera=!1;var Gt=l.cameraAnimation;Gt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Gt(this._map))}else this.stop(!0)},jn.prototype.mergeHandlerResult=function(s,a,n,l,v){if(n){i.extend(s,n);var O={handlerName:l,originalEvent:n.originalEvent||v};n.zoomDelta!==void 0&&(a.zoom=O),n.panDelta!==void 0&&(a.drag=O),n.pitchDelta!==void 0&&(a.pitch=O),n.bearingDelta!==void 0&&(a.rotate=O)}},jn.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,v=this._changes;l<v.length;l+=1){var O=v[l],L=O[0],j=O[1],ue=O[2];L.panDelta&&(s.panDelta=(s.panDelta||new i.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(s.around=L.around),L.pinchAround!==void 0&&(s.pinchAround=L.pinchAround),L.noInertia&&(s.noInertia=L.noInertia),i.extend(a,j),i.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},jn.prototype._updateMapTransform=function(s,a,n){var l=this._map,v=l.transform;if(!Jn(s))return this._fireEvents(a,n,!0);var O=s.panDelta,L=s.zoomDelta,j=s.bearingDelta,ue=s.pitchDelta,Ee=s.around,$e=s.pinchAround;$e!==void 0&&(Ee=$e),l._stop(!0),Ee=Ee||l.transform.centerPoint;var rt=v.pointLocation(O?Ee.sub(O):Ee);j&&(v.bearing+=j),ue&&(v.pitch+=ue),L&&(v.zoom+=L),v.setLocationAtPoint(rt,Ee),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},jn.prototype._fireEvents=function(s,a,n){var l=this,v=Cs(this._eventsInProgress),O=Cs(s),L={};for(var j in s)this._eventsInProgress[j]||(L[j+"start"]=s[j].originalEvent),this._eventsInProgress[j]=s[j];for(var ue in!v&&O&&this._fireEvent("movestart",O.originalEvent),L)this._fireEvent(ue,L[ue]);for(var Ee in O&&this._fireEvent("move",O.originalEvent),s)this._fireEvent(Ee,s[Ee].originalEvent);var $e,rt={};for(var at in this._eventsInProgress){var zt=this._eventsInProgress[at],Nt=zt.handlerName,Jt=zt.originalEvent;this._handlersById[Nt].isActive()||(delete this._eventsInProgress[at],rt[at+"end"]=$e=a[Nt]||Jt)}for(var jt in rt)this._fireEvent(jt,rt[jt]);var Gt=Cs(this._eventsInProgress);if(n&&(v||O)&&!Gt){this._updatingCamera=!0;var ar=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nr=function(gr){return gr!==0&&-l._bearingSnap<gr&&gr<l._bearingSnap};ar?(nr(ar.bearing||this._map.getBearing())&&(ar.bearing=0),this._map.easeTo(ar,{originalEvent:$e})):(this._map.fire(new i.Event("moveend",{originalEvent:$e})),nr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},jn.prototype._fireEvent=function(s,a){this._map.fire(new i.Event(s,a?{originalEvent:a}:{}))},jn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new xc("renderFrame",{timeStamp:a})),s._applyChanges()})},jn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Ec=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,v){return n=i.Point.convert(n).mult(-1),this.panTo(this.transform.center,i.extend({offset:n},l),v)},a.prototype.panTo=function(n,l,v){return this.easeTo(i.extend({center:n},l),v)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,v){return this.easeTo(i.extend({zoom:n},l),v)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,v){return this.easeTo(i.extend({bearing:n},l),v)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,i.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){n=i.LngLatBounds.convert(n);var v=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),v,l)},a.prototype._cameraForBoxAndBearing=function(n,l,v,O){var L={top:0,bottom:0,right:0,left:0};if(typeof(O=i.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){var j=O.padding;O.padding={top:j,bottom:j,right:j,left:j}}O.padding=i.extend(L,O.padding);var ue=this.transform,Ee=ue.padding,$e=ue.project(i.LngLat.convert(n)),rt=ue.project(i.LngLat.convert(l)),at=$e.rotate(-v*Math.PI/180),zt=rt.rotate(-v*Math.PI/180),Nt=new i.Point(Math.max(at.x,zt.x),Math.max(at.y,zt.y)),Jt=new i.Point(Math.min(at.x,zt.x),Math.min(at.y,zt.y)),jt=Nt.sub(Jt),Gt=(ue.width-(Ee.left+Ee.right+O.padding.left+O.padding.right))/jt.x,ar=(ue.height-(Ee.top+Ee.bottom+O.padding.top+O.padding.bottom))/jt.y;if(!(ar<0||Gt<0)){var nr=Math.min(ue.scaleZoom(ue.scale*Math.min(Gt,ar)),O.maxZoom),Rr=typeof O.offset.x=="number"?new i.Point(O.offset.x,O.offset.y):i.Point.convert(O.offset),gr=new i.Point((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(v*Math.PI/180),Ar=Rr.add(gr).mult(ue.scale/ue.zoomScale(nr));return{center:ue.unproject($e.add(rt).div(2).sub(Ar)),zoom:nr,bearing:v}}i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,v){return this._fitInternal(this.cameraForBounds(n,l),l,v)},a.prototype.fitScreenCoordinates=function(n,l,v,O,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.Point.convert(n)),this.transform.pointLocation(i.Point.convert(l)),v,O),O,L)},a.prototype._fitInternal=function(n,l,v){return n?(delete(l=i.extend(n,l)).padding,l.linear?this.easeTo(l,v):this.flyTo(l,v)):this},a.prototype.jumpTo=function(n,l){this.stop();var v=this.transform,O=!1,L=!1,j=!1;return"zoom"in n&&v.zoom!==+n.zoom&&(O=!0,v.zoom=+n.zoom),n.center!==void 0&&(v.center=i.LngLat.convert(n.center)),"bearing"in n&&v.bearing!==+n.bearing&&(L=!0,v.bearing=+n.bearing),"pitch"in n&&v.pitch!==+n.pitch&&(j=!0,v.pitch=+n.pitch),n.padding==null||v.isPaddingEqual(n.padding)||(v.padding=n.padding),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l)),O&&this.fire(new i.Event("zoomstart",l)).fire(new i.Event("zoom",l)).fire(new i.Event("zoomend",l)),L&&this.fire(new i.Event("rotatestart",l)).fire(new i.Event("rotate",l)).fire(new i.Event("rotateend",l)),j&&this.fire(new i.Event("pitchstart",l)).fire(new i.Event("pitch",l)).fire(new i.Event("pitchend",l)),this.fire(new i.Event("moveend",l))},a.prototype.easeTo=function(n,l){var v=this;this._stop(!1,n.easeId),((n=i.extend({offset:[0,0],duration:500,easing:i.ease},n)).animate===!1||!n.essential&&i.browser.prefersReducedMotion)&&(n.duration=0);var O=this.transform,L=this.getZoom(),j=this.getBearing(),ue=this.getPitch(),Ee=this.getPadding(),$e="zoom"in n?+n.zoom:L,rt="bearing"in n?this._normalizeBearing(n.bearing,j):j,at="pitch"in n?+n.pitch:ue,zt="padding"in n?n.padding:O.padding,Nt=i.Point.convert(n.offset),Jt=O.centerPoint.add(Nt),jt=O.pointLocation(Jt),Gt=i.LngLat.convert(n.center||jt);this._normalizeCenter(Gt);var ar,nr,Rr=O.project(jt),gr=O.project(Gt).sub(Rr),Ar=O.zoomScale($e-L);n.around&&(ar=i.LngLat.convert(n.around),nr=O.locationPoint(ar));var Cr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$e!==L,this._rotating=this._rotating||j!==rt,this._pitching=this._pitching||at!==ue,this._padding=!O.isPaddingEqual(zt),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Cr),this._ease(function(an){if(v._zooming&&(O.zoom=i.number(L,$e,an)),v._rotating&&(O.bearing=i.number(j,rt,an)),v._pitching&&(O.pitch=i.number(ue,at,an)),v._padding&&(O.interpolatePadding(Ee,zt,an),Jt=O.centerPoint.add(Nt)),ar)O.setLocationAtPoint(ar,nr);else{var Yr=O.zoomScale(O.zoom-L),vn=$e>L?Math.min(2,Ar):Math.max(.5,Ar),Pn=Math.pow(vn,1-an),qn=O.unproject(Rr.add(gr.mult(an*Pn)).mult(Yr));O.setLocationAtPoint(O.renderWorldCopies?qn.wrap():qn,Jt)}v._fireMoveEvents(l)},function(an){v._afterEase(l,an)},n),this},a.prototype._prepareEase=function(n,l,v){v===void 0&&(v={}),this._moving=!0,l||v.moving||this.fire(new i.Event("movestart",n)),this._zooming&&!v.zooming&&this.fire(new i.Event("zoomstart",n)),this._rotating&&!v.rotating&&this.fire(new i.Event("rotatestart",n)),this._pitching&&!v.pitching&&this.fire(new i.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new i.Event("move",n)),this._zooming&&this.fire(new i.Event("zoom",n)),this._rotating&&this.fire(new i.Event("rotate",n)),this._pitching&&this.fire(new i.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var v=this._zooming,O=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new i.Event("zoomend",n)),O&&this.fire(new i.Event("rotateend",n)),L&&this.fire(new i.Event("pitchend",n)),this.fire(new i.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var v=this;if(!n.essential&&i.browser.prefersReducedMotion){var O=i.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(O,l)}this.stop(),n=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},n);var L=this.transform,j=this.getZoom(),ue=this.getBearing(),Ee=this.getPitch(),$e=this.getPadding(),rt="zoom"in n?i.clamp(+n.zoom,L.minZoom,L.maxZoom):j,at="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,zt="pitch"in n?+n.pitch:Ee,Nt="padding"in n?n.padding:L.padding,Jt=L.zoomScale(rt-j),jt=i.Point.convert(n.offset),Gt=L.centerPoint.add(jt),ar=L.pointLocation(Gt),nr=i.LngLat.convert(n.center||ar);this._normalizeCenter(nr);var Rr=L.project(ar),gr=L.project(nr).sub(Rr),Ar=n.curve,Cr=Math.max(L.width,L.height),an=Cr/Jt,Yr=gr.mag();if("minZoom"in n){var vn=i.clamp(Math.min(n.minZoom,j,rt),L.minZoom,L.maxZoom),Pn=Cr/L.zoomScale(vn-j);Ar=Math.sqrt(Pn/Yr*2)}var qn=Ar*Ar;function sa(ia){var La=(an*an-Cr*Cr+(ia?-1:1)*qn*qn*Yr*Yr)/(2*(ia?an:Cr)*qn*Yr);return Math.log(Math.sqrt(La*La+1)-La)}function Aa(ia){return(Math.exp(ia)-Math.exp(-ia))/2}function Wa(ia){return(Math.exp(ia)+Math.exp(-ia))/2}var Tn=sa(0),ua=function(La){return Wa(Tn)/Wa(Tn+Ar*La)},xa=function(La){return Cr*((Wa(Tn)*(Aa(Fa=Tn+Ar*La)/Wa(Fa))-Aa(Tn))/qn)/Yr;var Fa},Zn=(sa(1)-Tn)/Ar;if(Math.abs(Yr)<1e-6||!isFinite(Zn)){if(Math.abs(Cr-an)<1e-6)return this.easeTo(n,l);var Ca=an<Cr?-1:1;Zn=Math.abs(Math.log(an/Cr))/Ar,xa=function(){return 0},ua=function(La){return Math.exp(Ca*Ar*La)}}return n.duration="duration"in n?+n.duration:1e3*Zn/("screenSpeed"in n?+n.screenSpeed/Ar:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==at,this._pitching=zt!==Ee,this._padding=!L.isPaddingEqual(Nt),this._prepareEase(l,!1),this._ease(function(ia){var La=ia*Zn,Fa=1/ua(La);L.zoom=ia===1?rt:j+L.scaleZoom(Fa),v._rotating&&(L.bearing=i.number(ue,at,ia)),v._pitching&&(L.pitch=i.number(Ee,zt,ia)),v._padding&&(L.interpolatePadding($e,Nt,ia),Gt=L.centerPoint.add(jt));var Hi=ia===1?nr:L.unproject(Rr.add(gr.mult(xa(La))).mult(Fa));L.setLocationAtPoint(L.renderWorldCopies?Hi.wrap():Hi,Gt),v._fireMoveEvents(l)},function(){return v._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,l)}if(!n){var O=this.handlers;O&&O.stop(!1)}return this},a.prototype._ease=function(n,l,v){v.animate===!1||v.duration===0?(n(1),l()):(this._easeStart=i.browser.now(),this._easeOptions=v,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((i.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=i.wrap(n,-180,180);var v=Math.abs(n-l);return Math.abs(n-360-l)<v&&(n-=360),Math.abs(n+360-l)<v&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var v=n.lng-l.center.lng;n.lng+=v>180?-360:v<-180?360:0}},a}(i.Evented),cs=function(a){a===void 0&&(a={}),this.options=a,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};cs.prototype.getDefaultPosition=function(){return"bottom-right"},cs.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},cs.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},cs.prototype._setElementTitle=function(s,a){var n=this._map._getUIString("AttributionControl."+a);s.title=n,s.setAttribute("aria-label",n)},cs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},cs.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,v,O){return v.value&&(l+=v.key+"="+v.value+(O<a.length-1?"&":"")),l},"?");s.href=i.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},cs.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},cs.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var v=n[l];if(v.used){var O=v.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort(function(j,ue){return j.length-ue.length});var L=(s=s.filter(function(j,ue){for(var Ee=ue+1;Ee<s.length;Ee++)if(s[Ee].indexOf(j)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,s.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},cs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Do=function(){i.bindAll(["_updateLogo"],this),i.bindAll(["_updateCompact"],this)};Do.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Do.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Do.prototype.getDefaultPosition=function(){return"bottom-left"},Do.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Do.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Do.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var vo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};vo.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},vo.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var v=l[n];if(v.id===s)return void(v.cancelled=!0)}},vo.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var v=l[n];if(!v.cancelled&&(v.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},vo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ws={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Au=i.window.HTMLImageElement,ec=i.window.HTMLElement,$a=i.window.ImageBitmap,no={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ll=function(s){function a(l){var v=this;if((l=i.extend({},no,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var O=new kn(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,O,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new vo,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},ws,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new i.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=i.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof ec))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return v._update(!1)}),this.on("moveend",function(){return v._update(!1)}),this.on("zoom",function(){return v._update(!0)}),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new jn(this,l),this._hash=l.hash&&new Ls(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,i.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new cs({customAttribution:l.customAttribution})),this.addControl(new Do,l.logoPosition),this.on("style.load",function(){v.transform.unmodified&&v.jumpTo(v.style.stylesheet)}),this.on("data",function(L){v._update(L.dataType==="style"),v.fire(new i.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){v.fire(new i.Event(L.dataType+"dataloading",L))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,v){if(v===void 0&&(v=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var O=l.onAdd(this);this._controls.push(l);var L=this._controlPositions[v];return v.indexOf("bottom")!==-1?L.insertBefore(O,L.firstChild):L.appendChild(O),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var v=this._controls.indexOf(l);return v>-1&&this._controls.splice(v,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var v=this._containerDimensions(),O=v[0],L=v[1];this._resizeCanvas(O,L),this.transform.resize(O,L),this.painter.resize(O,L);var j=!this._moving;return j&&(this.stop(),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l))),this.fire(new i.Event("resize",l)),j&&this.fire(new i.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(i.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(i.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(i.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,v,O){var L,j=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:v,listener:O,delegates:{mousemove:function(rt){var at=j.getLayer(v)?j.queryRenderedFeatures(rt.point,{layers:[v]}):[];at.length?ue||(ue=!0,O.call(j,new Ui(l,j,rt.originalEvent,{features:at}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Ee=!1;return{layer:v,listener:O,delegates:{mousemove:function(rt){(j.getLayer(v)?j.queryRenderedFeatures(rt.point,{layers:[v]}):[]).length?Ee=!0:Ee&&(Ee=!1,O.call(j,new Ui(l,j,rt.originalEvent)))},mouseout:function(rt){Ee&&(Ee=!1,O.call(j,new Ui(l,j,rt.originalEvent)))}}}}return{layer:v,listener:O,delegates:(L={},L[l]=function($e){var rt=j.getLayer(v)?j.queryRenderedFeatures($e.point,{layers:[v]}):[];rt.length&&($e.features=rt,O.call(j,$e),delete $e.features)},L)}},a.prototype.on=function(l,v,O){if(O===void 0)return s.prototype.on.call(this,l,v);var L=this._createDelegatedListener(l,v,O);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(L),L.delegates)this.on(j,L.delegates[j]);return this},a.prototype.once=function(l,v,O){if(O===void 0)return s.prototype.once.call(this,l,v);var L=this._createDelegatedListener(l,v,O);for(var j in L.delegates)this.once(j,L.delegates[j]);return this},a.prototype.off=function(l,v,O){var L=this;return O===void 0?s.prototype.off.call(this,l,v):(this._delegatedListeners&&this._delegatedListeners[l]&&function(j){for(var ue=j[l],Ee=0;Ee<ue.length;Ee++){var $e=ue[Ee];if($e.layer===v&&$e.listener===O){for(var rt in $e.delegates)L.off(rt,$e.delegates[rt]);return ue.splice(Ee,1),L}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,v){if(!this.style)return[];var O;if(v!==void 0||l===void 0||l instanceof i.Point||Array.isArray(l)||(v=l,l=void 0),v=v||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof i.Point||typeof l[0]=="number")O=[i.Point.convert(l)];else{var L=i.Point.convert(l[0]),j=i.Point.convert(l[1]);O=[L,new i.Point(j.x,L.y),j,new i.Point(L.x,j.y),L]}return this.style.queryRenderedFeatures(O,v,this.transform)},a.prototype.querySourceFeatures=function(l,v){return this.style.querySourceFeatures(l,v)},a.prototype.setStyle=function(l,v){return(v=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},v)).diff!==!1&&v.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,v),this):(this._localIdeographFontFamily=v.localIdeographFontFamily,this._updateStyle(l,v))},a.prototype._getUIString=function(l){var v=this._locale[l];if(v==null)throw new Error("Missing UI string '"+l+"'");return v},a.prototype._updateStyle=function(l,v){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new Ii(this,v||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ii(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,v){var O=this;if(typeof l=="string"){var L=this._requestManager.normalizeStyleURL(l),j=this._requestManager.transformRequest(L,i.ResourceType.Style);i.getJSON(j,function(ue,Ee){ue?O.fire(new i.ErrorEvent(ue)):Ee&&O._updateDiff(Ee,v)})}else typeof l=="object"&&this._updateDiff(l,v)},a.prototype._updateDiff=function(l,v){try{this.style.setState(l)&&this._update(!0)}catch(O){i.warnOnce("Unable to perform style diff: "+(O.message||O.error||O)+".  Rebuilding the style from scratch."),this._updateStyle(l,v)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,v){return this._lazyInitEmptyStyle(),this.style.addSource(l,v),this._update(!0)},a.prototype.isSourceLoaded=function(l){var v=this.style&&this.style.sourceCaches[l];if(v!==void 0)return v.loaded();this.fire(new i.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var v in l){var O=l[v]._tiles;for(var L in O){var j=O[L];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,v,O){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,v,O)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,v,O){O===void 0&&(O={});var L=O.pixelRatio;L===void 0&&(L=1);var j=O.sdf;j===void 0&&(j=!1);var ue=O.stretchX,Ee=O.stretchY,$e=O.content;if(this._lazyInitEmptyStyle(),v instanceof Au||$a&&v instanceof $a){var rt=i.browser.getImageData(v);this.style.addImage(l,{data:new i.RGBAImage({width:rt.width,height:rt.height},rt.data),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:j,version:0})}else{if(v.width===void 0||v.height===void 0)return this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var at=v;this.style.addImage(l,{data:new i.RGBAImage({width:v.width,height:v.height},new Uint8Array(v.data)),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:j,version:0,userImage:at}),at.onAdd&&at.onAdd(this,l)}},a.prototype.updateImage=function(l,v){var O=this.style.getImage(l);if(!O)return this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=v instanceof Au||$a&&v instanceof $a?i.browser.getImageData(v):v,j=L.width,ue=L.height,Ee=L.data;return j===void 0||ue===void 0?this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==O.data.width||ue!==O.data.height?this.fire(new i.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(O.data.replace(Ee,!(v instanceof Au||$a&&v instanceof $a)),void this.style.updateImage(l,O))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,v){i.getImage(this._requestManager.transformRequest(l,i.ResourceType.Image),v)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,v){return this._lazyInitEmptyStyle(),this.style.addLayer(l,v),this._update(!0)},a.prototype.moveLayer=function(l,v){return this.style.moveLayer(l,v),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,v,O){return this.style.setLayerZoomRange(l,v,O),this._update(!0)},a.prototype.setFilter=function(l,v,O){return O===void 0&&(O={}),this.style.setFilter(l,v,O),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,v,O,L){return L===void 0&&(L={}),this.style.setPaintProperty(l,v,O,L),this._update(!0)},a.prototype.getPaintProperty=function(l,v){return this.style.getPaintProperty(l,v)},a.prototype.setLayoutProperty=function(l,v,O,L){return L===void 0&&(L={}),this.style.setLayoutProperty(l,v,O,L),this._update(!0)},a.prototype.getLayoutProperty=function(l,v){return this.style.getLayoutProperty(l,v)},a.prototype.setLight=function(l,v){return v===void 0&&(v={}),this._lazyInitEmptyStyle(),this.style.setLight(l,v),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,v){return this.style.setFeatureState(l,v),this._update()},a.prototype.removeFeatureState=function(l,v){return this.style.removeFeatureState(l,v),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,v=0;return this._container&&(l=this._container.clientWidth||400,v=this._container.clientHeight||300),[l,v]},a.prototype._detectMissingCSS=function(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var v=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&v.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",v),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var O=this._containerDimensions();this._resizeCanvas(O[0],O[1]);var L=this._controlContainer=D.create("div","mapboxgl-control-container",l),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){j[ue]=D.create("div","mapboxgl-ctrl-"+ue,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,v){var O=i.browser.devicePixelRatio||1;this._canvas.width=O*l,this._canvas.height=O*v,this._canvas.style.width=l+"px",this._canvas.style.height=v+"px"},a.prototype._setupPainter=function(){var l=i.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),v=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);v?(this.painter=new Pi(v,this.transform),i.webpSupported.testSupport(v)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var v,O=this,L=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(v=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,v),L=i.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,$e=i.browser.now();this.style.zoomHistory.update(Ee,$e);var rt=new i.EvaluationParameters(Ee,{now:$e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),at=rt.crossFadingFactor();at===1&&at===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=at),this.style.update(rt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var zt=i.browser.now()-L;j.endQueryEXT(j.TIME_ELAPSED_EXT,v),setTimeout(function(){var jt=j.getQueryObjectEXT(v,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(v),O.fire(new i.Event("gpu-timing-frame",{cpuTime:zt,gpuTime:jt}))},50)}if(this.listens("gpu-timing-layer")){var Nt=this.painter.collectGpuTimers();setTimeout(function(){var jt=O.painter.queryGpuTimers(Nt);O.fire(new i.Event("gpu-timing-layer",{layerTimes:jt}))},50)}var Jt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Jt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||Jt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,v=this._controls;l<v.length;l+=1)v[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1));var O=this.painter.context.gl.getExtension("WEBGL_lose_context");O&&O.loseContext(),mu(this._canvasContainer),mu(this._controlContainer),mu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new i.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=i.browser.frame(function(v){l._frame=null,l._render(v)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,v){i.setCacheLimits(l,v)},n.version.get=function(){return i.version},Object.defineProperties(a.prototype,n),a}(Ec);function mu(s){s.parentNode&&s.parentNode.removeChild(s)}var cl={showCompass:!0,showZoom:!0,visualizePitch:!1},Cu=function(a){var n=this;this.options=i.extend({},cl,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Cu.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),a=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Cu.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Cu.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Is(this._map,this._compass,this.options.visualizePitch)),this._container},Cu.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Cu.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Cu.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var Is=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new us({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new ro({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function zc(s,a,n){if(s=new i.LngLat(s.lng,s.lat),a){var l=new i.LngLat(s.lng-360,s.lat),v=new i.LngLat(s.lng+360,s.lat),O=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<O?s=l:n.locationPoint(v).distSqr(a)<O&&(s=v)}for(;Math.abs(s.lng-n.center.lng)>180;){var L=n.locationPoint(s);if(L.x>=0&&L.y>=0&&L.x<=n.width&&L.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Is.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},Is.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var v=this.mousePitch.mousemoveWindow(s,a);v&&v.pitchDelta&&n.setPitch(n.getPitch()+v.pitchDelta)}},Is.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Is.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(i.window,"mousemove",this.mousemove),D.removeEventListener(i.window,"mouseup",this.mouseup)},Is.prototype.mousedown=function(s){this.down(i.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(i.window,"mousemove",this.mousemove),D.addEventListener(i.window,"mouseup",this.mouseup)},Is.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},Is.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Is.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Is.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Is.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Gs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yf(s,a,n){var l=s.classList;for(var v in Gs)l.remove("mapboxgl-"+n+"-anchor-"+v);l.add("mapboxgl-"+n+"-anchor-"+a)}var Ul,Bl=function(s){function a(n,l){if(s.call(this),(n instanceof i.window.HTMLElement||l)&&(n=i.extend({element:n},l)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=i.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var v=D.createNS("http://www.w3.org/2000/svg","svg");v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height","41px"),v.setAttributeNS(null,"width","27px"),v.setAttributeNS(null,"viewBox","0 0 27 41");var O=D.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"stroke","none"),O.setAttributeNS(null,"stroke-width","1"),O.setAttributeNS(null,"fill","none"),O.setAttributeNS(null,"fill-rule","evenodd");var L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var j=D.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(3.0, 29.0)"),j.setAttributeNS(null,"fill","#000000");for(var ue=0,Ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ee.length;ue+=1){var $e=Ee[ue],rt=D.createNS("http://www.w3.org/2000/svg","ellipse");rt.setAttributeNS(null,"opacity","0.04"),rt.setAttributeNS(null,"cx","10.5"),rt.setAttributeNS(null,"cy","5.80029008"),rt.setAttributeNS(null,"rx",$e.rx),rt.setAttributeNS(null,"ry",$e.ry),j.appendChild(rt)}var at=D.createNS("http://www.w3.org/2000/svg","g");at.setAttributeNS(null,"fill",this._color);var zt=D.createNS("http://www.w3.org/2000/svg","path");zt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),at.appendChild(zt);var Nt=D.createNS("http://www.w3.org/2000/svg","g");Nt.setAttributeNS(null,"opacity","0.25"),Nt.setAttributeNS(null,"fill","#000000");var Jt=D.createNS("http://www.w3.org/2000/svg","path");Jt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Nt.appendChild(Jt);var jt=D.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Gt=D.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ar=D.createNS("http://www.w3.org/2000/svg","circle");ar.setAttributeNS(null,"fill","#000000"),ar.setAttributeNS(null,"opacity","0.25"),ar.setAttributeNS(null,"cx","5.5"),ar.setAttributeNS(null,"cy","5.5"),ar.setAttributeNS(null,"r","5.4999962");var nr=D.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#FFFFFF"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962"),Gt.appendChild(ar),Gt.appendChild(nr),L.appendChild(j),L.appendChild(at),L.appendChild(Nt),L.appendChild(jt),L.appendChild(Gt),v.appendChild(L),v.setAttributeNS(null,"height",41*this._scale+"px"),v.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(v),this._offset=i.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Rr){Rr.preventDefault()}),this._element.addEventListener("mousedown",function(Rr){Rr.preventDefault()}),yf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,v=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&v!==32&&v!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,v=this._element;this._popup&&(l===v||v.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=zc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,Gs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+v+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=i.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(i.Evented),_c={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},fs=0,Bu=!1,Fc=function(s){function a(n){s.call(this),this.options=i.extend({},_c,n),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Ul!==void 0?l(Ul):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(function(v){l(Ul=v.state!=="denied")}):l(Ul=!!i.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,fs=0,Bu=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),v=n.coords;return l&&(v.longitude<l.getWest()||v.longitude>l.getEast()||v.latitude<l.getSouth()||v.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude),v=n.coords.accuracy,O=this._map.getBearing(),L=i.extend({bearing:O},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(v),L,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),v=this._map.unproject([1,n]),O=l.distanceTo(v),L=Math.ceil(2*this._accuracy/O);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Bu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v)}else{var O=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Bl(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||l._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new i.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":fs--,Bu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++fs>1?(n={maximumAge:6e5,timeout:0},Bu=!0):(n=this.options.positionOptions,Bu=!1),this._geolocationWatchID=i.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else i.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(i.Evented),Al={maxWidth:100,unit:"metric"},Vu=function(a){this.options=i.extend({},Al,a),i.bindAll(["_onMove","setUnit"],this)};function tc(s,a,n){var l=n&&n.maxWidth||100,v=s._container.clientHeight/2,O=s.unproject([0,v]),L=s.unproject([l,v]),j=O.distanceTo(L);if(n&&n.unit==="imperial"){var ue=3.2808*j;ue>5280?Gu(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):Gu(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Gu(a,l,j/1852,s._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Gu(a,l,j/1e3,s._getUIString("ScaleControl.Kilometers")):Gu(a,l,j,s._getUIString("ScaleControl.Meters"))}function Gu(s,a,n,l){var v,O,L,j=(v=n,(O=Math.pow(10,(""+Math.floor(v)).length-1))*(L=(L=v/O)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(ue){var Ee=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ee)/Ee}(L)));s.style.width=a*(j/n)+"px",s.innerHTML=j+"&nbsp;"+l}Vu.prototype.getDefaultPosition=function(){return"bottom-left"},Vu.prototype._onMove=function(){tc(this._map,this._container,this.options)},Vu.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vu.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vu.prototype.setUnit=function(s){this.options.unit=s,tc(this._map,this._container,this.options)};var Ds=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof i.window.HTMLElement?this._container=a.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in i.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in i.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in i.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ds.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ds.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._checkFullscreenSupport=function(){return!!(i.window.document.fullscreenEnabled||i.window.document.mozFullScreenEnabled||i.window.document.msFullscreenEnabled||i.window.document.webkitFullscreenEnabled)},Ds.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ds.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ds.prototype._isFullscreen=function(){return this._fullscreen},Ds.prototype._changeIcon=function(){(i.window.document.fullscreenElement||i.window.document.mozFullScreenElement||i.window.document.webkitFullscreenElement||i.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ds.prototype._onClickFullscreen=function(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.mozCancelFullScreen?i.window.document.mozCancelFullScreen():i.window.document.msExitFullscreen?i.window.document.msExitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var nf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),nc=function(s){function a(n){s.call(this),this.options=i.extend(Object.create(nf),n),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(i.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,v=i.window.document.createDocumentFragment(),O=i.window.document.createElement("body");for(O.innerHTML=n;l=O.firstChild;)v.appendChild(l);return this.setDOMContent(v)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(rt){return l._container.classList.add(rt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var v=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),O=this.options.anchor,L=function rt(at){if(at){if(typeof at=="number"){var zt=Math.round(Math.sqrt(.5*Math.pow(at,2)));return{center:new i.Point(0,0),top:new i.Point(0,at),"top-left":new i.Point(zt,zt),"top-right":new i.Point(-zt,zt),bottom:new i.Point(0,-at),"bottom-left":new i.Point(zt,-zt),"bottom-right":new i.Point(-zt,-zt),left:new i.Point(at,0),right:new i.Point(-at,0)}}if(at instanceof i.Point||Array.isArray(at)){var Nt=i.Point.convert(at);return{center:Nt,top:Nt,"top-left":Nt,"top-right":Nt,bottom:Nt,"bottom-left":Nt,"bottom-right":Nt,left:Nt,right:Nt}}return{center:i.Point.convert(at.center||[0,0]),top:i.Point.convert(at.top||[0,0]),"top-left":i.Point.convert(at["top-left"]||[0,0]),"top-right":i.Point.convert(at["top-right"]||[0,0]),bottom:i.Point.convert(at.bottom||[0,0]),"bottom-left":i.Point.convert(at["bottom-left"]||[0,0]),"bottom-right":i.Point.convert(at["bottom-right"]||[0,0]),left:i.Point.convert(at.left||[0,0]),right:i.Point.convert(at.right||[0,0])}}return rt(new i.Point(0,0))}(this.options.offset);if(!O){var j,ue=this._container.offsetWidth,Ee=this._container.offsetHeight;j=v.y+L.bottom.y<Ee?["top"]:v.y>this._map.transform.height-Ee?["bottom"]:[],v.x<ue/2?j.push("left"):v.x>this._map.transform.width-ue/2&&j.push("right"),O=j.length===0?"bottom":j.join("-")}var $e=v.add(L[O]).round();D.setTransform(this._container,Gs[O]+" translate("+$e.x+"px,"+$e.y+"px)"),yf(this._container,O,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(rc);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(i.Evented),ac={version:i.version,supported:Z,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:ll,NavigationControl:Cu,GeolocateControl:Fc,AttributionControl:cs,ScaleControl:Vu,FullscreenControl:Ds,Popup:nc,Marker:Bl,Style:Ii,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,config:i.config,prewarm:function(){tr().acquire(cr)},clearPrewarmedResources:function(){var a=wn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(cr),wn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(s){i.config.ACCESS_TOKEN=s},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(s){i.config.API_URL=s},get workerCount(){return Br.workerCount},set workerCount(s){Br.workerCount=s},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){i.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){i.clearTileCache(a)},workerUrl:""};return ac}),Y})},"9+tt":function(Fe,_,o){var x=o("7S95"),p=o("921W"),Y=o("nBjS"),z=Y&&Y.isSet,i=z?p(z):x;Fe.exports=i},"99LQ":function(Fe,_,o){"use strict";o.d(_,"a",function(){return x}),o.d(_,"b",function(){return ht}),o.d(_,"c",function(){return Wt}),o.d(_,"d",function(){return Qt}),o.d(_,"e",function(){return ur});var x={};o.r(x),o.d(x,"create",function(){return Y}),o.d(x,"clone",function(){return z}),o.d(x,"copy",function(){return i}),o.d(x,"identity",function(){return Z}),o.d(x,"fromValues",function(){return D}),o.d(x,"set",function(){return K}),o.d(x,"transpose",function(){return re}),o.d(x,"invert",function(){return fe}),o.d(x,"adjoint",function(){return X}),o.d(x,"determinant",function(){return He}),o.d(x,"multiply",function(){return Xe}),o.d(x,"rotate",function(){return pe}),o.d(x,"scale",function(){return Ce}),o.d(x,"fromRotation",function(){return mt}),o.d(x,"fromScaling",function(){return Ne}),o.d(x,"str",function(){return At}),o.d(x,"frob",function(){return Ye}),o.d(x,"LDU",function(){return Et}),o.d(x,"add",function(){return nt}),o.d(x,"subtract",function(){return Ct}),o.d(x,"exactEquals",function(){return Ot}),o.d(x,"equals",function(){return Re}),o.d(x,"multiplyScalar",function(){return Ie}),o.d(x,"multiplyScalarAndAdd",function(){return Be}),o.d(x,"mul",function(){return ft}),o.d(x,"sub",function(){return Me});var p=o("TaHB");function Y(){var oe=new p.a(4);return p.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function z(oe){var J=new p.a(4);return J[0]=oe[0],J[1]=oe[1],J[2]=oe[2],J[3]=oe[3],J}function i(oe,J){return oe[0]=J[0],oe[1]=J[1],oe[2]=J[2],oe[3]=J[3],oe}function Z(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,J,H,Se){var be=new p.a(4);return be[0]=oe,be[1]=J,be[2]=H,be[3]=Se,be}function K(oe,J,H,Se,be){return oe[0]=J,oe[1]=H,oe[2]=Se,oe[3]=be,oe}function re(oe,J){if(oe===J){var H=J[1];oe[1]=J[2],oe[2]=H}else oe[0]=J[0],oe[1]=J[2],oe[2]=J[1],oe[3]=J[3];return oe}function fe(oe,J){var H=J[0],Se=J[1],be=J[2],_e=J[3],me=H*_e-be*Se;return me?(me=1/me,oe[0]=_e*me,oe[1]=-Se*me,oe[2]=-be*me,oe[3]=H*me,oe):null}function X(oe,J){var H=J[0];return oe[0]=J[3],oe[1]=-J[1],oe[2]=-J[2],oe[3]=H,oe}function He(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function Xe(oe,J,H){var Se=J[0],be=J[1],_e=J[2],me=J[3],it=H[0],qt=H[1],Pt=H[2],ve=H[3];return oe[0]=Se*it+_e*qt,oe[1]=be*it+me*qt,oe[2]=Se*Pt+_e*ve,oe[3]=be*Pt+me*ve,oe}function pe(oe,J,H){var Se=J[0],be=J[1],_e=J[2],me=J[3],it=Math.sin(H),qt=Math.cos(H);return oe[0]=Se*qt+_e*it,oe[1]=be*qt+me*it,oe[2]=Se*-it+_e*qt,oe[3]=be*-it+me*qt,oe}function Ce(oe,J,H){var Se=J[0],be=J[1],_e=J[2],me=J[3],it=H[0],qt=H[1];return oe[0]=Se*it,oe[1]=be*it,oe[2]=_e*qt,oe[3]=me*qt,oe}function mt(oe,J){var H=Math.sin(J),Se=Math.cos(J);return oe[0]=Se,oe[1]=H,oe[2]=-H,oe[3]=Se,oe}function Ne(oe,J){return oe[0]=J[0],oe[1]=0,oe[2]=0,oe[3]=J[1],oe}function At(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function Ye(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function Et(oe,J,H,Se){return oe[2]=Se[2]/Se[0],H[0]=Se[0],H[1]=Se[1],H[3]=Se[3]-oe[2]*H[1],[oe,J,H]}function nt(oe,J,H){return oe[0]=J[0]+H[0],oe[1]=J[1]+H[1],oe[2]=J[2]+H[2],oe[3]=J[3]+H[3],oe}function Ct(oe,J,H){return oe[0]=J[0]-H[0],oe[1]=J[1]-H[1],oe[2]=J[2]-H[2],oe[3]=J[3]-H[3],oe}function Ot(oe,J){return oe[0]===J[0]&&oe[1]===J[1]&&oe[2]===J[2]&&oe[3]===J[3]}function Re(oe,J){var H=oe[0],Se=oe[1],be=oe[2],_e=oe[3],me=J[0],it=J[1],qt=J[2],Pt=J[3];return Math.abs(H-me)<=p.b*Math.max(1,Math.abs(H),Math.abs(me))&&Math.abs(Se-it)<=p.b*Math.max(1,Math.abs(Se),Math.abs(it))&&Math.abs(be-qt)<=p.b*Math.max(1,Math.abs(be),Math.abs(qt))&&Math.abs(_e-Pt)<=p.b*Math.max(1,Math.abs(_e),Math.abs(Pt))}function Ie(oe,J,H){return oe[0]=J[0]*H,oe[1]=J[1]*H,oe[2]=J[2]*H,oe[3]=J[3]*H,oe}function Be(oe,J,H,Se){return oe[0]=J[0]+H[0]*Se,oe[1]=J[1]+H[1]*Se,oe[2]=J[2]+H[2]*Se,oe[3]=J[3]+H[3]*Se,oe}var ft=Xe,Me=Ct,ht=o("jJQI"),Wt=o("d/dq"),Qt=o("gCNn"),ur=o("yktm")},"9DPn":function(Fe,_,o){(function(x,p){Fe.exports=p()})(this,function(){"use strict";function x(Re,Ie,Be,ft,Me,ht){if(Me-ft<=Be)return;var Wt=ft+Me>>1;p(Re,Ie,Wt,ft,Me,ht%2),x(Re,Ie,Be,ft,Wt-1,ht+1),x(Re,Ie,Be,Wt+1,Me,ht+1)}function p(Re,Ie,Be,ft,Me,ht){for(;Me>ft;){if(Me-ft>600){var Wt=Me-ft+1,Qt=Be-ft+1,ur=Math.log(Wt),oe=.5*Math.exp(2*ur/3),J=.5*Math.sqrt(ur*oe*(Wt-oe)/Wt)*(Qt-Wt/2<0?-1:1),H=Math.max(ft,Math.floor(Be-Qt*oe/Wt+J)),Se=Math.min(Me,Math.floor(Be+(Wt-Qt)*oe/Wt+J));p(Re,Ie,Be,H,Se,ht)}var be=Ie[2*Be+ht],_e=ft,me=Me;for(Y(Re,Ie,ft,Be),Ie[2*Me+ht]>be&&Y(Re,Ie,ft,Me);_e<me;){for(Y(Re,Ie,_e,me),_e++,me--;Ie[2*_e+ht]<be;)_e++;for(;Ie[2*me+ht]>be;)me--}Ie[2*ft+ht]===be?Y(Re,Ie,ft,me):(me++,Y(Re,Ie,me,Me)),me<=Be&&(ft=me+1),Be<=me&&(Me=me-1)}}function Y(Re,Ie,Be,ft){z(Re,Be,ft),z(Ie,2*Be,2*ft),z(Ie,2*Be+1,2*ft+1)}function z(Re,Ie,Be){var ft=Re[Ie];Re[Ie]=Re[Be],Re[Be]=ft}function i(Re,Ie,Be,ft,Me,ht,Wt){for(var Qt=[0,Re.length-1,0],ur=[],oe,J;Qt.length;){var H=Qt.pop(),Se=Qt.pop(),be=Qt.pop();if(Se-be<=Wt){for(var _e=be;_e<=Se;_e++)oe=Ie[2*_e],J=Ie[2*_e+1],oe>=Be&&oe<=Me&&J>=ft&&J<=ht&&ur.push(Re[_e]);continue}var me=Math.floor((be+Se)/2);oe=Ie[2*me],J=Ie[2*me+1],oe>=Be&&oe<=Me&&J>=ft&&J<=ht&&ur.push(Re[me]);var it=(H+1)%2;(H===0?Be<=oe:ft<=J)&&(Qt.push(be),Qt.push(me-1),Qt.push(it)),(H===0?Me>=oe:ht>=J)&&(Qt.push(me+1),Qt.push(Se),Qt.push(it))}return ur}function Z(Re,Ie,Be,ft,Me,ht){for(var Wt=[0,Re.length-1,0],Qt=[],ur=Me*Me;Wt.length;){var oe=Wt.pop(),J=Wt.pop(),H=Wt.pop();if(J-H<=ht){for(var Se=H;Se<=J;Se++)D(Ie[2*Se],Ie[2*Se+1],Be,ft)<=ur&&Qt.push(Re[Se]);continue}var be=Math.floor((H+J)/2),_e=Ie[2*be],me=Ie[2*be+1];D(_e,me,Be,ft)<=ur&&Qt.push(Re[be]);var it=(oe+1)%2;(oe===0?Be-Me<=_e:ft-Me<=me)&&(Wt.push(H),Wt.push(be-1),Wt.push(it)),(oe===0?Be+Me>=_e:ft+Me>=me)&&(Wt.push(be+1),Wt.push(J),Wt.push(it))}return Qt}function D(Re,Ie,Be,ft){var Me=Re-Be,ht=Ie-ft;return Me*Me+ht*ht}var K=function(Ie){return Ie[0]},re=function(Ie){return Ie[1]},fe=function(Ie,Be,ft,Me,ht){Be===void 0&&(Be=K),ft===void 0&&(ft=re),Me===void 0&&(Me=64),ht===void 0&&(ht=Float64Array),this.nodeSize=Me,this.points=Ie;for(var Wt=Ie.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Wt(Ie.length),ur=this.coords=new ht(Ie.length*2),oe=0;oe<Ie.length;oe++)Qt[oe]=oe,ur[2*oe]=Be(Ie[oe]),ur[2*oe+1]=ft(Ie[oe]);x(Qt,ur,Me,0,Qt.length-1,0)};fe.prototype.range=function(Ie,Be,ft,Me){return i(this.ids,this.coords,Ie,Be,ft,Me,this.nodeSize)},fe.prototype.within=function(Ie,Be,ft){return Z(this.ids,this.coords,Ie,Be,ft,this.nodeSize)};var X={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ie){return Ie}},He=function(Ie){this.options=nt(Object.create(X),Ie),this.trees=new Array(this.options.maxZoom+1)};He.prototype.load=function(Ie){var Be=this.options,ft=Be.log,Me=Be.minZoom,ht=Be.maxZoom,Wt=Be.nodeSize;ft&&console.time("total time");var Qt="prepare "+Ie.length+" points";ft&&console.time(Qt),this.points=Ie;for(var ur=[],oe=0;oe<Ie.length;oe++){if(!Ie[oe].geometry)continue;ur.push(pe(Ie[oe],oe))}this.trees[ht+1]=new fe(ur,Ct,Ot,Wt,Float32Array),ft&&console.timeEnd(Qt);for(var J=ht;J>=Me;J--){var H=+Date.now();ur=this._cluster(ur,J),this.trees[J]=new fe(ur,Ct,Ot,Wt,Float32Array),ft&&console.log("z%d: %d clusters in %dms",J,ur.length,+Date.now()-H)}return ft&&console.timeEnd("total time"),this},He.prototype.getClusters=function(Ie,Be){var ft=((Ie[0]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,Ie[1])),ht=Ie[2]===180?180:((Ie[2]+180)%360+360)%360-180,Wt=Math.max(-90,Math.min(90,Ie[3]));if(Ie[2]-Ie[0]>=360)ft=-180,ht=180;else if(ft>ht){var Qt=this.getClusters([ft,Me,180,Wt],Be),ur=this.getClusters([-180,Me,ht,Wt],Be);return Qt.concat(ur)}for(var oe=this.trees[this._limitZoom(Be)],J=oe.range(Ne(ft),At(Wt),Ne(ht),At(Me)),H=[],Se=0,be=J;Se<be.length;Se+=1){var _e=be[Se],me=oe.points[_e];H.push(me.numPoints?Ce(me):this.points[me.index])}return H},He.prototype.getChildren=function(Ie){var Be=this._getOriginId(Ie),ft=this._getOriginZoom(Ie),Me="No cluster with the specified id.",ht=this.trees[ft];if(!ht)throw new Error(Me);var Wt=ht.points[Be];if(!Wt)throw new Error(Me);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,ft-1)),ur=ht.within(Wt.x,Wt.y,Qt),oe=[],J=0,H=ur;J<H.length;J+=1){var Se=H[J],be=ht.points[Se];be.parentId===Ie&&oe.push(be.numPoints?Ce(be):this.points[be.index])}if(oe.length===0)throw new Error(Me);return oe},He.prototype.getLeaves=function(Ie,Be,ft){Be=Be||10,ft=ft||0;var Me=[];return this._appendLeaves(Me,Ie,Be,ft,0),Me},He.prototype.getTile=function(Ie,Be,ft){var Me=this.trees[this._limitZoom(Ie)],ht=Math.pow(2,Ie),Wt=this.options,Qt=Wt.extent,ur=Wt.radius,oe=ur/Qt,J=(ft-oe)/ht,H=(ft+1+oe)/ht,Se={features:[]};return this._addTileFeatures(Me.range((Be-oe)/ht,J,(Be+1+oe)/ht,H),Me.points,Be,ft,ht,Se),Be===0&&this._addTileFeatures(Me.range(1-oe/ht,J,1,H),Me.points,ht,ft,ht,Se),Be===ht-1&&this._addTileFeatures(Me.range(0,J,oe/ht,H),Me.points,-1,ft,ht,Se),Se.features.length?Se:null},He.prototype.getClusterExpansionZoom=function(Ie){for(var Be=this._getOriginZoom(Ie)-1;Be<=this.options.maxZoom;){var ft=this.getChildren(Ie);if(Be++,ft.length!==1)break;Ie=ft[0].properties.cluster_id}return Be},He.prototype._appendLeaves=function(Ie,Be,ft,Me,ht){for(var Wt=this.getChildren(Be),Qt=0,ur=Wt;Qt<ur.length;Qt+=1){var oe=ur[Qt],J=oe.properties;if(J&&J.cluster?ht+J.point_count<=Me?ht+=J.point_count:ht=this._appendLeaves(Ie,J.cluster_id,ft,Me,ht):ht<Me?ht++:Ie.push(oe),Ie.length===ft)break}return ht},He.prototype._addTileFeatures=function(Ie,Be,ft,Me,ht,Wt){for(var Qt=0,ur=Ie;Qt<ur.length;Qt+=1){var oe=ur[Qt],J=Be[oe],H=J.numPoints,Se={type:1,geometry:[[Math.round(this.options.extent*(J.x*ht-ft)),Math.round(this.options.extent*(J.y*ht-Me))]],tags:H?mt(J):this.points[J.index].properties},be=void 0;H?be=J.id:this.options.generateId?be=J.index:this.points[J.index].id&&(be=this.points[J.index].id),be!==void 0&&(Se.id=be),Wt.features.push(Se)}},He.prototype._limitZoom=function(Ie){return Math.max(this.options.minZoom,Math.min(+Ie,this.options.maxZoom+1))},He.prototype._cluster=function(Ie,Be){for(var ft=[],Me=this.options,ht=Me.radius,Wt=Me.extent,Qt=Me.reduce,ur=Me.minPoints,oe=ht/(Wt*Math.pow(2,Be)),J=0;J<Ie.length;J++){var H=Ie[J];if(H.zoom<=Be)continue;H.zoom=Be;for(var Se=this.trees[Be+1],be=Se.within(H.x,H.y,oe),_e=H.numPoints||1,me=_e,it=0,qt=be;it<qt.length;it+=1){var Pt=qt[it],ve=Se.points[Pt];ve.zoom>Be&&(me+=ve.numPoints||1)}if(me>=ur){for(var ge=H.x*_e,Ve=H.y*_e,st=Qt&&_e>1?this._map(H,!0):null,Oe=(J<<5)+(Be+1)+this.points.length,vt=0,C=be;vt<C.length;vt+=1){var R=C[vt],q=Se.points[R];if(q.zoom<=Be)continue;q.zoom=Be;var ce=q.numPoints||1;ge+=q.x*ce,Ve+=q.y*ce,q.parentId=Oe,Qt&&(st||(st=this._map(H,!0)),Qt(st,this._map(q)))}H.parentId=Oe,ft.push(Xe(ge/me,Ve/me,Oe,me,st))}else if(ft.push(H),me>1)for(var Ge=0,qe=be;Ge<qe.length;Ge+=1){var Tt=qe[Ge],ot=Se.points[Tt];if(ot.zoom<=Be)continue;ot.zoom=Be,ft.push(ot)}}return ft},He.prototype._getOriginId=function(Ie){return Ie-this.points.length>>5},He.prototype._getOriginZoom=function(Ie){return(Ie-this.points.length)%32},He.prototype._map=function(Ie,Be){if(Ie.numPoints)return Be?nt({},Ie.properties):Ie.properties;var ft=this.points[Ie.index].properties,Me=this.options.map(ft);return Be&&Me===ft?nt({},Me):Me};function Xe(Re,Ie,Be,ft,Me){return{x:Re,y:Ie,zoom:Infinity,id:Be,parentId:-1,numPoints:ft,properties:Me}}function pe(Re,Ie){var Be=Re.geometry.coordinates,ft=Be[0],Me=Be[1];return{x:Ne(ft),y:At(Me),zoom:Infinity,index:Ie,parentId:-1}}function Ce(Re){return{type:"Feature",id:Re.id,properties:mt(Re),geometry:{type:"Point",coordinates:[Ye(Re.x),Et(Re.y)]}}}function mt(Re){var Ie=Re.numPoints,Be=Ie>=1e4?Math.round(Ie/1e3)+"k":Ie>=1e3?Math.round(Ie/100)/10+"k":Ie;return nt(nt({},Re.properties),{cluster:!0,cluster_id:Re.id,point_count:Ie,point_count_abbreviated:Be})}function Ne(Re){return Re/360+.5}function At(Re){var Ie=Math.sin(Re*Math.PI/180),Be=.5-.25*Math.log((1+Ie)/(1-Ie))/Math.PI;return Be<0?0:Be>1?1:Be}function Ye(Re){return(Re-.5)*360}function Et(Re){var Ie=(180-Re*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ie))/Math.PI-90}function nt(Re,Ie){for(var Be in Ie)Re[Be]=Ie[Be];return Re}function Ct(Re){return Re.x}function Ot(Re){return Re.y}return He})},"9GRW":function(Fe,_,o){"use strict";(function(x,p){Fe.exports=p()})(this,function(){function x(fe){var X=[];return fe.AMapUI&&X.push(p(fe.AMapUI)),fe.Loca&&X.push(Y(fe.Loca)),Promise.all(X)}function p(fe){return new Promise(function(X,He){var Xe=[];if(fe.plugins)for(var pe=0;pe<fe.plugins.length;pe+=1)i.AMapUI.plugins.indexOf(fe.plugins[pe])==-1&&Xe.push(fe.plugins[pe]);if(Z.AMapUI===z.failed)He("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===z.notload){Z.AMapUI=z.loading,i.AMapUI.version=fe.version||i.AMapUI.version,pe=i.AMapUI.version;var Ce=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/ui/"+pe+"/main.js",mt.onerror=function(Ne){Z.AMapUI=z.failed,He("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){if(Z.AMapUI=z.loaded,Xe.length)window.AMapUI.loadUI(Xe,function(){for(var Ne=0,At=Xe.length;Ne<At;Ne++){var Ye=Xe[Ne].split("/").slice(-1)[0];window.AMapUI[Ye]=arguments[Ne]}for(X();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(X();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Ce.appendChild(mt)}else Z.AMapUI===z.loaded?fe.version&&fe.version!==i.AMapUI.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Xe.length?window.AMapUI.loadUI(Xe,function(){for(var Ne=0,At=Xe.length;Ne<At;Ne++){var Ye=Xe[Ne].split("/").slice(-1)[0];window.AMapUI[Ye]=arguments[Ne]}X()}):X():fe.version&&fe.version!==i.AMapUI.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(Ne){Ne?He(Ne):Xe.length?window.AMapUI.loadUI(Xe,function(){for(var At=0,Ye=Xe.length;At<Ye;At++){var Et=Xe[At].split("/").slice(-1)[0];window.AMapUI[Et]=arguments[At]}X()}):X()})})}function Y(fe){return new Promise(function(X,He){if(i.AMap.version.startsWith("2.0"))He("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Z.Loca===z.failed)He("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===z.notload){Z.Loca=z.loading,i.Loca.version=fe.version||i.Loca.version;var Xe=i.Loca.version,pe=i.key,Ce=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/loca?v="+Xe+"&key="+pe,mt.onerror=function(Ne){Z.Loca=z.failed,He("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){for(Z.Loca=z.loaded,X();D.Loca.length;)D.Loca.splice(0,1)[0]()},Ce.appendChild(mt)}else Z.Loca===z.loaded?fe.version&&fe.version!==i.Loca.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):X():fe.version&&fe.version!==i.Loca.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(Ne){Ne?He(Ne):He()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var z;(function(fe){fe.notload="notload",fe.loading="loading",fe.loaded="loaded",fe.failed="failed"})(z||(z={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]},K=[],re=function(X){typeof X=="function"&&(Z.AMap===z.loaded?X(window.AMap):K.push(X))};return{load:function(X){return new Promise(function(He,Xe){if(Z.AMap==z.failed)Xe("");else if(Z.AMap==z.notload){var pe=X.key,Ce=X.version,mt=X.plugins;pe?(window.AMap&&location.host!=="lbs.amap.com"&&Xe("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),i.key=pe,i.AMap.version=Ce||i.AMap.version,i.AMap.plugins=mt||i.AMap.plugins,Z.AMap=z.loading,Ce=document.body||document.head,window.___onAPILoaded=function(At){if(delete window.___onAPILoaded,At)Z.AMap=z.failed,Xe(At);else for(Z.AMap=z.loaded,x(X).then(function(){He(window.AMap)}).catch(Xe);K.length;)K.splice(0,1)[0]()},mt=document.createElement("script"),mt.type="text/javascript",mt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+pe+"&plugin="+i.AMap.plugins.join(","),mt.onerror=function(At){Z.AMap=z.failed,Xe(At)},Ce.appendChild(mt)):Xe("\u8BF7\u586B\u5199key")}else if(Z.AMap==z.loaded)if(X.key&&X.key!==i.key)Xe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(X.version&&X.version!==i.AMap.version)Xe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(pe=[],X.plugins)for(Ce=0;Ce<X.plugins.length;Ce+=1)i.AMap.plugins.indexOf(X.plugins[Ce])==-1&&pe.push(X.plugins[Ce]);pe.length?window.AMap.plugin(pe,function(){x(X).then(function(){He(window.AMap)}).catch(Xe)}):x(X).then(function(){He(window.AMap)}).catch(Xe)}else if(X.key&&X.key!==i.key)Xe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(X.version&&X.version!==i.AMap.version)Xe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Ne=[];if(X.plugins)for(Ce=0;Ce<X.plugins.length;Ce+=1)i.AMap.plugins.indexOf(X.plugins[Ce])==-1&&Ne.push(X.plugins[Ce]);re(function(){Ne.length?window.AMap.plugin(Ne,function(){x(X).then(function(){He(window.AMap)}).catch(Xe)}):x(X).then(function(){He(window.AMap)}).catch(Xe)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},"9R00":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("D6nA"),p=function(){function Y(z){this._binding=z}return Y.prototype.onActivation=function(z){return this._binding.onActivation=z,new x.BindingWhenSyntax(this._binding)},Y}();_.BindingOnSyntax=p},"9hGJ":function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},"9tAk":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("3XrA");function p(Ye,Et,nt){if(Ye===null)return;for(var Ct,Ot,Re,Ie,Be,ft,Me,ht=0,Wt=0,Qt,ur=Ye.type,oe=ur==="FeatureCollection",J=ur==="Feature",H=oe?Ye.features.length:1,Se=0;Se<H;Se++){Me=oe?Ye.features[Se].geometry:J?Ye.geometry:Ye,Qt=Me?Me.type==="GeometryCollection":!1,Be=Qt?Me.geometries.length:1;for(var be=0;be<Be;be++){var _e=0,me=0;if(Ie=Qt?Me.geometries[be]:Me,Ie===null)continue;ft=Ie.coordinates;var it=Ie.type;ht=nt&&(it==="Polygon"||it==="MultiPolygon")?1:0;switch(it){case null:break;case"Point":if(Et(ft,Wt,Se,_e,me)===!1)return!1;Wt++,_e++;break;case"LineString":case"MultiPoint":for(Ct=0;Ct<ft.length;Ct++){if(Et(ft[Ct],Wt,Se,_e,me)===!1)return!1;Wt++,it==="MultiPoint"&&_e++}it==="LineString"&&_e++;break;case"Polygon":case"MultiLineString":for(Ct=0;Ct<ft.length;Ct++){for(Ot=0;Ot<ft[Ct].length-ht;Ot++){if(Et(ft[Ct][Ot],Wt,Se,_e,me)===!1)return!1;Wt++}it==="MultiLineString"&&_e++,it==="Polygon"&&me++}it==="Polygon"&&_e++;break;case"MultiPolygon":for(Ct=0;Ct<ft.length;Ct++){for(me=0,Ot=0;Ot<ft[Ct].length;Ot++){for(Re=0;Re<ft[Ct][Ot].length-ht;Re++){if(Et(ft[Ct][Ot][Re],Wt,Se,_e,me)===!1)return!1;Wt++}me++}_e++}break;case"GeometryCollection":for(Ct=0;Ct<Ie.geometries.length;Ct++)if(p(Ie.geometries[Ct],Et,nt)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function Y(Ye,Et,nt,Ct){var Ot=nt;return p(Ye,function(Re,Ie,Be,ft,Me){Ie===0&&nt===void 0?Ot=Re:Ot=Et(Ot,Re,Ie,Be,ft,Me)},Ct),Ot}function z(Ye,Et){var nt;switch(Ye.type){case"FeatureCollection":for(nt=0;nt<Ye.features.length&&!(Et(Ye.features[nt].properties,nt)===!1);nt++);break;case"Feature":Et(Ye.properties,0);break}}function i(Ye,Et,nt){var Ct=nt;return z(Ye,function(Ot,Re){Re===0&&nt===void 0?Ct=Ot:Ct=Et(Ct,Ot,Re)}),Ct}function Z(Ye,Et){if(Ye.type==="Feature")Et(Ye,0);else if(Ye.type==="FeatureCollection")for(var nt=0;nt<Ye.features.length&&!(Et(Ye.features[nt],nt)===!1);nt++);}function D(Ye,Et,nt){var Ct=nt;return Z(Ye,function(Ot,Re){Re===0&&nt===void 0?Ct=Ot:Ct=Et(Ct,Ot,Re)}),Ct}function K(Ye){var Et=[];return p(Ye,function(nt){Et.push(nt)}),Et}function re(Ye,Et){var nt,Ct,Ot,Re,Ie,Be,ft,Me,ht,Wt,Qt=0,ur=Ye.type==="FeatureCollection",oe=Ye.type==="Feature",J=ur?Ye.features.length:1;for(nt=0;nt<J;nt++){for(Be=ur?Ye.features[nt].geometry:oe?Ye.geometry:Ye,Me=ur?Ye.features[nt].properties:oe?Ye.properties:{},ht=ur?Ye.features[nt].bbox:oe?Ye.bbox:void 0,Wt=ur?Ye.features[nt].id:oe?Ye.id:void 0,ft=Be?Be.type==="GeometryCollection":!1,Ie=ft?Be.geometries.length:1,Ot=0;Ot<Ie;Ot++){if(Re=ft?Be.geometries[Ot]:Be,Re===null){if(Et(null,Qt,Me,ht,Wt)===!1)return!1;continue}switch(Re.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(Et(Re,Qt,Me,ht,Wt)===!1)return!1;break}case"GeometryCollection":{for(Ct=0;Ct<Re.geometries.length;Ct++)if(Et(Re.geometries[Ct],Qt,Me,ht,Wt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Qt++}}function fe(Ye,Et,nt){var Ct=nt;return re(Ye,function(Ot,Re,Ie,Be,ft){Re===0&&nt===void 0?Ct=Ot:Ct=Et(Ct,Ot,Re,Ie,Be,ft)}),Ct}function X(Ye,Et){re(Ye,function(nt,Ct,Ot,Re,Ie){var Be=nt===null?null:nt.type;switch(Be){case null:case"Point":case"LineString":case"Polygon":return Et(x.feature(nt,Ot,{bbox:Re,id:Ie}),Ct,0)===!1?!1:void 0}var ft;switch(Be){case"MultiPoint":ft="Point";break;case"MultiLineString":ft="LineString";break;case"MultiPolygon":ft="Polygon";break}for(var Me=0;Me<nt.coordinates.length;Me++){var ht=nt.coordinates[Me],Wt={type:ft,coordinates:ht};if(Et(x.feature(Wt,Ot),Ct,Me)===!1)return!1}})}function He(Ye,Et,nt){var Ct=nt;return X(Ye,function(Ot,Re,Ie){Re===0&&Ie===0&&nt===void 0?Ct=Ot:Ct=Et(Ct,Ot,Re,Ie)}),Ct}function Xe(Ye,Et){X(Ye,function(nt,Ct,Ot){var Re=0;if(!nt.geometry)return;var Ie=nt.geometry.type;if(Ie==="Point"||Ie==="MultiPoint")return;var Be,ft=0,Me=0,ht=0;if(p(nt,function(Wt,Qt,ur,oe,J){if(Be===void 0||Ct>ft||oe>Me||J>ht){Be=Wt,ft=Ct,Me=oe,ht=J,Re=0;return}var H=x.lineString([Be,Wt],nt.properties);if(Et(H,Ct,Ot,J,Re)===!1)return!1;Re++,Be=Wt})===!1)return!1})}function pe(Ye,Et,nt){var Ct=nt,Ot=!1;return Xe(Ye,function(Re,Ie,Be,ft,Me){Ot===!1&&nt===void 0?Ct=Re:Ct=Et(Ct,Re,Ie,Be,ft,Me),Ot=!0}),Ct}function Ce(Ye,Et){if(!Ye)throw new Error("geojson is required");X(Ye,function(nt,Ct,Ot){if(nt.geometry===null)return;var Re=nt.geometry.type,Ie=nt.geometry.coordinates;switch(Re){case"LineString":if(Et(nt,Ct,Ot,0,0)===!1)return!1;break;case"Polygon":for(var Be=0;Be<Ie.length;Be++)if(Et(x.lineString(Ie[Be],nt.properties),Ct,Ot,Be)===!1)return!1;break}})}function mt(Ye,Et,nt){var Ct=nt;return Ce(Ye,function(Ot,Re,Ie,Be){Re===0&&nt===void 0?Ct=Ot:Ct=Et(Ct,Ot,Re,Ie,Be)}),Ct}function Ne(Ye,Et){if(Et=Et||{},!x.isObject(Et))throw new Error("options is invalid");var nt=Et.featureIndex||0,Ct=Et.multiFeatureIndex||0,Ot=Et.geometryIndex||0,Re=Et.segmentIndex||0,Ie=Et.properties,Be;switch(Ye.type){case"FeatureCollection":nt<0&&(nt=Ye.features.length+nt),Ie=Ie||Ye.features[nt].properties,Be=Ye.features[nt].geometry;break;case"Feature":Ie=Ie||Ye.properties,Be=Ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=Ye;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var ft=Be.coordinates;switch(Be.type){case"Point":case"MultiPoint":return null;case"LineString":return Re<0&&(Re=ft.length+Re-1),x.lineString([ft[Re],ft[Re+1]],Ie,Et);case"Polygon":return Ot<0&&(Ot=ft.length+Ot),Re<0&&(Re=ft[Ot].length+Re-1),x.lineString([ft[Ot][Re],ft[Ot][Re+1]],Ie,Et);case"MultiLineString":return Ct<0&&(Ct=ft.length+Ct),Re<0&&(Re=ft[Ct].length+Re-1),x.lineString([ft[Ct][Re],ft[Ct][Re+1]],Ie,Et);case"MultiPolygon":return Ct<0&&(Ct=ft.length+Ct),Ot<0&&(Ot=ft[Ct].length+Ot),Re<0&&(Re=ft[Ct][Ot].length-Re-1),x.lineString([ft[Ct][Ot][Re],ft[Ct][Ot][Re+1]],Ie,Et)}throw new Error("geojson is invalid")}function At(Ye,Et){if(Et=Et||{},!x.isObject(Et))throw new Error("options is invalid");var nt=Et.featureIndex||0,Ct=Et.multiFeatureIndex||0,Ot=Et.geometryIndex||0,Re=Et.coordIndex||0,Ie=Et.properties,Be;switch(Ye.type){case"FeatureCollection":nt<0&&(nt=Ye.features.length+nt),Ie=Ie||Ye.features[nt].properties,Be=Ye.features[nt].geometry;break;case"Feature":Ie=Ie||Ye.properties,Be=Ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Be=Ye;break;default:throw new Error("geojson is invalid")}if(Be===null)return null;var ft=Be.coordinates;switch(Be.type){case"Point":return x.point(ft,Ie,Et);case"MultiPoint":return Ct<0&&(Ct=ft.length+Ct),x.point(ft[Ct],Ie,Et);case"LineString":return Re<0&&(Re=ft.length+Re),x.point(ft[Re],Ie,Et);case"Polygon":return Ot<0&&(Ot=ft.length+Ot),Re<0&&(Re=ft[Ot].length+Re),x.point(ft[Ot][Re],Ie,Et);case"MultiLineString":return Ct<0&&(Ct=ft.length+Ct),Re<0&&(Re=ft[Ct].length+Re),x.point(ft[Ct][Re],Ie,Et);case"MultiPolygon":return Ct<0&&(Ct=ft.length+Ct),Ot<0&&(Ot=ft[Ct].length+Ot),Re<0&&(Re=ft[Ct][Ot].length-Re),x.point(ft[Ct][Ot][Re],Ie,Et)}throw new Error("geojson is invalid")}_.coordEach=p,_.coordReduce=Y,_.propEach=z,_.propReduce=i,_.featureEach=Z,_.featureReduce=D,_.coordAll=K,_.geomEach=re,_.geomReduce=fe,_.flattenEach=X,_.flattenReduce=He,_.segmentEach=Xe,_.segmentReduce=pe,_.lineEach=Ce,_.lineReduce=mt,_.findSegment=Ne,_.findPoint=At},AGSj:function(Fe,_){},Aljs:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=o("Vkc/");function z(i){return function(Z,D,K){var re=new p.Metadata(x.NAMED_TAG,i);typeof K=="number"?Y.tagParameter(Z,D,K,re):Y.tagProperty(Z,D,re)}}_.named=z},Aq8R:function(Fe,_,o){var x=o("ojxZ"),p=o("p+bC"),Y=o("8RlI"),z="['\u2019]",i=RegExp(z,"g");function Z(D){return function(K){return x(Y(p(K).replace(i,"")),D,"")}}Fe.exports=Z},B5wm:function(Fe,_,o){var x=o("kHJI"),p=o("SSN4");function Y(z){return p(z)&&x(z)}Fe.exports=Y},BLox:function(Fe,_,o){(function(x,p){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Y;(function(z){(function(i){var Z=typeof p=="object"?p:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=K(z);typeof Z.Reflect=="undefined"?Z.Reflect=z:D=K(Z.Reflect,D),i(D);function K(re,fe){return function(X,He){typeof re[X]!="function"&&Object.defineProperty(re,X,{configurable:!0,writable:!0,value:He}),fe&&fe(X,He)}}})(function(i){var Z=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",K=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",re=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",fe=typeof Object.create=="function",X={__proto__:[]}instanceof Array,He=!fe&&!X,Xe={create:fe?function(){return pr(Object.create(null))}:X?function(){return pr({__proto__:null})}:function(){return pr({})},has:He?function(Ke,bt){return Z.call(Ke,bt)}:function(Ke,bt){return bt in Ke},get:He?function(Ke,bt){return Z.call(Ke,bt)?Ke[bt]:void 0}:function(Ke,bt){return Ke[bt]}},pe=Object.getPrototypeOf(Function),Ce=typeof x=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",mt=!Ce&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ae(),Ne=!Ce&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),At=!Ce&&typeof WeakMap=="function"?WeakMap:kt(),Ye=new At;function Et(Ke,bt,yt,xt){if(qt(yt)){if(!R(Ke))throw new TypeError;if(!ce(bt))throw new TypeError;return Wt(Ke,bt)}else{if(!R(Ke))throw new TypeError;if(!ge(bt))throw new TypeError;if(!ge(xt)&&!qt(xt)&&!Pt(xt))throw new TypeError;return Pt(xt)&&(xt=void 0),yt=C(yt),Qt(Ke,bt,yt,xt)}}i("decorate",Et);function nt(Ke,bt){function yt(xt,ze){if(!ge(xt))throw new TypeError;if(!qt(ze)&&!Ge(ze))throw new TypeError;be(Ke,bt,xt,ze)}return yt}i("metadata",nt);function Ct(Ke,bt,yt,xt){if(!ge(yt))throw new TypeError;return qt(xt)||(xt=C(xt)),be(Ke,bt,yt,xt)}i("defineMetadata",Ct);function Ot(Ke,bt,yt){if(!ge(bt))throw new TypeError;return qt(yt)||(yt=C(yt)),oe(Ke,bt,yt)}i("hasMetadata",Ot);function Re(Ke,bt,yt){if(!ge(bt))throw new TypeError;return qt(yt)||(yt=C(yt)),J(Ke,bt,yt)}i("hasOwnMetadata",Re);function Ie(Ke,bt,yt){if(!ge(bt))throw new TypeError;return qt(yt)||(yt=C(yt)),H(Ke,bt,yt)}i("getMetadata",Ie);function Be(Ke,bt,yt){if(!ge(bt))throw new TypeError;return qt(yt)||(yt=C(yt)),Se(Ke,bt,yt)}i("getOwnMetadata",Be);function ft(Ke,bt){if(!ge(Ke))throw new TypeError;return qt(bt)||(bt=C(bt)),_e(Ke,bt)}i("getMetadataKeys",ft);function Me(Ke,bt){if(!ge(Ke))throw new TypeError;return qt(bt)||(bt=C(bt)),me(Ke,bt)}i("getOwnMetadataKeys",Me);function ht(Ke,bt,yt){if(!ge(bt))throw new TypeError;qt(yt)||(yt=C(yt));var xt=ur(bt,yt,!1);if(qt(xt))return!1;if(!xt.delete(Ke))return!1;if(xt.size>0)return!0;var ze=Ye.get(bt);return ze.delete(yt),ze.size>0||Ye.delete(bt),!0}i("deleteMetadata",ht);function Wt(Ke,bt){for(var yt=Ke.length-1;yt>=0;--yt){var xt=Ke[yt],ze=xt(bt);if(!qt(ze)&&!Pt(ze)){if(!ce(ze))throw new TypeError;bt=ze}}return bt}function Qt(Ke,bt,yt,xt){for(var ze=Ke.length-1;ze>=0;--ze){var dt=Ke[ze],gt=dt(bt,yt,xt);if(!qt(gt)&&!Pt(gt)){if(!ge(gt))throw new TypeError;xt=gt}}return xt}function ur(Ke,bt,yt){var xt=Ye.get(Ke);if(qt(xt)){if(!yt)return;xt=new mt,Ye.set(Ke,xt)}var ze=xt.get(bt);if(qt(ze)){if(!yt)return;ze=new mt,xt.set(bt,ze)}return ze}function oe(Ke,bt,yt){var xt=J(Ke,bt,yt);if(xt)return!0;var ze=Qe(bt);return Pt(ze)?!1:oe(Ke,ze,yt)}function J(Ke,bt,yt){var xt=ur(bt,yt,!1);return qt(xt)?!1:Oe(xt.has(Ke))}function H(Ke,bt,yt){var xt=J(Ke,bt,yt);if(xt)return Se(Ke,bt,yt);var ze=Qe(bt);return Pt(ze)?void 0:H(Ke,ze,yt)}function Se(Ke,bt,yt){var xt=ur(bt,yt,!1);return qt(xt)?void 0:xt.get(Ke)}function be(Ke,bt,yt,xt){var ze=ur(yt,xt,!0);ze.set(Ke,bt)}function _e(Ke,bt){var yt=me(Ke,bt),xt=Qe(Ke);if(xt===null)return yt;var ze=_e(xt,bt);if(ze.length<=0)return yt;if(yt.length<=0)return ze;for(var dt=new Ne,gt=[],Ht=0,hr=yt;Ht<hr.length;Ht++){var Zr=hr[Ht],yr=dt.has(Zr);yr||(dt.add(Zr),gt.push(Zr))}for(var Vn=0,Fn=ze;Vn<Fn.length;Vn++){var Zr=Fn[Vn],yr=dt.has(Zr);yr||(dt.add(Zr),gt.push(Zr))}return gt}function me(Ke,bt){var yt=[],xt=ur(Ke,bt,!1);if(qt(xt))return yt;for(var ze=xt.keys(),dt=Tt(ze),gt=0;;){var Ht=Ut(dt);if(!Ht)return yt.length=gt,yt;var hr=ot(Ht);try{yt[gt]=hr}catch(Zr){try{$(dt)}finally{throw Zr}}gt++}}function it(Ke){if(Ke===null)return 1;switch(typeof Ke){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ke===null?1:6;default:return 6}}function qt(Ke){return Ke===void 0}function Pt(Ke){return Ke===null}function ve(Ke){return typeof Ke=="symbol"}function ge(Ke){return typeof Ke=="object"?Ke!==null:typeof Ke=="function"}function Ve(Ke,bt){switch(it(Ke)){case 0:return Ke;case 1:return Ke;case 2:return Ke;case 3:return Ke;case 4:return Ke;case 5:return Ke}var yt=bt===3?"string":bt===5?"number":"default",xt=qe(Ke,K);if(xt!==void 0){var ze=xt.call(Ke,yt);if(ge(ze))throw new TypeError;return ze}return st(Ke,yt==="default"?"number":yt)}function st(Ke,bt){if(bt==="string"){var yt=Ke.toString;if(q(yt)){var xt=yt.call(Ke);if(!ge(xt))return xt}var ze=Ke.valueOf;if(q(ze)){var xt=ze.call(Ke);if(!ge(xt))return xt}}else{var ze=Ke.valueOf;if(q(ze)){var xt=ze.call(Ke);if(!ge(xt))return xt}var dt=Ke.toString;if(q(dt)){var xt=dt.call(Ke);if(!ge(xt))return xt}}throw new TypeError}function Oe(Ke){return!!Ke}function vt(Ke){return""+Ke}function C(Ke){var bt=Ve(Ke,3);return ve(bt)?bt:vt(bt)}function R(Ke){return Array.isArray?Array.isArray(Ke):Ke instanceof Object?Ke instanceof Array:Object.prototype.toString.call(Ke)==="[object Array]"}function q(Ke){return typeof Ke=="function"}function ce(Ke){return typeof Ke=="function"}function Ge(Ke){switch(it(Ke)){case 3:return!0;case 4:return!0;default:return!1}}function qe(Ke,bt){var yt=Ke[bt];if(yt==null)return;if(!q(yt))throw new TypeError;return yt}function Tt(Ke){var bt=qe(Ke,re);if(!q(bt))throw new TypeError;var yt=bt.call(Ke);if(!ge(yt))throw new TypeError;return yt}function ot(Ke){return Ke.value}function Ut(Ke){var bt=Ke.next();return bt.done?!1:bt}function $(Ke){var bt=Ke.return;bt&&bt.call(Ke)}function Qe(Ke){var bt=Object.getPrototypeOf(Ke);if(typeof Ke!="function"||Ke===pe)return bt;if(bt!==pe)return bt;var yt=Ke.prototype,xt=yt&&Object.getPrototypeOf(yt);if(xt==null||xt===Object.prototype)return bt;var ze=xt.constructor;return typeof ze!="function"||ze===Ke?bt:ze}function ae(){var Ke={},bt=[],yt=function(){function gt(Ht,hr,Zr){this._index=0,this._keys=Ht,this._values=hr,this._selector=Zr}return gt.prototype["@@iterator"]=function(){return this},gt.prototype[re]=function(){return this},gt.prototype.next=function(){var Ht=this._index;if(Ht>=0&&Ht<this._keys.length){var hr=this._selector(this._keys[Ht],this._values[Ht]);return Ht+1>=this._keys.length?(this._index=-1,this._keys=bt,this._values=bt):this._index++,{value:hr,done:!1}}return{value:void 0,done:!0}},gt.prototype.throw=function(Ht){throw this._index>=0&&(this._index=-1,this._keys=bt,this._values=bt),Ht},gt.prototype.return=function(Ht){return this._index>=0&&(this._index=-1,this._keys=bt,this._values=bt),{value:Ht,done:!0}},gt}();return function(){function gt(){this._keys=[],this._values=[],this._cacheKey=Ke,this._cacheIndex=-2}return Object.defineProperty(gt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),gt.prototype.has=function(Ht){return this._find(Ht,!1)>=0},gt.prototype.get=function(Ht){var hr=this._find(Ht,!1);return hr>=0?this._values[hr]:void 0},gt.prototype.set=function(Ht,hr){var Zr=this._find(Ht,!0);return this._values[Zr]=hr,this},gt.prototype.delete=function(Ht){var hr=this._find(Ht,!1);if(hr>=0){for(var Zr=this._keys.length,yr=hr+1;yr<Zr;yr++)this._keys[yr-1]=this._keys[yr],this._values[yr-1]=this._values[yr];return this._keys.length--,this._values.length--,Ht===this._cacheKey&&(this._cacheKey=Ke,this._cacheIndex=-2),!0}return!1},gt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ke,this._cacheIndex=-2},gt.prototype.keys=function(){return new yt(this._keys,this._values,xt)},gt.prototype.values=function(){return new yt(this._keys,this._values,ze)},gt.prototype.entries=function(){return new yt(this._keys,this._values,dt)},gt.prototype["@@iterator"]=function(){return this.entries()},gt.prototype[re]=function(){return this.entries()},gt.prototype._find=function(Ht,hr){return this._cacheKey!==Ht&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ht)),this._cacheIndex<0&&hr&&(this._cacheIndex=this._keys.length,this._keys.push(Ht),this._values.push(void 0)),this._cacheIndex},gt}();function xt(gt,Ht){return gt}function ze(gt,Ht){return Ht}function dt(gt,Ht){return[gt,Ht]}}function et(){return function(){function Ke(){this._map=new mt}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ke.prototype.has=function(bt){return this._map.has(bt)},Ke.prototype.add=function(bt){return this._map.set(bt,bt),this},Ke.prototype.delete=function(bt){return this._map.delete(bt)},Ke.prototype.clear=function(){this._map.clear()},Ke.prototype.keys=function(){return this._map.keys()},Ke.prototype.values=function(){return this._map.values()},Ke.prototype.entries=function(){return this._map.entries()},Ke.prototype["@@iterator"]=function(){return this.keys()},Ke.prototype[re]=function(){return this.keys()},Ke}()}function kt(){var Ke=16,bt=Xe.create(),yt=xt();return function(){function hr(){this._key=xt()}return hr.prototype.has=function(Zr){var yr=ze(Zr,!1);return yr!==void 0?Xe.has(yr,this._key):!1},hr.prototype.get=function(Zr){var yr=ze(Zr,!1);return yr!==void 0?Xe.get(yr,this._key):void 0},hr.prototype.set=function(Zr,yr){var Vn=ze(Zr,!0);return Vn[this._key]=yr,this},hr.prototype.delete=function(Zr){var yr=ze(Zr,!1);return yr!==void 0?delete yr[this._key]:!1},hr.prototype.clear=function(){this._key=xt()},hr}();function xt(){var hr;do hr="@@WeakMap@@"+Ht();while(Xe.has(bt,hr));return bt[hr]=!0,hr}function ze(hr,Zr){if(!Z.call(hr,yt)){if(!Zr)return;Object.defineProperty(hr,yt,{value:Xe.create()})}return hr[yt]}function dt(hr,Zr){for(var yr=0;yr<Zr;++yr)hr[yr]=Math.random()*255|0;return hr}function gt(hr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(hr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(hr)):dt(new Uint8Array(hr),hr):dt(new Array(hr),hr)}function Ht(){var hr=gt(Ke);hr[6]=hr[6]&79|64,hr[8]=hr[8]&191|128;for(var Zr="",yr=0;yr<Ke;++yr){var Vn=hr[yr];(yr===4||yr===6||yr===8)&&(Zr+="-"),Vn<16&&(Zr+="0"),Zr+=Vn.toString(16).toLowerCase()}return Zr}}function pr(Ke){return Ke.__=void 0,delete Ke.__,Ke}})})(Y||(Y={}))}).call(this,o("7vYp"),o("UywP"))},BTtX:function(Fe,_,o){var x=o("Mvxd"),p=o("fOlB"),Y=o("TIBF"),z=o("v4o2"),i=o("+Dft"),Z=o("H3Ql"),D=200;function K(re,fe,X){var He=-1,Xe=p,pe=re.length,Ce=!0,mt=[],Ne=mt;if(X)Ce=!1,Xe=Y;else if(pe>=D){var At=fe?null:i(re);if(At)return Z(At);Ce=!1,Xe=z,Ne=new x}else Ne=fe?[]:mt;e:for(;++He<pe;){var Ye=re[He],Et=fe?fe(Ye):Ye;if(Ye=X||Ye!==0?Ye:0,Ce&&Et===Et){for(var nt=Ne.length;nt--;)if(Ne[nt]===Et)continue e;fe&&Ne.push(Et),mt.push(Ye)}else Xe(Ne,Et,X)||(Ne!==mt&&Ne.push(Et),mt.push(Ye))}return mt}Fe.exports=K},BbNA:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=Symbol.for("INJECTION");function p(D,K,re,fe){function X(){return fe&&!Reflect.hasMetadata(x,this,K)&&Reflect.defineMetadata(x,re(),this,K),Reflect.hasMetadata(x,this,K)?Reflect.getMetadata(x,this,K):re()}function He(Xe){Reflect.defineMetadata(x,Xe,this,K)}Object.defineProperty(D,K,{configurable:!0,enumerable:!0,get:X,set:He})}function Y(D,K){return function(re){return function(fe,X){var He=function(){return D.get(re)};p(fe,X,He,K)}}}_.makePropertyInjectDecorator=Y;function z(D,K){return function(re,fe){return function(X,He){var Xe=function(){return D.getNamed(re,fe)};p(X,He,Xe,K)}}}_.makePropertyInjectNamedDecorator=z;function i(D,K){return function(re,fe,X){return function(He,Xe){var pe=function(){return D.getTagged(re,fe,X)};p(He,Xe,pe,K)}}}_.makePropertyInjectTaggedDecorator=i;function Z(D,K){return function(re){return function(fe,X){var He=function(){return D.getAll(re)};p(fe,X,He,K)}}}_.makePropertyMultiInjectDecorator=Z},BeS3:function(Fe,_){function o(x,p,Y){var z=-1,i=x.length;p<0&&(p=-p>i?0:i+p),Y=Y>i?i:Y,Y<0&&(Y+=i),i=p>Y?0:Y-p>>>0,p>>>=0;for(var Z=Array(i);++z<i;)Z[z]=x[z+p];return Z}Fe.exports=o},CC9Y:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("/jsB"),Y=o("Vrkw"),z=o("Vkc/"),i=function(){function D(K){this._cb=K}return D.prototype.unwrap=function(){return this._cb()},D}();_.LazyServiceIdentifer=i;function Z(D){return function(K,re,fe){if(D===void 0)throw new Error(x.UNDEFINED_INJECT_ANNOTATION(K.name));var X=new Y.Metadata(p.INJECT_TAG,D);typeof fe=="number"?z.tagParameter(K,re,fe,X):z.tagProperty(K,re,X)}}_.inject=Z},"CD4/":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("7s3S"),p=o("hSzU"),Y=function(){function z(i){this._binding=i}return z.prototype.inRequestScope=function(){return this._binding.scope=x.BindingScopeEnum.Request,new p.BindingWhenOnSyntax(this._binding)},z.prototype.inSingletonScope=function(){return this._binding.scope=x.BindingScopeEnum.Singleton,new p.BindingWhenOnSyntax(this._binding)},z.prototype.inTransientScope=function(){return this._binding.scope=x.BindingScopeEnum.Transient,new p.BindingWhenOnSyntax(this._binding)},z}();_.BindingInSyntax=Y},COyS:function(Fe,_){},CUEQ:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=o("Vkc/");function z(){return function(i,Z,D){var K=new p.Metadata(x.OPTIONAL_TAG,!0);typeof D=="number"?Y.tagParameter(i,Z,D,K):Y.tagProperty(i,Z,K)}}_.optional=z},Cv2u:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E");function p(Y){return Y instanceof RangeError||Y.message===x.STACK_OVERFLOW}_.isStackOverflowExeption=p},"D/gB":function(Fe,_){function o(x){return Function.toString.call(x).indexOf("[native code]")!==-1}Fe.exports=o},D6nA:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("9R00"),p=o("VTKP"),Y=function(){function z(i){this._binding=i}return z.prototype.when=function(i){return this._binding.constraint=i,new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetNamed=function(i){return this._binding.constraint=p.namedConstraint(i),new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(i){var Z=i.target!==null&&!i.target.isNamed()&&!i.target.isTagged();return Z},new x.BindingOnSyntax(this._binding)},z.prototype.whenTargetTagged=function(i,Z){return this._binding.constraint=p.taggedConstraint(i)(Z),new x.BindingOnSyntax(this._binding)},z.prototype.whenInjectedInto=function(i){return this._binding.constraint=function(Z){return p.typeConstraint(i)(Z.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenParentNamed=function(i){return this._binding.constraint=function(Z){return p.namedConstraint(i)(Z.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenParentTagged=function(i,Z){return this._binding.constraint=function(D){return p.taggedConstraint(i)(Z)(D.parentRequest)},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorIs=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,p.typeConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorIs=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,p.typeConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorNamed=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,p.namedConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorNamed=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,p.namedConstraint(i))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return p.traverseAncerstors(D,p.taggedConstraint(i)(Z))},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return!p.traverseAncerstors(D,p.taggedConstraint(i)(Z))},new x.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorMatches=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,i)},new x.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorMatches=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,i)},new x.BindingOnSyntax(this._binding)},z}();_.BindingWhenSyntax=Y},DAVx:function(Fe,_,o){"use strict";o.d(_,"a",function(){return p});var x=o("LhPA");function p(z,i){var Z=i.extent,D=new Promise(function(re){Y(z,function(fe){re(fe)})}),K={images:D,_id:1,dataArray:[{_id:0,coordinates:[[Z[0],Z[1]],[Z[2],Z[3]]]}]};return K}function Y(z,i){var Z=z,D=[];if(typeof Z=="string")Object(x.o)({url:Z},function(fe,X){D.push(X),i(D)});else{var K=Z.length,re=0;Z.forEach(function(fe){Object(x.o)({url:fe},function(X,He){re++,D.push(He),re===K&&i(D)})})}return p}},DTuh:function(Fe,_,o){var x=o("d55j"),p=o("a+hL");function Y(z,i){return z&&x(i,p(i),z)}Fe.exports=Y},DXzO:function(Fe,_){function o(x,p){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Fe.exports=o},"Dr/i":function(Fe,_,o){var x=o("mt6U"),p=o("8enF");function Y(z){return x(function(i,Z){var D=-1,K=Z.length,re=K>1?Z[K-1]:void 0,fe=K>2?Z[2]:void 0;for(re=z.length>3&&typeof re=="function"?(K--,re):void 0,fe&&p(Z[0],Z[1],fe)&&(re=K<3?void 0:re,K=1),i=Object(i);++D<K;){var X=Z[D];X&&z(i,X,D,re)}return i})}Fe.exports=Y},"E6G/":function(Fe,_,o){var x=o("ORxg"),p=o("0326"),Y=o("6Q7i"),z=o("xrLW");function i(Z,D,K){Z=z(Z),D=Y(D);var re=D?p(Z):0;return D&&re<D?Z+x(D-re,K):Z}Fe.exports=i},FTvH:function(Fe,_,o){"use strict";var x=o("cxjn");o.o(x,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return x.CityBuildingLayer}),o.o(x,"Control")&&o.d(_,"Control",function(){return x.Control}),o.o(x,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return x.HeatmapLayer}),o.o(x,"ImageLayer")&&o.d(_,"ImageLayer",function(){return x.ImageLayer}),o.o(x,"LineLayer")&&o.d(_,"LineLayer",function(){return x.LineLayer}),o.o(x,"Logo")&&o.d(_,"Logo",function(){return x.Logo}),o.o(x,"Marker")&&o.d(_,"Marker",function(){return x.Marker}),o.o(x,"PointLayer")&&o.d(_,"PointLayer",function(){return x.PointLayer}),o.o(x,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return x.PolygonLayer}),o.o(x,"Popup")&&o.d(_,"Popup",function(){return x.Popup}),o.o(x,"RasterLayer")&&o.d(_,"RasterLayer",function(){return x.RasterLayer}),o.o(x,"Scale")&&o.d(_,"Scale",function(){return x.Scale}),o.o(x,"Scene")&&o.d(_,"Scene",function(){return x.Scene}),o.o(x,"Zoom")&&o.d(_,"Zoom",function(){return x.Zoom});var p=o("/e4g");o.d(_,"Scene",function(){return p.a});var Y=o("pXiX");o.d(_,"CityBuildingLayer",function(){return Y.a}),o.d(_,"HeatmapLayer",function(){return Y.b}),o.d(_,"ImageLayer",function(){return Y.c}),o.d(_,"LineLayer",function(){return Y.d}),o.d(_,"PointLayer",function(){return Y.e}),o.d(_,"PolygonLayer",function(){return Y.f}),o.d(_,"RasterLayer",function(){return Y.g});var z=o("nSSz");o.d(_,"Control",function(){return z.a}),o.d(_,"Logo",function(){return z.b}),o.d(_,"Marker",function(){return z.c}),o.d(_,"Popup",function(){return z.d}),o.d(_,"Scale",function(){return z.e}),o.d(_,"Zoom",function(){return z.f});var i=o("LhPA"),Z=o("1oef")},FZ1S:function(Fe,_,o){var x=o("d55j"),p=o("wndA");function Y(z,i){return z&&x(i,p(i),z)}Fe.exports=Y},GfBb:function(Fe,_,o){"use strict";o.d(_,"a",function(){return Et}),o.d(_,"b",function(){return Re});var x=function(J,H,Se){J.prototype=H.prototype=Se,Se.constructor=J};function p(J,H){var Se=Object.create(J.prototype);for(var be in H)Se[be]=H[be];return Se}function Y(){}var z=.7,i=1/z,Z="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",re=/^#([0-9a-f]{3,8})$/,fe=new RegExp("^rgb\\("+[Z,Z,Z]+"\\)$"),X=new RegExp("^rgb\\("+[K,K,K]+"\\)$"),He=new RegExp("^rgba\\("+[Z,Z,Z,D]+"\\)$"),Xe=new RegExp("^rgba\\("+[K,K,K,D]+"\\)$"),pe=new RegExp("^hsl\\("+[D,K,K]+"\\)$"),Ce=new RegExp("^hsla\\("+[D,K,K,D]+"\\)$"),mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};x(Y,Et,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:Ne,formatHex:Ne,formatHsl:At,formatRgb:Ye,toString:Ye});function Ne(){return this.rgb().formatHex()}function At(){return Wt(this).formatHsl()}function Ye(){return this.rgb().formatRgb()}function Et(J){var H,Se;return J=(J+"").trim().toLowerCase(),(H=re.exec(J))?(Se=H[1].length,H=parseInt(H[1],16),Se===6?nt(H):Se===3?new Ie(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Se===8?Ct(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Se===4?Ct(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=fe.exec(J))?new Ie(H[1],H[2],H[3],1):(H=X.exec(J))?new Ie(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=He.exec(J))?Ct(H[1],H[2],H[3],H[4]):(H=Xe.exec(J))?Ct(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=pe.exec(J))?ht(H[1],H[2]/100,H[3]/100,1):(H=Ce.exec(J))?ht(H[1],H[2]/100,H[3]/100,H[4]):mt.hasOwnProperty(J)?nt(mt[J]):J==="transparent"?new Ie(NaN,NaN,NaN,0):null}function nt(J){return new Ie(J>>16&255,J>>8&255,J&255,1)}function Ct(J,H,Se,be){return be<=0&&(J=H=Se=NaN),new Ie(J,H,Se,be)}function Ot(J){return J instanceof Y||(J=Et(J)),J?(J=J.rgb(),new Ie(J.r,J.g,J.b,J.opacity)):new Ie}function Re(J,H,Se,be){return arguments.length===1?Ot(J):new Ie(J,H,Se,be==null?1:be)}function Ie(J,H,Se,be){this.r=+J,this.g=+H,this.b=+Se,this.opacity=+be}x(Ie,Re,p(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new Ie(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new Ie(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Be,formatHex:Be,formatRgb:ft,toString:ft}));function Be(){return"#"+Me(this.r)+Me(this.g)+Me(this.b)}function ft(){var J=this.opacity;return J=isNaN(J)?1:Math.max(0,Math.min(1,J)),(J===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(J===1?")":", "+J+")")}function Me(J){return J=Math.max(0,Math.min(255,Math.round(J)||0)),(J<16?"0":"")+J.toString(16)}function ht(J,H,Se,be){return be<=0?J=H=Se=NaN:Se<=0||Se>=1?J=H=NaN:H<=0&&(J=NaN),new ur(J,H,Se,be)}function Wt(J){if(J instanceof ur)return new ur(J.h,J.s,J.l,J.opacity);if(J instanceof Y||(J=Et(J)),!J)return new ur;if(J instanceof ur)return J;J=J.rgb();var H=J.r/255,Se=J.g/255,be=J.b/255,_e=Math.min(H,Se,be),me=Math.max(H,Se,be),it=NaN,qt=me-_e,Pt=(me+_e)/2;return qt?(H===me?it=(Se-be)/qt+(Se<be)*6:Se===me?it=(be-H)/qt+2:it=(H-Se)/qt+4,qt/=Pt<.5?me+_e:2-me-_e,it*=60):qt=Pt>0&&Pt<1?0:it,new ur(it,qt,Pt,J.opacity)}function Qt(J,H,Se,be){return arguments.length===1?Wt(J):new ur(J,H,Se,be==null?1:be)}function ur(J,H,Se,be){this.h=+J,this.s=+H,this.l=+Se,this.opacity=+be}x(ur,Qt,p(Y,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new ur(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new ur(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Se=isNaN(H)||isNaN(this.s)?0:this.s,be=this.l,_e=be+(be<.5?be:1-be)*Se,me=2*be-_e;return new Ie(oe(H>=240?H-240:H+120,me,_e),oe(H,me,_e),oe(H<120?H+240:H-120,me,_e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe(J,H,Se){return(J<60?H+(Se-H)*J/60:J<180?Se:J<240?H+(Se-H)*(240-J)/60:H)*255}},HPW9:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=function(){function Y(){this._map=new Map}return Y.prototype.getMap=function(){return this._map},Y.prototype.add=function(z,i){if(z==null)throw new Error(x.NULL_ARGUMENT);if(i==null)throw new Error(x.NULL_ARGUMENT);var Z=this._map.get(z);Z!==void 0?(Z.push(i),this._map.set(z,Z)):this._map.set(z,[i])},Y.prototype.get=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);var i=this._map.get(z);if(i!==void 0)return i;throw new Error(x.KEY_NOT_FOUND)},Y.prototype.remove=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);if(!this._map.delete(z))throw new Error(x.KEY_NOT_FOUND)},Y.prototype.removeByCondition=function(z){var i=this;this._map.forEach(function(Z,D){var K=Z.filter(function(re){return!z(re)});K.length>0?i._map.set(D,K):i._map.delete(D)})},Y.prototype.hasKey=function(z){if(z==null)throw new Error(x.NULL_ARGUMENT);return this._map.has(z)},Y.prototype.clone=function(){var z=new Y;return this._map.forEach(function(i,Z){i.forEach(function(D){return z.add(Z,D.clone())})}),z},Y.prototype.traverse=function(z){this._map.forEach(function(i,Z){z(Z,i)})},Y}();_.Lookup=p},HcOL:function(Fe,_){var o=9007199254740991,x=Math.floor;function p(Y,z){var i="";if(!Y||z<1||z>o)return i;do z%2&&(i+=Y),z=x(z/2),z&&(Y+=Y);while(z);return i}Fe.exports=p},"IT+u":function(Fe,_,o){"use strict";var x=o("W+Pn"),p=o("Sx2N"),Y=o("xwgP"),z=o.n(Y),i=o("iczh"),Z=o.n(i),D=o("5oCn"),K=function(X){var He=Object(Y.useContext)(D.a),Xe=X.children,pe=X.contentWidth,Ce=X.className,mt=X.style,Ne=Object(Y.useContext)(p.b.ConfigContext),At=Ne.getPrefixCls,Ye=X.prefixCls||At("pro"),Et=pe||He.contentWidth,nt="".concat(Ye,"-grid-content");return z.a.createElement("div",{className:Z()(nt,Ce,{wide:Et==="Fixed"}),style:mt},z.a.createElement("div",{className:"".concat(Ye,"-grid-content-children")},Xe))},re=_.a=K},ITHy:function(Fe,_,o){var x=o("Xpbd"),p=o("PPmI"),Y=o("wooT"),z=o("DStm"),i=Object.getOwnPropertySymbols,Z=i?function(D){for(var K=[];D;)x(K,Y(D)),D=p(D);return K}:z;Fe.exports=Z},"J+x/":function(Fe,_){},JArH:function(Fe,_,o){var x=o("jBg4"),p=o("pygv"),Y=o("iz/G"),z=o("feRE"),i=1/0,Z=x?x.prototype:void 0,D=Z?Z.toString:void 0;function K(re){if(typeof re=="string")return re;if(Y(re))return p(re,K)+"";if(z(re))return D?D.call(re):"";var fe=re+"";return fe=="0"&&1/re==-i?"-0":fe}Fe.exports=K},"JCi/":function(Fe,_){},JXKY:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x;(function(p){p.normal="normal",p.additive="additive",p.subtractive="subtractive",p.min="min",p.max="max",p.none="none"})(x||(x={}))},"Jdr+":function(Fe,_,o){var x=o("q2Nz"),p=o("MRi+"),Y=o("wHDA"),z=o("VQDY"),i=o("vG7H"),Z=o("FcS3"),D=o("iz/G"),K=o("B5wm"),re=o("Gv+9"),fe=o("33CM"),X=o("gteZ"),He=o("5RAj"),Xe=o("tuRO"),pe=o("obOy"),Ce=o("ofY/");function mt(Ne,At,Ye,Et,nt,Ct,Ot){var Re=pe(Ne,Ye),Ie=pe(At,Ye),Be=Ot.get(Ie);if(Be){x(Ne,Ye,Be);return}var ft=Ct?Ct(Re,Ie,Ye+"",Ne,At,Ot):void 0,Me=ft===void 0;if(Me){var ht=D(Ie),Wt=!ht&&re(Ie),Qt=!ht&&!Wt&&Xe(Ie);ft=Ie,ht||Wt||Qt?D(Re)?ft=Re:K(Re)?ft=z(Re):Wt?(Me=!1,ft=p(Ie,!0)):Qt?(Me=!1,ft=Y(Ie,!0)):ft=[]:He(Ie)||Z(Ie)?(ft=Re,Z(Re)?ft=Ce(Re):(!X(Re)||fe(Re))&&(ft=i(Ie))):Me=!1}Me&&(Ot.set(Ie,ft),nt(ft,Ie,Et,Ct,Ot),Ot.delete(Ie)),x(Ne,Ye,ft)}Fe.exports=mt},Jo4Q:function(Fe,_,o){var x=o("by6o");function p(Y,z){for(;!Object.prototype.hasOwnProperty.call(Y,z)&&!(Y=x(Y),Y===null););return Y}Fe.exports=p},"KgZ/":function(Fe,_,o){var x=o("Vfe6");Fe.exports=p;function p(K,re){switch(K&&K.type||null){case"FeatureCollection":return K.features=K.features.map(Y(p,re)),K;case"GeometryCollection":return K.geometries=K.geometries.map(Y(p,re)),K;case"Feature":return K.geometry=p(K.geometry,re),K;case"Polygon":case"MultiPolygon":return z(K,re);default:return K}}function Y(K,re){return function(fe){return K(fe,re)}}function z(K,re){return K.type==="Polygon"?K.coordinates=i(K.coordinates,re):K.type==="MultiPolygon"&&(K.coordinates=K.coordinates.map(Y(i,re))),K}function i(K,re){re=!!re,K[0]=Z(K[0],re);for(var fe=1;fe<K.length;fe++)K[fe]=Z(K[fe],!re);return K}function Z(K,re){return D(K)===re?K:K.reverse()}function D(K){return x.ring(K)>=0}},"LDg+":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=o("Vkc/");function z(i){return function(Z,D,K){var re=new p.Metadata(x.NAME_TAG,i);Y.tagParameter(Z,D,K,re)}}_.targetName=z},Lcph:function(Fe,_,o){var x=o("d55j"),p=o("ITHy");function Y(z,i){return x(z,p(z),i)}Fe.exports=Y},LhK6:function(Fe,_,o){var x=o("gteZ"),p=o("wCGl"),Y=o("eaIJ"),z=Object.prototype,i=z.hasOwnProperty;function Z(D){if(!x(D))return Y(D);var K=p(D),re=[];for(var fe in D)fe=="constructor"&&(K||!i.call(D,fe))||re.push(fe);return re}Fe.exports=Z},LhPA:function(Fe,_,o){"use strict";o.d(_,"o",function(){return Pt}),o.d(_,"m",function(){return Oe}),o.d(_,"p",function(){return q}),o.d(_,"d",function(){return ot}),o.d(_,"q",function(){return $}),o.d(_,"r",function(){return ae}),o.d(_,"j",function(){return et}),o.d(_,"h",function(){return kt}),o.d(_,"b",function(){return pr}),o.d(_,"i",function(){return Ke}),o.d(_,"s",function(){return yt}),o.d(_,"k",function(){return xt}),o.d(_,"l",function(){return ze}),o.d(_,"n",function(){return dt}),o.d(_,"f",function(){return gt}),o.d(_,"e",function(){return Ht}),o.d(_,"g",function(){return hr}),o.d(_,"a",function(){return x}),o.d(_,"c",function(){return p});var x={};o.r(x),o.d(x,"getContainer",function(){return Z}),o.d(x,"trim",function(){return D}),o.d(x,"splitWords",function(){return K}),o.d(x,"create",function(){return fe}),o.d(x,"remove",function(){return X}),o.d(x,"addClass",function(){return He}),o.d(x,"removeClass",function(){return Xe}),o.d(x,"hasClass",function(){return pe}),o.d(x,"setClass",function(){return Ce}),o.d(x,"getClass",function(){return mt}),o.d(x,"empty",function(){return Ne}),o.d(x,"setTransform",function(){return Ye}),o.d(x,"triggerResize",function(){return Et}),o.d(x,"printCanvas",function(){return nt});var p={};o.r(p),o.d(p,"sum",function(){return Vn}),o.d(p,"max",function(){return Zr}),o.d(p,"min",function(){return yr}),o.d(p,"mean",function(){return Fn}),o.d(p,"mode",function(){return oa}),o.d(p,"statMap",function(){return $n}),o.d(p,"getColumn",function(){return Kn}),o.d(p,"getSatByColumn",function(){return Cn});function Y(F){var W=131,le=137,xe=0;F+="x";for(var ut=Math.floor(9007199254740991/le),wt=0;wt<F.length;wt++)xe>ut&&(xe=Math.floor(xe/le)),xe=xe*W+F.charCodeAt(wt);return xe}function z(F){F=F.toString();for(var W=5381,le=F.length;le;)W=W*33^F.charCodeAt(--le);return W>>>0}var i=window.document.documentElement.style;function Z(F){var W=F;return typeof F=="string"&&(W=document.getElementById(F)),W}function D(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function K(F){return D(F).split(/\s+/)}function re(F){if(!i)return F[0];for(var W in F)if(F[W]&&F[W]in i)return F[W];return F[0]}function fe(F,W,le){var xe=document.createElement(F);return xe.className=W||"",le&&le.appendChild(xe),xe}function X(F){var W=F.parentNode;W&&W.removeChild(F)}function He(F,W){if(F.classList!==void 0)for(var le=K(W),xe=0,ut=le.length;xe<ut;xe++)F.classList.add(le[xe]);else if(!pe(F,W)){var wt=mt(F);Ce(F,(wt?wt+" ":"")+W)}}function Xe(F,W){F.classList!==void 0?F.classList.remove(W):Ce(F,D((" "+mt(F)+" ").replace(" "+W+" "," ")))}function pe(F,W){if(F.classList!==void 0)return F.classList.contains(W);var le=mt(F);return le.length>0&&new RegExp("(^|\\s)"+W+"(\\s|$)").test(le)}function Ce(F,W){F instanceof HTMLElement?F.className=W:F.className.baseVal=W}function mt(F){return F instanceof SVGElement&&(F=F.correspondingElement),F.className.baseVal===void 0?F.className:F.className.baseVal}function Ne(F){for(;F&&F.firstChild;)F.removeChild(F.firstChild)}var At=re(["transform","WebkitTransform"]);function Ye(F,W){F.style[At]=W}function Et(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var F=window.document.createEvent("UIEvents");F.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(F)}}function nt(F){var W=["padding: "+(F.height/2-8)+"px "+F.width/2+"px;","line-height: "+F.height+"px;","background-image: url("+F.toDataURL()+");"];console.log(`%c
`,W.join(""))}var Ct=o("b83N"),Ot=o.n(Ct),Re=o("xjNF"),Ie=o.n(Re),Be=o("vMUQ"),ft=o.n(Be),Me=o("ArX4"),ht=o.n(Me),Wt=o("by6o"),Qt=o.n(Wt),ur=o("Sjl4"),oe=o.n(ur);function J(F){var W=H();return function(){var xe=Qt()(F),ut;if(W){var wt=Qt()(this).constructor;ut=Reflect.construct(xe,arguments,wt)}else ut=xe.apply(this,arguments);return ht()(this,ut)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(F){return!1}}var Se=function(F){ft()(le,F);var W=J(le);function le(xe,ut,wt){var Bt;return Ot()(this,le),Bt=W.call(this,xe),Bt.status=void 0,Bt.url=void 0,Bt.status=ut,Bt.url=wt,Bt.name=Bt.constructor.name,Bt.message=xe,Bt}return Ie()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function be(F){var W=new XMLHttpRequest;W.open("GET",F.url,!0);for(var le in F.headers)F.headers.hasOwnProperty(le)&&W.setRequestHeader(le,F.headers[le]);return W.withCredentials=F.credentials==="include",W}var _e=function(W,le){var xe=be(W);return xe.setRequestHeader("Accept","application/json"),xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){if(xe.status>=200&&xe.status<300&&xe.response){var ut;try{ut=JSON.parse(xe.response)}catch(wt){return le(wt)}le(null,ut)}else xe.status===401?le(new Se("".concat(xe.statusText),xe.status,W.url)):le(new Se(xe.statusText,xe.status,W.url))},xe.send(),xe},me=function(W,le){var xe=be(W);return xe.responseType="arraybuffer",xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){var ut=xe.response;if(ut.byteLength===0&&xe.status===200)return le(new Error("http status 200 returned without content."));xe.status>=200&&xe.status<300&&xe.response?le(null,{data:ut,cacheControl:xe.getResponseHeader("Cache-Control"),expires:xe.getResponseHeader("Expires")}):le(new Se(xe.statusText,xe.status,W.url))},xe.send(),xe};function it(F){var W=window.document.createElement("a");return W.href=F,W.protocol===window.document.location.protocol&&W.host===window.document.location.host}var qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Pt=function(W,le){return me(W,function(xe,ut){if(xe)le(xe);else if(ut){var wt=new window.Image;wt.crossOrigin="anonymous";var Bt=window.URL||window.webkitURL;wt.onload=function(){le(null,wt),Bt.revokeObjectURL(wt.src)};var Ze=new window.Blob([new Uint8Array(ut.data)],{type:"image/png"});wt.src=ut.data.byteLength?Bt.createObjectURL(Ze):qt}})},ve=o("++Hr"),ge=o.n(ve),Ve=o("3XrA"),st=2*Math.PI*6378137/2;function Oe(F){var W=[Infinity,Infinity,-Infinity,-Infinity];return F.forEach(function(le){var xe=le.coordinates;vt(W,xe)}),W}function vt(F,W){return Array.isArray(W[0])?W.forEach(function(le){vt(F,le)}):(F[0]>W[0]&&(F[0]=W[0]),F[1]>W[1]&&(F[1]=W[1]),F[2]<W[0]&&(F[2]=W[0]),F[3]<W[1]&&(F[3]=W[1])),F}function C(F,W){return R(F,W)}function R(F,W){return Array.isArray(F[0])?F.map(function(le){return R(le,W)}):W(F)}function q(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};F=Tt(F,W);var xe=F[0],ut=F[1],wt=xe*st/180,Bt=Math.log(Math.tan((90+ut)*Math.PI/360))/(Math.PI/180);return Bt=Bt*st/180,le.enable&&(wt=Number(wt.toFixed(le.decimal)),Bt=Number(Bt.toFixed(le.decimal))),F.length===3?[wt,Bt,F[2]]:[wt,Bt]}function ce(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=F[0],xe=F[1],ut=le/st*180,wt=xe/st*180;return wt=180/Math.PI*(2*Math.atan(Math.exp(wt*Math.PI/180))-Math.PI/2),W!=null&&(ut=Number(ut.toFixed(W)),wt=Number(wt.toFixed(W))),F.length===3?[ut,wt,F[2]]:[ut,wt]}function Ge(F){if(F==null)throw new Error("lng is required");return(F>180||F<-180)&&(F=F%360,F>180&&(F=-360+F),F<-180&&(F=360+F),F===0&&(F=0)),F}function qe(F){if(F==null)throw new Error("lat is required");return(F>90||F<-90)&&(F=F%180,F>90&&(F=-180+F),F<-90&&(F=180+F),F===0&&(F=0)),F}function Tt(F,W){if(W===!1)return F;var le=Ge(F[0]),xe=qe(F[1]);return xe>85&&(xe=85),xe<-85&&(xe=-85),F.length===3?[le,xe,F[2]]:[le,xe]}function ot(F){var W=85.0511287798,le=Math.max(Math.min(W,F[1]),-W),xe=256<<20,ut=Math.PI/180,wt=F[0]*ut,Bt=le*ut;Bt=Math.log(Math.tan(Math.PI/4+Bt/2));var Ze=.5/Math.PI,Rt=.5,lr=-.5/Math.PI;return ut=.5,wt=xe*(Ze*wt+Rt),Bt=xe*(lr*Bt+ut),[Math.floor(wt),Math.floor(Bt)]}function Ut(F){var W=.5/Math.PI,le=.5,xe=-.5/Math.PI,ut=.5,wt=256<<20,Bt=ge()(F,2),Ze=Bt[0],Rt=Bt[1];Ze=(Ze/wt-le)/W,Rt=(Rt/wt-ut)/xe,Rt=(Math.atan(Math.pow(Math.E,Rt))-Math.PI/4)*2,ut=Math.PI/180;var lr=Rt/ut,Ur=Ze/ut;return[Ur,lr]}function $(F,W,le){var xe=Object(Ve.degreesToRadians)(W[1]-F[1]),ut=Object(Ve.degreesToRadians)(W[0]-F[0]),wt=Object(Ve.degreesToRadians)(F[1]),Bt=Object(Ve.degreesToRadians)(W[1]),Ze=Math.pow(Math.sin(xe/2),2)+Math.pow(Math.sin(ut/2),2)*Math.cos(wt)*Math.cos(Bt);return Object(Ve.radiansToLength)(2*Math.atan2(Math.sqrt(Ze),Math.sqrt(1-Ze)),le="meters")}function Qe(F){var W=Math.PI/180,le=85.0511287798,xe=6378137,ut=Math.max(Math.min(le,F[1]),-le),wt=Math.sin(ut*W),Bt=xe*F[0]*W,Ze=xe*Math.log((1+wt)/(1-wt))/2;return[Bt,Ze]}function ae(F,W){var le=Math.abs(F[1][1]-F[0][1])*W,xe=Math.abs(F[1][0]-F[0][0])*W;return[[F[0][0]-xe,F[0][1]-le],[F[1][0]+xe,F[1][1]+le]]}function et(F,W){return F[0][0]<=W[0][0]&&F[0][1]<=W[0][1]&&F[1][0]>=W[1][0]&&F[1][1]>=W[1][1]}function kt(F){return[[F[0],F[1]],[F[2],F[3]]]}var pr=function(){function F(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;Ot()(this,F),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=W,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return Ie()(F,[{key:"clear",value:function(){var le=this;this.order.forEach(function(xe){le.delete(xe)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var xe=this.cache[le];return xe&&(this.deleteOrder(le),this.appendOrder(le)),xe}},{key:"set",value:function(le,xe){this.cache[le]?(this.delete(le),this.cache[le]=xe,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=xe,this.appendOrder(le))}},{key:"delete",value:function(le){var xe=this.cache[le];xe&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(xe,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var xe=this.order.findIndex(function(ut){return ut===le});xe>=0&&this.order.splice(xe,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,xe){return null}}]),F}();function Ke(F,W){F.forEach(function(le){if(!W[le])return;W[le]=W[le].bind(W)})}var bt=o("GfBb");function yt(F){var W=bt.a(F),le=[0,0,0,0];return W!=null&&(le[0]=W.r/255,le[1]=W.g/255,le[2]=W.b/255,le[3]=W.opacity),le}function xt(F){var W=F&&F[0],le=F&&F[1],xe=F&&F[2],ut=W+le*256+xe*65536-1;return ut}function ze(F){return[F+1&255,F+1>>8&255,F+1>>8>>8&255]}function dt(F){var W=document.createElement("canvas"),le=W.getContext("2d");W.width=256,W.height=1;for(var xe=le.createLinearGradient(0,0,256,1),ut=null,wt=F.positions[0],Bt=F.positions[F.positions.length-1],Ze=0;Ze<F.colors.length;++Ze){var Rt=(F.positions[Ze]-wt)/(Bt-wt);xe.addColorStop(Rt,F.colors[Ze])}return le.fillStyle=xe,le.fillRect(0,0,256,1),ut=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(ut,256,1)}var gt;(function(F){F.CENTER="center",F.TOP="top",F["TOP-LEFT"]="top-left",F["TOP-RIGHT"]="top-right",F.BOTTOM="bottom",F["BOTTOM-LEFT"]="bottom-left",F.LEFT="left",F.RIGHT="right"})(gt||(gt={}));var Ht={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hr(F,W,le){var xe=F.classList;for(var ut in Ht)Ht.hasOwnProperty(ut)&&xe.remove("l7-".concat(le,"-anchor-").concat(ut));xe.add("l7-".concat(le,"-anchor-").concat(W))}function Zr(F){if(F.length===0)throw new Error("max requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]>W&&(W=F[le]);return W*1}function yr(F){if(F.length===0)throw new Error("min requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]<W&&(W=F[le]);return W*1}function Vn(F){if(F.length===0)return 0;for(var W=F[0]*1,le=1;le<F.length;le++)W+=F[le]*1;return W}function Fn(F){if(F.length===0)throw new Error("mean requires at least one data point");return Vn(F)/F.length}function oa(F){if(F.length===0)throw new Error("mean requires at least one data point");if(F.length<3)return F[0];F.sort();for(var W=F[0],le=NaN,xe=0,ut=1,wt=1;wt<F.length+1;wt++)F[wt]!==W?(ut>xe&&(xe=ut,le=W),ut=1,W=F[wt]):ut++;return le*1}var $n={min:yr,max:Zr,mean:Fn,sum:Vn,mode:oa};function Kn(F,W){return F.map(function(le){return le[W]})}function Cn(F,W){return $n[F](W)}},"M/AK":function(Fe,_,o){"use strict";var x=o("L84c"),p=o.n(x),Y=o("9DO+"),z=o.n(Y),i=o("yS0f"),Z=o.n(i),D=o("xwgP"),K=o("iczh"),re=o.n(K),fe=function(be){var _e=be.prefixCls,me=be.className,it=be.width,qt=be.style;return D.createElement("h3",{className:re()(_e,me),style:z()({width:it},qt)})},X=fe,He=o("h9B+"),Xe=o.n(He),pe=function(be){var _e=function(Ve){var st=be.width,Oe=be.rows,vt=Oe===void 0?2:Oe;return Array.isArray(st)?st[Ve]:vt-1===Ve?st:void 0},me=be.prefixCls,it=be.className,qt=be.style,Pt=be.rows,ve=Xe()(Array(Pt)).map(function(ge,Ve){return D.createElement("li",{key:Ve,style:{width:_e(Ve)}})});return D.createElement("ul",{className:re()(me,it),style:qt},ve)},Ce=pe,mt=o("3JSl"),Ne=function(be){var _e,me,it=be.prefixCls,qt=be.className,Pt=be.style,ve=be.size,ge=be.shape,Ve=re()((_e={},p()(_e,"".concat(it,"-lg"),ve==="large"),p()(_e,"".concat(it,"-sm"),ve==="small"),_e)),st=re()((me={},p()(me,"".concat(it,"-circle"),ge==="circle"),p()(me,"".concat(it,"-square"),ge==="square"),p()(me,"".concat(it,"-round"),ge==="round"),me)),Oe=typeof ve=="number"?{width:ve,height:ve,lineHeight:"".concat(ve,"px")}:{};return D.createElement("span",{className:re()(it,Ve,st,qt),style:z()(z()({},Oe),Pt)})},At=Ne,Ye=o("3CTf"),Et=function(be){var _e=function(it){var qt=it.getPrefixCls,Pt=be.prefixCls,ve=be.className,ge=be.active,Ve=qt("skeleton",Pt),st=Object(Ye.a)(be,["prefixCls"]),Oe=re()(Ve,"".concat(Ve,"-element"),p()({},"".concat(Ve,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(At,z()({prefixCls:"".concat(Ve,"-avatar")},st)))};return D.createElement(mt.a,null,_e)};Et.defaultProps={size:"default",shape:"circle"};var nt=Et,Ct=function(be){var _e=function(it){var qt=it.getPrefixCls,Pt=be.prefixCls,ve=be.className,ge=be.active,Ve=qt("skeleton",Pt),st=Object(Ye.a)(be,["prefixCls"]),Oe=re()(Ve,"".concat(Ve,"-element"),p()({},"".concat(Ve,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(At,z()({prefixCls:"".concat(Ve,"-button")},st)))};return D.createElement(mt.a,null,_e)};Ct.defaultProps={size:"default"};var Ot=Ct,Re=function(be){var _e=function(it){var qt=it.getPrefixCls,Pt=be.prefixCls,ve=be.className,ge=be.active,Ve=qt("skeleton",Pt),st=Object(Ye.a)(be,["prefixCls"]),Oe=re()(Ve,"".concat(Ve,"-element"),p()({},"".concat(Ve,"-active"),ge),ve);return D.createElement("div",{className:Oe},D.createElement(At,z()({prefixCls:"".concat(Ve,"-input")},st)))};return D.createElement(mt.a,null,_e)};Re.defaultProps={size:"default"};var Ie=Re,Be="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",ft=function(be){var _e=function(it){var qt=it.getPrefixCls,Pt=be.prefixCls,ve=be.className,ge=be.style,Ve=qt("skeleton",Pt),st=re()(Ve,"".concat(Ve,"-element"),ve);return D.createElement("div",{className:st},D.createElement("div",{className:re()("".concat(Ve,"-image"),ve),style:ge},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ve,"-image-svg")},D.createElement("path",{d:Be,className:"".concat(Ve,"-image-path")}))))};return D.createElement(mt.a,null,_e)},Me=ft;function ht(Se){return Se&&Z()(Se)==="object"?Se:{}}function Wt(Se,be){return Se&&!be?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Qt(Se,be){return!Se&&be?{width:"38%"}:Se&&be?{width:"50%"}:{}}function ur(Se,be){var _e={};return(!Se||!be)&&(_e.width="61%"),!Se&&be?_e.rows=3:_e.rows=2,_e}var oe=function(be){var _e=function(it){var qt=it.getPrefixCls,Pt=it.direction,ve=be.prefixCls,ge=be.loading,Ve=be.className,st=be.children,Oe=be.avatar,vt=be.title,C=be.paragraph,R=be.active,q=be.round,ce=qt("skeleton",ve);if(ge||!("loading"in be)){var Ge,qe=!!Oe,Tt=!!vt,ot=!!C,Ut;if(qe){var $=z()(z()({prefixCls:"".concat(ce,"-avatar")},Wt(Tt,ot)),ht(Oe));Ut=D.createElement("div",{className:"".concat(ce,"-header")},D.createElement(At,$))}var Qe;if(Tt||ot){var ae;if(Tt){var et=z()(z()({prefixCls:"".concat(ce,"-title")},Qt(qe,ot)),ht(vt));ae=D.createElement(X,et)}var kt;if(ot){var pr=z()(z()({prefixCls:"".concat(ce,"-paragraph")},ur(qe,Tt)),ht(C));kt=D.createElement(Ce,pr)}Qe=D.createElement("div",{className:"".concat(ce,"-content")},ae,kt)}var Ke=re()(ce,(Ge={},p()(Ge,"".concat(ce,"-with-avatar"),qe),p()(Ge,"".concat(ce,"-active"),R),p()(Ge,"".concat(ce,"-rtl"),Pt==="rtl"),p()(Ge,"".concat(ce,"-round"),q),Ge),Ve);return D.createElement("div",{className:Ke},Ut,Qe)}return st};return D.createElement(mt.a,null,_e)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=Ot,oe.Avatar=nt,oe.Input=Ie,oe.Image=Me;var J=oe,H=_.a=J},"M/r+":function(Fe,_){function o(x){return x}Fe.exports=o},MAyr:function(Fe,_,o){"use strict";var x=o("fjB6");_.a=x.a},"MRi+":function(Fe,_,o){(function(x){var p=o("trXQ"),Y=_&&!_.nodeType&&_,z=Y&&typeof x=="object"&&x&&!x.nodeType&&x,i=z&&z.exports===Y,Z=i?p.Buffer:void 0,D=Z?Z.allocUnsafe:void 0;function K(re,fe){if(fe)return re.slice();var X=re.length,He=D?D(X):new re.constructor(X);return re.copy(He),He}x.exports=K}).call(this,o("qrga")(Fe))},MWZR:function(Fe,_){},Mhuo:function(Fe,_,o){var x=o("PyXz"),p=o("921W"),Y=o("nBjS"),z=Y&&Y.isMap,i=z?p(z):x;Fe.exports=i},NI1Q:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("QbGg"),p=function(){function Y(z,i,Z,D,K){this.id=x.id(),this.serviceIdentifier=z,this.parentContext=i,this.parentRequest=Z,this.target=K,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=Z===null?new Map:null}return Y.prototype.addChildRequest=function(z,i,Z){var D=new Y(z,this.parentContext,this,i,Z);return this.childRequests.push(D),D},Y}();_.Request=p},"NNd+":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};_.BindingCount=x},"NQ+y":function(Fe,_,o){var x=o("gXXb"),p=o("q2Nz"),Y=o("66qL"),z=o("Jdr+"),i=o("gteZ"),Z=o("wndA"),D=o("obOy");function K(re,fe,X,He,Xe){if(re===fe)return;Y(fe,function(pe,Ce){if(Xe||(Xe=new x),i(pe))z(re,fe,Ce,X,K,He,Xe);else{var mt=He?He(D(re,Ce),pe,Ce+"",re,fe,Xe):void 0;mt===void 0&&(mt=pe),p(re,Ce,mt)}},Z)}Fe.exports=K},NW8c:function(Fe,_){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+p+Y,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",fe="[^"+o+"]",X="(?:\\ud83c[\\udde6-\\uddff]){2}",He="[\\ud800-\\udbff][\\udc00-\\udfff]",Xe="\\u200d",pe=re+"?",Ce="["+i+"]?",mt="(?:"+Xe+"(?:"+[fe,X,He].join("|")+")"+Ce+pe+")*",Ne=Ce+pe+mt,At="(?:"+[fe+D+"?",D,X,He,Z].join("|")+")",Ye=RegExp(K+"(?="+K+")|"+At+Ne,"g");function Et(nt){return nt.match(Ye)||[]}Fe.exports=Et},NgVo:function(Fe,_){function o(x,p,Y){switch(Y.length){case 0:return x.call(p);case 1:return x.call(p,Y[0]);case 2:return x.call(p,Y[0],Y[1]);case 3:return x.call(p,Y[0],Y[1],Y[2])}return x.apply(p,Y)}Fe.exports=o},NkMf:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=function(){function p(Y){this.str=Y}return p.prototype.startsWith=function(Y){return this.str.indexOf(Y)===0},p.prototype.endsWith=function(Y){var z="",i=Y.split("").reverse().join("");return z=this.str.split("").reverse().join(""),this.startsWith.call({str:z},i)},p.prototype.contains=function(Y){return this.str.indexOf(Y)!==-1},p.prototype.equals=function(Y){return this.str===Y},p.prototype.value=function(){return this.str},p}();_.QueryableString=x},NoL3:function(Fe,_){function o(x,p,Y){return x===x&&(Y!==void 0&&(x=x<=Y?x:Y),p!==void 0&&(x=x>=p?x:p)),x}Fe.exports=o},ORxg:function(Fe,_,o){var x=o("HcOL"),p=o("JArH"),Y=o("Ycz+"),z=o("OUY8"),i=o("0326"),Z=o("uWVo"),D=Math.ceil;function K(re,fe){fe=fe===void 0?" ":p(fe);var X=fe.length;if(X<2)return X?x(fe,re):fe;var He=x(fe,D(re/i(fe)));return z(fe)?Y(Z(He),0,re).join(""):He.slice(0,re)}Fe.exports=K},OUY8:function(Fe,_){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+p+Y,i="\\ufe0e\\ufe0f",Z="\\u200d",D=RegExp("["+Z+o+z+i+"]");function K(re){return D.test(re)}Fe.exports=K},PByh:function(Fe,_){function o(p,Y,z,i,Z,D,K){try{var re=p[D](K),fe=re.value}catch(X){z(X);return}re.done?Y(fe):Promise.resolve(fe).then(i,Z)}function x(p){return function(){var Y=this,z=arguments;return new Promise(function(i,Z){var D=p.apply(Y,z);function K(fe){o(D,i,Z,K,re,"next",fe)}function re(fe){o(D,i,Z,K,re,"throw",fe)}K(void 0)})}}Fe.exports=x},PEaR:function(Fe,_,o){"use strict";o.d(_,"a",function(){return X});var x=o("L84c"),p=o.n(x),Y=o("KgZ/"),z=o.n(Y),i=o("xl7n"),Z=o.n(i),D=o("9tAk"),K=o.n(D);function re(He,Xe){var pe=Object.keys(He);if(Object.getOwnPropertySymbols){var Ce=Object.getOwnPropertySymbols(He);Xe&&(Ce=Ce.filter(function(mt){return Object.getOwnPropertyDescriptor(He,mt).enumerable})),pe.push.apply(pe,Ce)}return pe}function fe(He){for(var Xe=1;Xe<arguments.length;Xe++){var pe=arguments[Xe]!=null?arguments[Xe]:{};Xe%2?re(Object(pe),!0).forEach(function(Ce){p()(He,Ce,pe[Ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(He,Object.getOwnPropertyDescriptors(pe)):re(Object(pe)).forEach(function(Ce){Object.defineProperty(He,Ce,Object.getOwnPropertyDescriptor(pe,Ce))})}return He}function X(He,Xe){var pe=[],Ce={};if(He.features=He.features.filter(function(Ne){var At=Ne.geometry;return Ne!=null&&At&&At.type&&At.coordinates&&At.coordinates.length>0}),z()(He,!0),He.features.length===0)return{dataArray:[],featureKeys:Ce};var mt=0;return D.flattenEach(He,function(Ne,At){var Ye=Object(i.getCoords)(Ne),Et=At,nt=fe(fe({},Ne.properties),{},{coordinates:Ye,_id:Et});pe.push(nt)}),{dataArray:pe,featureKeys:Ce}}},PFor:function(Fe,_){function o(x){var p=x.target||x.srcElement;p.__resizeRAF__&&cancelAnimationFrame(p.__resizeRAF__),p.__resizeRAF__=requestAnimationFrame(function(){var Y=p.__resizeTrigger__,z=Y&&Y.__resizeListeners__;z&&z.forEach(function(i){i.call(Y,x)})})}var _=function(p,Y){var z=this,i=z.document,Z,D=i.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function K(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!p.__resizeListeners__)if(p.__resizeListeners__=[],D)p.__resizeTrigger__=p,p.attachEvent("onresize",o);else{getComputedStyle(p).position==="static"&&(p.style.position="relative");var re=p.__resizeTrigger__=i.createElement("object");re.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),re.setAttribute("class","resize-sensor"),re.setAttribute("tabindex","-1"),re.__resizeElement__=p,re.onload=K,re.type="text/html",Z&&p.appendChild(re),re.data="about:blank",Z||p.appendChild(re)}p.__resizeListeners__.push(Y)};Fe.exports=typeof window=="undefined"?_:_.bind(window),Fe.exports.unbind=function(x,p){var Y=document.attachEvent,z=x.__resizeListeners__||[];if(p){var i=z.indexOf(p);i!==-1&&z.splice(i,1)}else z=x.__resizeListeners__=[];if(!z.length){if(Y)x.detachEvent("onresize",o);else if(x.__resizeTrigger__){var Z=x.__resizeTrigger__.contentDocument,D=Z&&Z.defaultView;D&&(D.removeEventListener("resize",o),delete D.__resizeTrigger__),x.__resizeTrigger__=!x.removeChild(x.__resizeTrigger__)}delete x.__resizeListeners__}}},PPmI:function(Fe,_,o){var x=o("85pI"),p=x(Object.getPrototypeOf,Object);Fe.exports=p},Pvkj:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});function x(p,Y){var z=Y.extent,i=Y.width,Z=Y.height,D=Y.min,K=Y.max,re={_id:1,dataArray:[{_id:1,data:Array.from(p),width:i,height:Z,min:D,max:K,coordinates:[[z[0],z[1]],[z[2],z[3]]]}]};return re}},PyXz:function(Fe,_,o){var x=o("HtJV"),p=o("SSN4"),Y="[object Map]";function z(i){return p(i)&&x(i)==Y}Fe.exports=z},QCRO:function(Fe,_,o){var x=o("QH1C"),p=o("zaTR"),Y=o("v7Ln"),z=o("3Jho"),i=o("wHDA"),Z="[object Boolean]",D="[object Date]",K="[object Map]",re="[object Number]",fe="[object RegExp]",X="[object Set]",He="[object String]",Xe="[object Symbol]",pe="[object ArrayBuffer]",Ce="[object DataView]",mt="[object Float32Array]",Ne="[object Float64Array]",At="[object Int8Array]",Ye="[object Int16Array]",Et="[object Int32Array]",nt="[object Uint8Array]",Ct="[object Uint8ClampedArray]",Ot="[object Uint16Array]",Re="[object Uint32Array]";function Ie(Be,ft,Me){var ht=Be.constructor;switch(ft){case pe:return x(Be);case Z:case D:return new ht(+Be);case Ce:return p(Be,Me);case mt:case Ne:case At:case Ye:case Et:case nt:case Ct:case Ot:case Re:return i(Be,Me);case K:return new ht;case re:case He:return new ht(Be);case fe:return Y(Be);case X:return new ht;case Xe:return z(Be)}}Fe.exports=Ie},QH1C:function(Fe,_,o){var x=o("hsS0");function p(Y){var z=new Y.constructor(Y.byteLength);return new x(z).set(new x(Y)),z}Fe.exports=p},QNeN:function(Fe,_,o){var x=o("mCIU"),p=o("iz/G"),Y=o("SSN4"),z="[object String]";function i(Z){return typeof Z=="string"||!p(Z)&&Y(Z)&&x(Z)==z}Fe.exports=i},"QTk+":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E");function p(re){if(typeof re=="function"){var fe=re;return fe.name}else{if(typeof re=="symbol")return re.toString();var fe=re;return fe}}_.getServiceIdentifierAsString=p;function Y(re,fe,X){var He="",Xe=X(re,fe);return Xe.length!==0&&(He=`
Registered bindings:`,Xe.forEach(function(pe){var Ce="Object";pe.implementationType!==null&&(Ce=K(pe.implementationType)),He=He+`
 `+Ce,pe.constraint.metaData&&(He=He+" - "+pe.constraint.metaData)})),He}_.listRegisteredBindingsForServiceIdentifier=Y;function z(re,fe){return re.parentRequest===null?!1:re.parentRequest.serviceIdentifier===fe?!0:z(re.parentRequest,fe)}function i(re){function fe(He,Xe){Xe===void 0&&(Xe=[]);var pe=p(He.serviceIdentifier);return Xe.push(pe),He.parentRequest!==null?fe(He.parentRequest,Xe):Xe}var X=fe(re);return X.reverse().join(" --> ")}function Z(re){re.childRequests.forEach(function(fe){if(z(fe,fe.serviceIdentifier)){var X=i(fe);throw new Error(x.CIRCULAR_DEPENDENCY+" "+X)}else Z(fe)})}_.circularDependencyToException=Z;function D(re,fe){if(fe.isTagged()||fe.isNamed()){var X="",He=fe.getNamedTag(),Xe=fe.getCustomTags();return He!==null&&(X+=He.toString()+`
`),Xe!==null&&Xe.forEach(function(pe){X+=pe.toString()+`
`})," "+re+`
 `+re+" - "+X}else return" "+re}_.listMetadataForTarget=D;function K(re){if(re.name)return re.name;var fe=re.toString(),X=fe.match(/^function\s*([^\s(]+)/);return X?X[1]:"Anonymous function: "+fe}_.getFunctionName=K},QbGg:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=0;function p(){return x++}_.id=p},"QnA+":function(Fe,_,o){"use strict";Fe.exports=p,Fe.exports.default=p;var x=1e20;function p(i,Z,D,K,re,fe){this.fontSize=i||24,this.buffer=Z===void 0?3:Z,this.cutoff=K||.25,this.fontFamily=re||"sans-serif",this.fontWeight=fe||"normal",this.radius=D||8;var X=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=X,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(X*X),this.gridInner=new Float64Array(X*X),this.f=new Float64Array(X),this.d=new Float64Array(X),this.z=new Float64Array(X+1),this.v=new Int16Array(X),this.middle=Math.round(X/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}p.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var Z=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),K=0;K<this.size*this.size;K++){var re=Z.data[K*4+3]/255;this.gridOuter[K]=re===1?0:re===0?x:Math.pow(Math.max(0,.5-re),2),this.gridInner[K]=re===1?x:re===0?0:Math.pow(Math.max(0,re-.5),2)}for(Y(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Y(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),K=0;K<this.size*this.size;K++){var fe=this.gridOuter[K]-this.gridInner[K];D[K]=Math.max(0,Math.min(255,Math.round(255-255*(fe/this.radius+this.cutoff))))}return D};function Y(i,Z,D,K,re,fe,X){for(var He=0;He<Z;He++){for(var Xe=0;Xe<D;Xe++)K[Xe]=i[Xe*Z+He];for(z(K,re,fe,X,D),Xe=0;Xe<D;Xe++)i[Xe*Z+He]=re[Xe]}for(Xe=0;Xe<D;Xe++){for(He=0;He<Z;He++)K[He]=i[Xe*Z+He];for(z(K,re,fe,X,Z),He=0;He<Z;He++)i[Xe*Z+He]=Math.sqrt(re[He])}}function z(i,Z,D,K,re){D[0]=0,K[0]=-x,K[1]=+x;for(var fe=1,X=0;fe<re;fe++){for(var He=(i[fe]+fe*fe-(i[D[X]]+D[X]*D[X]))/(2*fe-2*D[X]);He<=K[X];)X--,He=(i[fe]+fe*fe-(i[D[X]]+D[X]*D[X]))/(2*fe-2*D[X]);X++,D[X]=fe,K[X]=He,K[X+1]=+x}for(fe=0,X=0;fe<re;fe++){for(;K[X+1]<fe;)X++;Z[fe]=(fe-D[X])*(fe-D[X])+i[D[X]]}}},R1gD:function(Fe,_){typeof Object.create=="function"?Fe.exports=function(x,p){x.super_=p,x.prototype=Object.create(p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}})}:Fe.exports=function(x,p){x.super_=p;var Y=function(){};Y.prototype=p.prototype,x.prototype=new Y,x.prototype.constructor=x}},RLa6:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=function(){function p(){}return p.of=function(Y,z){var i=new p;return i.bindings=Y,i.middleware=z,i},p}();_.ContainerSnapshot=x},RM4u:function(Fe,_,o){var x=o("NQ+y"),p=o("Dr/i"),Y=p(function(z,i,Z){x(z,i,Z)});Fe.exports=Y},RYoK:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0}),_.multiBindToService=function(x){return function(p){return function(){for(var Y=[],z=0;z<arguments.length;z++)Y[z]=arguments[z];return Y.forEach(function(i){return x.bind(i).toService(p)})}}}},RhpP:function(Fe,_,o){var x=o("mE2a"),p={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Y=x(p);Fe.exports=Y},"S+oY":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB");_.METADATA_KEY=x;var p=o("7vCJ");_.Container=p.Container;var Y=o("7s3S");_.BindingScopeEnum=Y.BindingScopeEnum,_.BindingTypeEnum=Y.BindingTypeEnum,_.TargetTypeEnum=Y.TargetTypeEnum;var z=o("zyyB");_.AsyncContainerModule=z.AsyncContainerModule,_.ContainerModule=z.ContainerModule;var i=o("eodq");_.injectable=i.injectable;var Z=o("Weph");_.tagged=Z.tagged;var D=o("Aljs");_.named=D.named;var K=o("CC9Y");_.inject=K.inject,_.LazyServiceIdentifer=K.LazyServiceIdentifer;var re=o("CUEQ");_.optional=re.optional;var fe=o("q8dt");_.unmanaged=fe.unmanaged;var X=o("6gzr");_.multiInject=X.multiInject;var He=o("LDg+");_.targetName=He.targetName;var Xe=o("dUl7");_.postConstruct=Xe.postConstruct;var pe=o("g0Ch");_.MetadataReader=pe.MetadataReader;var Ce=o("QbGg");_.id=Ce.id;var mt=o("Vkc/");_.decorate=mt.decorate;var Ne=o("VTKP");_.traverseAncerstors=Ne.traverseAncerstors,_.taggedConstraint=Ne.taggedConstraint,_.namedConstraint=Ne.namedConstraint,_.typeConstraint=Ne.typeConstraint;var At=o("QTk+");_.getServiceIdentifierAsString=At.getServiceIdentifierAsString;var Ye=o("RYoK");_.multiBindToService=Ye.multiBindToService},S0vU:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("CC9Y"),p=o("0d2E"),Y=o("7s3S"),z=o("/jsB"),i=o("QTk+");_.getFunctionName=i.getFunctionName;var Z=o("Wz0W");function D(pe,Ce){var mt=i.getFunctionName(Ce),Ne=K(pe,mt,Ce,!1);return Ne}_.getDependencies=D;function K(pe,Ce,mt,Ne){var At=pe.getConstructorMetadata(mt),Ye=At.compilerGeneratedMetadata;if(Ye===void 0){var Et=p.MISSING_INJECTABLE_ANNOTATION+" "+Ce+".";throw new Error(Et)}var nt=At.userGeneratedMetadata,Ct=Object.keys(nt),Ot=mt.length===0&&Ct.length>0,Re=Ot?Ct.length:mt.length,Ie=fe(Ne,Ce,Ye,nt,Re),Be=X(pe,mt),ft=Ie.concat(Be);return ft}function re(pe,Ce,mt,Ne,At){var Ye=At[pe.toString()]||[],Et=Xe(Ye),nt=Et.unmanaged!==!0,Ct=Ne[pe],Ot=Et.inject||Et.multiInject;if(Ct=Ot||Ct,Ct instanceof x.LazyServiceIdentifer&&(Ct=Ct.unwrap()),nt){var Re=Ct===Object,Ie=Ct===Function,Be=Ct===void 0,ft=Re||Ie||Be;if(!Ce&&ft){var Me=p.MISSING_INJECT_ANNOTATION+" argument "+pe+" in class "+mt+".";throw new Error(Me)}var ht=new Z.Target(Y.TargetTypeEnum.ConstructorArgument,Et.targetName,Ct);return ht.metadata=Ye,ht}return null}function fe(pe,Ce,mt,Ne,At){for(var Ye=[],Et=0;Et<At;Et++){var nt=Et,Ct=re(nt,pe,Ce,mt,Ne);Ct!==null&&Ye.push(Ct)}return Ye}function X(pe,Ce){for(var mt=pe.getPropertiesMetadata(Ce),Ne=[],At=Object.keys(mt),Ye=0,Et=At;Ye<Et.length;Ye++){var nt=Et[Ye],Ct=mt[nt],Ot=Xe(mt[nt]),Re=Ot.targetName||nt,Ie=Ot.inject||Ot.multiInject,Be=new Z.Target(Y.TargetTypeEnum.ClassProperty,Re,Ie);Be.metadata=Ct,Ne.push(Be)}var ft=Object.getPrototypeOf(Ce.prototype).constructor;if(ft!==Object){var Me=X(pe,ft);Ne=Ne.concat(Me)}return Ne}function He(pe,Ce){var mt=Object.getPrototypeOf(Ce.prototype).constructor;if(mt!==Object){var Ne=i.getFunctionName(mt),At=K(pe,Ne,mt,!0),Ye=At.map(function(Ct){return Ct.metadata.filter(function(Ot){return Ot.key===z.UNMANAGED_TAG})}),Et=[].concat.apply([],Ye).length,nt=At.length-Et;return nt>0?nt:He(pe,mt)}else return 0}_.getBaseClassDependencyCount=He;function Xe(pe){var Ce={};return pe.forEach(function(mt){Ce[mt.key.toString()]=mt.value}),{inject:Ce[z.INJECT_TAG],multiInject:Ce[z.MULTI_INJECT_TAG],targetName:Ce[z.NAME_TAG],unmanaged:Ce[z.UNMANAGED_TAG]}}},SQcl:function(Fe,_,o){var x=o("xrLW"),p=o("vlZP");function Y(z){return p(x(z).toLowerCase())}Fe.exports=Y},SaUU:function(Fe,_,o){(function(x){var p=Object.getOwnPropertyDescriptors||function(me){for(var it=Object.keys(me),qt={},Pt=0;Pt<it.length;Pt++)qt[it[Pt]]=Object.getOwnPropertyDescriptor(me,it[Pt]);return qt},Y=/%[sdj%]/g;_.format=function(_e){if(!nt(_e)){for(var me=[],it=0;it<arguments.length;it++)me.push(Z(arguments[it]));return me.join(" ")}for(var it=1,qt=arguments,Pt=qt.length,ve=String(_e).replace(Y,function(Ve){if(Ve==="%%")return"%";if(it>=Pt)return Ve;switch(Ve){case"%s":return String(qt[it++]);case"%d":return Number(qt[it++]);case"%j":try{return JSON.stringify(qt[it++])}catch(st){return"[Circular]"}default:return Ve}}),ge=qt[it];it<Pt;ge=qt[++it])At(ge)||!Ie(ge)?ve+=" "+ge:ve+=" "+Z(ge);return ve},_.deprecate=function(_e,me){if(typeof x!="undefined"&&x.noDeprecation===!0)return _e;if(typeof x=="undefined")return function(){return _.deprecate(_e,me).apply(this,arguments)};var it=!1;function qt(){if(!it){if(x.throwDeprecation)throw new Error(me);x.traceDeprecation?console.trace(me):console.error(me),it=!0}return _e.apply(this,arguments)}return qt};var z={},i;_.debuglog=function(_e){if(Ot(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),_e=_e.toUpperCase(),!z[_e])if(new RegExp("\\b"+_e+"\\b","i").test(i)){var me=x.pid;z[_e]=function(){var it=_.format.apply(_,arguments);console.error("%s %d: %s",_e,me,it)}}else z[_e]=function(){};return z[_e]};function Z(_e,me){var it={seen:[],stylize:K};return arguments.length>=3&&(it.depth=arguments[2]),arguments.length>=4&&(it.colors=arguments[3]),Ne(me)?it.showHidden=me:me&&_._extend(it,me),Ot(it.showHidden)&&(it.showHidden=!1),Ot(it.depth)&&(it.depth=2),Ot(it.colors)&&(it.colors=!1),Ot(it.customInspect)&&(it.customInspect=!0),it.colors&&(it.stylize=D),fe(it,_e,it.depth)}_.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(_e,me){var it=Z.styles[me];return it?"["+Z.colors[it][0]+"m"+_e+"["+Z.colors[it][1]+"m":_e}function K(_e,me){return _e}function re(_e){var me={};return _e.forEach(function(it,qt){me[it]=!0}),me}function fe(_e,me,it){if(_e.customInspect&&me&&Me(me.inspect)&&me.inspect!==_.inspect&&!(me.constructor&&me.constructor.prototype===me)){var qt=me.inspect(it,_e);return nt(qt)||(qt=fe(_e,qt,it)),qt}var Pt=X(_e,me);if(Pt)return Pt;var ve=Object.keys(me),ge=re(ve);if(_e.showHidden&&(ve=Object.getOwnPropertyNames(me)),ft(me)&&(ve.indexOf("message")>=0||ve.indexOf("description")>=0))return He(me);if(ve.length===0){if(Me(me)){var Ve=me.name?": "+me.name:"";return _e.stylize("[Function"+Ve+"]","special")}if(Re(me))return _e.stylize(RegExp.prototype.toString.call(me),"regexp");if(Be(me))return _e.stylize(Date.prototype.toString.call(me),"date");if(ft(me))return He(me)}var st="",Oe=!1,vt=["{","}"];if(mt(me)&&(Oe=!0,vt=["[","]"]),Me(me)){var C=me.name?": "+me.name:"";st=" [Function"+C+"]"}if(Re(me)&&(st=" "+RegExp.prototype.toString.call(me)),Be(me)&&(st=" "+Date.prototype.toUTCString.call(me)),ft(me)&&(st=" "+He(me)),ve.length===0&&(!Oe||me.length==0))return vt[0]+st+vt[1];if(it<0)return Re(me)?_e.stylize(RegExp.prototype.toString.call(me),"regexp"):_e.stylize("[Object]","special");_e.seen.push(me);var R;return Oe?R=Xe(_e,me,it,ge,ve):R=ve.map(function(q){return pe(_e,me,it,ge,q,Oe)}),_e.seen.pop(),Ce(R,st,vt)}function X(_e,me){if(Ot(me))return _e.stylize("undefined","undefined");if(nt(me)){var it="'"+JSON.stringify(me).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _e.stylize(it,"string")}if(Et(me))return _e.stylize(""+me,"number");if(Ne(me))return _e.stylize(""+me,"boolean");if(At(me))return _e.stylize("null","null")}function He(_e){return"["+Error.prototype.toString.call(_e)+"]"}function Xe(_e,me,it,qt,Pt){for(var ve=[],ge=0,Ve=me.length;ge<Ve;++ge)J(me,String(ge))?ve.push(pe(_e,me,it,qt,String(ge),!0)):ve.push("");return Pt.forEach(function(st){st.match(/^\d+$/)||ve.push(pe(_e,me,it,qt,st,!0))}),ve}function pe(_e,me,it,qt,Pt,ve){var ge,Ve,st;if(st=Object.getOwnPropertyDescriptor(me,Pt)||{value:me[Pt]},st.get?st.set?Ve=_e.stylize("[Getter/Setter]","special"):Ve=_e.stylize("[Getter]","special"):st.set&&(Ve=_e.stylize("[Setter]","special")),J(qt,Pt)||(ge="["+Pt+"]"),Ve||(_e.seen.indexOf(st.value)<0?(At(it)?Ve=fe(_e,st.value,null):Ve=fe(_e,st.value,it-1),Ve.indexOf(`
`)>-1&&(ve?Ve=Ve.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):Ve=`
`+Ve.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`))):Ve=_e.stylize("[Circular]","special")),Ot(ge)){if(ve&&Pt.match(/^\d+$/))return Ve;ge=JSON.stringify(""+Pt),ge.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ge=ge.substr(1,ge.length-2),ge=_e.stylize(ge,"name")):(ge=ge.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ge=_e.stylize(ge,"string"))}return ge+": "+Ve}function Ce(_e,me,it){var qt=0,Pt=_e.reduce(function(ve,ge){return qt++,ge.indexOf(`
`)>=0&&qt++,ve+ge.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Pt>60?it[0]+(me===""?"":me+`
 `)+" "+_e.join(`,
  `)+" "+it[1]:it[0]+me+" "+_e.join(", ")+" "+it[1]}function mt(_e){return Array.isArray(_e)}_.isArray=mt;function Ne(_e){return typeof _e=="boolean"}_.isBoolean=Ne;function At(_e){return _e===null}_.isNull=At;function Ye(_e){return _e==null}_.isNullOrUndefined=Ye;function Et(_e){return typeof _e=="number"}_.isNumber=Et;function nt(_e){return typeof _e=="string"}_.isString=nt;function Ct(_e){return typeof _e=="symbol"}_.isSymbol=Ct;function Ot(_e){return _e===void 0}_.isUndefined=Ot;function Re(_e){return Ie(_e)&&Wt(_e)==="[object RegExp]"}_.isRegExp=Re;function Ie(_e){return typeof _e=="object"&&_e!==null}_.isObject=Ie;function Be(_e){return Ie(_e)&&Wt(_e)==="[object Date]"}_.isDate=Be;function ft(_e){return Ie(_e)&&(Wt(_e)==="[object Error]"||_e instanceof Error)}_.isError=ft;function Me(_e){return typeof _e=="function"}_.isFunction=Me;function ht(_e){return _e===null||typeof _e=="boolean"||typeof _e=="number"||typeof _e=="string"||typeof _e=="symbol"||typeof _e=="undefined"}_.isPrimitive=ht,_.isBuffer=o("3GKU");function Wt(_e){return Object.prototype.toString.call(_e)}function Qt(_e){return _e<10?"0"+_e.toString(10):_e.toString(10)}var ur=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var _e=new Date,me=[Qt(_e.getHours()),Qt(_e.getMinutes()),Qt(_e.getSeconds())].join(":");return[_e.getDate(),ur[_e.getMonth()],me].join(" ")}_.log=function(){console.log("%s - %s",oe(),_.format.apply(_,arguments))},_.inherits=o("R1gD"),_._extend=function(_e,me){if(!me||!Ie(me))return _e;for(var it=Object.keys(me),qt=it.length;qt--;)_e[it[qt]]=me[it[qt]];return _e};function J(_e,me){return Object.prototype.hasOwnProperty.call(_e,me)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;_.promisify=function(me){if(typeof me!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&me[H]){var it=me[H];if(typeof it!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(it,H,{value:it,enumerable:!1,writable:!1,configurable:!0}),it}function it(){for(var qt,Pt,ve=new Promise(function(st,Oe){qt=st,Pt=Oe}),ge=[],Ve=0;Ve<arguments.length;Ve++)ge.push(arguments[Ve]);ge.push(function(st,Oe){st?Pt(st):qt(Oe)});try{me.apply(this,ge)}catch(st){Pt(st)}return ve}return Object.setPrototypeOf(it,Object.getPrototypeOf(me)),H&&Object.defineProperty(it,H,{value:it,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(it,p(me))},_.promisify.custom=H;function Se(_e,me){if(!_e){var it=new Error("Promise was rejected with a falsy value");it.reason=_e,_e=it}return me(_e)}function be(_e){if(typeof _e!="function")throw new TypeError('The "original" argument must be of type Function');function me(){for(var it=[],qt=0;qt<arguments.length;qt++)it.push(arguments[qt]);var Pt=it.pop();if(typeof Pt!="function")throw new TypeError("The last argument must be of type Function");var ve=this,ge=function(){return Pt.apply(ve,arguments)};_e.apply(this,it).then(function(Ve){x.nextTick(ge,null,Ve)},function(Ve){x.nextTick(Se,Ve,ge)})}return Object.setPrototypeOf(me,Object.getPrototypeOf(_e)),Object.defineProperties(me,p(_e)),me}_.callbackify=be}).call(this,o("7vYp"))},Sjl4:function(Fe,_,o){var x=o("by6o"),p=o("4NP+"),Y=o("D/gB"),z=o("y5r/");function i(Z){var D=typeof Map=="function"?new Map:void 0;return Fe.exports=i=function(re){if(re===null||!Y(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(re))return D.get(re);D.set(re,fe)}function fe(){return z(re,arguments,x(this).constructor)}return fe.prototype=Object.create(re.prototype,{constructor:{value:fe,enumerable:!1,writable:!0,configurable:!0}}),p(fe,re)},i(Z)}Fe.exports=i},T0ZP:function(Fe,_,o){(function(x,p){Fe.exports=p()})(this,function(){"use strict";var x=function(je){return je instanceof Uint8Array||je instanceof Uint16Array||je instanceof Uint32Array||je instanceof Int8Array||je instanceof Int16Array||je instanceof Int32Array||je instanceof Float32Array||je instanceof Float64Array||je instanceof Uint8ClampedArray},p=function(je,Mt){for(var Er=Object.keys(Mt),Lr=0;Lr<Er.length;++Lr)je[Er[Lr]]=Mt[Er[Lr]];return je},Y=`
`;function z(ye){return typeof atob!="undefined"?atob(ye):"base64:"+ye}function i(ye){var je=new Error("(regl) "+ye);throw console.error(je),je}function Z(ye,je){ye||i(je)}function D(ye){return ye?": "+ye:""}function K(ye,je,Mt){ye in je||i("unknown parameter ("+ye+")"+D(Mt)+". possible values: "+Object.keys(je).join())}function re(ye,je){x(ye)||i("invalid parameter type"+D(je)+". must be a typed array")}function fe(ye,je){switch(je){case"number":return typeof ye=="number";case"object":return typeof ye=="object";case"string":return typeof ye=="string";case"boolean":return typeof ye=="boolean";case"function":return typeof ye=="function";case"undefined":return typeof ye=="undefined";case"symbol":return typeof ye=="symbol"}}function X(ye,je,Mt){fe(ye,je)||i("invalid parameter type"+D(Mt)+". expected "+je+", got "+typeof ye)}function He(ye,je){ye>=0&&(ye|0)===ye||i("invalid parameter type, ("+ye+")"+D(je)+". must be a nonnegative integer")}function Xe(ye,je,Mt){je.indexOf(ye)<0&&i("invalid value"+D(Mt)+". must be one of: "+je)}var pe=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ce(ye){Object.keys(ye).forEach(function(je){pe.indexOf(je)<0&&i('invalid regl constructor argument "'+je+'". must be one of '+pe)})}function mt(ye,je){for(ye=ye+"";ye.length<je;)ye=" "+ye;return ye}function Ne(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function At(ye,je){this.number=ye,this.line=je,this.errors=[]}function Ye(ye,je,Mt){this.file=ye,this.line=je,this.message=Mt}function Et(){var ye=new Error,je=(ye.stack||ye).toString(),Mt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(je);if(Mt)return Mt[1];var Er=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(je);return Er?Er[1]:"unknown"}function nt(){var ye=new Error,je=(ye.stack||ye).toString(),Mt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(je);if(Mt)return Mt[1];var Er=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(je);return Er?Er[1]:"unknown"}function Ct(ye,je){var Mt=ye.split(`
`),Er=1,Lr=0,wr={unknown:new Ne,0:new Ne};wr.unknown.name=wr[0].name=je||Et(),wr.unknown.lines.push(new At(0,""));for(var _r=0;_r<Mt.length;++_r){var Wr=Mt[_r],un=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(un)switch(un[1]){case"line":var Jr=/(\d+)(\s+\d+)?/.exec(un[2]);Jr&&(Er=Jr[1]|0,Jr[2]&&(Lr=Jr[2]|0,Lr in wr||(wr[Lr]=new Ne)));break;case"define":var Qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(un[2]);Qr&&(wr[Lr].name=Qr[1]?z(Qr[2]):Qr[2]);break}wr[Lr].lines.push(new At(Er++,Wr))}return Object.keys(wr).forEach(function(ln){var Sn=wr[ln];Sn.lines.forEach(function(pn){Sn.index[pn.number]=pn})}),wr}function Ot(ye){var je=[];return ye.split(`
`).forEach(function(Mt){if(Mt.length<5)return;var Er=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Mt);Er?je.push(new Ye(Er[1]|0,Er[2]|0,Er[3].trim())):Mt.length>0&&je.push(new Ye("unknown",0,Mt))}),je}function Re(ye,je){je.forEach(function(Mt){var Er=ye[Mt.file];if(Er){var Lr=Er.index[Mt.line];if(Lr){Lr.errors.push(Mt),Er.hasErrors=!0;return}}ye.unknown.hasErrors=!0,ye.unknown.lines[0].errors.push(Mt)})}function Ie(ye,je,Mt,Er,Lr){if(!ye.getShaderParameter(je,ye.COMPILE_STATUS)){var wr=ye.getShaderInfoLog(je),_r=Er===ye.FRAGMENT_SHADER?"fragment":"vertex";ur(Mt,"string",_r+" shader source must be a string",Lr);var Wr=Ct(Mt,Lr),un=Ot(wr);Re(Wr,un),Object.keys(Wr).forEach(function(Jr){var Qr=Wr[Jr];if(!Qr.hasErrors)return;var ln=[""],Sn=[""];function pn(nn,Tr){ln.push(nn),Sn.push(Tr||"")}pn("file number "+Jr+": "+Qr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qr.lines.forEach(function(nn){if(nn.errors.length>0){pn(mt(nn.number,4)+"|  ","background-color:yellow; font-weight:bold"),pn(nn.line+Y,"color:red; background-color:yellow; font-weight:bold");var Tr=0;nn.errors.forEach(function(xr){var Xr=xr.message,On=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xr);if(On){var Ir=On[1];Xr=On[2];switch(Ir){case"assign":Ir="=";break}Tr=Math.max(nn.line.indexOf(Ir,Tr),0)}else Tr=0;pn(mt("| ",6)),pn(mt("^^^",Tr+3)+Y,"font-weight:bold"),pn(mt("| ",6)),pn(Xr+Y,"font-weight:bold")}),pn(mt("| ",6)+Y)}else pn(mt(nn.number,4)+"|  "),pn(nn.line+Y,"color:red")}),typeof document!="undefined"&&!window.chrome?(Sn[0]=ln.join("%c"),console.log.apply(console,Sn)):console.log(ln.join(""))}),Z.raise("Error compiling "+_r+" shader, "+Wr[0].name)}}function Be(ye,je,Mt,Er,Lr){if(!ye.getProgramParameter(je,ye.LINK_STATUS)){var wr=ye.getProgramInfoLog(je),_r=Ct(Mt,Lr),Wr=Ct(Er,Lr),un='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+_r[0].name+'"';typeof document!="undefined"?console.log("%c"+un+Y+"%c"+wr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(un+Y+wr),Z.raise(un)}}function ft(ye){ye._commandRef=Et()}function Me(ye,je,Mt,Er){ft(ye);function Lr(un){return un?Er.id(un):0}ye._fragId=Lr(ye.static.frag),ye._vertId=Lr(ye.static.vert);function wr(un,Jr){Object.keys(Jr).forEach(function(Qr){un[Er.id(Qr)]=!0})}var _r=ye._uniformSet={};wr(_r,je.static),wr(_r,je.dynamic);var Wr=ye._attributeSet={};wr(Wr,Mt.static),wr(Wr,Mt.dynamic),ye._hasCount="count"in ye.static||"count"in ye.dynamic||"elements"in ye.static||"elements"in ye.dynamic}function ht(ye,je){var Mt=nt();i(ye+" in command "+(je||Et())+(Mt==="unknown"?"":" called from "+Mt))}function Wt(ye,je,Mt){ye||ht(je,Mt||Et())}function Qt(ye,je,Mt,Er){ye in je||ht("unknown parameter ("+ye+")"+D(Mt)+". possible values: "+Object.keys(je).join(),Er||Et())}function ur(ye,je,Mt,Er){fe(ye,je)||ht("invalid parameter type"+D(Mt)+". expected "+je+", got "+typeof ye,Er||Et())}function oe(ye){ye()}function J(ye,je,Mt){ye.texture?Xe(ye.texture._texture.internalformat,je,"unsupported texture format for attachment"):Xe(ye.renderbuffer._renderbuffer.format,Mt,"unsupported renderbuffer format for attachment")}var H=33071,Se=9728,be=9984,_e=9985,me=9986,it=9987,qt=5120,Pt=5121,ve=5122,ge=5123,Ve=5124,st=5125,Oe=5126,vt=32819,C=32820,R=33635,q=34042,ce=36193,Ge={};Ge[qt]=Ge[Pt]=1,Ge[ve]=Ge[ge]=Ge[ce]=Ge[R]=Ge[vt]=Ge[C]=2,Ge[Ve]=Ge[st]=Ge[Oe]=Ge[q]=4;function qe(ye,je){return ye===C||ye===vt||ye===R?2:ye===q?4:Ge[ye]*je}function Tt(ye){return!(ye&ye-1)&&!!ye}function ot(ye,je,Mt){var Er,Lr=je.width,wr=je.height,_r=je.channels;Z(Lr>0&&Lr<=Mt.maxTextureSize&&wr>0&&wr<=Mt.maxTextureSize,"invalid texture shape"),(ye.wrapS!==H||ye.wrapT!==H)&&Z(Tt(Lr)&&Tt(wr),"incompatible wrap mode for texture, both width and height must be power of 2"),je.mipmask===1?Lr!==1&&wr!==1&&Z(ye.minFilter!==be&&ye.minFilter!==me&&ye.minFilter!==_e&&ye.minFilter!==it,"min filter requires mipmap"):(Z(Tt(Lr)&&Tt(wr),"texture must be a square power of 2 to support mipmapping"),Z(je.mipmask===(Lr<<1)-1,"missing or incomplete mipmap data")),je.type===Oe&&(Mt.extensions.indexOf("oes_texture_float_linear")<0&&Z(ye.minFilter===Se&&ye.magFilter===Se,"filter not supported, must enable oes_texture_float_linear"),Z(!ye.genMipmaps,"mipmap generation not supported with float textures"));var Wr=je.images;for(Er=0;Er<16;++Er)if(Wr[Er]){var un=Lr>>Er,Jr=wr>>Er;Z(je.mipmask&1<<Er,"missing mipmap data");var Qr=Wr[Er];if(Z(Qr.width===un&&Qr.height===Jr,"invalid shape for mip images"),Z(Qr.format===je.format&&Qr.internalformat===je.internalformat&&Qr.type===je.type,"incompatible type for mip image"),!Qr.compressed)if(Qr.data){var ln=Math.ceil(qe(Qr.type,_r)*un/Qr.unpackAlignment)*Qr.unpackAlignment;Z(Qr.data.byteLength===ln*Jr,"invalid data for image, buffer size is inconsistent with image format")}else Qr.element||Qr.copy}else ye.genMipmaps||Z((je.mipmask&1<<Er)===0,"extra mipmap data");je.compressed&&Z(!ye.genMipmaps,"mipmap generation for compressed images not supported")}function Ut(ye,je,Mt,Er){var Lr=ye.width,wr=ye.height,_r=ye.channels;Z(Lr>0&&Lr<=Er.maxTextureSize&&wr>0&&wr<=Er.maxTextureSize,"invalid texture shape"),Z(Lr===wr,"cube map must be square"),Z(je.wrapS===H&&je.wrapT===H,"wrap mode not supported by cube map");for(var Wr=0;Wr<Mt.length;++Wr){var un=Mt[Wr];Z(un.width===Lr&&un.height===wr,"inconsistent cube map face shape"),je.genMipmaps&&(Z(!un.compressed,"can not generate mipmap for compressed textures"),Z(un.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Jr=un.images,Qr=0;Qr<16;++Qr){var ln=Jr[Qr];if(ln){var Sn=Lr>>Qr,pn=wr>>Qr;Z(un.mipmask&1<<Qr,"missing mipmap data"),Z(ln.width===Sn&&ln.height===pn,"invalid shape for mip images"),Z(ln.format===ye.format&&ln.internalformat===ye.internalformat&&ln.type===ye.type,"incompatible type for mip image"),ln.compressed||(ln.data?Z(ln.data.byteLength===Sn*pn*Math.max(qe(ln.type,_r),ln.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ln.element||ln.copy)}}}}var $=p(Z,{optional:oe,raise:i,commandRaise:ht,command:Wt,parameter:K,commandParameter:Qt,constructor:Ce,type:X,commandType:ur,isTypedArray:re,nni:He,oneOf:Xe,shaderError:Ie,linkError:Be,callSite:nt,saveCommandRef:ft,saveDrawInfo:Me,framebufferFormat:J,guessCommand:Et,texture2D:ot,textureCube:Ut}),Qe=0,ae=0,et=5,kt=6;function pr(ye,je){this.id=Qe++,this.type=ye,this.data=je}function Ke(ye){return ye.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function bt(ye){if(ye.length===0)return[];var je=ye.charAt(0),Mt=ye.charAt(ye.length-1);if(ye.length>1&&je===Mt&&(je==='"'||je==="'"))return['"'+Ke(ye.substr(1,ye.length-2))+'"'];var Er=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ye);if(Er)return bt(ye.substr(0,Er.index)).concat(bt(Er[1])).concat(bt(ye.substr(Er.index+Er[0].length)));var Lr=ye.split(".");if(Lr.length===1)return['"'+Ke(ye)+'"'];for(var wr=[],_r=0;_r<Lr.length;++_r)wr=wr.concat(bt(Lr[_r]));return wr}function yt(ye){return"["+bt(ye).join("][")+"]"}function xt(ye,je){return new pr(ye,yt(je+""))}function ze(ye){return typeof ye=="function"&&!ye._reglType||ye instanceof pr}function dt(ye,je){if(typeof ye=="function")return new pr(ae,ye);if(typeof ye=="number"||typeof ye=="boolean")return new pr(et,ye);if(Array.isArray(ye))return new pr(kt,ye.map(function(Mt,Er){return dt(Mt,je+"["+Er+"]")}));if(ye instanceof pr)return ye;$(!1,"invalid option type in uniform "+je)}var gt={DynamicVariable:pr,define:xt,isDynamic:ze,unbox:dt,accessor:yt},Ht={next:typeof requestAnimationFrame=="function"?function(ye){return requestAnimationFrame(ye)}:function(ye){return setTimeout(ye,16)},cancel:typeof cancelAnimationFrame=="function"?function(ye){return cancelAnimationFrame(ye)}:clearTimeout},hr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var ye={"":0},je=[""];return{id:function(Er){var Lr=ye[Er];return Lr||(Lr=ye[Er]=je.length,je.push(Er),Lr)},str:function(Er){return je[Er]}}}function yr(ye,je,Mt){var Er=document.createElement("canvas");p(Er.style,{border:0,margin:0,padding:0,top:0,left:0}),ye.appendChild(Er),ye===document.body&&(Er.style.position="absolute",p(ye.style,{margin:0,padding:0}));function Lr(){var Wr=window.innerWidth,un=window.innerHeight;if(ye!==document.body){var Jr=ye.getBoundingClientRect();Wr=Jr.right-Jr.left,un=Jr.bottom-Jr.top}Er.width=Mt*Wr,Er.height=Mt*un,p(Er.style,{width:Wr+"px",height:un+"px"})}var wr;ye!==document.body&&typeof ResizeObserver=="function"?(wr=new ResizeObserver(function(){setTimeout(Lr)}),wr.observe(ye)):window.addEventListener("resize",Lr,!1);function _r(){wr?wr.disconnect():window.removeEventListener("resize",Lr),ye.removeChild(Er)}return Lr(),{canvas:Er,onDestroy:_r}}function Vn(ye,je){function Mt(Er){try{return ye.getContext(Er,je)}catch(Lr){return null}}return Mt("webgl")||Mt("experimental-webgl")||Mt("webgl-experimental")}function Fn(ye){return typeof ye.nodeName=="string"&&typeof ye.appendChild=="function"&&typeof ye.getBoundingClientRect=="function"}function oa(ye){return typeof ye.drawArrays=="function"||typeof ye.drawElements=="function"}function $n(ye){return typeof ye=="string"?ye.split():($(Array.isArray(ye),"invalid extension array"),ye)}function Kn(ye){return typeof ye=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ye)):ye}function Cn(ye){var je=ye||{},Mt,Er,Lr,wr,_r={},Wr=[],un=[],Jr=typeof window=="undefined"?1:window.devicePixelRatio,Qr=!1,ln=function(Tr){Tr&&$.raise(Tr)},Sn=function(){};if(typeof je=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),Mt=document.querySelector(je),$(Mt,"invalid query string for element")):typeof je=="object"?Fn(je)?Mt=je:oa(je)?(wr=je,Lr=wr.canvas):($.constructor(je),"gl"in je?wr=je.gl:"canvas"in je?Lr=Kn(je.canvas):"container"in je&&(Er=Kn(je.container)),"attributes"in je&&(_r=je.attributes,$.type(_r,"object","invalid context attributes")),"extensions"in je&&(Wr=$n(je.extensions)),"optionalExtensions"in je&&(un=$n(je.optionalExtensions)),"onDone"in je&&($.type(je.onDone,"function","invalid or missing onDone callback"),ln=je.onDone),"profile"in je&&(Qr=!!je.profile),"pixelRatio"in je&&(Jr=+je.pixelRatio,$(Jr>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),Mt&&(Mt.nodeName.toLowerCase()==="canvas"?Lr=Mt:Er=Mt),!wr){if(!Lr){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pn=yr(Er||document.body,ln,Jr);if(!pn)return null;Lr=pn.canvas,Sn=pn.onDestroy}_r.premultipliedAlpha===void 0&&(_r.premultipliedAlpha=!0),wr=Vn(Lr,_r)}return wr?{gl:wr,canvas:Lr,container:Er,extensions:Wr,optionalExtensions:un,pixelRatio:Jr,profile:Qr,onDone:ln,onDestroy:Sn}:(Sn(),ln("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function F(ye,je){var Mt={};function Er(_r){$.type(_r,"string","extension name must be string");var Wr=_r.toLowerCase(),un;try{un=Mt[Wr]=ye.getExtension(Wr)}catch(Jr){}return!!un}for(var Lr=0;Lr<je.extensions.length;++Lr){var wr=je.extensions[Lr];if(!Er(wr))return je.onDestroy(),je.onDone('"'+wr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return je.optionalExtensions.forEach(Er),{extensions:Mt,restore:function(){Object.keys(Mt).forEach(function(Wr){if(Mt[Wr]&&!Er(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function W(ye,je){for(var Mt=Array(ye),Er=0;Er<ye;++Er)Mt[Er]=je(Er);return Mt}var le=5120,xe=5121,ut=5122,wt=5123,Bt=5124,Ze=5125,Rt=5126;function lr(ye){for(var je=16;je<=1<<28;je*=16)if(ye<=je)return je;return 0}function Ur(ye){var je,Mt;return je=(ye>65535)<<4,ye>>>=je,Mt=(ye>255)<<3,ye>>>=Mt,je|=Mt,Mt=(ye>15)<<2,ye>>>=Mt,je|=Mt,Mt=(ye>3)<<1,ye>>>=Mt,je|=Mt,je|ye>>1}function Gr(){var ye=W(8,function(){return[]});function je(wr){var _r=lr(wr),Wr=ye[Ur(_r)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(_r)}function Mt(wr){ye[Ur(wr.byteLength)>>2].push(wr)}function Er(wr,_r){var Wr=null;switch(wr){case le:Wr=new Int8Array(je(_r),0,_r);break;case xe:Wr=new Uint8Array(je(_r),0,_r);break;case ut:Wr=new Int16Array(je(2*_r),0,_r);break;case wt:Wr=new Uint16Array(je(2*_r),0,_r);break;case Bt:Wr=new Int32Array(je(4*_r),0,_r);break;case Ze:Wr=new Uint32Array(je(4*_r),0,_r);break;case Rt:Wr=new Float32Array(je(4*_r),0,_r);break;default:return null}return Wr.length!==_r?Wr.subarray(0,_r):Wr}function Lr(wr){Mt(wr.buffer)}return{alloc:je,free:Mt,allocType:Er,freeType:Lr}}var cr=Gr();cr.zero=Gr();var Br=3408,wn=3410,fn=3411,tr=3412,rn=3413,dn=3414,En=3415,bn=33901,gn=33902,Mn=3379,Ga=3386,ga=34921,Ma=36347,Ia=36348,Wi=35661,da=35660,vi=34930,ya=36349,ba=34076,ha=34024,wi=7936,is=7937,Xi=7938,Xo=35724,Du=34047,Ha=36063,Oi=34852,Jo=3553,ui=34067,Yi=34069,Oo=33984,Za=6408,oo=5126,so=5121,bu=36160,Qo=36053,Xl=36064,js=16384,ho=function(je,Mt){var Er=1;Mt.ext_texture_filter_anisotropic&&(Er=je.getParameter(Du));var Lr=1,wr=1;Mt.webgl_draw_buffers&&(Lr=je.getParameter(Oi),wr=je.getParameter(Ha));var _r=!!Mt.oes_texture_float;if(_r){var Wr=je.createTexture();je.bindTexture(Jo,Wr),je.texImage2D(Jo,0,Za,1,1,0,Za,oo,null);var un=je.createFramebuffer();if(je.bindFramebuffer(bu,un),je.framebufferTexture2D(bu,Xl,Jo,Wr,0),je.bindTexture(Jo,null),je.checkFramebufferStatus(bu)!==Qo)_r=!1;else{je.viewport(0,0,1,1),je.clearColor(1,0,0,1),je.clear(js);var Jr=cr.allocType(oo,4);je.readPixels(0,0,1,1,Za,oo,Jr),je.getError()?_r=!1:(je.deleteFramebuffer(un),je.deleteTexture(Wr),_r=Jr[0]===1),cr.freeType(Jr)}}var Qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ln=!0;if(!Qr){var Sn=je.createTexture(),pn=cr.allocType(so,36);je.activeTexture(Oo),je.bindTexture(ui,Sn),je.texImage2D(Yi,0,Za,3,3,0,Za,so,pn),cr.freeType(pn),je.bindTexture(ui,null),je.deleteTexture(Sn),ln=!je.getError()}return{colorBits:[je.getParameter(wn),je.getParameter(fn),je.getParameter(tr),je.getParameter(rn)],depthBits:je.getParameter(dn),stencilBits:je.getParameter(En),subpixelBits:je.getParameter(Br),extensions:Object.keys(Mt).filter(function(nn){return!!Mt[nn]}),maxAnisotropic:Er,maxDrawbuffers:Lr,maxColorAttachments:wr,pointSizeDims:je.getParameter(bn),lineWidthDims:je.getParameter(gn),maxViewportDims:je.getParameter(Ga),maxCombinedTextureUnits:je.getParameter(Wi),maxCubeMapSize:je.getParameter(ba),maxRenderbufferSize:je.getParameter(ha),maxTextureUnits:je.getParameter(vi),maxTextureSize:je.getParameter(Mn),maxAttributes:je.getParameter(ga),maxVertexUniforms:je.getParameter(Ma),maxVertexTextureUnits:je.getParameter(da),maxVaryingVectors:je.getParameter(Ia),maxFragmentUniforms:je.getParameter(ya),glsl:je.getParameter(Xo),renderer:je.getParameter(is),vendor:je.getParameter(wi),version:je.getParameter(Xi),readFloat:_r,npotTextureCube:ln}};function Vt(ye){return!!ye&&typeof ye=="object"&&Array.isArray(ye.shape)&&Array.isArray(ye.stride)&&typeof ye.offset=="number"&&ye.shape.length===ye.stride.length&&(Array.isArray(ye.data)||x(ye.data))}var Le=function(je){return Object.keys(je).map(function(Mt){return je[Mt]})},Dt={shape:po,flatten:Mi};function vr(ye,je,Mt){for(var Er=0;Er<je;++Er)Mt[Er]=ye[Er]}function en(ye,je,Mt,Er){for(var Lr=0,wr=0;wr<je;++wr)for(var _r=ye[wr],Wr=0;Wr<Mt;++Wr)Er[Lr++]=_r[Wr]}function _n(ye,je,Mt,Er,Lr,wr){for(var _r=wr,Wr=0;Wr<je;++Wr)for(var un=ye[Wr],Jr=0;Jr<Mt;++Jr)for(var Qr=un[Jr],ln=0;ln<Er;++ln)Lr[_r++]=Qr[ln]}function Gn(ye,je,Mt,Er,Lr){for(var wr=1,_r=Mt+1;_r<je.length;++_r)wr*=je[_r];var Wr=je[Mt];if(je.length-Mt===4){var un=je[Mt+1],Jr=je[Mt+2],Qr=je[Mt+3];for(_r=0;_r<Wr;++_r)_n(ye[_r],un,Jr,Qr,Er,Lr),Lr+=wr}else for(_r=0;_r<Wr;++_r)Gn(ye[_r],je,Mt+1,Er,Lr),Lr+=wr}function Mi(ye,je,Mt,Er){var Lr=1;if(je.length)for(var wr=0;wr<je.length;++wr)Lr*=je[wr];else Lr=0;var _r=Er||cr.allocType(Mt,Lr);switch(je.length){case 0:break;case 1:vr(ye,je[0],_r);break;case 2:en(ye,je[0],je[1],_r);break;case 3:_n(ye,je[0],je[1],je[2],_r,0);break;default:Gn(ye,je,0,_r,0)}return _r}function po(ye){for(var je=[],Mt=ye;Mt.length;Mt=Mt[0])je.push(Mt.length);return je}var mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Mo=5120,Nu=5122,Ol=5124,_s=5121,pc=5123,xu=5125,Po=5126,ku=5126,To={int8:Mo,int16:Nu,int32:Ol,uint8:_s,uint16:pc,uint32:xu,float:Po,float32:ku},Fi=35048,Ys=35040,Ks={dynamic:Fi,stream:Ys,static:35044},zs=Dt.flatten,Ii=Dt.shape,Gi=35044,Ts=35040,ml=5121,$u=5126,It=[];It[5120]=1,It[5122]=2,It[5124]=4,It[5121]=1,It[5123]=2,It[5125]=4,It[5126]=4;function fr(ye){return mo[Object.prototype.toString.call(ye)]|0}function Pr(ye,je){for(var Mt=0;Mt<je.length;++Mt)ye[Mt]=je[Mt]}function Wn(ye,je,Mt,Er,Lr,wr,_r){for(var Wr=0,un=0;un<Mt;++un)for(var Jr=0;Jr<Er;++Jr)ye[Wr++]=je[Lr*un+wr*Jr+_r]}function Ya(ye,je,Mt,Er){var Lr=0,wr={};function _r(Tr){this.id=Lr++,this.buffer=ye.createBuffer(),this.type=Tr,this.usage=Gi,this.byteLength=0,this.dimension=1,this.dtype=ml,this.persistentData=null,Mt.profile&&(this.stats={size:0})}_r.prototype.bind=function(){ye.bindBuffer(this.type,this.buffer)},_r.prototype.destroy=function(){Sn(this)};var Wr=[];function un(Tr,xr){var Xr=Wr.pop();return Xr||(Xr=new _r(Tr)),Xr.bind(),ln(Xr,xr,Ts,0,1,!1),Xr}function Jr(Tr){Wr.push(Tr)}function Qr(Tr,xr,Xr){Tr.byteLength=xr.byteLength,ye.bufferData(Tr.type,xr,Xr)}function ln(Tr,xr,Xr,On,Ir,ta){var qr;if(Tr.usage=Xr,Array.isArray(xr)){if(Tr.dtype=On||$u,xr.length>0){var Fr;if(Array.isArray(xr[0])){qr=Ii(xr);for(var Vr=1,Kr=1;Kr<qr.length;++Kr)Vr*=qr[Kr];Tr.dimension=Vr,Fr=zs(xr,qr,Tr.dtype),Qr(Tr,Fr,Xr),ta?Tr.persistentData=Fr:cr.freeType(Fr)}else if(typeof xr[0]=="number"){Tr.dimension=Ir;var Xn=cr.allocType(Tr.dtype,xr.length);Pr(Xn,xr),Qr(Tr,Xn,Xr),ta?Tr.persistentData=Xn:cr.freeType(Xn)}else x(xr[0])?(Tr.dimension=xr[0].length,Tr.dtype=On||fr(xr[0])||$u,Fr=zs(xr,[xr.length,xr[0].length],Tr.dtype),Qr(Tr,Fr,Xr),ta?Tr.persistentData=Fr:cr.freeType(Fr)):$.raise("invalid buffer data")}}else if(x(xr))Tr.dtype=On||fr(xr),Tr.dimension=Ir,Qr(Tr,xr,Xr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(xr.buffer)));else if(Vt(xr)){qr=xr.shape;var na=xr.stride,cn=xr.offset,Hr=0,jr=0,ma=0,pa=0;qr.length===1?(Hr=qr[0],jr=1,ma=na[0],pa=0):qr.length===2?(Hr=qr[0],jr=qr[1],ma=na[0],pa=na[1]):$.raise("invalid shape"),Tr.dtype=On||fr(xr.data)||$u,Tr.dimension=jr;var Un=cr.allocType(Tr.dtype,Hr*jr);Wn(Un,xr.data,Hr,jr,ma,pa,cn),Qr(Tr,Un,Xr),ta?Tr.persistentData=Un:cr.freeType(Un)}else xr instanceof ArrayBuffer?(Tr.dtype=ml,Tr.dimension=Ir,Qr(Tr,xr,Xr),ta&&(Tr.persistentData=new Uint8Array(new Uint8Array(xr)))):$.raise("invalid buffer data")}function Sn(Tr){je.bufferCount--,Er(Tr);var xr=Tr.buffer;$(xr,"buffer must not be deleted already"),ye.deleteBuffer(xr),Tr.buffer=null,delete wr[Tr.id]}function pn(Tr,xr,Xr,On){je.bufferCount++;var Ir=new _r(xr);wr[Ir.id]=Ir;function ta(Vr){var Kr=Gi,Xn=null,na=0,cn=0,Hr=1;return Array.isArray(Vr)||x(Vr)||Vt(Vr)||Vr instanceof ArrayBuffer?Xn=Vr:typeof Vr=="number"?na=Vr|0:Vr&&($.type(Vr,"object","buffer arguments must be an object, a number or an array"),"data"in Vr&&($(Xn===null||Array.isArray(Xn)||x(Xn)||Vt(Xn),"invalid data for buffer"),Xn=Vr.data),"usage"in Vr&&($.parameter(Vr.usage,Ks,"invalid buffer usage"),Kr=Ks[Vr.usage]),"type"in Vr&&($.parameter(Vr.type,To,"invalid buffer type"),cn=To[Vr.type]),"dimension"in Vr&&($.type(Vr.dimension,"number","invalid dimension"),Hr=Vr.dimension|0),"length"in Vr&&($.nni(na,"buffer length must be a nonnegative integer"),na=Vr.length|0)),Ir.bind(),Xn?ln(Ir,Xn,Kr,cn,Hr,On):(na&&ye.bufferData(Ir.type,na,Kr),Ir.dtype=cn||ml,Ir.usage=Kr,Ir.dimension=Hr,Ir.byteLength=na),Mt.profile&&(Ir.stats.size=Ir.byteLength*It[Ir.dtype]),ta}function qr(Vr,Kr){$(Kr+Vr.byteLength<=Ir.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Vr.byteLength+" starting from offset "+Kr+" to a buffer of size "+Ir.byteLength),ye.bufferSubData(Ir.type,Kr,Vr)}function Fr(Vr,Kr){var Xn=(Kr||0)|0,na;if(Ir.bind(),x(Vr)||Vr instanceof ArrayBuffer)qr(Vr,Xn);else if(Array.isArray(Vr)){if(Vr.length>0)if(typeof Vr[0]=="number"){var cn=cr.allocType(Ir.dtype,Vr.length);Pr(cn,Vr),qr(cn,Xn),cr.freeType(cn)}else if(Array.isArray(Vr[0])||x(Vr[0])){na=Ii(Vr);var Hr=zs(Vr,na,Ir.dtype);qr(Hr,Xn),cr.freeType(Hr)}else $.raise("invalid buffer data")}else if(Vt(Vr)){na=Vr.shape;var jr=Vr.stride,ma=0,pa=0,Un=0,Ua=0;na.length===1?(ma=na[0],pa=1,Un=jr[0],Ua=0):na.length===2?(ma=na[0],pa=na[1],Un=jr[0],Ua=jr[1]):$.raise("invalid shape");var _a=Array.isArray(Vr.data)?Ir.dtype:fr(Vr.data),Ba=cr.allocType(_a,ma*pa);Wn(Ba,Vr.data,ma,pa,Un,Ua,Vr.offset),qr(Ba,Xn),cr.freeType(Ba)}else $.raise("invalid data for buffer subdata");return ta}return Xr||ta(Tr),ta._reglType="buffer",ta._buffer=Ir,ta.subdata=Fr,Mt.profile&&(ta.stats=Ir.stats),ta.destroy=function(){Sn(Ir)},ta}function nn(){Le(wr).forEach(function(Tr){Tr.buffer=ye.createBuffer(),ye.bindBuffer(Tr.type,Tr.buffer),ye.bufferData(Tr.type,Tr.persistentData||Tr.byteLength,Tr.usage)})}return Mt.profile&&(je.getTotalBufferSize=function(){var Tr=0;return Object.keys(wr).forEach(function(xr){Tr+=wr[xr].stats.size}),Tr}),{create:pn,createStream:un,destroyStream:Jr,clear:function(){Le(wr).forEach(Sn),Wr.forEach(Sn)},getBuffer:function(xr){return xr&&xr._buffer instanceof _r?xr._buffer:null},restore:nn,_initBuffer:ln}}var xi=0,Ki=0,Ka=1,Di=1,Yo=4,Ps=4,gi={points:xi,point:Ki,lines:Ka,line:Di,triangles:Yo,triangle:Ps,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ml=0,$s=1,Ss=4,vl=5120,cu=5121,Eu=5122,fu=5123,ju=5124,Js=5125,Mc=34963,hf=35040,pi=35044;function Pc(ye,je,Mt,Er){var Lr={},wr=0,_r={uint8:cu,uint16:fu};je.oes_element_index_uint&&(_r.uint32=Js);function Wr(nn){this.id=wr++,Lr[this.id]=this,this.buffer=nn,this.primType=Ss,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var un=[];function Jr(nn){var Tr=un.pop();return Tr||(Tr=new Wr(Mt.create(null,Mc,!0,!1)._buffer)),ln(Tr,nn,hf,-1,-1,0,0),Tr}function Qr(nn){un.push(nn)}function ln(nn,Tr,xr,Xr,On,Ir,ta){nn.buffer.bind();var qr;if(Tr){var Fr=ta;!ta&&(!x(Tr)||Vt(Tr)&&!x(Tr.data))&&(Fr=je.oes_element_index_uint?Js:fu),Mt._initBuffer(nn.buffer,Tr,xr,Fr,3)}else ye.bufferData(Mc,Ir,xr),nn.buffer.dtype=qr||cu,nn.buffer.usage=xr,nn.buffer.dimension=3,nn.buffer.byteLength=Ir;if(qr=ta,!ta){switch(nn.buffer.dtype){case cu:case vl:qr=cu;break;case fu:case Eu:qr=fu;break;case Js:case ju:qr=Js;break;default:$.raise("unsupported type for element array")}nn.buffer.dtype=qr}nn.type=qr,$(qr!==Js||!!je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Vr=On;Vr<0&&(Vr=nn.buffer.byteLength,qr===fu?Vr>>=1:qr===Js&&(Vr>>=2)),nn.vertCount=Vr;var Kr=Xr;if(Xr<0){Kr=Ss;var Xn=nn.buffer.dimension;Xn===1&&(Kr=Ml),Xn===2&&(Kr=$s),Xn===3&&(Kr=Ss)}nn.primType=Kr}function Sn(nn){Er.elementsCount--,$(nn.buffer!==null,"must not double destroy elements"),delete Lr[nn.id],nn.buffer.destroy(),nn.buffer=null}function pn(nn,Tr){var xr=Mt.create(null,Mc,!0),Xr=new Wr(xr._buffer);Er.elementsCount++;function On(Ir){if(!Ir)xr(),Xr.primType=Ss,Xr.vertCount=0,Xr.type=cu;else if(typeof Ir=="number")xr(Ir),Xr.primType=Ss,Xr.vertCount=Ir|0,Xr.type=cu;else{var ta=null,qr=pi,Fr=-1,Vr=-1,Kr=0,Xn=0;Array.isArray(Ir)||x(Ir)||Vt(Ir)?ta=Ir:($.type(Ir,"object","invalid arguments for elements"),"data"in Ir&&(ta=Ir.data,$(Array.isArray(ta)||x(ta)||Vt(ta),"invalid data for element buffer")),"usage"in Ir&&($.parameter(Ir.usage,Ks,"invalid element buffer usage"),qr=Ks[Ir.usage]),"primitive"in Ir&&($.parameter(Ir.primitive,gi,"invalid element buffer primitive"),Fr=gi[Ir.primitive]),"count"in Ir&&($(typeof Ir.count=="number"&&Ir.count>=0,"invalid vertex count for elements"),Vr=Ir.count|0),"type"in Ir&&($.parameter(Ir.type,_r,"invalid buffer type"),Xn=_r[Ir.type]),"length"in Ir?Kr=Ir.length|0:(Kr=Vr,Xn===fu||Xn===Eu?Kr*=2:(Xn===Js||Xn===ju)&&(Kr*=4))),ln(Xr,ta,qr,Fr,Vr,Kr,Xn)}return On}return On(nn),On._reglType="elements",On._elements=Xr,On.subdata=function(Ir,ta){return xr.subdata(Ir,ta),On},On.destroy=function(){Sn(Xr)},On}return{create:pn,createStream:Jr,destroyStream:Qr,getElements:function(Tr){return typeof Tr=="function"&&Tr._elements instanceof Wr?Tr._elements:null},clear:function(){Le(Lr).forEach(Sn)}}}var mc=new Float32Array(1),$c=new Uint32Array(mc.buffer),gl=5123;function Jc(ye){for(var je=cr.allocType(gl,ye.length),Mt=0;Mt<ye.length;++Mt)if(isNaN(ye[Mt]))je[Mt]=65535;else if(ye[Mt]===Infinity)je[Mt]=31744;else if(ye[Mt]===-Infinity)je[Mt]=64512;else{mc[0]=ye[Mt];var Er=$c[0],Lr=Er>>>31<<15,wr=(Er<<1>>>24)-127,_r=Er>>13&(1<<10)-1;if(wr<-24)je[Mt]=Lr;else if(wr<-14){var Wr=-14-wr;je[Mt]=Lr+(_r+(1<<10)>>Wr)}else wr>15?je[Mt]=Lr+31744:je[Mt]=Lr+(wr+15<<10)+_r}return je}function $i(ye){return Array.isArray(ye)||x(ye)}var _u=function(je){return!(je&je-1)&&!!je},yl=34467,os=3553,Lc=34067,vc=34069,Pl=6408,Ju=6406,Rc=6407,hu=6409,Tu=6410,Qc=32854,Yl=32855,Si=36194,qc=32819,df=32820,Kl=33635,Ic=34042,$l=6402,Qu=34041,zu=35904,bl=35906,Lo=36193,Jl=33776,Ll=33777,Rl=33778,Dc=33779,xl=35986,Qs=35987,eo=34798,pf=35840,mf=35841,El=35842,Ql=35843,qu=36196,Il=5121,gc=5123,yc=5125,el=5126,ef=10242,tl=10243,qs=10497,_l=33071,ql=33648,Nc=10240,tf=10241,Fs=9728,vf=9729,rl=9984,Pi=9985,nl=9986,Fu=9987,fi=33170,kn=4352,Li=4353,Ls=4354,Dl=34046,Uu=3317,al=37440,gf=37441,ss=37443,Tl=37444,il=33984,ol=[rl,nl,Pi,Fu],Ui=[0,hu,Tu,Rc,Pl],As={};As[hu]=As[Ju]=As[$l]=1,As[Qu]=As[Tu]=2,As[Rc]=As[zu]=3,As[Pl]=As[bl]=4;function Nl(ye){return"[object "+ye+"]"}var to=Nl("HTMLCanvasElement"),Rn=Nl("OffscreenCanvas"),Us=Nl("CanvasRenderingContext2D"),ni=Nl("ImageBitmap"),kl=Nl("HTMLImageElement"),du=Nl("HTMLVideoElement"),Bs=Object.keys(mo).concat([to,Rn,Us,ni,kl,du]),sl=[];sl[Il]=1,sl[el]=4,sl[Lo]=2,sl[gc]=2,sl[yc]=4;var tn=[];tn[Qc]=2,tn[Yl]=2,tn[Si]=2,tn[Qu]=4,tn[Jl]=.5,tn[Ll]=.5,tn[Rl]=1,tn[Dc]=1,tn[xl]=.5,tn[Qs]=1,tn[eo]=1,tn[pf]=.5,tn[mf]=.25,tn[El]=.5,tn[Ql]=.25,tn[qu]=.5;function bc(ye){return Array.isArray(ye)&&(ye.length===0||typeof ye[0]=="number")}function us(ye){if(!Array.isArray(ye))return!1;var je=ye.length;return!(je===0||!$i(ye[0]))}function ro(ye){return Object.prototype.toString.call(ye)}function qo(ye){return ro(ye)===to}function Rs(ye){return ro(ye)===Rn}function jl(ye){return ro(ye)===Us}function kc(ye){return ro(ye)===ni}function Vs(ye){return ro(ye)===kl}function Su(ye){return ro(ye)===du}function zl(ye){if(!ye)return!1;var je=ro(ye);return Bs.indexOf(je)>=0?!0:bc(ye)||us(ye)||Vt(ye)}function Fl(ye){return mo[Object.prototype.toString.call(ye)]|0}function rf(ye,je){var Mt=je.length;switch(ye.type){case Il:case gc:case yc:case el:var Er=cr.allocType(ye.type,Mt);Er.set(je),ye.data=Er;break;case Lo:ye.data=Jc(je);break;default:$.raise("unsupported texture type, must specify a typed array")}}function jc(ye,je){return cr.allocType(ye.type===Lo?el:ye.type,je)}function Ro(ye,je){ye.type===Lo?(ye.data=Jc(je),cr.freeType(je)):ye.data=je}function ls(ye,je,Mt,Er,Lr,wr){for(var _r=ye.width,Wr=ye.height,un=ye.channels,Jr=_r*Wr*un,Qr=jc(ye,Jr),ln=0,Sn=0;Sn<Wr;++Sn)for(var pn=0;pn<_r;++pn)for(var nn=0;nn<un;++nn)Qr[ln++]=je[Mt*pn+Er*Sn+Lr*nn+wr];Ro(ye,Qr)}function Pa(ye,je,Mt,Er,Lr,wr){var _r;if(typeof tn[ye]!="undefined"?_r=tn[ye]:_r=As[ye]*sl[je],wr&&(_r*=6),Lr){for(var Wr=0,un=Mt;un>=1;)Wr+=_r*un*un,un/=2;return Wr}else return _r*Mt*Er}function eu(ye,je,Mt,Er,Lr,wr,_r){var Wr={"don't care":kn,"dont care":kn,nice:Ls,fast:Li},un={repeat:qs,clamp:_l,mirror:ql},Jr={nearest:Fs,linear:vf},Qr=p({mipmap:Fu,"nearest mipmap nearest":rl,"linear mipmap nearest":Pi,"nearest mipmap linear":nl,"linear mipmap linear":Fu},Jr),ln={none:0,browser:Tl},Sn={uint8:Il,rgba4:qc,rgb565:Kl,"rgb5 a1":df},pn={alpha:Ju,luminance:hu,"luminance alpha":Tu,rgb:Rc,rgba:Pl,rgba4:Qc,"rgb5 a1":Yl,rgb565:Si},nn={};je.ext_srgb&&(pn.srgb=zu,pn.srgba=bl),je.oes_texture_float&&(Sn.float32=Sn.float=el),je.oes_texture_half_float&&(Sn.float16=Sn["half float"]=Lo),je.webgl_depth_texture&&(p(pn,{depth:$l,"depth stencil":Qu}),p(Sn,{uint16:gc,uint32:yc,"depth stencil":Ic})),je.webgl_compressed_texture_s3tc&&p(nn,{"rgb s3tc dxt1":Jl,"rgba s3tc dxt1":Ll,"rgba s3tc dxt3":Rl,"rgba s3tc dxt5":Dc}),je.webgl_compressed_texture_atc&&p(nn,{"rgb atc":xl,"rgba atc explicit alpha":Qs,"rgba atc interpolated alpha":eo}),je.webgl_compressed_texture_pvrtc&&p(nn,{"rgb pvrtc 4bppv1":pf,"rgb pvrtc 2bppv1":mf,"rgba pvrtc 4bppv1":El,"rgba pvrtc 2bppv1":Ql}),je.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=qu);var Tr=Array.prototype.slice.call(ye.getParameter(yl));Object.keys(nn).forEach(function(c){var d=nn[c];Tr.indexOf(d)>=0&&(pn[c]=d)});var xr=Object.keys(pn);Mt.textureFormats=xr;var Xr=[];Object.keys(pn).forEach(function(c){var d=pn[c];Xr[d]=c});var On=[];Object.keys(Sn).forEach(function(c){var d=Sn[c];On[d]=c});var Ir=[];Object.keys(Jr).forEach(function(c){var d=Jr[c];Ir[d]=c});var ta=[];Object.keys(Qr).forEach(function(c){var d=Qr[c];ta[d]=c});var qr=[];Object.keys(un).forEach(function(c){var d=un[c];qr[d]=c});var Fr=xr.reduce(function(c,d){var g=pn[d];return g===hu||g===Ju||g===hu||g===Tu||g===$l||g===Qu||je.ext_srgb&&(g===zu||g===bl)?c[g]=g:g===Yl||d.indexOf("rgba")>=0?c[g]=Pl:c[g]=Rc,c},{});function Vr(){this.internalformat=Pl,this.format=Pl,this.type=Il,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Tl,this.width=0,this.height=0,this.channels=0}function Kr(c,d){c.internalformat=d.internalformat,c.format=d.format,c.type=d.type,c.compressed=d.compressed,c.premultiplyAlpha=d.premultiplyAlpha,c.flipY=d.flipY,c.unpackAlignment=d.unpackAlignment,c.colorSpace=d.colorSpace,c.width=d.width,c.height=d.height,c.channels=d.channels}function Xn(c,d){if(typeof d!="object"||!d)return;if("premultiplyAlpha"in d&&($.type(d.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),c.premultiplyAlpha=d.premultiplyAlpha),"flipY"in d&&($.type(d.flipY,"boolean","invalid texture flip"),c.flipY=d.flipY),"alignment"in d&&($.oneOf(d.alignment,[1,2,4,8],"invalid texture unpack alignment"),c.unpackAlignment=d.alignment),"colorSpace"in d&&($.parameter(d.colorSpace,ln,"invalid colorSpace"),c.colorSpace=ln[d.colorSpace]),"type"in d){var g=d.type;$(je.oes_texture_float||!(g==="float"||g==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(je.oes_texture_half_float||!(g==="half float"||g==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(je.webgl_depth_texture||!(g==="uint16"||g==="uint32"||g==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(g,Sn,"invalid texture type"),c.type=Sn[g]}var I=c.width,ee=c.height,B=c.channels,k=!1;"shape"in d?($(Array.isArray(d.shape)&&d.shape.length>=2,"shape must be an array"),I=d.shape[0],ee=d.shape[1],d.shape.length===3&&(B=d.shape[2],$(B>0&&B<=4,"invalid number of channels"),k=!0),$(I>=0&&I<=Mt.maxTextureSize,"invalid width"),$(ee>=0&&ee<=Mt.maxTextureSize,"invalid height")):("radius"in d&&(I=ee=d.radius,$(I>=0&&I<=Mt.maxTextureSize,"invalid radius")),"width"in d&&(I=d.width,$(I>=0&&I<=Mt.maxTextureSize,"invalid width")),"height"in d&&(ee=d.height,$(ee>=0&&ee<=Mt.maxTextureSize,"invalid height")),"channels"in d&&(B=d.channels,$(B>0&&B<=4,"invalid number of channels"),k=!0)),c.width=I|0,c.height=ee|0,c.channels=B|0;var Q=!1;if("format"in d){var We=d.format;$(je.webgl_depth_texture||!(We==="depth"||We==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(We,pn,"invalid texture format");var tt=c.internalformat=pn[We];c.format=Fr[tt],We in Sn&&("type"in d||(c.type=Sn[We])),We in nn&&(c.compressed=!0),Q=!0}!k&&Q?c.channels=As[c.format]:k&&!Q?c.channels!==Ui[c.format]&&(c.format=c.internalformat=Ui[c.channels]):Q&&k&&$(c.channels===As[c.format],"number of channels inconsistent with specified format")}function na(c){ye.pixelStorei(al,c.flipY),ye.pixelStorei(gf,c.premultiplyAlpha),ye.pixelStorei(ss,c.colorSpace),ye.pixelStorei(Uu,c.unpackAlignment)}function cn(){Vr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Hr(c,d){var g=null;if(zl(d)?g=d:d&&($.type(d,"object","invalid pixel data type"),Xn(c,d),"x"in d&&(c.xOffset=d.x|0),"y"in d&&(c.yOffset=d.y|0),zl(d.data)&&(g=d.data)),$(!c.compressed||g instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),d.copy){$(!g,"can not specify copy and data field for the same texture");var I=Lr.viewportWidth,ee=Lr.viewportHeight;c.width=c.width||I-c.xOffset,c.height=c.height||ee-c.yOffset,c.needsCopy=!0,$(c.xOffset>=0&&c.xOffset<I&&c.yOffset>=0&&c.yOffset<ee&&c.width>0&&c.width<=I&&c.height>0&&c.height<=ee,"copy texture read out of bounds")}else if(!g)c.width=c.width||1,c.height=c.height||1,c.channels=c.channels||4;else if(x(g))c.channels=c.channels||4,c.data=g,!("type"in d)&&c.type===Il&&(c.type=Fl(g));else if(bc(g))c.channels=c.channels||4,rf(c,g),c.alignment=1,c.needsFree=!0;else if(Vt(g)){var B=g.data;!Array.isArray(B)&&c.type===Il&&(c.type=Fl(B));var k=g.shape,Q=g.stride,We,tt,Pe,Je,_t,ke;k.length===3?(Pe=k[2],ke=Q[2]):($(k.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Pe=1,ke=1),We=k[0],tt=k[1],Je=Q[0],_t=Q[1],c.alignment=1,c.width=We,c.height=tt,c.channels=Pe,c.format=c.internalformat=Ui[Pe],c.needsFree=!0,ls(c,B,Je,_t,ke,g.offset)}else if(qo(g)||Rs(g)||jl(g))qo(g)||Rs(g)?c.element=g:c.element=g.canvas,c.width=c.element.width,c.height=c.element.height,c.channels=4;else if(kc(g))c.element=g,c.width=g.width,c.height=g.height,c.channels=4;else if(Vs(g))c.element=g,c.width=g.naturalWidth,c.height=g.naturalHeight,c.channels=4;else if(Su(g))c.element=g,c.width=g.videoWidth,c.height=g.videoHeight,c.channels=4;else if(us(g)){var pt=c.width||g[0].length,De=c.height||g.length,Zt=c.channels;$i(g[0][0])?Zt=Zt||g[0][0].length:Zt=Zt||1;for(var Kt=Dt.shape(g),dr=1,rr=0;rr<Kt.length;++rr)dr*=Kt[rr];var mr=jc(c,dr);Dt.flatten(g,Kt,"",mr),Ro(c,mr),c.alignment=1,c.width=pt,c.height=De,c.channels=Zt,c.format=c.internalformat=Ui[Zt],c.needsFree=!0}c.type===el?$(Mt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):c.type===Lo&&$(Mt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function jr(c,d,g){var I=c.element,ee=c.data,B=c.internalformat,k=c.format,Q=c.type,We=c.width,tt=c.height;na(c),I?ye.texImage2D(d,g,k,k,Q,I):c.compressed?ye.compressedTexImage2D(d,g,B,We,tt,0,ee):c.needsCopy?(Er(),ye.copyTexImage2D(d,g,k,c.xOffset,c.yOffset,We,tt,0)):ye.texImage2D(d,g,k,We,tt,0,k,Q,ee||null)}function ma(c,d,g,I,ee){var B=c.element,k=c.data,Q=c.internalformat,We=c.format,tt=c.type,Pe=c.width,Je=c.height;na(c),B?ye.texSubImage2D(d,ee,g,I,We,tt,B):c.compressed?ye.compressedTexSubImage2D(d,ee,g,I,Q,Pe,Je,k):c.needsCopy?(Er(),ye.copyTexSubImage2D(d,ee,g,I,c.xOffset,c.yOffset,Pe,Je)):ye.texSubImage2D(d,ee,g,I,Pe,Je,We,tt,k)}var pa=[];function Un(){return pa.pop()||new cn}function Ua(c){c.needsFree&&cr.freeType(c.data),cn.call(c),pa.push(c)}function _a(){Vr.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function Ba(c,d,g){var I=c.images[0]=Un();c.mipmask=1,I.width=c.width=d,I.height=c.height=g,I.channels=c.channels=4}function hi(c,d){var g=null;if(zl(d))g=c.images[0]=Un(),Kr(g,c),Hr(g,d),c.mipmask=1;else if(Xn(c,d),Array.isArray(d.mipmap))for(var I=d.mipmap,ee=0;ee<I.length;++ee)g=c.images[ee]=Un(),Kr(g,c),g.width>>=ee,g.height>>=ee,Hr(g,I[ee]),c.mipmask|=1<<ee;else g=c.images[0]=Un(),Kr(g,c),Hr(g,d),c.mipmask=1;Kr(c,c.images[0]),c.compressed&&(c.internalformat===Jl||c.internalformat===Ll||c.internalformat===Rl||c.internalformat===Dc)&&$(c.width%4===0&&c.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function zo(c,d){for(var g=c.images,I=0;I<g.length;++I){if(!g[I])return;jr(g[I],d,I)}}var Os=[];function ei(){var c=Os.pop()||new _a;Vr.call(c),c.mipmask=0;for(var d=0;d<16;++d)c.images[d]=null;return c}function bo(c){for(var d=c.images,g=0;g<d.length;++g)d[g]&&Ua(d[g]),d[g]=null;Os.push(c)}function Ci(){this.minFilter=Fs,this.magFilter=Fs,this.wrapS=_l,this.wrapT=_l,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function vs(c,d){if("min"in d){var g=d.min;$.parameter(g,Qr),c.minFilter=Qr[g],ol.indexOf(c.minFilter)>=0&&!("faces"in d)&&(c.genMipmaps=!0)}if("mag"in d){var I=d.mag;$.parameter(I,Jr),c.magFilter=Jr[I]}var ee=c.wrapS,B=c.wrapT;if("wrap"in d){var k=d.wrap;typeof k=="string"?($.parameter(k,un),ee=B=un[k]):Array.isArray(k)&&($.parameter(k[0],un),$.parameter(k[1],un),ee=un[k[0]],B=un[k[1]])}else{if("wrapS"in d){var Q=d.wrapS;$.parameter(Q,un),ee=un[Q]}if("wrapT"in d){var We=d.wrapT;$.parameter(We,un),B=un[We]}}if(c.wrapS=ee,c.wrapT=B,"anisotropic"in d){var tt=d.anisotropic;$(typeof tt=="number"&&tt>=1&&tt<=Mt.maxAnisotropic,"aniso samples must be between 1 and "),c.anisotropic=d.anisotropic}if("mipmap"in d){var Pe=!1;switch(typeof d.mipmap){case"string":$.parameter(d.mipmap,Wr,"invalid mipmap hint"),c.mipmapHint=Wr[d.mipmap],c.genMipmaps=!0,Pe=!0;break;case"boolean":Pe=c.genMipmaps=d.mipmap;break;case"object":$(Array.isArray(d.mipmap),"invalid mipmap type"),c.genMipmaps=!1,Pe=!0;break;default:$.raise("invalid mipmap type")}Pe&&!("min"in d)&&(c.minFilter=rl)}}function Fo(c,d){ye.texParameteri(d,tf,c.minFilter),ye.texParameteri(d,Nc,c.magFilter),ye.texParameteri(d,ef,c.wrapS),ye.texParameteri(d,tl,c.wrapT),je.ext_texture_filter_anisotropic&&ye.texParameteri(d,Dl,c.anisotropic),c.genMipmaps&&(ye.hint(fi,c.mipmapHint),ye.generateMipmap(d))}var gs=0,Uo={},Bo=Mt.maxTextureUnits,Vo=Array(Bo).map(function(){return null});function aa(c){Vr.call(this),this.mipmask=0,this.internalformat=Pl,this.id=gs++,this.refCount=1,this.target=c,this.texture=ye.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ci,_r.profile&&(this.stats={size:0})}function ou(c){ye.activeTexture(il),ye.bindTexture(c.target,c.texture)}function yi(){var c=Vo[0];c?ye.bindTexture(c.target,c.texture):ye.bindTexture(os,null)}function An(c){var d=c.texture;$(d,"must not double destroy texture");var g=c.unit,I=c.target;g>=0&&(ye.activeTexture(il+g),ye.bindTexture(I,null),Vo[g]=null),ye.deleteTexture(d),c.texture=null,c.params=null,c.pixels=null,c.refCount=0,delete Uo[c.id],wr.textureCount--}p(aa.prototype,{bind:function(){var d=this;d.bindCount+=1;var g=d.unit;if(g<0){for(var I=0;I<Bo;++I){var ee=Vo[I];if(ee){if(ee.bindCount>0)continue;ee.unit=-1}Vo[I]=d,g=I;break}g>=Bo&&$.raise("insufficient number of texture units"),_r.profile&&wr.maxTextureUnits<g+1&&(wr.maxTextureUnits=g+1),d.unit=g,ye.activeTexture(il+g),ye.bindTexture(d.target,d.texture)}return g},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&An(this)}});function Ra(c,d){var g=new aa(os);Uo[g.id]=g,wr.textureCount++;function I(k,Q){var We=g.texInfo;Ci.call(We);var tt=ei();return typeof k=="number"?typeof Q=="number"?Ba(tt,k|0,Q|0):Ba(tt,k|0,k|0):k?($.type(k,"object","invalid arguments to regl.texture"),vs(We,k),hi(tt,k)):Ba(tt,1,1),We.genMipmaps&&(tt.mipmask=(tt.width<<1)-1),g.mipmask=tt.mipmask,Kr(g,tt),$.texture2D(We,tt,Mt),g.internalformat=tt.internalformat,I.width=tt.width,I.height=tt.height,ou(g),zo(tt,os),Fo(We,os),yi(),bo(tt),_r.profile&&(g.stats.size=Pa(g.internalformat,g.type,tt.width,tt.height,We.genMipmaps,!1)),I.format=Xr[g.internalformat],I.type=On[g.type],I.mag=Ir[We.magFilter],I.min=ta[We.minFilter],I.wrapS=qr[We.wrapS],I.wrapT=qr[We.wrapT],I}function ee(k,Q,We,tt){$(!!k,"must specify image data");var Pe=Q|0,Je=We|0,_t=tt|0,ke=Un();return Kr(ke,g),ke.width=0,ke.height=0,Hr(ke,k),ke.width=ke.width||(g.width>>_t)-Pe,ke.height=ke.height||(g.height>>_t)-Je,$(g.type===ke.type&&g.format===ke.format&&g.internalformat===ke.internalformat,"incompatible format for texture.subimage"),$(Pe>=0&&Je>=0&&Pe+ke.width<=g.width&&Je+ke.height<=g.height,"texture.subimage write out of bounds"),$(g.mipmask&1<<_t,"missing mipmap data"),$(ke.data||ke.element||ke.needsCopy,"missing image data"),ou(g),ma(ke,os,Pe,Je,_t),yi(),Ua(ke),I}function B(k,Q){var We=k|0,tt=Q|0||We;if(We===g.width&&tt===g.height)return I;I.width=g.width=We,I.height=g.height=tt,ou(g);for(var Pe=0;g.mipmask>>Pe;++Pe){var Je=We>>Pe,_t=tt>>Pe;if(!Je||!_t)break;ye.texImage2D(os,Pe,g.format,Je,_t,0,g.format,g.type,null)}return yi(),_r.profile&&(g.stats.size=Pa(g.internalformat,g.type,We,tt,!1,!1)),I}return I(c,d),I.subimage=ee,I.resize=B,I._reglType="texture2d",I._texture=g,_r.profile&&(I.stats=g.stats),I.destroy=function(){g.decRef()},I}function Va(c,d,g,I,ee,B){var k=new aa(Lc);Uo[k.id]=k,wr.cubeCount++;var Q=new Array(6);function We(Je,_t,ke,pt,De,Zt){var Kt,dr=k.texInfo;for(Ci.call(dr),Kt=0;Kt<6;++Kt)Q[Kt]=ei();if(typeof Je=="number"||!Je){var rr=Je|0||1;for(Kt=0;Kt<6;++Kt)Ba(Q[Kt],rr,rr)}else if(typeof Je=="object")if(_t)hi(Q[0],Je),hi(Q[1],_t),hi(Q[2],ke),hi(Q[3],pt),hi(Q[4],De),hi(Q[5],Zt);else if(vs(dr,Je),Xn(k,Je),"faces"in Je){var mr=Je.faces;for($(Array.isArray(mr)&&mr.length===6,"cube faces must be a length 6 array"),Kt=0;Kt<6;++Kt)$(typeof mr[Kt]=="object"&&!!mr[Kt],"invalid input for cube map face"),Kr(Q[Kt],k),hi(Q[Kt],mr[Kt])}else for(Kt=0;Kt<6;++Kt)hi(Q[Kt],Je);else $.raise("invalid arguments to cube map");for(Kr(k,Q[0]),Mt.npotTextureCube||$(_u(k.width)&&_u(k.height),"your browser does not support non power or two texture dimensions"),dr.genMipmaps?k.mipmask=(Q[0].width<<1)-1:k.mipmask=Q[0].mipmask,$.textureCube(k,dr,Q,Mt),k.internalformat=Q[0].internalformat,We.width=Q[0].width,We.height=Q[0].height,ou(k),Kt=0;Kt<6;++Kt)zo(Q[Kt],vc+Kt);for(Fo(dr,Lc),yi(),_r.profile&&(k.stats.size=Pa(k.internalformat,k.type,We.width,We.height,dr.genMipmaps,!0)),We.format=Xr[k.internalformat],We.type=On[k.type],We.mag=Ir[dr.magFilter],We.min=ta[dr.minFilter],We.wrapS=qr[dr.wrapS],We.wrapT=qr[dr.wrapT],Kt=0;Kt<6;++Kt)bo(Q[Kt]);return We}function tt(Je,_t,ke,pt,De){$(!!_t,"must specify image data"),$(typeof Je=="number"&&Je===(Je|0)&&Je>=0&&Je<6,"invalid face");var Zt=ke|0,Kt=pt|0,dr=De|0,rr=Un();return Kr(rr,k),rr.width=0,rr.height=0,Hr(rr,_t),rr.width=rr.width||(k.width>>dr)-Zt,rr.height=rr.height||(k.height>>dr)-Kt,$(k.type===rr.type&&k.format===rr.format&&k.internalformat===rr.internalformat,"incompatible format for texture.subimage"),$(Zt>=0&&Kt>=0&&Zt+rr.width<=k.width&&Kt+rr.height<=k.height,"texture.subimage write out of bounds"),$(k.mipmask&1<<dr,"missing mipmap data"),$(rr.data||rr.element||rr.needsCopy,"missing image data"),ou(k),ma(rr,vc+Je,Zt,Kt,dr),yi(),Ua(rr),We}function Pe(Je){var _t=Je|0;if(_t===k.width)return;We.width=k.width=_t,We.height=k.height=_t,ou(k);for(var ke=0;ke<6;++ke)for(var pt=0;k.mipmask>>pt;++pt)ye.texImage2D(vc+ke,pt,k.format,_t>>pt,_t>>pt,0,k.format,k.type,null);return yi(),_r.profile&&(k.stats.size=Pa(k.internalformat,k.type,We.width,We.height,!1,!0)),We}return We(c,d,g,I,ee,B),We.subimage=tt,We.resize=Pe,We._reglType="textureCube",We._texture=k,_r.profile&&(We.stats=k.stats),We.destroy=function(){k.decRef()},We}function rs(){for(var c=0;c<Bo;++c)ye.activeTexture(il+c),ye.bindTexture(os,null),Vo[c]=null;Le(Uo).forEach(An),wr.cubeCount=0,wr.textureCount=0}_r.profile&&(wr.getTotalTextureSize=function(){var c=0;return Object.keys(Uo).forEach(function(d){c+=Uo[d].stats.size}),c});function w(){for(var c=0;c<Bo;++c){var d=Vo[c];d&&(d.bindCount=0,d.unit=-1,Vo[c]=null)}Le(Uo).forEach(function(g){g.texture=ye.createTexture(),ye.bindTexture(g.target,g.texture);for(var I=0;I<32;++I){if((g.mipmask&1<<I)===0)continue;if(g.target===os)ye.texImage2D(os,I,g.internalformat,g.width>>I,g.height>>I,0,g.internalformat,g.type,null);else for(var ee=0;ee<6;++ee)ye.texImage2D(vc+ee,I,g.internalformat,g.width>>I,g.height>>I,0,g.internalformat,g.type,null)}Fo(g.texInfo,g.target)})}function y(){for(var c=0;c<Bo;++c){var d=Vo[c];d&&(d.bindCount=0,d.unit=-1,Vo[c]=null),ye.activeTexture(il+c),ye.bindTexture(os,null),ye.bindTexture(Lc,null)}}return{create2D:Ra,createCube:Va,clear:rs,getTexture:function(d){return null},restore:w,refresh:y}}var Io=36161,So=32854,Sl=32855,ul=36194,pu=33189,Cs=36168,xc=34041,Jn=35907,jn=34836,Ec=34842,cs=34843,Do=[];Do[So]=2,Do[Sl]=2,Do[ul]=2,Do[pu]=2,Do[Cs]=1,Do[xc]=4,Do[Jn]=4,Do[jn]=16,Do[Ec]=8,Do[cs]=6;function vo(ye,je,Mt){return Do[ye]*je*Mt}var ws=function(je,Mt,Er,Lr,wr){var _r={rgba4:So,rgb565:ul,"rgb5 a1":Sl,depth:pu,stencil:Cs,"depth stencil":xc};Mt.ext_srgb&&(_r.srgba=Jn),Mt.ext_color_buffer_half_float&&(_r.rgba16f=Ec,_r.rgb16f=cs),Mt.webgl_color_buffer_float&&(_r.rgba32f=jn);var Wr=[];Object.keys(_r).forEach(function(nn){var Tr=_r[nn];Wr[Tr]=nn});var un=0,Jr={};function Qr(nn){this.id=un++,this.refCount=1,this.renderbuffer=nn,this.format=So,this.width=0,this.height=0,wr.profile&&(this.stats={size:0})}Qr.prototype.decRef=function(){--this.refCount<=0&&ln(this)};function ln(nn){var Tr=nn.renderbuffer;$(Tr,"must not double destroy renderbuffer"),je.bindRenderbuffer(Io,null),je.deleteRenderbuffer(Tr),nn.renderbuffer=null,nn.refCount=0,delete Jr[nn.id],Lr.renderbufferCount--}function Sn(nn,Tr){var xr=new Qr(je.createRenderbuffer());Jr[xr.id]=xr,Lr.renderbufferCount++;function Xr(Ir,ta){var qr=0,Fr=0,Vr=So;if(typeof Ir=="object"&&Ir){var Kr=Ir;if("shape"in Kr){var Xn=Kr.shape;$(Array.isArray(Xn)&&Xn.length>=2,"invalid renderbuffer shape"),qr=Xn[0]|0,Fr=Xn[1]|0}else"radius"in Kr&&(qr=Fr=Kr.radius|0),"width"in Kr&&(qr=Kr.width|0),"height"in Kr&&(Fr=Kr.height|0);"format"in Kr&&($.parameter(Kr.format,_r,"invalid renderbuffer format"),Vr=_r[Kr.format])}else typeof Ir=="number"?(qr=Ir|0,typeof ta=="number"?Fr=ta|0:Fr=qr):Ir?$.raise("invalid arguments to renderbuffer constructor"):qr=Fr=1;return $(qr>0&&Fr>0&&qr<=Er.maxRenderbufferSize&&Fr<=Er.maxRenderbufferSize,"invalid renderbuffer size"),qr===xr.width&&Fr===xr.height&&Vr===xr.format?void 0:(Xr.width=xr.width=qr,Xr.height=xr.height=Fr,xr.format=Vr,je.bindRenderbuffer(Io,xr.renderbuffer),je.renderbufferStorage(Io,Vr,qr,Fr),$(je.getError()===0,"invalid render buffer format"),wr.profile&&(xr.stats.size=vo(xr.format,xr.width,xr.height)),Xr.format=Wr[xr.format],Xr)}function On(Ir,ta){var qr=Ir|0,Fr=ta|0||qr;return qr===xr.width&&Fr===xr.height||($(qr>0&&Fr>0&&qr<=Er.maxRenderbufferSize&&Fr<=Er.maxRenderbufferSize,"invalid renderbuffer size"),Xr.width=xr.width=qr,Xr.height=xr.height=Fr,je.bindRenderbuffer(Io,xr.renderbuffer),je.renderbufferStorage(Io,xr.format,qr,Fr),$(je.getError()===0,"invalid render buffer format"),wr.profile&&(xr.stats.size=vo(xr.format,xr.width,xr.height))),Xr}return Xr(nn,Tr),Xr.resize=On,Xr._reglType="renderbuffer",Xr._renderbuffer=xr,wr.profile&&(Xr.stats=xr.stats),Xr.destroy=function(){xr.decRef()},Xr}wr.profile&&(Lr.getTotalRenderbufferSize=function(){var nn=0;return Object.keys(Jr).forEach(function(Tr){nn+=Jr[Tr].stats.size}),nn});function pn(){Le(Jr).forEach(function(nn){nn.renderbuffer=je.createRenderbuffer(),je.bindRenderbuffer(Io,nn.renderbuffer),je.renderbufferStorage(Io,nn.format,nn.width,nn.height)}),je.bindRenderbuffer(Io,null)}return{create:Sn,clear:function(){Le(Jr).forEach(ln)},restore:pn}},Au=36160,ec=36161,$a=3553,no=34069,ll=36064,mu=36096,cl=36128,Cu=33306,Is=36053,zc=36054,Gs=36055,yf=36057,Ul=36061,Bl=36193,_c=5121,fs=5126,Bu=6407,Fc=6408,Al=6402,Vu=[Bu,Fc],tc=[];tc[Fc]=4,tc[Bu]=3;var Gu=[];Gu[_c]=1,Gu[fs]=4,Gu[Bl]=2;var Ds=32854,nf=32855,rc=36194,nc=33189,ac=36168,s=34041,a=35907,n=34836,l=34842,v=34843,O=[Ds,nf,rc,a,l,v,n],L={};L[Is]="complete",L[zc]="incomplete attachment",L[yf]="incomplete dimensions",L[Gs]="incomplete, missing attachment",L[Ul]="unsupported";function j(ye,je,Mt,Er,Lr,wr){var _r={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],un=["rgba4","rgb565","rgb5 a1"];je.ext_srgb&&un.push("srgba"),je.ext_color_buffer_half_float&&un.push("rgba16f","rgb16f"),je.webgl_color_buffer_float&&un.push("rgba32f");var Jr=["uint8"];je.oes_texture_half_float&&Jr.push("half float","float16"),je.oes_texture_float&&Jr.push("float","float32");function Qr(cn,Hr,jr){this.target=cn,this.texture=Hr,this.renderbuffer=jr;var ma=0,pa=0;Hr?(ma=Hr.width,pa=Hr.height):jr&&(ma=jr.width,pa=jr.height),this.width=ma,this.height=pa}function ln(cn){cn&&(cn.texture&&cn.texture._texture.decRef(),cn.renderbuffer&&cn.renderbuffer._renderbuffer.decRef())}function Sn(cn,Hr,jr){if(!cn)return;if(cn.texture){var ma=cn.texture._texture,pa=Math.max(1,ma.width),Un=Math.max(1,ma.height);$(pa===Hr&&Un===jr,"inconsistent width/height for supplied texture"),ma.refCount+=1}else{var Ua=cn.renderbuffer._renderbuffer;$(Ua.width===Hr&&Ua.height===jr,"inconsistent width/height for renderbuffer"),Ua.refCount+=1}}function pn(cn,Hr){Hr&&(Hr.texture?ye.framebufferTexture2D(Au,cn,Hr.target,Hr.texture._texture.texture,0):ye.framebufferRenderbuffer(Au,cn,ec,Hr.renderbuffer._renderbuffer.renderbuffer))}function nn(cn){var Hr=$a,jr=null,ma=null,pa=cn;typeof cn=="object"&&(pa=cn.data,"target"in cn&&(Hr=cn.target|0)),$.type(pa,"function","invalid attachment data");var Un=pa._reglType;return Un==="texture2d"?(jr=pa,$(Hr===$a)):Un==="textureCube"?(jr=pa,$(Hr>=no&&Hr<no+6,"invalid cube map target")):Un==="renderbuffer"?(ma=pa,Hr=ec):$.raise("invalid regl object for attachment"),new Qr(Hr,jr,ma)}function Tr(cn,Hr,jr,ma,pa){if(jr){var Un=Er.create2D({width:cn,height:Hr,format:ma,type:pa});return Un._texture.refCount=0,new Qr($a,Un,null)}else{var Ua=Lr.create({width:cn,height:Hr,format:ma});return Ua._renderbuffer.refCount=0,new Qr(ec,null,Ua)}}function xr(cn){return cn&&(cn.texture||cn.renderbuffer)}function Xr(cn,Hr,jr){cn&&(cn.texture?cn.texture.resize(Hr,jr):cn.renderbuffer&&cn.renderbuffer.resize(Hr,jr),cn.width=Hr,cn.height=jr)}var On=0,Ir={};function ta(){this.id=On++,Ir[this.id]=this,this.framebuffer=ye.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function qr(cn){cn.colorAttachments.forEach(ln),ln(cn.depthAttachment),ln(cn.stencilAttachment),ln(cn.depthStencilAttachment)}function Fr(cn){var Hr=cn.framebuffer;$(Hr,"must not double destroy framebuffer"),ye.deleteFramebuffer(Hr),cn.framebuffer=null,wr.framebufferCount--,delete Ir[cn.id]}function Vr(cn){var Hr;ye.bindFramebuffer(Au,cn.framebuffer);var jr=cn.colorAttachments;for(Hr=0;Hr<jr.length;++Hr)pn(ll+Hr,jr[Hr]);for(Hr=jr.length;Hr<Mt.maxColorAttachments;++Hr)ye.framebufferTexture2D(Au,ll+Hr,$a,null,0);ye.framebufferTexture2D(Au,Cu,$a,null,0),ye.framebufferTexture2D(Au,mu,$a,null,0),ye.framebufferTexture2D(Au,cl,$a,null,0),pn(mu,cn.depthAttachment),pn(cl,cn.stencilAttachment),pn(Cu,cn.depthStencilAttachment);var ma=ye.checkFramebufferStatus(Au);!ye.isContextLost()&&ma!==Is&&$.raise("framebuffer configuration not supported, status = "+L[ma]),ye.bindFramebuffer(Au,_r.next?_r.next.framebuffer:null),_r.cur=_r.next,ye.getError()}function Kr(cn,Hr){var jr=new ta;wr.framebufferCount++;function ma(Un,Ua){var _a;$(_r.next!==jr,"can not update framebuffer which is currently in use");var Ba=0,hi=0,zo=!0,Os=!0,ei=null,bo=!0,Ci="rgba",vs="uint8",Fo=1,gs=null,Uo=null,Bo=null,Vo=!1;if(typeof Un=="number")Ba=Un|0,hi=Ua|0||Ba;else if(!Un)Ba=hi=1;else{$.type(Un,"object","invalid arguments for framebuffer");var aa=Un;if("shape"in aa){var ou=aa.shape;$(Array.isArray(ou)&&ou.length>=2,"invalid shape for framebuffer"),Ba=ou[0],hi=ou[1]}else"radius"in aa&&(Ba=hi=aa.radius),"width"in aa&&(Ba=aa.width),"height"in aa&&(hi=aa.height);("color"in aa||"colors"in aa)&&(ei=aa.color||aa.colors,Array.isArray(ei)&&$(ei.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),ei||("colorCount"in aa&&(Fo=aa.colorCount|0,$(Fo>0,"invalid color buffer count")),"colorTexture"in aa&&(bo=!!aa.colorTexture,Ci="rgba4"),"colorType"in aa&&(vs=aa.colorType,bo?($(je.oes_texture_float||!(vs==="float"||vs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(je.oes_texture_half_float||!(vs==="half float"||vs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vs==="half float"||vs==="float16"?($(je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ci="rgba16f"):(vs==="float"||vs==="float32")&&($(je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ci="rgba32f"),$.oneOf(vs,Jr,"invalid color type")),"colorFormat"in aa&&(Ci=aa.colorFormat,Wr.indexOf(Ci)>=0?bo=!0:un.indexOf(Ci)>=0?bo=!1:bo?$.oneOf(aa.colorFormat,Wr,"invalid color format for texture"):$.oneOf(aa.colorFormat,un,"invalid color format for renderbuffer"))),("depthTexture"in aa||"depthStencilTexture"in aa)&&(Vo=!!(aa.depthTexture||aa.depthStencilTexture),$(!Vo||je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in aa&&(typeof aa.depth=="boolean"?zo=aa.depth:(gs=aa.depth,Os=!1)),"stencil"in aa&&(typeof aa.stencil=="boolean"?Os=aa.stencil:(Uo=aa.stencil,zo=!1)),"depthStencil"in aa&&(typeof aa.depthStencil=="boolean"?zo=Os=aa.depthStencil:(Bo=aa.depthStencil,zo=!1,Os=!1))}var yi=null,An=null,Ra=null,Va=null;if(Array.isArray(ei))yi=ei.map(nn);else if(ei)yi=[nn(ei)];else for(yi=new Array(Fo),_a=0;_a<Fo;++_a)yi[_a]=Tr(Ba,hi,bo,Ci,vs);$(je.webgl_draw_buffers||yi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(yi.length<=Mt.maxColorAttachments,"too many color attachments, not supported"),Ba=Ba||yi[0].width,hi=hi||yi[0].height,gs?An=nn(gs):zo&&!Os&&(An=Tr(Ba,hi,Vo,"depth","uint32")),Uo?Ra=nn(Uo):Os&&!zo&&(Ra=Tr(Ba,hi,!1,"stencil","uint8")),Bo?Va=nn(Bo):!gs&&!Uo&&Os&&zo&&(Va=Tr(Ba,hi,Vo,"depth stencil","depth stencil")),$(!!gs+!!Uo+!!Bo<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var rs=null;for(_a=0;_a<yi.length;++_a)if(Sn(yi[_a],Ba,hi),$(!yi[_a]||yi[_a].texture&&Vu.indexOf(yi[_a].texture._texture.format)>=0||yi[_a].renderbuffer&&O.indexOf(yi[_a].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+_a+" is invalid"),yi[_a]&&yi[_a].texture){var w=tc[yi[_a].texture._texture.format]*Gu[yi[_a].texture._texture.type];rs===null?rs=w:$(rs===w,"all color attachments much have the same number of bits per pixel.")}return Sn(An,Ba,hi),$(!An||An.texture&&An.texture._texture.format===Al||An.renderbuffer&&An.renderbuffer._renderbuffer.format===nc,"invalid depth attachment for framebuffer object"),Sn(Ra,Ba,hi),$(!Ra||Ra.renderbuffer&&Ra.renderbuffer._renderbuffer.format===ac,"invalid stencil attachment for framebuffer object"),Sn(Va,Ba,hi),$(!Va||Va.texture&&Va.texture._texture.format===s||Va.renderbuffer&&Va.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),qr(jr),jr.width=Ba,jr.height=hi,jr.colorAttachments=yi,jr.depthAttachment=An,jr.stencilAttachment=Ra,jr.depthStencilAttachment=Va,ma.color=yi.map(xr),ma.depth=xr(An),ma.stencil=xr(Ra),ma.depthStencil=xr(Va),ma.width=jr.width,ma.height=jr.height,Vr(jr),ma}function pa(Un,Ua){$(_r.next!==jr,"can not resize a framebuffer which is currently in use");var _a=Math.max(Un|0,1),Ba=Math.max(Ua|0||_a,1);if(_a===jr.width&&Ba===jr.height)return ma;for(var hi=jr.colorAttachments,zo=0;zo<hi.length;++zo)Xr(hi[zo],_a,Ba);return Xr(jr.depthAttachment,_a,Ba),Xr(jr.stencilAttachment,_a,Ba),Xr(jr.depthStencilAttachment,_a,Ba),jr.width=ma.width=_a,jr.height=ma.height=Ba,Vr(jr),ma}return ma(cn,Hr),p(ma,{resize:pa,_reglType:"framebuffer",_framebuffer:jr,destroy:function(){Fr(jr),qr(jr)},use:function(Ua){_r.setFBO({framebuffer:ma},Ua)}})}function Xn(cn){var Hr=Array(6);function jr(pa){var Un;$(Hr.indexOf(_r.next)<0,"can not update framebuffer which is currently in use");var Ua={color:null},_a=0,Ba=null,hi="rgba",zo="uint8",Os=1;if(typeof pa=="number")_a=pa|0;else if(!pa)_a=1;else{$.type(pa,"object","invalid arguments for framebuffer");var ei=pa;if("shape"in ei){var bo=ei.shape;$(Array.isArray(bo)&&bo.length>=2,"invalid shape for framebuffer"),$(bo[0]===bo[1],"cube framebuffer must be square"),_a=bo[0]}else"radius"in ei&&(_a=ei.radius|0),"width"in ei?(_a=ei.width|0,"height"in ei&&$(ei.height===_a,"must be square")):"height"in ei&&(_a=ei.height|0);("color"in ei||"colors"in ei)&&(Ba=ei.color||ei.colors,Array.isArray(Ba)&&$(Ba.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Ba||("colorCount"in ei&&(Os=ei.colorCount|0,$(Os>0,"invalid color buffer count")),"colorType"in ei&&($.oneOf(ei.colorType,Jr,"invalid color type"),zo=ei.colorType),"colorFormat"in ei&&(hi=ei.colorFormat,$.oneOf(ei.colorFormat,Wr,"invalid color format for texture"))),"depth"in ei&&(Ua.depth=ei.depth),"stencil"in ei&&(Ua.stencil=ei.stencil),"depthStencil"in ei&&(Ua.depthStencil=ei.depthStencil)}var Ci;if(Ba)if(Array.isArray(Ba))for(Ci=[],Un=0;Un<Ba.length;++Un)Ci[Un]=Ba[Un];else Ci=[Ba];else{Ci=Array(Os);var vs={radius:_a,format:hi,type:zo};for(Un=0;Un<Os;++Un)Ci[Un]=Er.createCube(vs)}for(Ua.color=Array(Ci.length),Un=0;Un<Ci.length;++Un){var Fo=Ci[Un];$(typeof Fo=="function"&&Fo._reglType==="textureCube","invalid cube map"),_a=_a||Fo.width,$(Fo.width===_a&&Fo.height===_a,"invalid cube map shape"),Ua.color[Un]={target:no,data:Ci[Un]}}for(Un=0;Un<6;++Un){for(var gs=0;gs<Ci.length;++gs)Ua.color[gs].target=no+Un;Un>0&&(Ua.depth=Hr[0].depth,Ua.stencil=Hr[0].stencil,Ua.depthStencil=Hr[0].depthStencil),Hr[Un]?Hr[Un](Ua):Hr[Un]=Kr(Ua)}return p(jr,{width:_a,height:_a,color:Ci})}function ma(pa){var Un,Ua=pa|0;if($(Ua>0&&Ua<=Mt.maxCubeMapSize,"invalid radius for cube fbo"),Ua===jr.width)return jr;var _a=jr.color;for(Un=0;Un<_a.length;++Un)_a[Un].resize(Ua);for(Un=0;Un<6;++Un)Hr[Un].resize(Ua);return jr.width=jr.height=Ua,jr}return jr(cn),p(jr,{faces:Hr,resize:ma,_reglType:"framebufferCube",destroy:function(){Hr.forEach(function(Un){Un.destroy()})}})}function na(){_r.cur=null,_r.next=null,_r.dirty=!0,Le(Ir).forEach(function(cn){cn.framebuffer=ye.createFramebuffer(),Vr(cn)})}return p(_r,{getFramebuffer:function(Hr){if(typeof Hr=="function"&&Hr._reglType==="framebuffer"){var jr=Hr._framebuffer;if(jr instanceof ta)return jr}return null},create:Kr,createCube:Xn,clear:function(){Le(Ir).forEach(Fr)},restore:na})}var ue=5126,Ee=34962;function $e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function rt(ye,je,Mt,Er,Lr){for(var wr=Mt.maxAttributes,_r=new Array(wr),Wr=0;Wr<wr;++Wr)_r[Wr]=new $e;var un=0,Jr={},Qr={Record:$e,scope:{},state:_r,currentVAO:null,targetVAO:null,restore:Sn()?Ir:function(){},createVAO:ta,getVAO:nn,destroyBuffer:ln,setVAO:Sn()?Tr:xr,clear:Sn()?Xr:function(){}};function ln(qr){for(var Fr=0;Fr<_r.length;++Fr){var Vr=_r[Fr];Vr.buffer===qr&&(ye.disableVertexAttribArray(Fr),Vr.buffer=null)}}function Sn(){return je.oes_vertex_array_object}function pn(){return je.angle_instanced_arrays}function nn(qr){return typeof qr=="function"&&qr._vao?qr._vao:null}function Tr(qr){if(qr===Qr.currentVAO)return;var Fr=Sn();qr?Fr.bindVertexArrayOES(qr.vao):Fr.bindVertexArrayOES(null),Qr.currentVAO=qr}function xr(qr){if(qr===Qr.currentVAO)return;if(qr)qr.bindAttrs();else for(var Fr=pn(),Vr=0;Vr<_r.length;++Vr){var Kr=_r[Vr];Kr.buffer?(ye.enableVertexAttribArray(Vr),ye.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),Fr&&Kr.divisor&&Fr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(ye.disableVertexAttribArray(Vr),ye.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}Qr.currentVAO=qr}function Xr(){Le(Jr).forEach(function(qr){qr.destroy()})}function On(){this.id=++un,this.attributes=[];var qr=Sn();qr?this.vao=qr.createVertexArrayOES():this.vao=null,Jr[this.id]=this,this.buffers=[]}On.prototype.bindAttrs=function(){for(var qr=pn(),Fr=this.attributes,Vr=0;Vr<Fr.length;++Vr){var Kr=Fr[Vr];Kr.buffer?(ye.enableVertexAttribArray(Vr),ye.bindBuffer(Ee,Kr.buffer.buffer),ye.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),qr&&Kr.divisor&&qr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(ye.disableVertexAttribArray(Vr),ye.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Xn=Fr.length;Xn<wr;++Xn)ye.disableVertexAttribArray(Xn)},On.prototype.refresh=function(){var qr=Sn();qr&&(qr.bindVertexArrayOES(this.vao),this.bindAttrs(),Qr.currentVAO=this)},On.prototype.destroy=function(){if(this.vao){var qr=Sn();this===Qr.currentVAO&&(Qr.currentVAO=null,qr.bindVertexArrayOES(null)),qr.deleteVertexArrayOES(this.vao),this.vao=null}Jr[this.id]&&(delete Jr[this.id],Er.vaoCount-=1)};function Ir(){var qr=Sn();qr&&Le(Jr).forEach(function(Fr){Fr.refresh()})}function ta(qr){var Fr=new On;Er.vaoCount+=1;function Vr(Kr){$(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),$(Kr.length<wr,"too many attributes"),$(Kr.length>0,"must specify at least one attribute");var Xn={},na=Fr.attributes;na.length=Kr.length;for(var cn=0;cn<Kr.length;++cn){var Hr=Kr[cn],jr=na[cn]=new $e,ma=Hr.data||Hr;if(Array.isArray(ma)||x(ma)||Vt(ma)){var pa;Fr.buffers[cn]&&(pa=Fr.buffers[cn],x(ma)&&pa._buffer.byteLength>=ma.byteLength?pa.subdata(ma):(pa.destroy(),Fr.buffers[cn]=null)),Fr.buffers[cn]||(pa=Fr.buffers[cn]=Lr.create(Hr,Ee,!1,!0)),jr.buffer=Lr.getBuffer(pa),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1,Xn[cn]=1}else Lr.getBuffer(Hr)?(jr.buffer=Lr.getBuffer(Hr),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1):Lr.getBuffer(Hr.buffer)?(jr.buffer=Lr.getBuffer(Hr.buffer),jr.size=(+Hr.size||jr.buffer.dimension)|0,jr.normalized=!!Hr.normalized||!1,"type"in Hr?($.parameter(Hr.type,To,"invalid buffer type"),jr.type=To[Hr.type]):jr.type=jr.buffer.dtype,jr.offset=(Hr.offset||0)|0,jr.stride=(Hr.stride||0)|0,jr.divisor=(Hr.divisor||0)|0,jr.state=1,$(jr.size>=1&&jr.size<=4,"size must be between 1 and 4"),$(jr.offset>=0,"invalid offset"),$(jr.stride>=0&&jr.stride<=255,"stride must be between 0 and 255"),$(jr.divisor>=0,"divisor must be positive"),$(!jr.divisor||!!je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Hr?($(cn>0,"first attribute must not be a constant"),jr.x=+Hr.x||0,jr.y=+Hr.y||0,jr.z=+Hr.z||0,jr.w=+Hr.w||0,jr.state=2):$(!1,"invalid attribute spec for location "+cn)}for(var Un=0;Un<Fr.buffers.length;++Un)!Xn[Un]&&Fr.buffers[Un]&&(Fr.buffers[Un].destroy(),Fr.buffers[Un]=null);return Fr.refresh(),Vr}return Vr.destroy=function(){for(var Kr=0;Kr<Fr.buffers.length;++Kr)Fr.buffers[Kr]&&Fr.buffers[Kr].destroy();Fr.buffers.length=0,Fr.destroy()},Vr._vao=Fr,Vr._reglType="vao",Vr(qr)}return Qr}var at=35632,zt=35633,Nt=35718,Jt=35721;function jt(ye,je,Mt,Er){var Lr={},wr={};function _r(Tr,xr,Xr,On){this.name=Tr,this.id=xr,this.location=Xr,this.info=On}function Wr(Tr,xr){for(var Xr=0;Xr<Tr.length;++Xr)if(Tr[Xr].id===xr.id){Tr[Xr].location=xr.location;return}Tr.push(xr)}function un(Tr,xr,Xr){var On=Tr===at?Lr:wr,Ir=On[xr];if(!Ir){var ta=je.str(xr);Ir=ye.createShader(Tr),ye.shaderSource(Ir,ta),ye.compileShader(Ir),$.shaderError(ye,Ir,ta,Tr,Xr),On[xr]=Ir}return Ir}var Jr={},Qr=[],ln=0;function Sn(Tr,xr){this.id=ln++,this.fragId=Tr,this.vertId=xr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Er.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pn(Tr,xr,Xr){var On,Ir,ta=un(at,Tr.fragId),qr=un(zt,Tr.vertId),Fr=Tr.program=ye.createProgram();if(ye.attachShader(Fr,ta),ye.attachShader(Fr,qr),Xr)for(On=0;On<Xr.length;++On){var Vr=Xr[On];ye.bindAttribLocation(Fr,Vr[0],Vr[1])}ye.linkProgram(Fr),$.linkError(ye,Fr,je.str(Tr.fragId),je.str(Tr.vertId),xr);var Kr=ye.getProgramParameter(Fr,Nt);Er.profile&&(Tr.stats.uniformsCount=Kr);var Xn=Tr.uniforms;for(On=0;On<Kr;++On)if(Ir=ye.getActiveUniform(Fr,On),Ir)if(Ir.size>1)for(var na=0;na<Ir.size;++na){var cn=Ir.name.replace("[0]","["+na+"]");Wr(Xn,new _r(cn,je.id(cn),ye.getUniformLocation(Fr,cn),Ir))}else Wr(Xn,new _r(Ir.name,je.id(Ir.name),ye.getUniformLocation(Fr,Ir.name),Ir));var Hr=ye.getProgramParameter(Fr,Jt);Er.profile&&(Tr.stats.attributesCount=Hr);var jr=Tr.attributes;for(On=0;On<Hr;++On)Ir=ye.getActiveAttrib(Fr,On),Ir&&Wr(jr,new _r(Ir.name,je.id(Ir.name),ye.getAttribLocation(Fr,Ir.name),Ir))}Er.profile&&(Mt.getMaxUniformsCount=function(){var Tr=0;return Qr.forEach(function(xr){xr.stats.uniformsCount>Tr&&(Tr=xr.stats.uniformsCount)}),Tr},Mt.getMaxAttributesCount=function(){var Tr=0;return Qr.forEach(function(xr){xr.stats.attributesCount>Tr&&(Tr=xr.stats.attributesCount)}),Tr});function nn(){Lr={},wr={};for(var Tr=0;Tr<Qr.length;++Tr)pn(Qr[Tr],null,Qr[Tr].attributes.map(function(xr){return[xr.location,xr.name]}))}return{clear:function(){var xr=ye.deleteShader.bind(ye);Le(Lr).forEach(xr),Lr={},Le(wr).forEach(xr),wr={},Qr.forEach(function(Xr){ye.deleteProgram(Xr.program)}),Qr.length=0,Jr={},Mt.shaderCount=0},program:function(xr,Xr,On,Ir){$.command(xr>=0,"missing vertex shader",On),$.command(Xr>=0,"missing fragment shader",On);var ta=Jr[Xr];ta||(ta=Jr[Xr]={});var qr=ta[xr];if(qr&&(qr.refCount++,!Ir))return qr;var Fr=new Sn(Xr,xr);return Mt.shaderCount++,pn(Fr,On,Ir),qr||(ta[xr]=Fr),Qr.push(Fr),p(Fr,{destroy:function(){if(Fr.refCount--,Fr.refCount<=0){ye.deleteProgram(Fr.program);var Kr=Qr.indexOf(Fr);Qr.splice(Kr,1),Mt.shaderCount--}ta[Fr.vertId].refCount<=0&&(ye.deleteShader(wr[Fr.vertId]),delete wr[Fr.vertId],delete Jr[Fr.fragId][Fr.vertId]),Object.keys(Jr[Fr.fragId]).length||(ye.deleteShader(Lr[Fr.fragId]),delete Lr[Fr.fragId],delete Jr[Fr.fragId])}})},restore:nn,shader:un,frag:-1,vert:-1}}var Gt=6408,ar=5121,nr=3333,Rr=5126;function gr(ye,je,Mt,Er,Lr,wr,_r){function Wr(Qr){var ln;je.next===null?($(Lr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ln=ar):($(je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ln=je.next.colorAttachments[0].texture._texture.type,wr.oes_texture_float?($(ln===ar||ln===Rr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ln===Rr&&$(_r.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(ln===ar,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Sn=0,pn=0,nn=Er.framebufferWidth,Tr=Er.framebufferHeight,xr=null;x(Qr)?xr=Qr:Qr&&($.type(Qr,"object","invalid arguments to regl.read()"),Sn=Qr.x|0,pn=Qr.y|0,$(Sn>=0&&Sn<Er.framebufferWidth,"invalid x offset for regl.read"),$(pn>=0&&pn<Er.framebufferHeight,"invalid y offset for regl.read"),nn=(Qr.width||Er.framebufferWidth-Sn)|0,Tr=(Qr.height||Er.framebufferHeight-pn)|0,xr=Qr.data||null),xr&&(ln===ar?$(xr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ln===Rr&&$(xr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(nn>0&&nn+Sn<=Er.framebufferWidth,"invalid width for read pixels"),$(Tr>0&&Tr+pn<=Er.framebufferHeight,"invalid height for read pixels"),Mt();var Xr=nn*Tr*4;return xr||(ln===ar?xr=new Uint8Array(Xr):ln===Rr&&(xr=xr||new Float32Array(Xr))),$.isTypedArray(xr,"data buffer for regl.read() must be a typedarray"),$(xr.byteLength>=Xr,"data buffer for regl.read() too small"),ye.pixelStorei(nr,4),ye.readPixels(Sn,pn,nn,Tr,Gt,ln,xr),xr}function un(Qr){var ln;return je.setFBO({framebuffer:Qr.framebuffer},function(){ln=Wr(Qr)}),ln}function Jr(Qr){return!Qr||!("framebuffer"in Qr)?Wr(Qr):un(Qr)}return Jr}function Ar(ye){return Array.prototype.slice.call(ye)}function Cr(ye){return Ar(ye).join("")}function an(){var ye=0,je=[],Mt=[];function Er(ln){for(var Sn=0;Sn<Mt.length;++Sn)if(Mt[Sn]===ln)return je[Sn];var pn="g"+ye++;return je.push(pn),Mt.push(ln),pn}function Lr(){var ln=[];function Sn(){ln.push.apply(ln,Ar(arguments))}var pn=[];function nn(){var Tr="v"+ye++;return pn.push(Tr),arguments.length>0&&(ln.push(Tr,"="),ln.push.apply(ln,Ar(arguments)),ln.push(";")),Tr}return p(Sn,{def:nn,toString:function(){return Cr([pn.length>0?"var "+pn.join(",")+";":"",Cr(ln)])}})}function wr(){var ln=Lr(),Sn=Lr(),pn=ln.toString,nn=Sn.toString;function Tr(xr,Xr){Sn(xr,Xr,"=",ln.def(xr,Xr),";")}return p(function(){ln.apply(ln,Ar(arguments))},{def:ln.def,entry:ln,exit:Sn,save:Tr,set:function(Xr,On,Ir){Tr(Xr,On),ln(Xr,On,"=",Ir,";")},toString:function(){return pn()+nn()}})}function _r(){var ln=Cr(arguments),Sn=wr(),pn=wr(),nn=Sn.toString,Tr=pn.toString;return p(Sn,{then:function(){return Sn.apply(Sn,Ar(arguments)),this},else:function(){return pn.apply(pn,Ar(arguments)),this},toString:function(){var Xr=Tr();return Xr&&(Xr="else{"+Xr+"}"),Cr(["if(",ln,"){",nn(),"}",Xr])}})}var Wr=Lr(),un={};function Jr(ln,Sn){var pn=[];function nn(){var Ir="a"+pn.length;return pn.push(Ir),Ir}Sn=Sn||0;for(var Tr=0;Tr<Sn;++Tr)nn();var xr=wr(),Xr=xr.toString,On=un[ln]=p(xr,{arg:nn,toString:function(){return Cr(["function(",pn.join(),"){",Xr(),"}"])}});return On}function Qr(){var ln=['"use strict";',Wr,"return {"];Object.keys(un).forEach(function(nn){ln.push('"',nn,'":',un[nn].toString(),",")}),ln.push("}");var Sn=Cr(ln).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pn=Function.apply(null,je.concat(Sn));return pn.apply(null,Mt)}return{global:Wr,link:Er,block:Lr,proc:Jr,scope:wr,cond:_r,compile:Qr}}var Yr="xyzw".split(""),vn=5121,Pn=1,qn=2,sa=0,Aa=1,Wa=2,Tn=3,ua=4,xa=5,Zn=6,Ca="dither",ia="blend.enable",La="blend.color",Fa="blend.equation",Hi="blend.func",Ai="depth.enable",Ni="depth.func",Ei="depth.range",Bi="depth.mask",es="colorMask",ts="cull.enable",vu="cull.face",wu="frontFace",hs="lineWidth",Hs="polygonOffset.enable",Ou="polygonOffset.offset",ic="sample.alpha",tu="sample.enable",Hu="sample.coverage",oc="stencil.enable",ru="stencil.mask",Mu="stencil.func",ds="stencil.opFront",ao="stencil.opBack",Zu="scissor.enable",Vl="scissor.box",ps="viewport",No="profile",ko="framebuffer",Ko="vert",Ao="frag",uo="elements",Ns="primitive",nu="count",Gl="offset",Uc="instances",fl="vao",sc="Width",hl="Height",ks=ko+sc,go=ko+hl,Tc=ps+sc,ms=ps+hl,af="drawingBuffer",Sf=af+sc,Af=af+hl,Sc=[Hi,Fa,Mu,ds,ao,Hu,ps,Vl,Ou],Wu=34962,bf=34963,of=35632,Cf=35633,Pu=3553,uc=34067,If=2884,Bc=3042,Ac=3024,$f=2960,Jf=2929,Qf=3089,qf=32823,wf=32926,eh=32928,Hl=5126,sf=35664,io=35665,lc=35666,xf=5124,Cc=35667,au=35668,Cl=35669,Ef=35670,Df=35671,Vc=35672,uf=35673,Gc=35674,dl=35675,ne=35676,se=35678,N=35680,G=4,Ae=1028,ct=1029,Yt=2304,sr=2305,or=32775,Dr=32776,sn=519,Hn=7680,ea=0,la=1,ti=32774,ja=513,_i=36160,Qa=36064,Vi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Co=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],yo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Zi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},jo={frag:of,vert:Cf},qa={cw:Yt,ccw:sr};function lo(ye){return Array.isArray(ye)||x(ye)||Vt(ye)}function iu(ye){return ye.sort(function(je,Mt){return je===ps?-1:Mt===ps?1:je<Mt?-1:1})}function Ti(ye,je,Mt,Er){this.thisDep=ye,this.contextDep=je,this.propDep=Mt,this.append=Er}function ki(ye){return ye&&!(ye.thisDep||ye.contextDep||ye.propDep)}function Ea(ye){return new Ti(!1,!1,!1,ye)}function wo(ye,je){var Mt=ye.type;if(Mt===sa){var Er=ye.data.length;return new Ti(!0,Er>=1,Er>=2,je)}else if(Mt===ua){var Lr=ye.data;return new Ti(Lr.thisDep,Lr.contextDep,Lr.propDep,je)}else{if(Mt===xa)return new Ti(!1,!1,!1,je);if(Mt===Zn){for(var wr=!1,_r=!1,Wr=!1,un=0;un<ye.data.length;++un){var Jr=ye.data[un];if(Jr.type===Aa)Wr=!0;else if(Jr.type===Wa)_r=!0;else if(Jr.type===Tn)wr=!0;else if(Jr.type===sa){wr=!0;var Qr=Jr.data;Qr>=1&&(_r=!0),Qr>=2&&(Wr=!0)}else Jr.type===ua&&(wr=wr||Jr.data.thisDep,_r=_r||Jr.data.contextDep,Wr=Wr||Jr.data.propDep)}return new Ti(wr,_r,Wr,je)}else return new Ti(Mt===Tn,Mt===Wa,Mt===Aa,je)}}var cc=new Ti(!1,!1,!1,function(){});function Nf(ye,je,Mt,Er,Lr,wr,_r,Wr,un,Jr,Qr,ln,Sn,pn,nn){var Tr=Jr.Record,xr={add:32774,subtract:32778,"reverse subtract":32779};Mt.ext_blend_minmax&&(xr.min=or,xr.max=Dr);var Xr=Mt.angle_instanced_arrays,On=Mt.webgl_draw_buffers,Ir={dirty:!0,profile:nn.profile},ta={},qr=[],Fr={},Vr={};function Kr(B){return B.replace(".","_")}function Xn(B,k,Q){var We=Kr(B);qr.push(B),ta[We]=Ir[We]=!!Q,Fr[We]=k}function na(B,k,Q){var We=Kr(B);qr.push(B),Array.isArray(Q)?(Ir[We]=Q.slice(),ta[We]=Q.slice()):Ir[We]=ta[We]=Q,Vr[We]=k}Xn(Ca,Ac),Xn(ia,Bc),na(La,"blendColor",[0,0,0,0]),na(Fa,"blendEquationSeparate",[ti,ti]),na(Hi,"blendFuncSeparate",[la,ea,la,ea]),Xn(Ai,Jf,!0),na(Ni,"depthFunc",ja),na(Ei,"depthRange",[0,1]),na(Bi,"depthMask",!0),na(es,es,[!0,!0,!0,!0]),Xn(ts,If),na(vu,"cullFace",ct),na(wu,wu,sr),na(hs,hs,1),Xn(Hs,qf),na(Ou,"polygonOffset",[0,0]),Xn(ic,wf),Xn(tu,eh),na(Hu,"sampleCoverage",[1,!1]),Xn(oc,$f),na(ru,"stencilMask",-1),na(Mu,"stencilFunc",[sn,0,-1]),na(ds,"stencilOpSeparate",[Ae,Hn,Hn,Hn]),na(ao,"stencilOpSeparate",[ct,Hn,Hn,Hn]),Xn(Zu,Qf),na(Vl,"scissor",[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]),na(ps,ps,[0,0,ye.drawingBufferWidth,ye.drawingBufferHeight]);var cn={gl:ye,context:Sn,strings:je,next:ta,current:Ir,draw:ln,elements:wr,buffer:Lr,shader:Qr,attributes:Jr.state,vao:Jr,uniforms:un,framebuffer:Wr,extensions:Mt,timer:pn,isBufferArgs:lo},Hr={primTypes:gi,compareFuncs:yo,blendFuncs:Vi,blendEquations:xr,stencilOps:Zi,glTypes:To,orientationType:qa};$.optional(function(){cn.isArrayLike=$i}),On&&(Hr.backBuffer=[ct],Hr.drawBuffer=W(Er.maxDrawbuffers,function(B){return B===0?[0]:W(B,function(k){return Qa+k})}));var jr=0;function ma(){var B=an(),k=B.link,Q=B.global;B.id=jr++,B.batchId="0";var We=k(cn),tt=B.shared={props:"a0"};Object.keys(cn).forEach(function(pt){tt[pt]=Q.def(We,".",pt)}),$.optional(function(){B.CHECK=k($),B.commandStr=$.guessCommand(),B.command=k(B.commandStr),B.assert=function(pt,De,Zt){pt("if(!(",De,"))",this.CHECK,".commandRaise(",k(Zt),",",this.command,");")},Hr.invalidBlendCombinations=Co});var Pe=B.next={},Je=B.current={};Object.keys(Vr).forEach(function(pt){Array.isArray(Ir[pt])&&(Pe[pt]=Q.def(tt.next,".",pt),Je[pt]=Q.def(tt.current,".",pt))});var _t=B.constants={};Object.keys(Hr).forEach(function(pt){_t[pt]=Q.def(JSON.stringify(Hr[pt]))}),B.invoke=function(pt,De){switch(De.type){case sa:var Zt=["this",tt.context,tt.props,B.batchId];return pt.def(k(De.data),".call(",Zt.slice(0,Math.max(De.data.length+1,4)),")");case Aa:return pt.def(tt.props,De.data);case Wa:return pt.def(tt.context,De.data);case Tn:return pt.def("this",De.data);case ua:return De.data.append(B,pt),De.data.ref;case xa:return De.data.toString();case Zn:return De.data.map(function(Kt){return B.invoke(pt,Kt)})}},B.attribCache={};var ke={};return B.scopeAttrib=function(pt){var De=je.id(pt);if(De in ke)return ke[De];var Zt=Jr.scope[De];Zt||(Zt=Jr.scope[De]=new Tr);var Kt=ke[De]=k(Zt);return Kt},B}function pa(B){var k=B.static,Q=B.dynamic,We;if(No in k){var tt=!!k[No];We=Ea(function(Je,_t){return tt}),We.enable=tt}else if(No in Q){var Pe=Q[No];We=wo(Pe,function(Je,_t){return Je.invoke(_t,Pe)})}return We}function Un(B,k){var Q=B.static,We=B.dynamic;if(ko in Q){var tt=Q[ko];return tt?(tt=Wr.getFramebuffer(tt),$.command(tt,"invalid framebuffer object"),Ea(function(Je,_t){var ke=Je.link(tt),pt=Je.shared;_t.set(pt.framebuffer,".next",ke);var De=pt.context;return _t.set(De,"."+ks,ke+".width"),_t.set(De,"."+go,ke+".height"),ke})):Ea(function(Je,_t){var ke=Je.shared;_t.set(ke.framebuffer,".next","null");var pt=ke.context;return _t.set(pt,"."+ks,pt+"."+Sf),_t.set(pt,"."+go,pt+"."+Af),"null"})}else if(ko in We){var Pe=We[ko];return wo(Pe,function(Je,_t){var ke=Je.invoke(_t,Pe),pt=Je.shared,De=pt.framebuffer,Zt=_t.def(De,".getFramebuffer(",ke,")");$.optional(function(){Je.assert(_t,"!"+ke+"||"+Zt,"invalid framebuffer object")}),_t.set(De,".next",Zt);var Kt=pt.context;return _t.set(Kt,"."+ks,Zt+"?"+Zt+".width:"+Kt+"."+Sf),_t.set(Kt,"."+go,Zt+"?"+Zt+".height:"+Kt+"."+Af),Zt})}else return null}function Ua(B,k,Q){var We=B.static,tt=B.dynamic;function Pe(ke){if(ke in We){var pt=We[ke];$.commandType(pt,"object","invalid "+ke,Q.commandStr);var De=!0,Zt=pt.x|0,Kt=pt.y|0,dr,rr;return"width"in pt?(dr=pt.width|0,$.command(dr>=0,"invalid "+ke,Q.commandStr)):De=!1,"height"in pt?(rr=pt.height|0,$.command(rr>=0,"invalid "+ke,Q.commandStr)):De=!1,new Ti(!De&&k&&k.thisDep,!De&&k&&k.contextDep,!De&&k&&k.propDep,function($r,Bn){var on=$r.shared.context,Dn=dr;"width"in pt||(Dn=Bn.def(on,".",ks,"-",Zt));var ca=rr;return"height"in pt||(ca=Bn.def(on,".",go,"-",Kt)),[Zt,Kt,Dn,ca]})}else if(ke in tt){var mr=tt[ke],Or=wo(mr,function($r,Bn){var on=$r.invoke(Bn,mr);$.optional(function(){$r.assert(Bn,on+"&&typeof "+on+'==="object"',"invalid "+ke)});var Dn=$r.shared.context,ca=Bn.def(on,".x|0"),Na=Bn.def(on,".y|0"),ri=Bn.def('"width" in ',on,"?",on,".width|0:","(",Dn,".",ks,"-",ca,")"),co=Bn.def('"height" in ',on,"?",on,".height|0:","(",Dn,".",go,"-",Na,")");return $.optional(function(){$r.assert(Bn,ri+">=0&&"+co+">=0","invalid "+ke)}),[ca,Na,ri,co]});return k&&(Or.thisDep=Or.thisDep||k.thisDep,Or.contextDep=Or.contextDep||k.contextDep,Or.propDep=Or.propDep||k.propDep),Or}else return k?new Ti(k.thisDep,k.contextDep,k.propDep,function($r,Bn){var on=$r.shared.context;return[0,0,Bn.def(on,".",ks),Bn.def(on,".",go)]}):null}var Je=Pe(ps);if(Je){var _t=Je;Je=new Ti(Je.thisDep,Je.contextDep,Je.propDep,function(ke,pt){var De=_t.append(ke,pt),Zt=ke.shared.context;return pt.set(Zt,"."+Tc,De[2]),pt.set(Zt,"."+ms,De[3]),De})}return{viewport:Je,scissor_box:Pe(Vl)}}function _a(B,k){var Q=B.static,We=typeof Q[Ao]=="string"&&typeof Q[Ko]=="string";if(We){if(Object.keys(k.dynamic).length>0)return null;var tt=k.static,Pe=Object.keys(tt);if(Pe.length>0&&typeof tt[Pe[0]]=="number"){for(var Je=[],_t=0;_t<Pe.length;++_t)$(typeof tt[Pe[_t]]=="number","must specify all vertex attribute locations when using vaos"),Je.push([tt[Pe[_t]]|0,Pe[_t]]);return Je}}return null}function Ba(B,k,Q){var We=B.static,tt=B.dynamic;function Pe(De){if(De in We){var Zt=je.id(We[De]);$.optional(function(){Qr.shader(jo[De],Zt,$.guessCommand())});var Kt=Ea(function(){return Zt});return Kt.id=Zt,Kt}else if(De in tt){var dr=tt[De];return wo(dr,function(rr,mr){var Or=rr.invoke(mr,dr),$r=mr.def(rr.shared.strings,".id(",Or,")");return $.optional(function(){mr(rr.shared.shader,".shader(",jo[De],",",$r,",",rr.command,");")}),$r})}return null}var Je=Pe(Ao),_t=Pe(Ko),ke=null,pt;return ki(Je)&&ki(_t)?(ke=Qr.program(_t.id,Je.id,null,Q),pt=Ea(function(De,Zt){return De.link(ke)})):pt=new Ti(Je&&Je.thisDep||_t&&_t.thisDep,Je&&Je.contextDep||_t&&_t.contextDep,Je&&Je.propDep||_t&&_t.propDep,function(De,Zt){var Kt=De.shared.shader,dr;Je?dr=Je.append(De,Zt):dr=Zt.def(Kt,".",Ao);var rr;_t?rr=_t.append(De,Zt):rr=Zt.def(Kt,".",Ko);var mr=Kt+".program("+rr+","+dr;return $.optional(function(){mr+=","+De.command}),Zt.def(mr+")")}),{frag:Je,vert:_t,progVar:pt,program:ke}}function hi(B,k){var Q=B.static,We=B.dynamic;function tt(){if(uo in Q){var De=Q[uo];lo(De)?De=wr.getElements(wr.create(De,!0)):De&&(De=wr.getElements(De),$.command(De,"invalid elements",k.commandStr));var Zt=Ea(function(dr,rr){if(De){var mr=dr.link(De);return dr.ELEMENTS=mr,mr}return dr.ELEMENTS=null,null});return Zt.value=De,Zt}else if(uo in We){var Kt=We[uo];return wo(Kt,function(dr,rr){var mr=dr.shared,Or=mr.isBufferArgs,$r=mr.elements,Bn=dr.invoke(rr,Kt),on=rr.def("null"),Dn=rr.def(Or,"(",Bn,")"),ca=dr.cond(Dn).then(on,"=",$r,".createStream(",Bn,");").else(on,"=",$r,".getElements(",Bn,");");return $.optional(function(){dr.assert(ca.else,"!"+Bn+"||"+on,"invalid elements")}),rr.entry(ca),rr.exit(dr.cond(Dn).then($r,".destroyStream(",on,");")),dr.ELEMENTS=on,on})}return null}var Pe=tt();function Je(){if(Ns in Q){var De=Q[Ns];return $.commandParameter(De,gi,"invalid primitve",k.commandStr),Ea(function(Kt,dr){return gi[De]})}else if(Ns in We){var Zt=We[Ns];return wo(Zt,function(Kt,dr){var rr=Kt.constants.primTypes,mr=Kt.invoke(dr,Zt);return $.optional(function(){Kt.assert(dr,mr+" in "+rr,"invalid primitive, must be one of "+Object.keys(gi))}),dr.def(rr,"[",mr,"]")})}else if(Pe)return ki(Pe)?Pe.value?Ea(function(Kt,dr){return dr.def(Kt.ELEMENTS,".primType")}):Ea(function(){return G}):new Ti(Pe.thisDep,Pe.contextDep,Pe.propDep,function(Kt,dr){var rr=Kt.ELEMENTS;return dr.def(rr,"?",rr,".primType:",G)});return null}function _t(De,Zt){if(De in Q){var Kt=Q[De]|0;return $.command(!Zt||Kt>=0,"invalid "+De,k.commandStr),Ea(function(rr,mr){return Zt&&(rr.OFFSET=Kt),Kt})}else if(De in We){var dr=We[De];return wo(dr,function(rr,mr){var Or=rr.invoke(mr,dr);return Zt&&(rr.OFFSET=Or,$.optional(function(){rr.assert(mr,Or+">=0","invalid "+De)})),Or})}else if(Zt&&Pe)return Ea(function(rr,mr){return rr.OFFSET="0",0});return null}var ke=_t(Gl,!0);function pt(){if(nu in Q){var De=Q[nu]|0;return $.command(typeof De=="number"&&De>=0,"invalid vertex count",k.commandStr),Ea(function(){return De})}else if(nu in We){var Zt=We[nu];return wo(Zt,function(rr,mr){var Or=rr.invoke(mr,Zt);return $.optional(function(){rr.assert(mr,"typeof "+Or+'==="number"&&'+Or+">=0&&"+Or+"===("+Or+"|0)","invalid vertex count")}),Or})}else if(Pe)if(ki(Pe)){if(Pe)return ke?new Ti(ke.thisDep,ke.contextDep,ke.propDep,function(rr,mr){var Or=mr.def(rr.ELEMENTS,".vertCount-",rr.OFFSET);return $.optional(function(){rr.assert(mr,Or+">=0","invalid vertex offset/element buffer too small")}),Or}):Ea(function(rr,mr){return mr.def(rr.ELEMENTS,".vertCount")});var Kt=Ea(function(){return-1});return $.optional(function(){Kt.MISSING=!0}),Kt}else{var dr=new Ti(Pe.thisDep||ke.thisDep,Pe.contextDep||ke.contextDep,Pe.propDep||ke.propDep,function(rr,mr){var Or=rr.ELEMENTS;return rr.OFFSET?mr.def(Or,"?",Or,".vertCount-",rr.OFFSET,":-1"):mr.def(Or,"?",Or,".vertCount:-1")});return $.optional(function(){dr.DYNAMIC=!0}),dr}return null}return{elements:Pe,primitive:Je(),count:pt(),instances:_t(Uc,!1),offset:ke}}function zo(B,k){var Q=B.static,We=B.dynamic,tt={};return qr.forEach(function(Pe){var Je=Kr(Pe);function _t(ke,pt){if(Pe in Q){var De=ke(Q[Pe]);tt[Je]=Ea(function(){return De})}else if(Pe in We){var Zt=We[Pe];tt[Je]=wo(Zt,function(Kt,dr){return pt(Kt,dr,Kt.invoke(dr,Zt))})}}switch(Pe){case ts:case ia:case Ca:case oc:case Ai:case Zu:case Hs:case ic:case tu:case Bi:return _t(function(ke){return $.commandType(ke,"boolean",Pe,k.commandStr),ke},function(ke,pt,De){return $.optional(function(){ke.assert(pt,"typeof "+De+'==="boolean"',"invalid flag "+Pe,ke.commandStr)}),De});case Ni:return _t(function(ke){return $.commandParameter(ke,yo,"invalid "+Pe,k.commandStr),yo[ke]},function(ke,pt,De){var Zt=ke.constants.compareFuncs;return $.optional(function(){ke.assert(pt,De+" in "+Zt,"invalid "+Pe+", must be one of "+Object.keys(yo))}),pt.def(Zt,"[",De,"]")});case Ei:return _t(function(ke){return $.command($i(ke)&&ke.length===2&&typeof ke[0]=="number"&&typeof ke[1]=="number"&&ke[0]<=ke[1],"depth range is 2d array",k.commandStr),ke},function(ke,pt,De){$.optional(function(){ke.assert(pt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===2&&typeof "+De+'[0]==="number"&&typeof '+De+'[1]==="number"&&'+De+"[0]<="+De+"[1]","depth range must be a 2d array")});var Zt=pt.def("+",De,"[0]"),Kt=pt.def("+",De,"[1]");return[Zt,Kt]});case Hi:return _t(function(ke){$.commandType(ke,"object","blend.func",k.commandStr);var pt="srcRGB"in ke?ke.srcRGB:ke.src,De="srcAlpha"in ke?ke.srcAlpha:ke.src,Zt="dstRGB"in ke?ke.dstRGB:ke.dst,Kt="dstAlpha"in ke?ke.dstAlpha:ke.dst;return $.commandParameter(pt,Vi,Je+".srcRGB",k.commandStr),$.commandParameter(De,Vi,Je+".srcAlpha",k.commandStr),$.commandParameter(Zt,Vi,Je+".dstRGB",k.commandStr),$.commandParameter(Kt,Vi,Je+".dstAlpha",k.commandStr),$.command(Co.indexOf(pt+", "+Zt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+pt+", "+Zt+")",k.commandStr),[Vi[pt],Vi[Zt],Vi[De],Vi[Kt]]},function(ke,pt,De){var Zt=ke.constants.blendFuncs;$.optional(function(){ke.assert(pt,De+"&&typeof "+De+'==="object"',"invalid blend func, must be an object")});function Kt(on,Dn){var ca=pt.def('"',on,Dn,'" in ',De,"?",De,".",on,Dn,":",De,".",on);return $.optional(function(){ke.assert(pt,ca+" in "+Zt,"invalid "+Pe+"."+on+Dn+", must be one of "+Object.keys(Vi))}),ca}var dr=Kt("src","RGB"),rr=Kt("dst","RGB");$.optional(function(){var on=ke.constants.invalidBlendCombinations;ke.assert(pt,on+".indexOf("+dr+'+", "+'+rr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var mr=pt.def(Zt,"[",dr,"]"),Or=pt.def(Zt,"[",Kt("src","Alpha"),"]"),$r=pt.def(Zt,"[",rr,"]"),Bn=pt.def(Zt,"[",Kt("dst","Alpha"),"]");return[mr,$r,Or,Bn]});case Fa:return _t(function(ke){if(typeof ke=="string")return $.commandParameter(ke,xr,"invalid "+Pe,k.commandStr),[xr[ke],xr[ke]];if(typeof ke=="object")return $.commandParameter(ke.rgb,xr,Pe+".rgb",k.commandStr),$.commandParameter(ke.alpha,xr,Pe+".alpha",k.commandStr),[xr[ke.rgb],xr[ke.alpha]];$.commandRaise("invalid blend.equation",k.commandStr)},function(ke,pt,De){var Zt=ke.constants.blendEquations,Kt=pt.def(),dr=pt.def(),rr=ke.cond("typeof ",De,'==="string"');return $.optional(function(){function mr(Or,$r,Bn){ke.assert(Or,Bn+" in "+Zt,"invalid "+$r+", must be one of "+Object.keys(xr))}mr(rr.then,Pe,De),ke.assert(rr.else,De+"&&typeof "+De+'==="object"',"invalid "+Pe),mr(rr.else,Pe+".rgb",De+".rgb"),mr(rr.else,Pe+".alpha",De+".alpha")}),rr.then(Kt,"=",dr,"=",Zt,"[",De,"];"),rr.else(Kt,"=",Zt,"[",De,".rgb];",dr,"=",Zt,"[",De,".alpha];"),pt(rr),[Kt,dr]});case La:return _t(function(ke){return $.command($i(ke)&&ke.length===4,"blend.color must be a 4d array",k.commandStr),W(4,function(pt){return+ke[pt]})},function(ke,pt,De){return $.optional(function(){ke.assert(pt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===4","blend.color must be a 4d array")}),W(4,function(Zt){return pt.def("+",De,"[",Zt,"]")})});case ru:return _t(function(ke){return $.commandType(ke,"number",Je,k.commandStr),ke|0},function(ke,pt,De){return $.optional(function(){ke.assert(pt,"typeof "+De+'==="number"',"invalid stencil.mask")}),pt.def(De,"|0")});case Mu:return _t(function(ke){$.commandType(ke,"object",Je,k.commandStr);var pt=ke.cmp||"keep",De=ke.ref||0,Zt="mask"in ke?ke.mask:-1;return $.commandParameter(pt,yo,Pe+".cmp",k.commandStr),$.commandType(De,"number",Pe+".ref",k.commandStr),$.commandType(Zt,"number",Pe+".mask",k.commandStr),[yo[pt],De,Zt]},function(ke,pt,De){var Zt=ke.constants.compareFuncs;$.optional(function(){function mr(){ke.assert(pt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}mr(De+"&&typeof ",De,'==="object"'),mr('!("cmp" in ',De,")||(",De,".cmp in ",Zt,")")});var Kt=pt.def('"cmp" in ',De,"?",Zt,"[",De,".cmp]",":",Hn),dr=pt.def(De,".ref|0"),rr=pt.def('"mask" in ',De,"?",De,".mask|0:-1");return[Kt,dr,rr]});case ds:case ao:return _t(function(ke){$.commandType(ke,"object",Je,k.commandStr);var pt=ke.fail||"keep",De=ke.zfail||"keep",Zt=ke.zpass||"keep";return $.commandParameter(pt,Zi,Pe+".fail",k.commandStr),$.commandParameter(De,Zi,Pe+".zfail",k.commandStr),$.commandParameter(Zt,Zi,Pe+".zpass",k.commandStr),[Pe===ao?ct:Ae,Zi[pt],Zi[De],Zi[Zt]]},function(ke,pt,De){var Zt=ke.constants.stencilOps;$.optional(function(){ke.assert(pt,De+"&&typeof "+De+'==="object"',"invalid "+Pe)});function Kt(dr){return $.optional(function(){ke.assert(pt,'!("'+dr+'" in '+De+")||("+De+"."+dr+" in "+Zt+")","invalid "+Pe+"."+dr+", must be one of "+Object.keys(Zi))}),pt.def('"',dr,'" in ',De,"?",Zt,"[",De,".",dr,"]:",Hn)}return[Pe===ao?ct:Ae,Kt("fail"),Kt("zfail"),Kt("zpass")]});case Ou:return _t(function(ke){$.commandType(ke,"object",Je,k.commandStr);var pt=ke.factor|0,De=ke.units|0;return $.commandType(pt,"number",Je+".factor",k.commandStr),$.commandType(De,"number",Je+".units",k.commandStr),[pt,De]},function(ke,pt,De){$.optional(function(){ke.assert(pt,De+"&&typeof "+De+'==="object"',"invalid "+Pe)});var Zt=pt.def(De,".factor|0"),Kt=pt.def(De,".units|0");return[Zt,Kt]});case vu:return _t(function(ke){var pt=0;return ke==="front"?pt=Ae:ke==="back"&&(pt=ct),$.command(!!pt,Je,k.commandStr),pt},function(ke,pt,De){return $.optional(function(){ke.assert(pt,De+'==="front"||'+De+'==="back"',"invalid cull.face")}),pt.def(De,'==="front"?',Ae,":",ct)});case hs:return _t(function(ke){return $.command(typeof ke=="number"&&ke>=Er.lineWidthDims[0]&&ke<=Er.lineWidthDims[1],"invalid line width, must be a positive number between "+Er.lineWidthDims[0]+" and "+Er.lineWidthDims[1],k.commandStr),ke},function(ke,pt,De){return $.optional(function(){ke.assert(pt,"typeof "+De+'==="number"&&'+De+">="+Er.lineWidthDims[0]+"&&"+De+"<="+Er.lineWidthDims[1],"invalid line width")}),De});case wu:return _t(function(ke){return $.commandParameter(ke,qa,Je,k.commandStr),qa[ke]},function(ke,pt,De){return $.optional(function(){ke.assert(pt,De+'==="cw"||'+De+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),pt.def(De+'==="cw"?'+Yt+":"+sr)});case es:return _t(function(ke){return $.command($i(ke)&&ke.length===4,"color.mask must be length 4 array",k.commandStr),ke.map(function(pt){return!!pt})},function(ke,pt,De){return $.optional(function(){ke.assert(pt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===4","invalid color.mask")}),W(4,function(Zt){return"!!"+De+"["+Zt+"]"})});case Hu:return _t(function(ke){$.command(typeof ke=="object"&&ke,Je,k.commandStr);var pt="value"in ke?ke.value:1,De=!!ke.invert;return $.command(typeof pt=="number"&&pt>=0&&pt<=1,"sample.coverage.value must be a number between 0 and 1",k.commandStr),[pt,De]},function(ke,pt,De){$.optional(function(){ke.assert(pt,De+"&&typeof "+De+'==="object"',"invalid sample.coverage")});var Zt=pt.def('"value" in ',De,"?+",De,".value:1"),Kt=pt.def("!!",De,".invert");return[Zt,Kt]})}}),tt}function Os(B,k){var Q=B.static,We=B.dynamic,tt={};return Object.keys(Q).forEach(function(Pe){var Je=Q[Pe],_t;if(typeof Je=="number"||typeof Je=="boolean")_t=Ea(function(){return Je});else if(typeof Je=="function"){var ke=Je._reglType;ke==="texture2d"||ke==="textureCube"?_t=Ea(function(pt){return pt.link(Je)}):ke==="framebuffer"||ke==="framebufferCube"?($.command(Je.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Pe+'"',k.commandStr),_t=Ea(function(pt){return pt.link(Je.color[0])})):$.commandRaise('invalid data for uniform "'+Pe+'"',k.commandStr)}else $i(Je)?_t=Ea(function(pt){var De=pt.global.def("[",W(Je.length,function(Zt){return $.command(typeof Je[Zt]=="number"||typeof Je[Zt]=="boolean","invalid uniform "+Pe,pt.commandStr),Je[Zt]}),"]");return De}):$.commandRaise('invalid or missing data for uniform "'+Pe+'"',k.commandStr);_t.value=Je,tt[Pe]=_t}),Object.keys(We).forEach(function(Pe){var Je=We[Pe];tt[Pe]=wo(Je,function(_t,ke){return _t.invoke(ke,Je)})}),tt}function ei(B,k){var Q=B.static,We=B.dynamic,tt={};return Object.keys(Q).forEach(function(Pe){var Je=Q[Pe],_t=je.id(Pe),ke=new Tr;if(lo(Je))ke.state=Pn,ke.buffer=Lr.getBuffer(Lr.create(Je,Wu,!1,!0)),ke.type=0;else{var pt=Lr.getBuffer(Je);if(pt)ke.state=Pn,ke.buffer=pt,ke.type=0;else if($.command(typeof Je=="object"&&Je,"invalid data for attribute "+Pe,k.commandStr),"constant"in Je){var De=Je.constant;ke.buffer="null",ke.state=qn,typeof De=="number"?ke.x=De:($.command($i(De)&&De.length>0&&De.length<=4,"invalid constant for attribute "+Pe,k.commandStr),Yr.forEach(function($r,Bn){Bn<De.length&&(ke[$r]=De[Bn])}))}else{lo(Je.buffer)?pt=Lr.getBuffer(Lr.create(Je.buffer,Wu,!1,!0)):pt=Lr.getBuffer(Je.buffer),$.command(!!pt,'missing buffer for attribute "'+Pe+'"',k.commandStr);var Zt=Je.offset|0;$.command(Zt>=0,'invalid offset for attribute "'+Pe+'"',k.commandStr);var Kt=Je.stride|0;$.command(Kt>=0&&Kt<256,'invalid stride for attribute "'+Pe+'", must be integer betweeen [0, 255]',k.commandStr);var dr=Je.size|0;$.command(!("size"in Je)||dr>0&&dr<=4,'invalid size for attribute "'+Pe+'", must be 1,2,3,4',k.commandStr);var rr=!!Je.normalized,mr=0;"type"in Je&&($.commandParameter(Je.type,To,"invalid type for attribute "+Pe,k.commandStr),mr=To[Je.type]);var Or=Je.divisor|0;"divisor"in Je&&($.command(Or===0||Xr,'cannot specify divisor for attribute "'+Pe+'", instancing not supported',k.commandStr),$.command(Or>=0,'invalid divisor for attribute "'+Pe+'"',k.commandStr)),$.optional(function(){var $r=k.commandStr,Bn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Je).forEach(function(on){$.command(Bn.indexOf(on)>=0,'unknown parameter "'+on+'" for attribute pointer "'+Pe+'" (valid parameters are '+Bn+")",$r)})}),ke.buffer=pt,ke.state=Pn,ke.size=dr,ke.normalized=rr,ke.type=mr||pt.dtype,ke.offset=Zt,ke.stride=Kt,ke.divisor=Or}}tt[Pe]=Ea(function($r,Bn){var on=$r.attribCache;if(_t in on)return on[_t];var Dn={isStream:!1};return Object.keys(ke).forEach(function(ca){Dn[ca]=ke[ca]}),ke.buffer&&(Dn.buffer=$r.link(ke.buffer),Dn.type=Dn.type||Dn.buffer+".dtype"),on[_t]=Dn,Dn})}),Object.keys(We).forEach(function(Pe){var Je=We[Pe];function _t(ke,pt){var De=ke.invoke(pt,Je),Zt=ke.shared,Kt=ke.constants,dr=Zt.isBufferArgs,rr=Zt.buffer;$.optional(function(){ke.assert(pt,De+"&&(typeof "+De+'==="object"||typeof '+De+'==="function")&&('+dr+"("+De+")||"+rr+".getBuffer("+De+")||"+rr+".getBuffer("+De+".buffer)||"+dr+"("+De+'.buffer)||("constant" in '+De+"&&(typeof "+De+'.constant==="number"||'+Zt.isArrayLike+"("+De+".constant))))",'invalid dynamic attribute "'+Pe+'"')});var mr={isStream:pt.def(!1)},Or=new Tr;Or.state=Pn,Object.keys(Or).forEach(function(Dn){mr[Dn]=pt.def(""+Or[Dn])});var $r=mr.buffer,Bn=mr.type;pt("if(",dr,"(",De,")){",mr.isStream,"=true;",$r,"=",rr,".createStream(",Wu,",",De,");",Bn,"=",$r,".dtype;","}else{",$r,"=",rr,".getBuffer(",De,");","if(",$r,"){",Bn,"=",$r,".dtype;",'}else if("constant" in ',De,"){",mr.state,"=",qn,";","if(typeof "+De+'.constant === "number"){',mr[Yr[0]],"=",De,".constant;",Yr.slice(1).map(function(Dn){return mr[Dn]}).join("="),"=0;","}else{",Yr.map(function(Dn,ca){return mr[Dn]+"="+De+".constant.length>"+ca+"?"+De+".constant["+ca+"]:0;"}).join(""),"}}else{","if(",dr,"(",De,".buffer)){",$r,"=",rr,".createStream(",Wu,",",De,".buffer);","}else{",$r,"=",rr,".getBuffer(",De,".buffer);","}",Bn,'="type" in ',De,"?",Kt.glTypes,"[",De,".type]:",$r,".dtype;",mr.normalized,"=!!",De,".normalized;");function on(Dn){pt(mr[Dn],"=",De,".",Dn,"|0;")}return on("size"),on("offset"),on("stride"),on("divisor"),pt("}}"),pt.exit("if(",mr.isStream,"){",rr,".destroyStream(",$r,");","}"),mr}tt[Pe]=wo(Je,_t)}),tt}function bo(B,k){var Q=B.static,We=B.dynamic;if(fl in Q){var tt=Q[fl];return tt!==null&&Jr.getVAO(tt)===null&&(tt=Jr.createVAO(tt)),Ea(function(Je){return Je.link(Jr.getVAO(tt))})}else if(fl in We){var Pe=We[fl];return wo(Pe,function(Je,_t){var ke=Je.invoke(_t,Pe);return _t.def(Je.shared.vao+".getVAO("+ke+")")})}return null}function Ci(B){var k=B.static,Q=B.dynamic,We={};return Object.keys(k).forEach(function(tt){var Pe=k[tt];We[tt]=Ea(function(Je,_t){return typeof Pe=="number"||typeof Pe=="boolean"?""+Pe:Je.link(Pe)})}),Object.keys(Q).forEach(function(tt){var Pe=Q[tt];We[tt]=wo(Pe,function(Je,_t){return Je.invoke(_t,Pe)})}),We}function vs(B,k,Q,We,tt){var Pe=B.static,Je=B.dynamic;$.optional(function(){var on=[ko,Ko,Ao,uo,Ns,Gl,nu,Uc,No,fl].concat(qr);function Dn(ca){Object.keys(ca).forEach(function(Na){$.command(on.indexOf(Na)>=0,'unknown parameter "'+Na+'"',tt.commandStr)})}Dn(Pe),Dn(Je)});var _t=_a(B,k),ke=Un(B,tt),pt=Ua(B,ke,tt),De=hi(B,tt),Zt=zo(B,tt),Kt=Ba(B,tt,_t);function dr(on){var Dn=pt[on];Dn&&(Zt[on]=Dn)}dr(ps),dr(Kr(Vl));var rr=Object.keys(Zt).length>0,mr={framebuffer:ke,draw:De,shader:Kt,state:Zt,dirty:rr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(mr.profile=pa(B,tt),mr.uniforms=Os(Q,tt),mr.drawVAO=mr.scopeVAO=bo(B,tt),!mr.drawVAO&&Kt.program&&!_t&&Mt.angle_instanced_arrays){var Or=!0,$r=Kt.program.attributes.map(function(on){var Dn=k.static[on];return Or=Or&&!!Dn,Dn});if(Or&&$r.length>0){var Bn=Jr.getVAO(Jr.createVAO($r));mr.drawVAO=new Ti(null,null,null,function(on,Dn){return on.link(Bn)}),mr.useVAO=!0}}return _t?mr.useVAO=!0:mr.attributes=ei(k,tt),mr.context=Ci(We,tt),mr}function Fo(B,k,Q){var We=B.shared,tt=We.context,Pe=B.scope();Object.keys(Q).forEach(function(Je){k.save(tt,"."+Je);var _t=Q[Je],ke=_t.append(B,k);Array.isArray(ke)?Pe(tt,".",Je,"=[",ke.join(),"];"):Pe(tt,".",Je,"=",ke,";")}),k(Pe)}function gs(B,k,Q,We){var tt=B.shared,Pe=tt.gl,Je=tt.framebuffer,_t;On&&(_t=k.def(tt.extensions,".webgl_draw_buffers"));var ke=B.constants,pt=ke.drawBuffer,De=ke.backBuffer,Zt;Q?Zt=Q.append(B,k):Zt=k.def(Je,".next"),We||k("if(",Zt,"!==",Je,".cur){"),k("if(",Zt,"){",Pe,".bindFramebuffer(",_i,",",Zt,".framebuffer);"),On&&k(_t,".drawBuffersWEBGL(",pt,"[",Zt,".colorAttachments.length]);"),k("}else{",Pe,".bindFramebuffer(",_i,",null);"),On&&k(_t,".drawBuffersWEBGL(",De,");"),k("}",Je,".cur=",Zt,";"),We||k("}")}function Uo(B,k,Q){var We=B.shared,tt=We.gl,Pe=B.current,Je=B.next,_t=We.current,ke=We.next,pt=B.cond(_t,".dirty");qr.forEach(function(De){var Zt=Kr(De);if(Zt in Q.state)return;var Kt,dr;if(Zt in Je){Kt=Je[Zt],dr=Pe[Zt];var rr=W(Ir[Zt].length,function(Or){return pt.def(Kt,"[",Or,"]")});pt(B.cond(rr.map(function(Or,$r){return Or+"!=="+dr+"["+$r+"]"}).join("||")).then(tt,".",Vr[Zt],"(",rr,");",rr.map(function(Or,$r){return dr+"["+$r+"]="+Or}).join(";"),";"))}else{Kt=pt.def(ke,".",Zt);var mr=B.cond(Kt,"!==",_t,".",Zt);pt(mr),Zt in Fr?mr(B.cond(Kt).then(tt,".enable(",Fr[Zt],");").else(tt,".disable(",Fr[Zt],");"),_t,".",Zt,"=",Kt,";"):mr(tt,".",Vr[Zt],"(",Kt,");",_t,".",Zt,"=",Kt,";")}}),Object.keys(Q.state).length===0&&pt(_t,".dirty=false;"),k(pt)}function Bo(B,k,Q,We){var tt=B.shared,Pe=B.current,Je=tt.current,_t=tt.gl;iu(Object.keys(Q)).forEach(function(ke){var pt=Q[ke];if(We&&!We(pt))return;var De=pt.append(B,k);if(Fr[ke]){var Zt=Fr[ke];ki(pt)?De?k(_t,".enable(",Zt,");"):k(_t,".disable(",Zt,");"):k(B.cond(De).then(_t,".enable(",Zt,");").else(_t,".disable(",Zt,");")),k(Je,".",ke,"=",De,";")}else if($i(De)){var Kt=Pe[ke];k(_t,".",Vr[ke],"(",De,");",De.map(function(dr,rr){return Kt+"["+rr+"]="+dr}).join(";"),";")}else k(_t,".",Vr[ke],"(",De,");",Je,".",ke,"=",De,";")})}function Vo(B,k){Xr&&(B.instancing=k.def(B.shared.extensions,".angle_instanced_arrays"))}function aa(B,k,Q,We,tt){var Pe=B.shared,Je=B.stats,_t=Pe.current,ke=Pe.timer,pt=Q.profile;function De(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Zt,Kt;function dr(on){Zt=k.def(),on(Zt,"=",De(),";"),typeof tt=="string"?on(Je,".count+=",tt,";"):on(Je,".count++;"),pn&&(We?(Kt=k.def(),on(Kt,"=",ke,".getNumPendingQueries();")):on(ke,".beginQuery(",Je,");"))}function rr(on){on(Je,".cpuTime+=",De(),"-",Zt,";"),pn&&(We?on(ke,".pushScopeStats(",Kt,",",ke,".getNumPendingQueries(),",Je,");"):on(ke,".endQuery();"))}function mr(on){var Dn=k.def(_t,".profile");k(_t,".profile=",on,";"),k.exit(_t,".profile=",Dn,";")}var Or;if(pt){if(ki(pt)){pt.enable?(dr(k),rr(k.exit),mr("true")):mr("false");return}Or=pt.append(B,k),mr(Or)}else Or=k.def(_t,".profile");var $r=B.block();dr($r),k("if(",Or,"){",$r,"}");var Bn=B.block();rr(Bn),k.exit("if(",Or,"){",Bn,"}")}function ou(B,k,Q,We,tt){var Pe=B.shared;function Je(ke){switch(ke){case sf:case Cc:case Df:return 2;case io:case au:case Vc:return 3;case lc:case Cl:case uf:return 4;default:return 1}}function _t(ke,pt,De){var Zt=Pe.gl,Kt=k.def(ke,".location"),dr=k.def(Pe.attributes,"[",Kt,"]"),rr=De.state,mr=De.buffer,Or=[De.x,De.y,De.z,De.w],$r=["buffer","normalized","offset","stride"];function Bn(){k("if(!",dr,".buffer){",Zt,".enableVertexAttribArray(",Kt,");}");var Dn=De.type,ca;if(De.size?ca=k.def(De.size,"||",pt):ca=pt,k("if(",dr,".type!==",Dn,"||",dr,".size!==",ca,"||",$r.map(function(ri){return dr+"."+ri+"!=="+De[ri]}).join("||"),"){",Zt,".bindBuffer(",Wu,",",mr,".buffer);",Zt,".vertexAttribPointer(",[Kt,ca,Dn,De.normalized,De.stride,De.offset],");",dr,".type=",Dn,";",dr,".size=",ca,";",$r.map(function(ri){return dr+"."+ri+"="+De[ri]+";"}).join(""),"}"),Xr){var Na=De.divisor;k("if(",dr,".divisor!==",Na,"){",B.instancing,".vertexAttribDivisorANGLE(",[Kt,Na],");",dr,".divisor=",Na,";}")}}function on(){k("if(",dr,".buffer){",Zt,".disableVertexAttribArray(",Kt,");",dr,".buffer=null;","}if(",Yr.map(function(Dn,ca){return dr+"."+Dn+"!=="+Or[ca]}).join("||"),"){",Zt,".vertexAttrib4f(",Kt,",",Or,");",Yr.map(function(Dn,ca){return dr+"."+Dn+"="+Or[ca]+";"}).join(""),"}")}rr===Pn?Bn():rr===qn?on():(k("if(",rr,"===",Pn,"){"),Bn(),k("}else{"),on(),k("}"))}We.forEach(function(ke){var pt=ke.name,De=Q.attributes[pt],Zt;if(De){if(!tt(De))return;Zt=De.append(B,k)}else{if(!tt(cc))return;var Kt=B.scopeAttrib(pt);$.optional(function(){B.assert(k,Kt+".state","missing attribute "+pt)}),Zt={},Object.keys(new Tr).forEach(function(dr){Zt[dr]=k.def(Kt,".",dr)})}_t(B.link(ke),Je(ke.info.type),Zt)})}function yi(B,k,Q,We,tt){for(var Pe=B.shared,Je=Pe.gl,_t,ke=0;ke<We.length;++ke){var pt=We[ke],De=pt.name,Zt=pt.info.type,Kt=Q.uniforms[De],dr=B.link(pt),rr=dr+".location",mr;if(Kt){if(!tt(Kt))continue;if(ki(Kt)){var Or=Kt.value;if($.command(Or!==null&&typeof Or!="undefined",'missing uniform "'+De+'"',B.commandStr),Zt===se||Zt===N){$.command(typeof Or=="function"&&(Zt===se&&(Or._reglType==="texture2d"||Or._reglType==="framebuffer")||Zt===N&&(Or._reglType==="textureCube"||Or._reglType==="framebufferCube")),"invalid texture for uniform "+De,B.commandStr);var $r=B.link(Or._texture||Or.color[0]._texture);k(Je,".uniform1i(",rr,",",$r+".bind());"),k.exit($r,".unbind();")}else if(Zt===Gc||Zt===dl||Zt===ne){$.optional(function(){$.command($i(Or),"invalid matrix for uniform "+De,B.commandStr),$.command(Zt===Gc&&Or.length===4||Zt===dl&&Or.length===9||Zt===ne&&Or.length===16,"invalid length for matrix uniform "+De,B.commandStr)});var Bn=B.global.def("new Float32Array(["+Array.prototype.slice.call(Or)+"])"),on=2;Zt===dl?on=3:Zt===ne&&(on=4),k(Je,".uniformMatrix",on,"fv(",rr,",false,",Bn,");")}else{switch(Zt){case Hl:$.commandType(Or,"number","uniform "+De,B.commandStr),_t="1f";break;case sf:$.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),_t="2f";break;case io:$.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),_t="3f";break;case lc:$.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),_t="4f";break;case Ef:$.commandType(Or,"boolean","uniform "+De,B.commandStr),_t="1i";break;case xf:$.commandType(Or,"number","uniform "+De,B.commandStr),_t="1i";break;case Df:$.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),_t="2i";break;case Cc:$.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),_t="2i";break;case Vc:$.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),_t="3i";break;case au:$.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),_t="3i";break;case uf:$.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),_t="4i";break;case Cl:$.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),_t="4i";break}k(Je,".uniform",_t,"(",rr,",",$i(Or)?Array.prototype.slice.call(Or):Or,");")}continue}else mr=Kt.append(B,k)}else{if(!tt(cc))continue;mr=k.def(Pe.uniforms,"[",je.id(De),"]")}Zt===se?($(!Array.isArray(mr),"must specify a scalar prop for textures"),k("if(",mr,"&&",mr,'._reglType==="framebuffer"){',mr,"=",mr,".color[0];","}")):Zt===N&&($(!Array.isArray(mr),"must specify a scalar prop for cube maps"),k("if(",mr,"&&",mr,'._reglType==="framebufferCube"){',mr,"=",mr,".color[0];","}")),$.optional(function(){function co(xo,Wl){B.assert(k,xo,'bad data or missing for uniform "'+De+'".  '+Wl)}function Hc(xo){$(!Array.isArray(mr),"must not specify an array type for uniform"),co("typeof "+mr+'==="'+xo+'"',"invalid type, expected "+xo)}function ys(xo,Wl){Array.isArray(mr)?$(mr.length===xo,"must have length "+xo):co(Pe.isArrayLike+"("+mr+")&&"+mr+".length==="+xo,"invalid vector, should have length "+xo,B.commandStr)}function fc(xo){$(!Array.isArray(mr),"must not specify a value type"),co("typeof "+mr+'==="function"&&'+mr+'._reglType==="texture'+(xo===Pu?"2d":"Cube")+'"',"invalid texture type",B.commandStr)}switch(Zt){case xf:Hc("number");break;case Cc:ys(2,"number");break;case au:ys(3,"number");break;case Cl:ys(4,"number");break;case Hl:Hc("number");break;case sf:ys(2,"number");break;case io:ys(3,"number");break;case lc:ys(4,"number");break;case Ef:Hc("boolean");break;case Df:ys(2,"boolean");break;case Vc:ys(3,"boolean");break;case uf:ys(4,"boolean");break;case Gc:ys(4,"number");break;case dl:ys(9,"number");break;case ne:ys(16,"number");break;case se:fc(Pu);break;case N:fc(uc);break}});var Dn=1;switch(Zt){case se:case N:var ca=k.def(mr,"._texture");k(Je,".uniform1i(",rr,",",ca,".bind());"),k.exit(ca,".unbind();");continue;case xf:case Ef:_t="1i";break;case Cc:case Df:_t="2i",Dn=2;break;case au:case Vc:_t="3i",Dn=3;break;case Cl:case uf:_t="4i",Dn=4;break;case Hl:_t="1f";break;case sf:_t="2f",Dn=2;break;case io:_t="3f",Dn=3;break;case lc:_t="4f",Dn=4;break;case Gc:_t="Matrix2fv";break;case dl:_t="Matrix3fv";break;case ne:_t="Matrix4fv";break}if(k(Je,".uniform",_t,"(",rr,","),_t.charAt(0)==="M"){var Na=Math.pow(Zt-Gc+2,2),ri=B.global.def("new Float32Array(",Na,")");Array.isArray(mr)?k("false,(",W(Na,function(co){return ri+"["+co+"]="+mr[co]}),",",ri,")"):k("false,(Array.isArray(",mr,")||",mr," instanceof Float32Array)?",mr,":(",W(Na,function(co){return ri+"["+co+"]="+mr+"["+co+"]"}),",",ri,")")}else Dn>1?k(W(Dn,function(co){return Array.isArray(mr)?mr[co]:mr+"["+co+"]"})):($(!Array.isArray(mr),"uniform value must not be an array"),k(mr));k(");")}}function An(B,k,Q,We){var tt=B.shared,Pe=tt.gl,Je=tt.draw,_t=We.draw;function ke(){var ca=_t.elements,Na,ri=k;return ca?((ca.contextDep&&We.contextDynamic||ca.propDep)&&(ri=Q),Na=ca.append(B,ri)):Na=ri.def(Je,".",uo),Na&&ri("if("+Na+")"+Pe+".bindBuffer("+bf+","+Na+".buffer.buffer);"),Na}function pt(){var ca=_t.count,Na,ri=k;return ca?((ca.contextDep&&We.contextDynamic||ca.propDep)&&(ri=Q),Na=ca.append(B,ri),$.optional(function(){ca.MISSING&&B.assert(k,"false","missing vertex count"),ca.DYNAMIC&&B.assert(ri,Na+">=0","missing vertex count")})):(Na=ri.def(Je,".",nu),$.optional(function(){B.assert(ri,Na+">=0","missing vertex count")})),Na}var De=ke();function Zt(ca){var Na=_t[ca];return Na?Na.contextDep&&We.contextDynamic||Na.propDep?Na.append(B,Q):Na.append(B,k):k.def(Je,".",ca)}var Kt=Zt(Ns),dr=Zt(Gl),rr=pt();if(typeof rr=="number"){if(rr===0)return}else Q("if(",rr,"){"),Q.exit("}");var mr,Or;Xr&&(mr=Zt(Uc),Or=B.instancing);var $r=De+".type",Bn=_t.elements&&ki(_t.elements);function on(){function ca(){Q(Or,".drawElementsInstancedANGLE(",[Kt,rr,$r,dr+"<<(("+$r+"-"+vn+")>>1)",mr],");")}function Na(){Q(Or,".drawArraysInstancedANGLE(",[Kt,dr,rr,mr],");")}De?Bn?ca():(Q("if(",De,"){"),ca(),Q("}else{"),Na(),Q("}")):Na()}function Dn(){function ca(){Q(Pe+".drawElements("+[Kt,rr,$r,dr+"<<(("+$r+"-"+vn+")>>1)"]+");")}function Na(){Q(Pe+".drawArrays("+[Kt,dr,rr]+");")}De?Bn?ca():(Q("if(",De,"){"),ca(),Q("}else{"),Na(),Q("}")):Na()}Xr&&(typeof mr!="number"||mr>=0)?typeof mr=="string"?(Q("if(",mr,">0){"),on(),Q("}else if(",mr,"<0){"),Dn(),Q("}")):on():Dn()}function Ra(B,k,Q,We,tt){var Pe=ma(),Je=Pe.proc("body",tt);return $.optional(function(){Pe.commandStr=k.commandStr,Pe.command=Pe.link(k.commandStr)}),Xr&&(Pe.instancing=Je.def(Pe.shared.extensions,".angle_instanced_arrays")),B(Pe,Je,Q,We),Pe.compile().body}function Va(B,k,Q,We){Vo(B,k),Q.useVAO?Q.drawVAO?k(B.shared.vao,".setVAO(",Q.drawVAO.append(B,k),");"):k(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(k(B.shared.vao,".setVAO(null);"),ou(B,k,Q,We.attributes,function(){return!0})),yi(B,k,Q,We.uniforms,function(){return!0}),An(B,k,k,Q)}function rs(B,k){var Q=B.proc("draw",1);Vo(B,Q),Fo(B,Q,k.context),gs(B,Q,k.framebuffer),Uo(B,Q,k),Bo(B,Q,k.state),aa(B,Q,k,!1,!0);var We=k.shader.progVar.append(B,Q);if(Q(B.shared.gl,".useProgram(",We,".program);"),k.shader.program)Va(B,Q,k,k.shader.program);else{Q(B.shared.vao,".setVAO(null);");var tt=B.global.def("{}"),Pe=Q.def(We,".id"),Je=Q.def(tt,"[",Pe,"]");Q(B.cond(Je).then(Je,".call(this,a0);").else(Je,"=",tt,"[",Pe,"]=",B.link(function(_t){return Ra(Va,B,k,_t,1)}),"(",We,");",Je,".call(this,a0);"))}Object.keys(k.state).length>0&&Q(B.shared.current,".dirty=true;")}function w(B,k,Q,We){B.batchId="a1",Vo(B,k);function tt(){return!0}ou(B,k,Q,We.attributes,tt),yi(B,k,Q,We.uniforms,tt),An(B,k,k,Q)}function y(B,k,Q,We){Vo(B,k);var tt=Q.contextDep,Pe=k.def(),Je="a0",_t="a1",ke=k.def();B.shared.props=ke,B.batchId=Pe;var pt=B.scope(),De=B.scope();k(pt.entry,"for(",Pe,"=0;",Pe,"<",_t,";++",Pe,"){",ke,"=",Je,"[",Pe,"];",De,"}",pt.exit);function Zt($r){return $r.contextDep&&tt||$r.propDep}function Kt($r){return!Zt($r)}if(Q.needsContext&&Fo(B,De,Q.context),Q.needsFramebuffer&&gs(B,De,Q.framebuffer),Bo(B,De,Q.state,Zt),Q.profile&&Zt(Q.profile)&&aa(B,De,Q,!1,!0),We)Q.useVAO?Q.drawVAO?Zt(Q.drawVAO)?De(B.shared.vao,".setVAO(",Q.drawVAO.append(B,De),");"):pt(B.shared.vao,".setVAO(",Q.drawVAO.append(B,pt),");"):pt(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(pt(B.shared.vao,".setVAO(null);"),ou(B,pt,Q,We.attributes,Kt),ou(B,De,Q,We.attributes,Zt)),yi(B,pt,Q,We.uniforms,Kt),yi(B,De,Q,We.uniforms,Zt),An(B,pt,De,Q);else{var dr=B.global.def("{}"),rr=Q.shader.progVar.append(B,De),mr=De.def(rr,".id"),Or=De.def(dr,"[",mr,"]");De(B.shared.gl,".useProgram(",rr,".program);","if(!",Or,"){",Or,"=",dr,"[",mr,"]=",B.link(function($r){return Ra(w,B,Q,$r,2)}),"(",rr,");}",Or,".call(this,a0[",Pe,"],",Pe,");")}}function c(B,k){var Q=B.proc("batch",2);B.batchId="0",Vo(B,Q);var We=!1,tt=!0;Object.keys(k.context).forEach(function(dr){We=We||k.context[dr].propDep}),We||(Fo(B,Q,k.context),tt=!1);var Pe=k.framebuffer,Je=!1;Pe?(Pe.propDep?We=Je=!0:Pe.contextDep&&We&&(Je=!0),Je||gs(B,Q,Pe)):gs(B,Q,null),k.state.viewport&&k.state.viewport.propDep&&(We=!0);function _t(dr){return dr.contextDep&&We||dr.propDep}Uo(B,Q,k),Bo(B,Q,k.state,function(dr){return!_t(dr)}),(!k.profile||!_t(k.profile))&&aa(B,Q,k,!1,"a1"),k.contextDep=We,k.needsContext=tt,k.needsFramebuffer=Je;var ke=k.shader.progVar;if(ke.contextDep&&We||ke.propDep)y(B,Q,k,null);else{var pt=ke.append(B,Q);if(Q(B.shared.gl,".useProgram(",pt,".program);"),k.shader.program)y(B,Q,k,k.shader.program);else{Q(B.shared.vao,".setVAO(null);");var De=B.global.def("{}"),Zt=Q.def(pt,".id"),Kt=Q.def(De,"[",Zt,"]");Q(B.cond(Kt).then(Kt,".call(this,a0,a1);").else(Kt,"=",De,"[",Zt,"]=",B.link(function(dr){return Ra(y,B,k,dr,2)}),"(",pt,");",Kt,".call(this,a0,a1);"))}}Object.keys(k.state).length>0&&Q(B.shared.current,".dirty=true;")}function d(B,k){var Q=B.proc("scope",3);B.batchId="a2";var We=B.shared,tt=We.current;Fo(B,Q,k.context),k.framebuffer&&k.framebuffer.append(B,Q),iu(Object.keys(k.state)).forEach(function(Je){var _t=k.state[Je],ke=_t.append(B,Q);$i(ke)?ke.forEach(function(pt,De){Q.set(B.next[Je],"["+De+"]",pt)}):Q.set(We.next,"."+Je,ke)}),aa(B,Q,k,!0,!0),[uo,Gl,nu,Uc,Ns].forEach(function(Je){var _t=k.draw[Je];if(!_t)return;Q.set(We.draw,"."+Je,""+_t.append(B,Q))}),Object.keys(k.uniforms).forEach(function(Je){var _t=k.uniforms[Je].append(B,Q);Array.isArray(_t)&&(_t="["+_t.join()+"]"),Q.set(We.uniforms,"["+je.id(Je)+"]",_t)}),Object.keys(k.attributes).forEach(function(Je){var _t=k.attributes[Je].append(B,Q),ke=B.scopeAttrib(Je);Object.keys(new Tr).forEach(function(pt){Q.set(ke,"."+pt,_t[pt])})}),k.scopeVAO&&Q.set(We.vao,".targetVAO",k.scopeVAO.append(B,Q));function Pe(Je){var _t=k.shader[Je];_t&&Q.set(We.shader,"."+Je,_t.append(B,Q))}Pe(Ko),Pe(Ao),Object.keys(k.state).length>0&&(Q(tt,".dirty=true;"),Q.exit(tt,".dirty=true;")),Q("a1(",B.shared.context,",a0,",B.batchId,");")}function g(B){if(typeof B!="object"||$i(B))return;for(var k=Object.keys(B),Q=0;Q<k.length;++Q)if(gt.isDynamic(B[k[Q]]))return!0;return!1}function I(B,k,Q){var We=k.static[Q];if(!We||!g(We))return;var tt=B.global,Pe=Object.keys(We),Je=!1,_t=!1,ke=!1,pt=B.global.def("{}");Pe.forEach(function(Zt){var Kt=We[Zt];if(gt.isDynamic(Kt)){typeof Kt=="function"&&(Kt=We[Zt]=gt.unbox(Kt));var dr=wo(Kt,null);Je=Je||dr.thisDep,ke=ke||dr.propDep,_t=_t||dr.contextDep}else{tt(pt,".",Zt,"=");switch(typeof Kt){case"number":tt(Kt);break;case"string":tt('"',Kt,'"');break;case"object":Array.isArray(Kt)&&tt("[",Kt.join(),"]");break;default:tt(B.link(Kt));break}tt(";")}});function De(Zt,Kt){Pe.forEach(function(dr){var rr=We[dr];if(!gt.isDynamic(rr))return;var mr=Zt.invoke(Kt,rr);Kt(pt,".",dr,"=",mr,";")})}k.dynamic[Q]=new gt.DynamicVariable(ua,{thisDep:Je,contextDep:_t,propDep:ke,ref:pt,append:De}),delete k.static[Q]}function ee(B,k,Q,We,tt){var Pe=ma();Pe.stats=Pe.link(tt),Object.keys(k.static).forEach(function(_t){I(Pe,k,_t)}),Sc.forEach(function(_t){I(Pe,B,_t)});var Je=vs(B,k,Q,We,Pe);return rs(Pe,Je),d(Pe,Je),c(Pe,Je),p(Pe.compile(),{destroy:function(){Je.shader.program.destroy()}})}return{next:ta,current:Ir,procs:function(){var B=ma(),k=B.proc("poll"),Q=B.proc("refresh"),We=B.block();k(We),Q(We);var tt=B.shared,Pe=tt.gl,Je=tt.next,_t=tt.current;We(_t,".dirty=false;"),gs(B,k),gs(B,Q,null,!0);var ke;Xr&&(ke=B.link(Xr)),Mt.oes_vertex_array_object&&Q(B.link(Mt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var pt=0;pt<Er.maxAttributes;++pt){var De=Q.def(tt.attributes,"[",pt,"]"),Zt=B.cond(De,".buffer");Zt.then(Pe,".enableVertexAttribArray(",pt,");",Pe,".bindBuffer(",Wu,",",De,".buffer.buffer);",Pe,".vertexAttribPointer(",pt,",",De,".size,",De,".type,",De,".normalized,",De,".stride,",De,".offset);").else(Pe,".disableVertexAttribArray(",pt,");",Pe,".vertexAttrib4f(",pt,",",De,".x,",De,".y,",De,".z,",De,".w);",De,".buffer=null;"),Q(Zt),Xr&&Q(ke,".vertexAttribDivisorANGLE(",pt,",",De,".divisor);")}return Q(B.shared.vao,".currentVAO=null;",B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"),Object.keys(Fr).forEach(function(Kt){var dr=Fr[Kt],rr=We.def(Je,".",Kt),mr=B.block();mr("if(",rr,"){",Pe,".enable(",dr,")}else{",Pe,".disable(",dr,")}",_t,".",Kt,"=",rr,";"),Q(mr),k("if(",rr,"!==",_t,".",Kt,"){",mr,"}")}),Object.keys(Vr).forEach(function(Kt){var dr=Vr[Kt],rr=Ir[Kt],mr,Or,$r=B.block();if($r(Pe,".",dr,"("),$i(rr)){var Bn=rr.length;mr=B.global.def(Je,".",Kt),Or=B.global.def(_t,".",Kt),$r(W(Bn,function(on){return mr+"["+on+"]"}),");",W(Bn,function(on){return Or+"["+on+"]="+mr+"["+on+"];"}).join("")),k("if(",W(Bn,function(on){return mr+"["+on+"]!=="+Or+"["+on+"]"}).join("||"),"){",$r,"}")}else mr=We.def(Je,".",Kt),Or=We.def(_t,".",Kt),$r(mr,");",_t,".",Kt,"=",mr,";"),k("if(",mr,"!==",Or,"){",$r,"}");Q($r)}),B.compile()}(),compile:ee}}function oh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var kf=34918,Lu=34919,jf=35007,lf=function(je,Mt){if(!Mt.ext_disjoint_timer_query)return null;var Er=[];function Lr(){return Er.pop()||Mt.ext_disjoint_timer_query.createQueryEXT()}function wr(On){Er.push(On)}var _r=[];function Wr(On){var Ir=Lr();Mt.ext_disjoint_timer_query.beginQueryEXT(jf,Ir),_r.push(Ir),nn(_r.length-1,_r.length,On)}function un(){Mt.ext_disjoint_timer_query.endQueryEXT(jf)}function Jr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Qr=[];function ln(){return Qr.pop()||new Jr}function Sn(On){Qr.push(On)}var pn=[];function nn(On,Ir,ta){var qr=ln();qr.startQueryIndex=On,qr.endQueryIndex=Ir,qr.sum=0,qr.stats=ta,pn.push(qr)}var Tr=[],xr=[];function Xr(){var On,Ir,ta=_r.length;if(ta===0)return;xr.length=Math.max(xr.length,ta+1),Tr.length=Math.max(Tr.length,ta+1),Tr[0]=0,xr[0]=0;var qr=0;for(On=0,Ir=0;Ir<_r.length;++Ir){var Fr=_r[Ir];Mt.ext_disjoint_timer_query.getQueryObjectEXT(Fr,Lu)?(qr+=Mt.ext_disjoint_timer_query.getQueryObjectEXT(Fr,kf),wr(Fr)):_r[On++]=Fr,Tr[Ir+1]=qr,xr[Ir+1]=On}for(_r.length=On,On=0,Ir=0;Ir<pn.length;++Ir){var Vr=pn[Ir],Kr=Vr.startQueryIndex,Xn=Vr.endQueryIndex;Vr.sum+=Tr[Xn]-Tr[Kr];var na=xr[Kr],cn=xr[Xn];cn===na?(Vr.stats.gpuTime+=Vr.sum/1e6,Sn(Vr)):(Vr.startQueryIndex=na,Vr.endQueryIndex=cn,pn[On++]=Vr)}pn.length=On}return{beginQuery:Wr,endQuery:un,pushScopeStats:nn,update:Xr,getNumPendingQueries:function(){return _r.length},clear:function(){Er.push.apply(Er,_r);for(var Ir=0;Ir<Er.length;Ir++)Mt.ext_disjoint_timer_query.deleteQueryEXT(Er[Ir]);_r.length=0,Er.length=0},restore:function(){_r.length=0,Er.length=0}}},zf=16384,Eh=256,sh=1024,_f=34962,Ff="webglcontextlost",Uf="webglcontextrestored",uh=1,Bf=2,Of=3;function Zl(ye,je){for(var Mt=0;Mt<ye.length;++Mt)if(ye[Mt]===je)return Mt;return-1}function Ih(ye){var je=Cn(ye);if(!je)return null;var Mt=je.gl,Er=Mt.getContextAttributes(),Lr=Mt.isContextLost(),wr=F(Mt,je);if(!wr)return null;var _r=Zr(),Wr=oh(),un=wr.extensions,Jr=lf(Mt,un),Qr=hr(),ln=Mt.drawingBufferWidth,Sn=Mt.drawingBufferHeight,pn={tick:0,time:0,viewportWidth:ln,viewportHeight:Sn,framebufferWidth:ln,framebufferHeight:Sn,drawingBufferWidth:ln,drawingBufferHeight:Sn,pixelRatio:je.pixelRatio},nn={},Tr={elements:null,primitive:4,count:-1,offset:0,instances:-1},xr=ho(Mt,un),Xr=Ya(Mt,Wr,je,Ir),On=rt(Mt,un,xr,Wr,Xr);function Ir(An){return On.destroyBuffer(An)}var ta=Pc(Mt,un,Xr,Wr),qr=jt(Mt,_r,Wr,je),Fr=eu(Mt,un,xr,function(){Xn.procs.poll()},pn,Wr,je),Vr=ws(Mt,un,xr,Wr,je),Kr=j(Mt,un,xr,Fr,Vr,Wr),Xn=Nf(Mt,_r,un,xr,Xr,ta,Fr,Kr,nn,On,qr,Tr,pn,Jr,je),na=gr(Mt,Kr,Xn.procs.poll,pn,Er,un,xr),cn=Xn.next,Hr=Mt.canvas,jr=[],ma=[],pa=[],Un=[je.onDestroy],Ua=null;function _a(){if(jr.length===0){Jr&&Jr.update(),Ua=null;return}Ua=Ht.next(_a),Bo();for(var An=jr.length-1;An>=0;--An){var Ra=jr[An];Ra&&Ra(pn,null,0)}Mt.flush(),Jr&&Jr.update()}function Ba(){!Ua&&jr.length>0&&(Ua=Ht.next(_a))}function hi(){Ua&&(Ht.cancel(_a),Ua=null)}function zo(An){An.preventDefault(),Lr=!0,hi(),ma.forEach(function(Ra){Ra()})}function Os(An){Mt.getError(),Lr=!1,wr.restore(),qr.restore(),Xr.restore(),Fr.restore(),Vr.restore(),Kr.restore(),On.restore(),Jr&&Jr.restore(),Xn.procs.refresh(),Ba(),pa.forEach(function(Ra){Ra()})}Hr&&(Hr.addEventListener(Ff,zo,!1),Hr.addEventListener(Uf,Os,!1));function ei(){jr.length=0,hi(),Hr&&(Hr.removeEventListener(Ff,zo),Hr.removeEventListener(Uf,Os)),qr.clear(),Kr.clear(),Vr.clear(),Fr.clear(),ta.clear(),Xr.clear(),On.clear(),Jr&&Jr.clear(),Un.forEach(function(An){An()})}function bo(An){$(!!An,"invalid args to regl({...})"),$.type(An,"object","invalid args to regl({...})");function Ra(tt){var Pe=p({},tt);delete Pe.uniforms,delete Pe.attributes,delete Pe.context,delete Pe.vao,"stencil"in Pe&&Pe.stencil.op&&(Pe.stencil.opBack=Pe.stencil.opFront=Pe.stencil.op,delete Pe.stencil.op);function Je(_t){if(_t in Pe){var ke=Pe[_t];delete Pe[_t],Object.keys(ke).forEach(function(pt){Pe[_t+"."+pt]=ke[pt]})}}return Je("blend"),Je("depth"),Je("cull"),Je("stencil"),Je("polygonOffset"),Je("scissor"),Je("sample"),"vao"in tt&&(Pe.vao=tt.vao),Pe}function Va(tt,Pe){var Je={},_t={};return Object.keys(tt).forEach(function(ke){var pt=tt[ke];if(gt.isDynamic(pt)){_t[ke]=gt.unbox(pt,ke);return}else if(Pe&&Array.isArray(pt)){for(var De=0;De<pt.length;++De)if(gt.isDynamic(pt[De])){_t[ke]=gt.unbox(pt,ke);return}}Je[ke]=pt}),{dynamic:_t,static:Je}}var rs=Va(An.context||{},!0),w=Va(An.uniforms||{},!0),y=Va(An.attributes||{},!1),c=Va(Ra(An),!1),d={gpuTime:0,cpuTime:0,count:0},g=Xn.compile(c,y,w,rs,d),I=g.draw,ee=g.batch,B=g.scope,k=[];function Q(tt){for(;k.length<tt;)k.push(null);return k}function We(tt,Pe){var Je;if(Lr&&$.raise("context lost"),typeof tt=="function")return B.call(this,null,tt,0);if(typeof Pe=="function")if(typeof tt=="number")for(Je=0;Je<tt;++Je)B.call(this,null,Pe,Je);else if(Array.isArray(tt))for(Je=0;Je<tt.length;++Je)B.call(this,tt[Je],Pe,Je);else return B.call(this,tt,Pe,0);else if(typeof tt=="number"){if(tt>0)return ee.call(this,Q(tt|0),tt|0)}else if(Array.isArray(tt)){if(tt.length)return ee.call(this,tt,tt.length)}else return I.call(this,tt)}return p(We,{stats:d,destroy:function(){g.destroy()}})}var Ci=Kr.setFBO=bo({framebuffer:gt.define.call(null,uh,"framebuffer")});function vs(An,Ra){var Va=0;Xn.procs.poll();var rs=Ra.color;rs&&(Mt.clearColor(+rs[0]||0,+rs[1]||0,+rs[2]||0,+rs[3]||0),Va|=zf),"depth"in Ra&&(Mt.clearDepth(+Ra.depth),Va|=Eh),"stencil"in Ra&&(Mt.clearStencil(Ra.stencil|0),Va|=sh),$(!!Va,"called regl.clear with no buffer specified"),Mt.clear(Va)}function Fo(An){if($(typeof An=="object"&&An,"regl.clear() takes an object as input"),"framebuffer"in An)if(An.framebuffer&&An.framebuffer_reglType==="framebufferCube")for(var Ra=0;Ra<6;++Ra)Ci(p({framebuffer:An.framebuffer.faces[Ra]},An),vs);else Ci(An,vs);else vs(null,An)}function gs(An){$.type(An,"function","regl.frame() callback must be a function"),jr.push(An);function Ra(){var Va=Zl(jr,An);$(Va>=0,"cannot cancel a frame twice");function rs(){var w=Zl(jr,rs);jr[w]=jr[jr.length-1],jr.length-=1,jr.length<=0&&hi()}jr[Va]=rs}return Ba(),{cancel:Ra}}function Uo(){var An=cn.viewport,Ra=cn.scissor_box;An[0]=An[1]=Ra[0]=Ra[1]=0,pn.viewportWidth=pn.framebufferWidth=pn.drawingBufferWidth=An[2]=Ra[2]=Mt.drawingBufferWidth,pn.viewportHeight=pn.framebufferHeight=pn.drawingBufferHeight=An[3]=Ra[3]=Mt.drawingBufferHeight}function Bo(){pn.tick+=1,pn.time=aa(),Uo(),Xn.procs.poll()}function Vo(){Fr.refresh(),Uo(),Xn.procs.refresh(),Jr&&Jr.update()}function aa(){return(hr()-Qr)/1e3}Vo();function ou(An,Ra){$.type(Ra,"function","listener callback must be a function");var Va;switch(An){case"frame":return gs(Ra);case"lost":Va=ma;break;case"restore":Va=pa;break;case"destroy":Va=Un;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return Va.push(Ra),{cancel:function(){for(var w=0;w<Va.length;++w)if(Va[w]===Ra){Va[w]=Va[Va.length-1],Va.pop();return}}}}var yi=p(bo,{clear:Fo,prop:gt.define.bind(null,uh),context:gt.define.bind(null,Bf),this:gt.define.bind(null,Of),draw:bo({}),buffer:function(Ra){return Xr.create(Ra,_f,!1,!1)},elements:function(Ra){return ta.create(Ra,!1)},texture:Fr.create2D,cube:Fr.createCube,renderbuffer:Vr.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:On.createVAO,attributes:Er,frame:gs,on:ou,limits:xr,hasExtension:function(Ra){return xr.extensions.indexOf(Ra.toLowerCase())>=0},read:na,destroy:ei,_gl:Mt,_refresh:Vo,poll:function(){Bo(),Jr&&Jr.update()},now:aa,stats:Wr});return je.onDone(null,yi),yi}return Ih})},T9As:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});function x(p,Y){var z=Y.callback;return z&&(p.dataArray=p.dataArray.map(z)),p}},TIBF:function(Fe,_){function o(x,p,Y){for(var z=-1,i=x==null?0:x.length;++z<i;)if(Y(p,x[z]))return!0;return!1}Fe.exports=o},TaHB:function(Fe,_,o){"use strict";o.d(_,"b",function(){return x}),o.d(_,"a",function(){return p}),o.d(_,"c",function(){return Y});var x=1e-6,p=typeof Float32Array!="undefined"?Float32Array:Array,Y=Math.random;function z(K){p=K}var i=Math.PI/180;function Z(K){return K*i}function D(K,re){return Math.abs(K-re)<=x*Math.max(1,Math.abs(K),Math.abs(re))}Math.hypot||(Math.hypot=function(){for(var K=0,re=arguments.length;re--;)K+=arguments[re]*arguments[re];return Math.sqrt(K)})},Tj1F:function(Fe,_,o){"use strict";(function(x){o.d(_,"a",function(){return be}),o.d(_,"b",function(){return qt}),o.d(_,"c",function(){return oe}),o.d(_,"d",function(){return it});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function p(Pt,ve,ge,Ve){function st(Oe){return Oe instanceof ge?Oe:new ge(function(vt){vt(Oe)})}return new(ge||(ge=Promise))(function(Oe,vt){function C(ce){try{q(Ve.next(ce))}catch(Ge){vt(Ge)}}function R(ce){try{q(Ve.throw(ce))}catch(Ge){vt(Ge)}}function q(ce){ce.done?Oe(ce.value):st(ce.value).then(C,R)}q((Ve=Ve.apply(Pt,ve||[])).next())})}function Y(Pt,ve){var ge={label:0,sent:function(){if(Oe[0]&1)throw Oe[1];return Oe[1]},trys:[],ops:[]},Ve,st,Oe,vt;return vt={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(vt[Symbol.iterator]=function(){return this}),vt;function C(q){return function(ce){return R([q,ce])}}function R(q){if(Ve)throw new TypeError("Generator is already executing.");for(;ge;)try{if(Ve=1,st&&(Oe=q[0]&2?st.return:q[0]?st.throw||((Oe=st.return)&&Oe.call(st),0):st.next)&&!(Oe=Oe.call(st,q[1])).done)return Oe;(st=0,Oe)&&(q=[q[0]&2,Oe.value]);switch(q[0]){case 0:case 1:Oe=q;break;case 4:return ge.label++,{value:q[1],done:!1};case 5:ge.label++,st=q[1],q=[0];continue;case 7:q=ge.ops.pop(),ge.trys.pop();continue;default:if(!(Oe=ge.trys,Oe=Oe.length>0&&Oe[Oe.length-1])&&(q[0]===6||q[0]===2)){ge=0;continue}if(q[0]===3&&(!Oe||q[1]>Oe[0]&&q[1]<Oe[3])){ge.label=q[1];break}if(q[0]===6&&ge.label<Oe[1]){ge.label=Oe[1],Oe=q;break}if(Oe&&ge.label<Oe[2]){ge.label=Oe[2],ge.ops.push(q);break}Oe[2]&&ge.ops.pop(),ge.trys.pop();continue}q=ve.call(Pt,ge)}catch(ce){q=[6,ce],st=0}finally{Ve=Oe=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function z(Pt,ve){var ge=typeof Symbol=="function"&&Pt[Symbol.iterator];if(!ge)return Pt;var Ve=ge.call(Pt),st,Oe=[],vt;try{for(;(ve===void 0||ve-- >0)&&!(st=Ve.next()).done;)Oe.push(st.value)}catch(C){vt={error:C}}finally{try{st&&!st.done&&(ge=Ve.return)&&ge.call(Ve)}finally{if(vt)throw vt.error}}return Oe}function i(){for(var Pt=[],ve=0;ve<arguments.length;ve++)Pt=Pt.concat(z(arguments[ve]));return Pt}function Z(Pt){return Pt&&Pt.__esModule&&Object.prototype.hasOwnProperty.call(Pt,"default")?Pt.default:Pt}function D(Pt,ve){return ve={exports:{}},Pt(ve,ve.exports),ve.exports}var K=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(Ve){return Ve&&typeof Ve.length=="number"&&Ve.length>=0&&Ve.length%1===0}Pt.exports=ve.default});Z(K);var re=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return function(){for(var Ve=[],st=arguments.length;st--;)Ve[st]=arguments[st];var Oe=Ve.pop();return ge.call(this,Ve,Oe)}},Pt.exports=ve.default});Z(re);var fe=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.fallback=st,ve.wrap=Oe;var ge=ve.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ve=ve.hasNextTick=typeof x=="object"&&typeof x.nextTick=="function";function st(C){setTimeout(C,0)}function Oe(C){return function(R){for(var q=[],ce=arguments.length-1;ce-- >0;)q[ce]=arguments[ce+1];return C(function(){return R.apply(void 0,q)})}}var vt;ge?vt=setImmediate:Ve?vt=x.nextTick:vt=st,ve.default=Oe(vt)});Z(fe);var X=fe.fallback,He=fe.wrap,Xe=fe.hasSetImmediate,pe=fe.hasNextTick,Ce=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(re),Ve=st(fe);function st(R){return R&&R.__esModule?R:{default:R}}function Oe(R){return(0,mt.isAsync)(R)?function(){for(var q=[],ce=arguments.length;ce--;)q[ce]=arguments[ce];var Ge=q.pop(),qe=R.apply(this,q);return vt(qe,Ge)}:(0,ge.default)(function(q,ce){var Ge;try{Ge=R.apply(this,q)}catch(qe){return ce(qe)}if(Ge&&typeof Ge.then=="function")return vt(Ge,ce);ce(null,Ge)})}function vt(R,q){return R.then(function(ce){C(q,null,ce)},function(ce){C(q,ce&&ce.message?ce:new Error(ce))})}function C(R,q,ce){try{R(q,ce)}catch(Ge){(0,Ve.default)(function(qe){throw qe},Ge)}}Pt.exports=ve.default});Z(Ce);var mt=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.isAsyncIterable=ve.isAsyncGenerator=ve.isAsync=void 0;var ge=Ve(Ce);function Ve(R){return R&&R.__esModule?R:{default:R}}function st(R){return R[Symbol.toStringTag]==="AsyncFunction"}function Oe(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function vt(R){return typeof R[Symbol.asyncIterator]=="function"}function C(R){if(typeof R!="function")throw new Error("expected a function");return st(R)?(0,ge.default)(R):R}ve.default=C,ve.isAsync=st,ve.isAsyncGenerator=Oe,ve.isAsyncIterable=vt});Z(mt);var Ne=mt.isAsyncIterable,At=mt.isAsyncGenerator,Ye=mt.isAsync,Et=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(Ve,st){if(st===void 0&&(st=Ve.length),!st)throw new Error("arity is undefined");function Oe(){for(var vt=this,C=[],R=arguments.length;R--;)C[R]=arguments[R];return typeof C[st-1]=="function"?Ve.apply(this,C):new Promise(function(q,ce){C[st-1]=function(Ge){for(var qe=[],Tt=arguments.length-1;Tt-- >0;)qe[Tt]=arguments[Tt+1];if(Ge)return ce(Ge);q(qe.length>1?qe:qe[0])},Ve.apply(vt,C)})}return Object.defineProperty(Oe,"name",{configurable:!0,value:"awaitable("+Ve.name+")"}),Oe}Pt.exports=ve.default});Z(Et);var nt=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=Oe(K),Ve=Oe(mt),st=Oe(Et);function Oe(vt){return vt&&vt.__esModule?vt:{default:vt}}ve.default=(0,st.default)(function(vt,C,R){var q=(0,ge.default)(C)?[]:{};vt(C,function(ce,Ge,qe){(0,Ve.default)(ce)(function(Tt){for(var ot,Ut=[],$=arguments.length-1;$-- >0;)Ut[$]=arguments[$+1];Ut.length<2&&(ot=Ut,Ut=ot[0]),q[Ge]=Ut,qe(Tt)})},function(ce){return R(ce,q)})},3),Pt.exports=ve.default});Z(nt);var Ct=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(Ve){function st(){for(var Oe=[],vt=arguments.length;vt--;)Oe[vt]=arguments[vt];if(Ve===null)return;var C=Ve;Ve=null,C.apply(this,Oe)}return Object.assign(st,Ve),st}Pt.exports=ve.default});Z(Ct);var Ot=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(ge){return ge[Symbol.iterator]&&ge[Symbol.iterator]()},Pt.exports=ve.default});Z(Ot);var Re=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=R;var ge=st(K),Ve=st(Ot);function st(q){return q&&q.__esModule?q:{default:q}}function Oe(q){var ce=-1,Ge=q.length;return function(){return++ce<Ge?{value:q[ce],key:ce}:null}}function vt(q){var ce=-1;return function(){var qe=q.next();return qe.done?null:(ce++,{value:qe.value,key:ce})}}function C(q){var ce=q?Object.keys(q):[],Ge=-1,qe=ce.length;return function(){var ot=ce[++Ge];return Ge<qe?{value:q[ot],key:ot}:null}}function R(q){if((0,ge.default)(q))return Oe(q);var ce=(0,Ve.default)(q);return ce?vt(ce):C(q)}Pt.exports=ve.default});Z(Re);var Ie=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=ge;function ge(Ve){return function(){for(var st=[],Oe=arguments.length;Oe--;)st[Oe]=arguments[Oe];if(Ve===null)throw new Error("Callback was already called.");var vt=Ve;Ve=null,vt.apply(this,st)}}Pt.exports=ve.default});Z(Ie);var Be=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge={};ve.default=ge,Pt.exports=ve.default});Z(Be);var ft=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=st;var ge=Ve(Be);function Ve(Oe){return Oe&&Oe.__esModule?Oe:{default:Oe}}function st(Oe,vt,C,R){var q=!1,ce=!1,Ge=!1,qe=0,Tt=0;function ot(){if(qe>=vt||Ge||q)return;Ge=!0,Oe.next().then(function(Qe){var ae=Qe.value,et=Qe.done;if(ce||q)return;if(Ge=!1,et){q=!0,qe<=0&&R(null);return}qe++,C(ae,Tt,Ut),Tt++,ot()}).catch($)}function Ut(Qe,ae){if(qe-=1,ce)return;if(Qe)return $(Qe);if(Qe===!1){q=!0,ce=!0;return}if(ae===ge.default||q&&qe<=0)return q=!0,R(null);ot()}function $(Qe){if(ce)return;Ge=!1,q=!0,R(Qe)}ot()}Pt.exports=ve.default});Z(ft);var Me=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=C(Ct),Ve=C(Re),st=C(Ie),Oe=C(ft),vt=C(Be);function C(R){return R&&R.__esModule?R:{default:R}}ve.default=function(R){return function(q,ce,Ge){if(Ge=(0,ge.default)(Ge),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return Ge(null);if((0,mt.isAsyncGenerator)(q))return(0,Oe.default)(q,R,ce,Ge);if((0,mt.isAsyncIterable)(q))return(0,Oe.default)(q[Symbol.asyncIterator](),R,ce,Ge);var qe=(0,Ve.default)(q),Tt=!1,ot=!1,Ut=0,$=!1;function Qe(et,kt){if(ot)return;if(Ut-=1,et)Tt=!0,Ge(et);else if(et===!1)Tt=!0,ot=!0;else{if(kt===vt.default||Tt&&Ut<=0)return Tt=!0,Ge(null);$||ae()}}function ae(){for($=!0;Ut<R&&!Tt;){var et=qe();if(et===null){Tt=!0,Ut<=0&&Ge(null);return}Ut+=1,ce(et.value,et.key,(0,st.default)(Qe))}$=!1}ae()}},Pt.exports=ve.default});Z(Me);var ht=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=Oe(Me),Ve=Oe(mt),st=Oe(Et);function Oe(C){return C&&C.__esModule?C:{default:C}}function vt(C,R,q,ce){return(0,ge.default)(R)(C,(0,Ve.default)(q),ce)}ve.default=(0,st.default)(vt,4),Pt.exports=ve.default});Z(ht);var Wt=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=st(ht),Ve=st(Et);function st(vt){return vt&&vt.__esModule?vt:{default:vt}}function Oe(vt,C,R){return(0,ge.default)(vt,1,C,R)}ve.default=(0,Ve.default)(Oe,3),Pt.exports=ve.default});Z(Wt);var Qt=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(nt),Ve=st(Wt);function st(vt){return vt&&vt.__esModule?vt:{default:vt}}function Oe(vt,C){return(0,ge.default)(Ve.default,vt,C)}Pt.exports=ve.default}),ur=Z(Qt),oe=function(){function Pt(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];this.args=[],this.tasks=[]}return Pt.prototype.call=function(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];return this.args=ge,ur(this.tasks)},Pt.prototype.tap=function(ve,ge){var Ve=this;this.tasks.push(function(st){ge.apply(void 0,i(Ve.args)),st(null,ve)})},Pt}(),J=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=q(K),Ve=q(Be),st=q(ht),Oe=q(Ct),vt=q(Ie),C=q(mt),R=q(Et);function q(Tt){return Tt&&Tt.__esModule?Tt:{default:Tt}}function ce(Tt,ot,Ut){Ut=(0,Oe.default)(Ut);var $=0,Qe=0,ae=Tt.length,et=!1;ae===0&&Ut(null);function kt(pr,Ke){if(pr===!1&&(et=!0),et===!0)return;pr?Ut(pr):(++Qe===ae||Ke===Ve.default)&&Ut(null)}for(;$<ae;$++)ot(Tt[$],$,(0,vt.default)(kt))}function Ge(Tt,ot,Ut){return(0,st.default)(Tt,Infinity,ot,Ut)}function qe(Tt,ot,Ut){var $=(0,ge.default)(Tt)?ce:Ge;return $(Tt,(0,C.default)(ot),Ut)}ve.default=(0,R.default)(qe,3),Pt.exports=ve.default});Z(J);var H=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=Oe;var ge=st(J),Ve=st(nt);function st(vt){return vt&&vt.__esModule?vt:{default:vt}}function Oe(vt,C){return(0,Ve.default)(ge.default,vt,C)}Pt.exports=ve.default}),Se=Z(H),be=function(){function Pt(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];this.tasks=[]}return Pt.prototype.promise=function(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];return Se(this.tasks)},Pt.prototype.tapPromise=function(ve,ge){var Ve=this;this.tasks.push(function(st){return p(Ve,void 0,void 0,function(){return Y(this,function(Oe){switch(Oe.label){case 0:return[4,ge()];case 1:return Oe.sent(),st(null,ve),[2]}})})})},Pt}(),_e=D(function(Pt,ve){Object.defineProperty(ve,"__esModule",{value:!0});var ge=vt(Ct),Ve=vt(Ie),st=vt(mt),Oe=vt(Et);function vt(R){return R&&R.__esModule?R:{default:R}}function C(R,q){if(q=(0,ge.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var ce=0;function Ge(Tt){var ot=(0,st.default)(R[ce++]);ot.apply(void 0,Tt.concat([(0,Ve.default)(qe)]))}function qe(Tt){for(var ot=[],Ut=arguments.length-1;Ut-- >0;)ot[Ut]=arguments[Ut+1];if(Tt===!1)return;if(Tt||ce===R.length)return q.apply(void 0,[Tt].concat(ot));Ge(ot)}Ge([])}ve.default=(0,Oe.default)(C),Pt.exports=ve.default}),me=Z(_e),it=function(){function Pt(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];this.tasks=[]}return Pt.prototype.call=function(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];return me(this.tasks)},Pt.prototype.tap=function(ve,ge){this.tasks.length===0?this.tasks.push(function(Ve){var st=ge();Ve(st?null:!1,st)}):this.tasks.push(function(Ve,st){var Oe=ge();st(Oe?null:!1,ve)})},Pt}(),qt=function(){function Pt(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];this.tasks=[]}return Pt.prototype.call=function(){for(var ve=arguments,ge=[],Ve=0;Ve<arguments.length;Ve++)ge[Ve]=ve[Ve];return ur(this.tasks)},Pt.prototype.tap=function(ve,ge){this.tasks.push(function(Ve){var st=ge();Ve(st,ve)})},Pt}()}).call(this,o("7vYp"))},UHDP:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("BbNA");function p(Y,z){z===void 0&&(z=!0);var i=x.makePropertyInjectDecorator(Y,z),Z=x.makePropertyInjectNamedDecorator(Y,z),D=x.makePropertyInjectTaggedDecorator(Y,z),K=x.makePropertyMultiInjectDecorator(Y,z);return{lazyInject:i,lazyInjectNamed:Z,lazyInjectTagged:D,lazyMultiInject:K}}_.default=p},USOk:function(Fe,_,o){var x=o("hbMb"),p=function(){try{var Y=x(Object,"defineProperty");return Y({},"",{}),Y}catch(z){}}();Fe.exports=p},Udc0:function(Fe,_,o){var x=o("5NJe"),p=x("length");Fe.exports=p},UqwA:function(Fe,_,o){"use strict";var x=o("fvT1"),p=o("g2Np"),Y=o("PEaR"),z=o("DAVx"),i=o("ueXz"),Z=o("Pvkj"),D=o("ubZI"),K=o("ihlD"),re=o("ujT9"),fe=o("6AiZ"),X=o("t+Cx"),He=o("jkwx"),Xe=o("T9As");o.d(_,"getTransform",function(){return x.b}),o.d(_,"getParser",function(){return x.a});var pe=o("xG66"),Ce=o.n(pe);_.default=D.a,Object(x.c)("geojson",Y.a),Object(x.c)("image",z.a),Object(x.c)("csv",p.a),Object(x.c)("json",i.a),Object(x.c)("raster",Z.a),Object(x.d)("cluster",K.a),Object(x.d)("filter",re.a),Object(x.d)("join",He.a),Object(x.d)("map",Xe.a),Object(x.d)("grid",fe.a),Object(x.d)("hexagon",X.a)},VQDY:function(Fe,_){function o(x,p){var Y=-1,z=x.length;for(p||(p=Array(z));++Y<z;)p[Y]=x[Y];return p}Fe.exports=o},VTKP:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=function D(K,re){var fe=K.parentRequest;return fe!==null?re(fe)?!0:D(fe,re):!1};_.traverseAncerstors=Y;var z=function(K){return function(re){var fe=function(He){return He!==null&&He.target!==null&&He.target.matchesTag(K)(re)};return fe.metaData=new p.Metadata(K,re),fe}};_.taggedConstraint=z;var i=z(x.NAMED_TAG);_.namedConstraint=i;var Z=function(K){return function(re){var fe=null;if(re!==null)if(fe=re.bindings[0],typeof K=="string"){var X=fe.serviceIdentifier;return X===K}else{var He=re.bindings[0].implementationType;return K===He}return!1}};_.typeConstraint=Z},Vfe6:function(Fe,_,o){var x=o("YHGW");Fe.exports.geometry=p,Fe.exports.ring=z;function p(Z){var D=0,K;switch(Z.type){case"Polygon":return Y(Z.coordinates);case"MultiPolygon":for(K=0;K<Z.coordinates.length;K++)D+=Y(Z.coordinates[K]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(K=0;K<Z.geometries.length;K++)D+=p(Z.geometries[K]);return D}}function Y(Z){var D=0;if(Z&&Z.length>0){D+=Math.abs(z(Z[0]));for(var K=1;K<Z.length;K++)D-=Math.abs(z(Z[K]))}return D}function z(Z){var D,K,re,fe,X,He,Xe,pe=0,Ce=Z.length;if(Ce>2){for(Xe=0;Xe<Ce;Xe++)Xe===Ce-2?(fe=Ce-2,X=Ce-1,He=0):Xe===Ce-1?(fe=Ce-1,X=0,He=1):(fe=Xe,X=Xe+1,He=Xe+2),D=Z[fe],K=Z[X],re=Z[He],pe+=(i(re[0])-i(D[0]))*Math.sin(i(K[1]));pe=pe*x.RADIUS*x.RADIUS/2}return pe}function i(Z){return Z*Math.PI/180}},VhfK:function(Fe,_){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function x(p){return p.match(o)||[]}Fe.exports=x},"Vkc/":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("/jsB");function Y(re,fe,X,He){var Xe=p.TAGGED;i(Xe,re,fe,He,X)}_.tagParameter=Y;function z(re,fe,X){var He=p.TAGGED_PROP;i(He,re.constructor,fe,X)}_.tagProperty=z;function i(re,fe,X,He,Xe){var pe={},Ce=typeof Xe=="number",mt=Xe!==void 0&&Ce?Xe.toString():X;if(Ce&&X!==void 0)throw new Error(x.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(re,fe)&&(pe=Reflect.getMetadata(re,fe));var Ne=pe[mt];if(!Array.isArray(Ne))Ne=[];else for(var At=0,Ye=Ne;At<Ye.length;At++){var Et=Ye[At];if(Et.key===He.key)throw new Error(x.DUPLICATED_METADATA+" "+Et.key.toString())}Ne.push(He),pe[mt]=Ne,Reflect.defineMetadata(re,pe,fe)}function Z(re,fe){Reflect.decorate(re,fe)}function D(re,fe){return function(X,He){fe(X,He,re)}}function K(re,fe,X){typeof X=="number"?Z([D(X,re)],fe):typeof X=="string"?Reflect.decorate([re],fe,X):Z([re],fe)}_.decorate=K},Vrkw:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=function(){function Y(z,i){this.key=z,this.value=i}return Y.prototype.toString=function(){return this.key===x.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Y}();_.Metadata=p},VyIr:function(Fe,_){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+p+Y,i="\\u2700-\\u27bf",Z="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",K="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",re="\\u2000-\\u206f",fe=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",X="A-Z\\xc0-\\xd6\\xd8-\\xde",He="\\ufe0e\\ufe0f",Xe=D+K+re+fe,pe="['\u2019]",Ce="["+Xe+"]",mt="["+z+"]",Ne="\\d+",At="["+i+"]",Ye="["+Z+"]",Et="[^"+o+Xe+Ne+i+Z+X+"]",nt="\\ud83c[\\udffb-\\udfff]",Ct="(?:"+mt+"|"+nt+")",Ot="[^"+o+"]",Re="(?:\\ud83c[\\udde6-\\uddff]){2}",Ie="[\\ud800-\\udbff][\\udc00-\\udfff]",Be="["+X+"]",ft="\\u200d",Me="(?:"+Ye+"|"+Et+")",ht="(?:"+Be+"|"+Et+")",Wt="(?:"+pe+"(?:d|ll|m|re|s|t|ve))?",Qt="(?:"+pe+"(?:D|LL|M|RE|S|T|VE))?",ur=Ct+"?",oe="["+He+"]?",J="(?:"+ft+"(?:"+[Ot,Re,Ie].join("|")+")"+oe+ur+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Se="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",be=oe+ur+J,_e="(?:"+[At,Re,Ie].join("|")+")"+be,me=RegExp([Be+"?"+Ye+"+"+Wt+"(?="+[Ce,Be,"$"].join("|")+")",ht+"+"+Qt+"(?="+[Ce,Be+Me,"$"].join("|")+")",Be+"?"+Me+"+"+Wt,Be+"+"+Qt,Se,H,Ne,_e].join("|"),"g");function it(qt){return qt.match(me)||[]}Fe.exports=it},W4l2:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x=["mapload"]},Weph:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("Vrkw"),p=o("Vkc/");function Y(z,i){return function(Z,D,K){var re=new x.Metadata(z,i);typeof K=="number"?p.tagParameter(Z,D,K,re):p.tagProperty(Z,D,re)}}_.tagged=Y},Wz0W:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("QbGg"),Y=o("Vrkw"),z=o("NkMf"),i=function(){function Z(D,K,re,fe){this.id=p.id(),this.type=D,this.serviceIdentifier=re,this.name=new z.QueryableString(K||""),this.metadata=new Array;var X=null;typeof fe=="string"?X=new Y.Metadata(x.NAMED_TAG,fe):fe instanceof Y.Metadata&&(X=fe),X!==null&&this.metadata.push(X)}return Z.prototype.hasTag=function(D){for(var K=0,re=this.metadata;K<re.length;K++){var fe=re[K];if(fe.key===D)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(x.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(D){return this.matchesTag(x.MULTI_INJECT_TAG)(D)},Z.prototype.isNamed=function(){return this.hasTag(x.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==x.INJECT_TAG&&D.key!==x.MULTI_INJECT_TAG&&D.key!==x.NAME_TAG&&D.key!==x.UNMANAGED_TAG&&D.key!==x.NAMED_TAG})},Z.prototype.isOptional=function(){return this.matchesTag(x.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===x.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==x.INJECT_TAG&&D.key!==x.MULTI_INJECT_TAG&&D.key!==x.NAME_TAG&&D.key!==x.UNMANAGED_TAG&&D.key!==x.NAMED_TAG}):null},Z.prototype.matchesNamedTag=function(D){return this.matchesTag(x.NAMED_TAG)(D)},Z.prototype.matchesTag=function(D){var K=this;return function(re){for(var fe=0,X=K.metadata;fe<X.length;fe++){var He=X[fe];if(He.key===D&&He.value===re)return!0}return!1}},Z}();_.Target=i},XIPF:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("7s3S"),Y=o("5d8b"),z=o("hSzU"),i=function(){function Z(D){this._binding=D}return Z.prototype.to=function(D){return this._binding.type=p.BindingTypeEnum.Instance,this._binding.implementationType=D,new Y.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+x.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},Z.prototype.toConstantValue=function(D){return this._binding.type=p.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(D){return this._binding.type=p.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new Y.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(D){return this._binding.type=p.BindingTypeEnum.Constructor,this._binding.implementationType=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(D){return this._binding.type=p.BindingTypeEnum.Factory,this._binding.factory=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(x.INVALID_FUNCTION_BINDING);var K=this.toConstantValue(D);return this._binding.type=p.BindingTypeEnum.Function,K},Z.prototype.toAutoFactory=function(D){return this._binding.type=p.BindingTypeEnum.Factory,this._binding.factory=function(K){var re=function(){return K.container.get(D)};return re},new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(D){return this._binding.type=p.BindingTypeEnum.Provider,this._binding.provider=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(D){this.toDynamicValue(function(K){return K.container.get(D)})},Z}();_.BindingToSyntax=i},XQ5J:function(Fe,_,o){var x=o("ORxg"),p=o("0326"),Y=o("6Q7i"),z=o("xrLW");function i(Z,D,K){Z=z(Z),D=Y(D);var re=D?p(Z):0;return D&&re<D?x(D-re,K)+Z:Z}Fe.exports=i},Y2WT:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},YEB8:function(Fe,_,o){var x=o("n1AK"),p=o("qDY+"),Y=p(x);Fe.exports=Y},YHGW:function(Fe,_){Fe.exports.RADIUS=6378137,Fe.exports.FLATTENING=1/298.257223563,Fe.exports.POLAR_RADIUS=63567523142e-4},"Ycz+":function(Fe,_,o){var x=o("BeS3");function p(Y,z,i){var Z=Y.length;return i=i===void 0?Z:i,!z&&i>=Z?Y:x(Y,z,i)}Fe.exports=p},YfZD:function(Fe,_){function o(x){return function(){return x}}Fe.exports=o},Yfmi:function(Fe,_,o){"use strict";var x=o("L84c"),p=o.n(x),Y=o("9DO+"),z=o.n(Y),i=o("xwgP"),Z=o("iczh"),D=o.n(Z),K=o("3JSl"),re=o("M/AK"),fe=o("E6G/"),X=o.n(fe),He=function(me){var it=me.value,qt=me.formatter,Pt=me.precision,ve=me.decimalSeparator,ge=me.groupSeparator,Ve=ge===void 0?"":ge,st=me.prefixCls,Oe;if(typeof qt=="function")Oe=qt(it);else{var vt=String(it),C=vt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!C||vt==="-")Oe=vt;else{var R=C[1],q=C[2]||"0",ce=C[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,Ve),typeof Pt=="number"&&(ce=X()(ce,Pt,"0").slice(0,Pt)),ce&&(ce="".concat(ve).concat(ce)),Oe=[i.createElement("span",{key:"int",className:"".concat(st,"-content-value-int")},R,q),ce&&i.createElement("span",{key:"decimal",className:"".concat(st,"-content-value-decimal")},ce)]}}return i.createElement("span",{className:"".concat(st,"-content-value")},Oe)},Xe=He,pe=function(me){var it=me.prefixCls,qt=me.className,Pt=me.style,ve=me.valueStyle,ge=me.value,Ve=ge===void 0?0:ge,st=me.title,Oe=me.valueRender,vt=me.prefix,C=me.suffix,R=me.loading,q=me.direction,ce=me.onMouseEnter,Ge=me.onMouseLeave,qe=i.createElement(Xe,z()({},me,{value:Ve})),Tt=D()(it,p()({},"".concat(it,"-rtl"),q==="rtl"),qt);return i.createElement("div",{className:Tt,style:Pt,onMouseEnter:ce,onMouseLeave:Ge},st&&i.createElement("div",{className:"".concat(it,"-title")},st),i.createElement(re.a,{paragraph:!1,loading:R},i.createElement("div",{style:ve,className:"".concat(it,"-content")},vt&&i.createElement("span",{className:"".concat(it,"-content-prefix")},vt),Oe?Oe(qe):qe,C&&i.createElement("span",{className:"".concat(it,"-content-suffix")},C))))};pe.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Ce=Object(K.c)({prefixCls:"statistic"})(pe),mt=Ce,Ne=o("b83N"),At=o.n(Ne),Ye=o("xjNF"),Et=o.n(Ye),nt=o("vMUQ"),Ct=o.n(nt),Ot=o("Wbqm"),Re=o.n(Ot),Ie=o("++Hr"),Be=o.n(Ie),ft=o("XQ5J"),Me=o.n(ft),ht=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Wt(_e,me){var it=_e,qt=/\[[^\]]*]/g,Pt=(me.match(qt)||[]).map(function(st){return st.slice(1,-1)}),ve=me.replace(qt,"[]"),ge=ht.reduce(function(st,Oe){var vt=Be()(Oe,2),C=vt[0],R=vt[1];if(st.indexOf(C)!==-1){var q=Math.floor(it/R);return it-=q*R,st.replace(new RegExp("".concat(C,"+"),"g"),function(ce){var Ge=ce.length;return Me()(q.toString(),Ge,"0")})}return st},ve),Ve=0;return ge.replace(qt,function(){var st=Pt[Ve];return Ve+=1,st})}function Qt(_e,me){var it=me.format,qt=it===void 0?"":it,Pt=new Date(_e).getTime(),ve=Date.now(),ge=Math.max(Pt-ve,0);return Wt(ge,qt)}var ur=o("ifEM"),oe=1e3/30;function J(_e){return new Date(_e).getTime()}var H=function(_e){Ct()(it,_e);var me=Re()(it);function it(){var qt;return At()(this,it),qt=me.apply(this,arguments),qt.syncTimer=function(){var Pt=qt.props.value,ve=J(Pt);ve>=Date.now()?qt.startTimer():qt.stopTimer()},qt.startTimer=function(){if(qt.countdownId)return;qt.countdownId=window.setInterval(function(){qt.forceUpdate()},oe)},qt.stopTimer=function(){var Pt=qt.props,ve=Pt.onFinish,ge=Pt.value;if(qt.countdownId){clearInterval(qt.countdownId),qt.countdownId=void 0;var Ve=J(ge);ve&&Ve<Date.now()&&ve()}},qt.formatCountdown=function(Pt,ve){var ge=qt.props.format;return Qt(Pt,z()(z()({},ve),{format:ge}))},qt.valueRender=function(Pt){return Object(ur.a)(Pt,{title:void 0})},qt}return Et()(it,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return i.createElement(mt,z()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),it}(i.Component);H.defaultProps={format:"HH:mm:ss"};var Se=H;mt.Countdown=Se;var be=_.a=mt},YvkH:function(Fe,_,o){"use strict";Fe.exports=x,Fe.exports.default=x;function x(oe,J,H){H=H||2;var Se=J&&J.length,be=Se?J[0]*H:oe.length,_e=p(oe,0,be,H,!0),me=[];if(!_e||_e.next===_e.prev)return me;var it,qt,Pt,ve,ge,Ve,st;if(Se&&(_e=re(oe,J,_e,H)),oe.length>80*H){it=Pt=oe[0],qt=ve=oe[1];for(var Oe=H;Oe<be;Oe+=H)ge=oe[Oe],Ve=oe[Oe+1],ge<it&&(it=ge),Ve<qt&&(qt=Ve),ge>Pt&&(Pt=ge),Ve>ve&&(ve=Ve);st=Math.max(Pt-it,ve-qt),st=st!==0?1/st:0}return z(_e,me,H,it,qt,st),me}function p(oe,J,H,Se,be){var _e,me;if(be===ur(oe,J,H,Se)>0)for(_e=J;_e<H;_e+=Se)me=ht(_e,oe[_e],oe[_e+1],me);else for(_e=H-Se;_e>=J;_e-=Se)me=ht(_e,oe[_e],oe[_e+1],me);return me&&nt(me,me.next)&&(Wt(me),me=me.next),me}function Y(oe,J){if(!oe)return oe;J||(J=oe);var H=oe,Se;do if(Se=!1,!H.steiner&&(nt(H,H.next)||Et(H.prev,H,H.next)===0)){if(Wt(H),H=J=H.prev,H===H.next)break;Se=!0}else H=H.next;while(Se||H!==J);return J}function z(oe,J,H,Se,be,_e,me){if(!oe)return;!me&&_e&&pe(oe,Se,be,_e);for(var it=oe,qt,Pt;oe.prev!==oe.next;){if(qt=oe.prev,Pt=oe.next,_e?Z(oe,Se,be,_e):i(oe)){J.push(qt.i/H),J.push(oe.i/H),J.push(Pt.i/H),Wt(oe),oe=Pt.next,it=Pt.next;continue}if(oe=Pt,oe===it){me?me===1?(oe=D(Y(oe),J,H),z(oe,J,H,Se,be,_e,2)):me===2&&K(oe,J,H,Se,be,_e):z(Y(oe),J,H,Se,be,_e,1);break}}}function i(oe){var J=oe.prev,H=oe,Se=oe.next;if(Et(J,H,Se)>=0)return!1;for(var be=oe.next.next;be!==oe.prev;){if(At(J.x,J.y,H.x,H.y,Se.x,Se.y,be.x,be.y)&&Et(be.prev,be,be.next)>=0)return!1;be=be.next}return!0}function Z(oe,J,H,Se){var be=oe.prev,_e=oe,me=oe.next;if(Et(be,_e,me)>=0)return!1;for(var it=be.x<_e.x?be.x<me.x?be.x:me.x:_e.x<me.x?_e.x:me.x,qt=be.y<_e.y?be.y<me.y?be.y:me.y:_e.y<me.y?_e.y:me.y,Pt=be.x>_e.x?be.x>me.x?be.x:me.x:_e.x>me.x?_e.x:me.x,ve=be.y>_e.y?be.y>me.y?be.y:me.y:_e.y>me.y?_e.y:me.y,ge=mt(it,qt,J,H,Se),Ve=mt(Pt,ve,J,H,Se),st=oe.prevZ,Oe=oe.nextZ;st&&st.z>=ge&&Oe&&Oe.z<=Ve;){if(st!==oe.prev&&st!==oe.next&&At(be.x,be.y,_e.x,_e.y,me.x,me.y,st.x,st.y)&&Et(st.prev,st,st.next)>=0)return!1;if(st=st.prevZ,Oe!==oe.prev&&Oe!==oe.next&&At(be.x,be.y,_e.x,_e.y,me.x,me.y,Oe.x,Oe.y)&&Et(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}for(;st&&st.z>=ge;){if(st!==oe.prev&&st!==oe.next&&At(be.x,be.y,_e.x,_e.y,me.x,me.y,st.x,st.y)&&Et(st.prev,st,st.next)>=0)return!1;st=st.prevZ}for(;Oe&&Oe.z<=Ve;){if(Oe!==oe.prev&&Oe!==oe.next&&At(be.x,be.y,_e.x,_e.y,me.x,me.y,Oe.x,Oe.y)&&Et(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function D(oe,J,H){var Se=oe;do{var be=Se.prev,_e=Se.next.next;!nt(be,_e)&&Ct(be,Se,Se.next,_e)&&Be(be,_e)&&Be(_e,be)&&(J.push(be.i/H),J.push(Se.i/H),J.push(_e.i/H),Wt(Se),Wt(Se.next),Se=oe=_e),Se=Se.next}while(Se!==oe);return Y(Se)}function K(oe,J,H,Se,be,_e){var me=oe;do{for(var it=me.next.next;it!==me.prev;){if(me.i!==it.i&&Ye(me,it)){var qt=Me(me,it);me=Y(me,me.next),qt=Y(qt,qt.next),z(me,J,H,Se,be,_e),z(qt,J,H,Se,be,_e);return}it=it.next}me=me.next}while(me!==oe)}function re(oe,J,H,Se){var be=[],_e,me,it,qt,Pt;for(_e=0,me=J.length;_e<me;_e++)it=J[_e]*Se,qt=_e<me-1?J[_e+1]*Se:oe.length,Pt=p(oe,it,qt,Se,!1),Pt===Pt.next&&(Pt.steiner=!0),be.push(Ne(Pt));for(be.sort(fe),_e=0;_e<be.length;_e++)X(be[_e],H),H=Y(H,H.next);return H}function fe(oe,J){return oe.x-J.x}function X(oe,J){if(J=He(oe,J),J){var H=Me(J,oe);Y(J,J.next),Y(H,H.next)}}function He(oe,J){var H=J,Se=oe.x,be=oe.y,_e=-Infinity,me;do{if(be<=H.y&&be>=H.next.y&&H.next.y!==H.y){var it=H.x+(be-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(it<=Se&&it>_e){if(_e=it,it===Se){if(be===H.y)return H;if(be===H.next.y)return H.next}me=H.x<H.next.x?H:H.next}}H=H.next}while(H!==J);if(!me)return null;if(Se===_e)return me;var qt=me,Pt=me.x,ve=me.y,ge=Infinity,Ve;H=me;do Se>=H.x&&H.x>=Pt&&Se!==H.x&&At(be<ve?Se:_e,be,Pt,ve,be<ve?_e:Se,be,H.x,H.y)&&(Ve=Math.abs(be-H.y)/(Se-H.x),Be(H,oe)&&(Ve<ge||Ve===ge&&(H.x>me.x||H.x===me.x&&Xe(me,H)))&&(me=H,ge=Ve)),H=H.next;while(H!==qt);return me}function Xe(oe,J){return Et(oe.prev,oe,J.prev)<0&&Et(J.next,oe,oe.next)<0}function pe(oe,J,H,Se){var be=oe;do be.z===null&&(be.z=mt(be.x,be.y,J,H,Se)),be.prevZ=be.prev,be.nextZ=be.next,be=be.next;while(be!==oe);be.prevZ.nextZ=null,be.prevZ=null,Ce(be)}function Ce(oe){var J,H,Se,be,_e,me,it,qt,Pt=1;do{for(H=oe,oe=null,_e=null,me=0;H;){for(me++,Se=H,it=0,J=0;J<Pt&&!(it++,Se=Se.nextZ,!Se);J++);for(qt=Pt;it>0||qt>0&&Se;)it!==0&&(qt===0||!Se||H.z<=Se.z)?(be=H,H=H.nextZ,it--):(be=Se,Se=Se.nextZ,qt--),_e?_e.nextZ=be:oe=be,be.prevZ=_e,_e=be;H=Se}_e.nextZ=null,Pt*=2}while(me>1);return oe}function mt(oe,J,H,Se,be){return oe=32767*(oe-H)*be,J=32767*(J-Se)*be,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,J=(J|J<<8)&16711935,J=(J|J<<4)&252645135,J=(J|J<<2)&858993459,J=(J|J<<1)&1431655765,oe|J<<1}function Ne(oe){var J=oe,H=oe;do(J.x<H.x||J.x===H.x&&J.y<H.y)&&(H=J),J=J.next;while(J!==oe);return H}function At(oe,J,H,Se,be,_e,me,it){return(be-me)*(J-it)-(oe-me)*(_e-it)>=0&&(oe-me)*(Se-it)-(H-me)*(J-it)>=0&&(H-me)*(_e-it)-(be-me)*(Se-it)>=0}function Ye(oe,J){return oe.next.i!==J.i&&oe.prev.i!==J.i&&!Ie(oe,J)&&(Be(oe,J)&&Be(J,oe)&&ft(oe,J)&&(Et(oe.prev,oe,J.prev)||Et(oe,J.prev,J))||nt(oe,J)&&Et(oe.prev,oe,oe.next)>0&&Et(J.prev,J,J.next)>0)}function Et(oe,J,H){return(J.y-oe.y)*(H.x-J.x)-(J.x-oe.x)*(H.y-J.y)}function nt(oe,J){return oe.x===J.x&&oe.y===J.y}function Ct(oe,J,H,Se){var be=Re(Et(oe,J,H)),_e=Re(Et(oe,J,Se)),me=Re(Et(H,Se,oe)),it=Re(Et(H,Se,J));return be!==_e&&me!==it||(be===0&&Ot(oe,H,J)||(_e===0&&Ot(oe,Se,J)||me===0&&Ot(H,oe,Se)))?!0:!!(it===0&&Ot(H,J,Se))}function Ot(oe,J,H){return J.x<=Math.max(oe.x,H.x)&&J.x>=Math.min(oe.x,H.x)&&J.y<=Math.max(oe.y,H.y)&&J.y>=Math.min(oe.y,H.y)}function Re(oe){return oe>0?1:oe<0?-1:0}function Ie(oe,J){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==J.i&&H.next.i!==J.i&&Ct(H,H.next,oe,J))return!0;H=H.next}while(H!==oe);return!1}function Be(oe,J){return Et(oe.prev,oe,oe.next)<0?Et(oe,J,oe.next)>=0&&Et(oe,oe.prev,J)>=0:Et(oe,J,oe.prev)<0||Et(oe,oe.next,J)<0}function ft(oe,J){var H=oe,Se=!1,be=(oe.x+J.x)/2,_e=(oe.y+J.y)/2;do H.y>_e!==H.next.y>_e&&H.next.y!==H.y&&be<(H.next.x-H.x)*(_e-H.y)/(H.next.y-H.y)+H.x&&(Se=!Se),H=H.next;while(H!==oe);return Se}function Me(oe,J){var H=new Qt(oe.i,oe.x,oe.y),Se=new Qt(J.i,J.x,J.y),be=oe.next,_e=J.prev;return oe.next=J,J.prev=oe,H.next=be,be.prev=H,Se.next=H,H.prev=Se,_e.next=Se,Se.prev=_e,Se}function ht(oe,J,H,Se){var be=new Qt(oe,J,H);return Se?(be.next=Se.next,be.prev=Se,Se.next.prev=be,Se.next=be):(be.prev=be,be.next=be),be}function Wt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Qt(oe,J,H){this.i=oe,this.x=J,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}x.deviation=function(oe,J,H,Se){var be=J&&J.length,_e=be?J[0]*H:oe.length,me=Math.abs(ur(oe,0,_e,H));if(be)for(var it=0,qt=J.length;it<qt;it++){var Pt=J[it]*H,ve=it<qt-1?J[it+1]*H:oe.length;me-=Math.abs(ur(oe,Pt,ve,H))}var ge=0;for(it=0;it<Se.length;it+=3){var Ve=Se[it]*H,st=Se[it+1]*H,Oe=Se[it+2]*H;ge+=Math.abs((oe[Ve]-oe[Oe])*(oe[st+1]-oe[Ve+1])-(oe[Ve]-oe[st])*(oe[Oe+1]-oe[Ve+1]))}return me===0&&ge===0?0:Math.abs((ge-me)/me)};function ur(oe,J,H,Se){for(var be=0,_e=J,me=H-Se;_e<H;_e+=Se)be+=(oe[me]-oe[_e])*(oe[_e+1]+oe[me+1]),me=_e;return be}x.flatten=function(oe){for(var J=oe[0][0].length,H={vertices:[],holes:[],dimensions:J},Se=0,be=0;be<oe.length;be++){for(var _e=0;_e<oe[be].length;_e++)for(var me=0;me<J;me++)H.vertices.push(oe[be][_e][me]);be>0&&(Se+=oe[be-1].length,H.holes.push(Se))}return H}},"Z+lO":function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x;(function(p){p[p.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",p[p.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",p[p.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",p[p.POINTS=0]="POINTS",p[p.LINES=1]="LINES",p[p.LINE_LOOP=2]="LINE_LOOP",p[p.LINE_STRIP=3]="LINE_STRIP",p[p.TRIANGLES=4]="TRIANGLES",p[p.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",p[p.TRIANGLE_FAN=6]="TRIANGLE_FAN",p[p.ZERO=0]="ZERO",p[p.ONE=1]="ONE",p[p.SRC_COLOR=768]="SRC_COLOR",p[p.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",p[p.SRC_ALPHA=770]="SRC_ALPHA",p[p.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",p[p.DST_ALPHA=772]="DST_ALPHA",p[p.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",p[p.DST_COLOR=774]="DST_COLOR",p[p.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",p[p.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",p[p.FUNC_ADD=32774]="FUNC_ADD",p[p.BLEND_EQUATION=32777]="BLEND_EQUATION",p[p.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",p[p.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",p[p.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",p[p.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",p[p.MAX_EXT=32776]="MAX_EXT",p[p.MIN_EXT=32775]="MIN_EXT",p[p.BLEND_DST_RGB=32968]="BLEND_DST_RGB",p[p.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",p[p.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",p[p.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",p[p.CONSTANT_COLOR=32769]="CONSTANT_COLOR",p[p.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",p[p.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",p[p.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",p[p.BLEND_COLOR=32773]="BLEND_COLOR",p[p.ARRAY_BUFFER=34962]="ARRAY_BUFFER",p[p.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",p[p.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",p[p.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",p[p.STREAM_DRAW=35040]="STREAM_DRAW",p[p.STATIC_DRAW=35044]="STATIC_DRAW",p[p.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",p[p.BUFFER_SIZE=34660]="BUFFER_SIZE",p[p.BUFFER_USAGE=34661]="BUFFER_USAGE",p[p.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",p[p.FRONT=1028]="FRONT",p[p.BACK=1029]="BACK",p[p.FRONT_AND_BACK=1032]="FRONT_AND_BACK",p[p.CULL_FACE=2884]="CULL_FACE",p[p.BLEND=3042]="BLEND",p[p.DITHER=3024]="DITHER",p[p.STENCIL_TEST=2960]="STENCIL_TEST",p[p.DEPTH_TEST=2929]="DEPTH_TEST",p[p.SCISSOR_TEST=3089]="SCISSOR_TEST",p[p.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",p[p.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",p[p.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",p[p.NO_ERROR=0]="NO_ERROR",p[p.INVALID_ENUM=1280]="INVALID_ENUM",p[p.INVALID_VALUE=1281]="INVALID_VALUE",p[p.INVALID_OPERATION=1282]="INVALID_OPERATION",p[p.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",p[p.CW=2304]="CW",p[p.CCW=2305]="CCW",p[p.LINE_WIDTH=2849]="LINE_WIDTH",p[p.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",p[p.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",p[p.CULL_FACE_MODE=2885]="CULL_FACE_MODE",p[p.FRONT_FACE=2886]="FRONT_FACE",p[p.DEPTH_RANGE=2928]="DEPTH_RANGE",p[p.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",p[p.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",p[p.DEPTH_FUNC=2932]="DEPTH_FUNC",p[p.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",p[p.STENCIL_FUNC=2962]="STENCIL_FUNC",p[p.STENCIL_FAIL=2964]="STENCIL_FAIL",p[p.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",p[p.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",p[p.STENCIL_REF=2967]="STENCIL_REF",p[p.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",p[p.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",p[p.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",p[p.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",p[p.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",p[p.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",p[p.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",p[p.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",p[p.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",p[p.VIEWPORT=2978]="VIEWPORT",p[p.SCISSOR_BOX=3088]="SCISSOR_BOX",p[p.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",p[p.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",p[p.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",p[p.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",p[p.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",p[p.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",p[p.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",p[p.RED_BITS=3410]="RED_BITS",p[p.GREEN_BITS=3411]="GREEN_BITS",p[p.BLUE_BITS=3412]="BLUE_BITS",p[p.ALPHA_BITS=3413]="ALPHA_BITS",p[p.DEPTH_BITS=3414]="DEPTH_BITS",p[p.STENCIL_BITS=3415]="STENCIL_BITS",p[p.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",p[p.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",p[p.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",p[p.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",p[p.SAMPLES=32937]="SAMPLES",p[p.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",p[p.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",p[p.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",p[p.DONT_CARE=4352]="DONT_CARE",p[p.FASTEST=4353]="FASTEST",p[p.NICEST=4354]="NICEST",p[p.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",p[p.BYTE=5120]="BYTE",p[p.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",p[p.SHORT=5122]="SHORT",p[p.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",p[p.INT=5124]="INT",p[p.UNSIGNED_INT=5125]="UNSIGNED_INT",p[p.FLOAT=5126]="FLOAT",p[p.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",p[p.ALPHA=6406]="ALPHA",p[p.RGB=6407]="RGB",p[p.RGBA=6408]="RGBA",p[p.LUMINANCE=6409]="LUMINANCE",p[p.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",p[p.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",p[p.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",p[p.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",p[p.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",p[p.VERTEX_SHADER=35633]="VERTEX_SHADER",p[p.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",p[p.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",p[p.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",p[p.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",p[p.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",p[p.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",p[p.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",p[p.SHADER_TYPE=35663]="SHADER_TYPE",p[p.DELETE_STATUS=35712]="DELETE_STATUS",p[p.LINK_STATUS=35714]="LINK_STATUS",p[p.VALIDATE_STATUS=35715]="VALIDATE_STATUS",p[p.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",p[p.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",p[p.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",p[p.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",p[p.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",p[p.NEVER=512]="NEVER",p[p.LESS=513]="LESS",p[p.EQUAL=514]="EQUAL",p[p.LEQUAL=515]="LEQUAL",p[p.GREATER=516]="GREATER",p[p.NOTEQUAL=517]="NOTEQUAL",p[p.GEQUAL=518]="GEQUAL",p[p.ALWAYS=519]="ALWAYS",p[p.KEEP=7680]="KEEP",p[p.REPLACE=7681]="REPLACE",p[p.INCR=7682]="INCR",p[p.DECR=7683]="DECR",p[p.INVERT=5386]="INVERT",p[p.INCR_WRAP=34055]="INCR_WRAP",p[p.DECR_WRAP=34056]="DECR_WRAP",p[p.VENDOR=7936]="VENDOR",p[p.RENDERER=7937]="RENDERER",p[p.VERSION=7938]="VERSION",p[p.NEAREST=9728]="NEAREST",p[p.LINEAR=9729]="LINEAR",p[p.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",p[p.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",p[p.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",p[p.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",p[p.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",p[p.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",p[p.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",p[p.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",p[p.TEXTURE_2D=3553]="TEXTURE_2D",p[p.TEXTURE=5890]="TEXTURE",p[p.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",p[p.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",p[p.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",p[p.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",p[p.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",p[p.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",p[p.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",p[p.TEXTURE0=33984]="TEXTURE0",p[p.TEXTURE1=33985]="TEXTURE1",p[p.TEXTURE2=33986]="TEXTURE2",p[p.TEXTURE3=33987]="TEXTURE3",p[p.TEXTURE4=33988]="TEXTURE4",p[p.TEXTURE5=33989]="TEXTURE5",p[p.TEXTURE6=33990]="TEXTURE6",p[p.TEXTURE7=33991]="TEXTURE7",p[p.TEXTURE8=33992]="TEXTURE8",p[p.TEXTURE9=33993]="TEXTURE9",p[p.TEXTURE10=33994]="TEXTURE10",p[p.TEXTURE11=33995]="TEXTURE11",p[p.TEXTURE12=33996]="TEXTURE12",p[p.TEXTURE13=33997]="TEXTURE13",p[p.TEXTURE14=33998]="TEXTURE14",p[p.TEXTURE15=33999]="TEXTURE15",p[p.TEXTURE16=34e3]="TEXTURE16",p[p.TEXTURE17=34001]="TEXTURE17",p[p.TEXTURE18=34002]="TEXTURE18",p[p.TEXTURE19=34003]="TEXTURE19",p[p.TEXTURE20=34004]="TEXTURE20",p[p.TEXTURE21=34005]="TEXTURE21",p[p.TEXTURE22=34006]="TEXTURE22",p[p.TEXTURE23=34007]="TEXTURE23",p[p.TEXTURE24=34008]="TEXTURE24",p[p.TEXTURE25=34009]="TEXTURE25",p[p.TEXTURE26=34010]="TEXTURE26",p[p.TEXTURE27=34011]="TEXTURE27",p[p.TEXTURE28=34012]="TEXTURE28",p[p.TEXTURE29=34013]="TEXTURE29",p[p.TEXTURE30=34014]="TEXTURE30",p[p.TEXTURE31=34015]="TEXTURE31",p[p.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",p[p.REPEAT=10497]="REPEAT",p[p.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",p[p.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",p[p.FLOAT_VEC2=35664]="FLOAT_VEC2",p[p.FLOAT_VEC3=35665]="FLOAT_VEC3",p[p.FLOAT_VEC4=35666]="FLOAT_VEC4",p[p.INT_VEC2=35667]="INT_VEC2",p[p.INT_VEC3=35668]="INT_VEC3",p[p.INT_VEC4=35669]="INT_VEC4",p[p.BOOL=35670]="BOOL",p[p.BOOL_VEC2=35671]="BOOL_VEC2",p[p.BOOL_VEC3=35672]="BOOL_VEC3",p[p.BOOL_VEC4=35673]="BOOL_VEC4",p[p.FLOAT_MAT2=35674]="FLOAT_MAT2",p[p.FLOAT_MAT3=35675]="FLOAT_MAT3",p[p.FLOAT_MAT4=35676]="FLOAT_MAT4",p[p.SAMPLER_2D=35678]="SAMPLER_2D",p[p.SAMPLER_CUBE=35680]="SAMPLER_CUBE",p[p.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",p[p.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",p[p.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",p[p.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",p[p.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",p[p.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",p[p.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",p[p.COMPILE_STATUS=35713]="COMPILE_STATUS",p[p.LOW_FLOAT=36336]="LOW_FLOAT",p[p.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",p[p.HIGH_FLOAT=36338]="HIGH_FLOAT",p[p.LOW_INT=36339]="LOW_INT",p[p.MEDIUM_INT=36340]="MEDIUM_INT",p[p.HIGH_INT=36341]="HIGH_INT",p[p.FRAMEBUFFER=36160]="FRAMEBUFFER",p[p.RENDERBUFFER=36161]="RENDERBUFFER",p[p.RGBA4=32854]="RGBA4",p[p.RGB5_A1=32855]="RGB5_A1",p[p.RGB565=36194]="RGB565",p[p.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",p[p.STENCIL_INDEX=6401]="STENCIL_INDEX",p[p.STENCIL_INDEX8=36168]="STENCIL_INDEX8",p[p.DEPTH_STENCIL=34041]="DEPTH_STENCIL",p[p.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",p[p.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",p[p.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",p[p.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",p[p.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",p[p.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",p[p.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",p[p.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",p[p.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",p[p.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",p[p.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",p[p.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",p[p.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",p[p.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",p[p.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",p[p.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",p[p.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",p[p.NONE=0]="NONE",p[p.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",p[p.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",p[p.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",p[p.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",p[p.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",p[p.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",p[p.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",p[p.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",p[p.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",p[p.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",p[p.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",p[p.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",p[p.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",p[p.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(x||(x={}))},Z2dz:function(Fe,_,o){var x=o("NoL3"),p=o("aXON");function Y(z,i,Z){return Z===void 0&&(Z=i,i=void 0),Z!==void 0&&(Z=p(Z),Z=Z===Z?Z:0),i!==void 0&&(i=p(i),i=i===i?i:0),x(p(z),i,Z)}Fe.exports=Y},ZHBU:function(Fe,_,o){"use strict";o.d(_,"b",function(){return x}),o.d(_,"c",function(){return p}),o.d(_,"a",function(){return Y});var x;(function(z){z.LINEAR="linear",z.POWER="power",z.LOG="log",z.IDENTITY="identity",z.TIME="time",z.QUANTILE="quantile",z.QUANTIZE="quantize",z.THRESHOLD="threshold",z.CAT="cat"})(x||(x={}));var p;(function(z){z.CONSTANT="constant",z.VARIABLE="variable"})(p||(p={}));var Y;(function(z){z[z.Attribute=0]="Attribute",z[z.InstancedAttribute=1]="InstancedAttribute",z[z.Uniform=2]="Uniform"})(Y||(Y={}))},ZJ87:function(Fe,_){Fe.exports=o;function o(x,p,Y,z){this.cx=3*x,this.bx=3*(Y-x)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(z-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=x,this.p1y=z,this.p2x=Y,this.p2y=z}o.prototype.sampleCurveX=function(x){return((this.ax*x+this.bx)*x+this.cx)*x},o.prototype.sampleCurveY=function(x){return((this.ay*x+this.by)*x+this.cy)*x},o.prototype.sampleCurveDerivativeX=function(x){return(3*this.ax*x+2*this.bx)*x+this.cx},o.prototype.solveCurveX=function(x,p){typeof p=="undefined"&&(p=1e-6);var Y,z,i,Z,D;for(i=x,D=0;D<8;D++){if(Z=this.sampleCurveX(i)-x,Math.abs(Z)<p)return i;var K=this.sampleCurveDerivativeX(i);if(Math.abs(K)<1e-6)break;i=i-Z/K}if(Y=0,z=1,i=x,i<Y)return Y;if(i>z)return z;for(;Y<z;){if(Z=this.sampleCurveX(i),Math.abs(Z-x)<p)return i;x>Z?Y=i:z=i,i=(z-Y)*.5+Y}return i},o.prototype.solve=function(x,p){return this.sampleCurveY(this.solveCurveX(x,p))}},ZaRd:function(Fe,_,o){"use strict";o.d(_,"a",function(){return oe});var x=o("L84c"),p=o.n(x),Y=o("oH/p"),z=o.n(Y),i=o("b83N"),Z=o.n(i),D=o("xjNF"),K=o.n(D),re=o("jZ0V"),fe=o.n(re),X=o("DXzO"),He=o.n(X),Xe=o("vlZP"),pe=o.n(Xe),Ce=o("5MNg"),mt=o.n(Ce),Ne=o("r4C2"),At=o.n(Ne),Ye=o("S+oY"),Et=o.n(Ye),nt=o("cxjn"),Ct=o("Y2WT"),Ot=o("p14H"),Re,Ie,Be,ft,Me,ht;function Wt(J,H){var Se=Object.keys(J);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(J);H&&(be=be.filter(function(_e){return Object.getOwnPropertyDescriptor(J,_e).enumerable})),Se.push.apply(Se,be)}return Se}function Qt(J){for(var H=1;H<arguments.length;H++){var Se=arguments[H]!=null?arguments[H]:{};H%2?Wt(Object(Se),!0).forEach(function(be){p()(J,be,Se[be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(Se)):Wt(Object(Se)).forEach(function(be){Object.defineProperty(J,be,Object.getOwnPropertyDescriptor(Se,be))})}return J}var ur=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(Re=Object(Ye.injectable)(),Ie=Object(Ye.inject)(Ct.a.IShaderModuleService),Re(Be=(ft=(ht=function(){function J(){Z()(this,J),z()(this,"shaderModuleService",Me,this),this.rendererService=void 0,this.config=void 0,this.quad=ur,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return K()(J,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Se){this.name=Se}},{key:"getType",value:function(){return Ot.a.PostProcessing}},{key:"init",value:function(Se,be){this.config=be,this.rendererService=Se.getContainer().get(Ct.a.IRendererService);var _e=this.rendererService,me=_e.createAttribute,it=_e.createBuffer,qt=_e.createModel,Pt=this.setupShaders(),ve=Pt.vs,ge=Pt.fs,Ve=Pt.uniforms;this.model=qt({vs:ve,fs:ge,attributes:{a_Position:me({buffer:it({data:[-4,-4,4,-4,0,4],type:nt.gl.FLOAT}),size:2})},uniforms:Qt(Qt({u_Texture:null},Ve),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Se){var be=this,_e=Se.multiPassRenderer.getPostProcessor(),me=this.rendererService,it=me.useFramebuffer,qt=me.getViewportSize,Pt=me.clear,ve=qt(),ge=ve.width,Ve=ve.height;it(this.renderToScreen?null:_e.getWriteFBO(),function(){Pt({framebuffer:_e.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),be.model.draw({uniforms:Qt({u_Texture:_e.getReadFBO(),u_ViewportSize:[ge,Ve]},be.convertOptionsToUniforms(be.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Se){this.enabled=Se}},{key:"setRenderToScreen",value:function(Se){this.renderToScreen=Se}},{key:"updateOptions",value:function(Se){this.optionsToUpdate=Qt(Qt({},this.optionsToUpdate),Se)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Se){var be={};return Object.keys(Se).forEach(function(_e){mt()(Se[_e])||(be["u_".concat(pe()(At()(_e)))]=Se[_e])}),be}}]),J}(),ht),Me=fe()(ft.prototype,"shaderModuleService",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft))||Be)},"aj+B":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0}),_.default=function(Ce){return(0,p.default)((0,K.default)(Ce)&&Ce.length>=1,"Must merge at least 1 JSON schema."),z.default.apply(void 0,[{}].concat(pe(Ce),[function(mt,Ne,At){if((0,Z.default)(mt))return;if(At==="required")return(0,fe.default)(mt.concat(Ne));if((0,He.default)(mt)){if(!(0,He.default)(Ne))throw new Error('Failed to merge schemas because "'+At+'" has different values.');return}p.default.deepEqual(mt,Ne,'Failed to merge schemas because "'+At+'" has different values: '+JSON.stringify(mt)+" and "+JSON.stringify(Ne)+".")}]))};var x=o("4eip"),p=Xe(x),Y=o("1BAa"),z=Xe(Y),i=o("fWxm"),Z=Xe(i),D=o("7otc"),K=Xe(D),re=o("cVoK"),fe=Xe(re),X=o("mF5f"),He=Xe(X);function Xe(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}function pe(Ce){if(Array.isArray(Ce)){for(var mt=0,Ne=Array(Ce.length);mt<Ce.length;mt++)Ne[mt]=Ce[mt];return Ne}else return Array.from(Ce)}Fe.exports=_.default},c2Jw:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("7s3S"),Y=o("/jsB");function z(K,re,fe){var X=re.filter(function(Xe){return Xe.target!==null&&Xe.target.type===p.TargetTypeEnum.ClassProperty}),He=X.map(fe);return X.forEach(function(Xe,pe){var Ce="";Ce=Xe.target.name.value();var mt=He[pe];K[Ce]=mt}),K}function i(K,re){return new(K.bind.apply(K,[void 0].concat(re)))}function Z(K,re){if(Reflect.hasMetadata(Y.POST_CONSTRUCT,K)){var fe=Reflect.getMetadata(Y.POST_CONSTRUCT,K);try{re[fe.value]()}catch(X){throw new Error(x.POST_CONSTRUCT_ERROR(K.name,X.message))}}}function D(K,re,fe){var X=null;if(re.length>0){var He=re.filter(function(pe){return pe.target!==null&&pe.target.type===p.TargetTypeEnum.ConstructorArgument}),Xe=He.map(fe);X=i(K,Xe),X=z(X,re,fe)}else X=new K;return Z(K,X),X}_.resolveInstance=D},cI4T:function(Fe,_,o){var x=o("7dF+"),p=o("gteZ"),Y="Expected a function";function z(i,Z,D){var K=!0,re=!0;if(typeof i!="function")throw new TypeError(Y);return p(D)&&(K="leading"in D?!!D.leading:K,re="trailing"in D?!!D.trailing:re),x(i,Z,{leading:K,maxWait:Z,trailing:re})}Fe.exports=z},cOPB:function(Fe,_,o){var x=o("gXXb"),p=o("myZC"),Y=o("uB5b"),z=o("DTuh"),i=o("FZ1S"),Z=o("MRi+"),D=o("VQDY"),K=o("xZJU"),re=o("Lcph"),fe=o("tcMs"),X=o("dQxg"),He=o("HtJV"),Xe=o("0RSn"),pe=o("QCRO"),Ce=o("vG7H"),mt=o("iz/G"),Ne=o("Gv+9"),At=o("Mhuo"),Ye=o("gteZ"),Et=o("9+tt"),nt=o("a+hL"),Ct=o("wndA"),Ot=1,Re=2,Ie=4,Be="[object Arguments]",ft="[object Array]",Me="[object Boolean]",ht="[object Date]",Wt="[object Error]",Qt="[object Function]",ur="[object GeneratorFunction]",oe="[object Map]",J="[object Number]",H="[object Object]",Se="[object RegExp]",be="[object Set]",_e="[object String]",me="[object Symbol]",it="[object WeakMap]",qt="[object ArrayBuffer]",Pt="[object DataView]",ve="[object Float32Array]",ge="[object Float64Array]",Ve="[object Int8Array]",st="[object Int16Array]",Oe="[object Int32Array]",vt="[object Uint8Array]",C="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",ce={};ce[Be]=ce[ft]=ce[qt]=ce[Pt]=ce[Me]=ce[ht]=ce[ve]=ce[ge]=ce[Ve]=ce[st]=ce[Oe]=ce[oe]=ce[J]=ce[H]=ce[Se]=ce[be]=ce[_e]=ce[me]=ce[vt]=ce[C]=ce[R]=ce[q]=!0,ce[Wt]=ce[Qt]=ce[it]=!1;function Ge(qe,Tt,ot,Ut,$,Qe){var ae,et=Tt&Ot,kt=Tt&Re,pr=Tt&Ie;if(ot&&(ae=$?ot(qe,Ut,$,Qe):ot(qe)),ae!==void 0)return ae;if(!Ye(qe))return qe;var Ke=mt(qe);if(Ke){if(ae=Xe(qe),!et)return D(qe,ae)}else{var bt=He(qe),yt=bt==Qt||bt==ur;if(Ne(qe))return Z(qe,et);if(bt==H||bt==Be||yt&&!$){if(ae=kt||yt?{}:Ce(qe),!et)return kt?re(qe,i(ae,qe)):K(qe,z(ae,qe))}else{if(!ce[bt])return $?qe:{};ae=pe(qe,bt,et)}}Qe||(Qe=new x);var xt=Qe.get(qe);if(xt)return xt;Qe.set(qe,ae),Et(qe)?qe.forEach(function(gt){ae.add(Ge(gt,Tt,ot,gt,qe,Qe))}):At(qe)&&qe.forEach(function(gt,Ht){ae.set(Ht,Ge(gt,Tt,ot,Ht,qe,Qe))});var ze=pr?kt?X:fe:kt?Ct:nt,dt=Ke?void 0:ze(qe);return p(dt||qe,function(gt,Ht){dt&&(Ht=gt,gt=qe[Ht]),Y(ae,Ht,Ge(gt,Tt,ot,Ht,qe,Qe))}),ae}Fe.exports=Ge},cVoK:function(Fe,_,o){(function(x){var p=200,Y="__lodash_hash_undefined__",z=1/0,i="[object Function]",Z="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,re=typeof x=="object"&&x&&x.Object===Object&&x,fe=typeof self=="object"&&self&&self.Object===Object&&self,X=re||fe||Function("return this")();function He(dt,gt){var Ht=dt?dt.length:0;return!!Ht&&Ce(dt,gt,0)>-1}function Xe(dt,gt,Ht){for(var hr=-1,Zr=dt?dt.length:0;++hr<Zr;)if(Ht(gt,dt[hr]))return!0;return!1}function pe(dt,gt,Ht,hr){for(var Zr=dt.length,yr=Ht+(hr?1:-1);hr?yr--:++yr<Zr;)if(gt(dt[yr],yr,dt))return yr;return-1}function Ce(dt,gt,Ht){if(gt!==gt)return pe(dt,mt,Ht);for(var hr=Ht-1,Zr=dt.length;++hr<Zr;)if(dt[hr]===gt)return hr;return-1}function mt(dt){return dt!==dt}function Ne(dt,gt){return dt.has(gt)}function At(dt,gt){return dt==null?void 0:dt[gt]}function Ye(dt){var gt=!1;if(dt!=null&&typeof dt.toString!="function")try{gt=!!(dt+"")}catch(Ht){}return gt}function Et(dt){var gt=-1,Ht=Array(dt.size);return dt.forEach(function(hr){Ht[++gt]=hr}),Ht}var nt=Array.prototype,Ct=Function.prototype,Ot=Object.prototype,Re=X["__core-js_shared__"],Ie=function(){var dt=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||"");return dt?"Symbol(src)_1."+dt:""}(),Be=Ct.toString,ft=Ot.hasOwnProperty,Me=Ot.toString,ht=RegExp("^"+Be.call(ft).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=nt.splice,Qt=ae(X,"Map"),ur=ae(X,"Set"),oe=ae(Object,"create");function J(dt){var gt=-1,Ht=dt?dt.length:0;for(this.clear();++gt<Ht;){var hr=dt[gt];this.set(hr[0],hr[1])}}function H(){this.__data__=oe?oe(null):{}}function Se(dt){return this.has(dt)&&delete this.__data__[dt]}function be(dt){var gt=this.__data__;if(oe){var Ht=gt[dt];return Ht===Y?void 0:Ht}return ft.call(gt,dt)?gt[dt]:void 0}function _e(dt){var gt=this.__data__;return oe?gt[dt]!==void 0:ft.call(gt,dt)}function me(dt,gt){var Ht=this.__data__;return Ht[dt]=oe&&gt===void 0?Y:gt,this}J.prototype.clear=H,J.prototype.delete=Se,J.prototype.get=be,J.prototype.has=_e,J.prototype.set=me;function it(dt){var gt=-1,Ht=dt?dt.length:0;for(this.clear();++gt<Ht;){var hr=dt[gt];this.set(hr[0],hr[1])}}function qt(){this.__data__=[]}function Pt(dt){var gt=this.__data__,Ht=Tt(gt,dt);if(Ht<0)return!1;var hr=gt.length-1;return Ht==hr?gt.pop():Wt.call(gt,Ht,1),!0}function ve(dt){var gt=this.__data__,Ht=Tt(gt,dt);return Ht<0?void 0:gt[Ht][1]}function ge(dt){return Tt(this.__data__,dt)>-1}function Ve(dt,gt){var Ht=this.__data__,hr=Tt(Ht,dt);return hr<0?Ht.push([dt,gt]):Ht[hr][1]=gt,this}it.prototype.clear=qt,it.prototype.delete=Pt,it.prototype.get=ve,it.prototype.has=ge,it.prototype.set=Ve;function st(dt){var gt=-1,Ht=dt?dt.length:0;for(this.clear();++gt<Ht;){var hr=dt[gt];this.set(hr[0],hr[1])}}function Oe(){this.__data__={hash:new J,map:new(Qt||it),string:new J}}function vt(dt){return Qe(this,dt).delete(dt)}function C(dt){return Qe(this,dt).get(dt)}function R(dt){return Qe(this,dt).has(dt)}function q(dt,gt){return Qe(this,dt).set(dt,gt),this}st.prototype.clear=Oe,st.prototype.delete=vt,st.prototype.get=C,st.prototype.has=R,st.prototype.set=q;function ce(dt){var gt=-1,Ht=dt?dt.length:0;for(this.__data__=new st;++gt<Ht;)this.add(dt[gt])}function Ge(dt){return this.__data__.set(dt,Y),this}function qe(dt){return this.__data__.has(dt)}ce.prototype.add=ce.prototype.push=Ge,ce.prototype.has=qe;function Tt(dt,gt){for(var Ht=dt.length;Ht--;)if(bt(dt[Ht][0],gt))return Ht;return-1}function ot(dt){if(!xt(dt)||kt(dt))return!1;var gt=yt(dt)||Ye(dt)?ht:K;return gt.test(pr(dt))}function Ut(dt,gt,Ht){var hr=-1,Zr=He,yr=dt.length,Vn=!0,Fn=[],oa=Fn;if(Ht)Vn=!1,Zr=Xe;else if(yr>=p){var $n=gt?null:$(dt);if($n)return Et($n);Vn=!1,Zr=Ne,oa=new ce}else oa=gt?[]:Fn;e:for(;++hr<yr;){var Kn=dt[hr],Cn=gt?gt(Kn):Kn;if(Kn=Ht||Kn!==0?Kn:0,Vn&&Cn===Cn){for(var F=oa.length;F--;)if(oa[F]===Cn)continue e;gt&&oa.push(Cn),Fn.push(Kn)}else Zr(oa,Cn,Ht)||(oa!==Fn&&oa.push(Cn),Fn.push(Kn))}return Fn}var $=ur&&1/Et(new ur([,-0]))[1]==z?function(dt){return new ur(dt)}:ze;function Qe(dt,gt){var Ht=dt.__data__;return et(gt)?Ht[typeof gt=="string"?"string":"hash"]:Ht.map}function ae(dt,gt){var Ht=At(dt,gt);return ot(Ht)?Ht:void 0}function et(dt){var gt=typeof dt;return gt=="string"||gt=="number"||gt=="symbol"||gt=="boolean"?dt!=="__proto__":dt===null}function kt(dt){return!!Ie&&Ie in dt}function pr(dt){if(dt!=null){try{return Be.call(dt)}catch(gt){}try{return dt+""}catch(gt){}}return""}function Ke(dt){return dt&&dt.length?Ut(dt):[]}function bt(dt,gt){return dt===gt||dt!==dt&&gt!==gt}function yt(dt){var gt=xt(dt)?Me.call(dt):"";return gt==i||gt==Z}function xt(dt){var gt=typeof dt;return!!dt&&(gt=="object"||gt=="function")}function ze(){}Fe.exports=Ke}).call(this,o("UywP"))},cxjn:function(Fe,_,o){"use strict";var x=o("sQYV");o.d(_,"container",function(){return x.c}),o.d(_,"createSceneContainer",function(){return x.b}),o.d(_,"createLayerContainer",function(){return x.a}),o.d(_,"lazyInject",function(){return x.d});var p=o("ZaRd"),Y=o("Y2WT");o.d(_,"TYPES",function(){return Y.a});var z=o("0eeP"),i=o("JXKY");o.d(_,"BlendType",function(){return i.a});var Z=o("ZHBU");o.d(_,"AttributeType",function(){return Z.a}),o.d(_,"ScaleTypes",function(){return Z.b}),o.d(_,"StyleScaleType",function(){return Z.c});var D=o("y1Ry"),K=o.n(D);o.o(D,"CameraUniform")&&o.d(_,"CameraUniform",function(){return D.CameraUniform}),o.o(D,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return D.CityBuildingLayer}),o.o(D,"Control")&&o.d(_,"Control",function(){return D.Control}),o.o(D,"CoordinateSystem")&&o.d(_,"CoordinateSystem",function(){return D.CoordinateSystem}),o.o(D,"CoordinateUniform")&&o.d(_,"CoordinateUniform",function(){return D.CoordinateUniform}),o.o(D,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return D.HeatmapLayer}),o.o(D,"ImageLayer")&&o.d(_,"ImageLayer",function(){return D.ImageLayer}),o.o(D,"LineLayer")&&o.d(_,"LineLayer",function(){return D.LineLayer}),o.o(D,"Logo")&&o.d(_,"Logo",function(){return D.Logo}),o.o(D,"MapServiceEvent")&&o.d(_,"MapServiceEvent",function(){return D.MapServiceEvent}),o.o(D,"Marker")&&o.d(_,"Marker",function(){return D.Marker}),o.o(D,"PointLayer")&&o.d(_,"PointLayer",function(){return D.PointLayer}),o.o(D,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return D.PolygonLayer}),o.o(D,"Popup")&&o.d(_,"Popup",function(){return D.Popup}),o.o(D,"PositionType")&&o.d(_,"PositionType",function(){return D.PositionType}),o.o(D,"RasterLayer")&&o.d(_,"RasterLayer",function(){return D.RasterLayer}),o.o(D,"Scale")&&o.d(_,"Scale",function(){return D.Scale}),o.o(D,"Scene")&&o.d(_,"Scene",function(){return D.Scene}),o.o(D,"SceneEventList")&&o.d(_,"SceneEventList",function(){return D.SceneEventList}),o.o(D,"Zoom")&&o.d(_,"Zoom",function(){return D.Zoom}),o.o(D,"gl")&&o.d(_,"gl",function(){return D.gl});var re=o("W4l2");o.d(_,"MapServiceEvent",function(){return re.a});var fe=o("8Mwt");o.d(_,"CoordinateSystem",function(){return fe.a}),o.d(_,"CoordinateUniform",function(){return fe.b});var X=o("MWZR"),He=o.n(X);o.o(X,"CameraUniform")&&o.d(_,"CameraUniform",function(){return X.CameraUniform}),o.o(X,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return X.CityBuildingLayer}),o.o(X,"Control")&&o.d(_,"Control",function(){return X.Control}),o.o(X,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return X.HeatmapLayer}),o.o(X,"ImageLayer")&&o.d(_,"ImageLayer",function(){return X.ImageLayer}),o.o(X,"LineLayer")&&o.d(_,"LineLayer",function(){return X.LineLayer}),o.o(X,"Logo")&&o.d(_,"Logo",function(){return X.Logo}),o.o(X,"Marker")&&o.d(_,"Marker",function(){return X.Marker}),o.o(X,"PointLayer")&&o.d(_,"PointLayer",function(){return X.PointLayer}),o.o(X,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return X.PolygonLayer}),o.o(X,"Popup")&&o.d(_,"Popup",function(){return X.Popup}),o.o(X,"PositionType")&&o.d(_,"PositionType",function(){return X.PositionType}),o.o(X,"RasterLayer")&&o.d(_,"RasterLayer",function(){return X.RasterLayer}),o.o(X,"Scale")&&o.d(_,"Scale",function(){return X.Scale}),o.o(X,"Scene")&&o.d(_,"Scene",function(){return X.Scene}),o.o(X,"SceneEventList")&&o.d(_,"SceneEventList",function(){return X.SceneEventList}),o.o(X,"Zoom")&&o.d(_,"Zoom",function(){return X.Zoom}),o.o(X,"gl")&&o.d(_,"gl",function(){return X.gl});var Xe=o("9hGJ");o.d(_,"CameraUniform",function(){return Xe.a});var pe=o("gkfd"),Ce=o.n(pe);o.o(pe,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return pe.CityBuildingLayer}),o.o(pe,"Control")&&o.d(_,"Control",function(){return pe.Control}),o.o(pe,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return pe.HeatmapLayer}),o.o(pe,"ImageLayer")&&o.d(_,"ImageLayer",function(){return pe.ImageLayer}),o.o(pe,"LineLayer")&&o.d(_,"LineLayer",function(){return pe.LineLayer}),o.o(pe,"Logo")&&o.d(_,"Logo",function(){return pe.Logo}),o.o(pe,"Marker")&&o.d(_,"Marker",function(){return pe.Marker}),o.o(pe,"PointLayer")&&o.d(_,"PointLayer",function(){return pe.PointLayer}),o.o(pe,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return pe.PolygonLayer}),o.o(pe,"Popup")&&o.d(_,"Popup",function(){return pe.Popup}),o.o(pe,"PositionType")&&o.d(_,"PositionType",function(){return pe.PositionType}),o.o(pe,"RasterLayer")&&o.d(_,"RasterLayer",function(){return pe.RasterLayer}),o.o(pe,"Scale")&&o.d(_,"Scale",function(){return pe.Scale}),o.o(pe,"Scene")&&o.d(_,"Scene",function(){return pe.Scene}),o.o(pe,"SceneEventList")&&o.d(_,"SceneEventList",function(){return pe.SceneEventList}),o.o(pe,"Zoom")&&o.d(_,"Zoom",function(){return pe.Zoom}),o.o(pe,"gl")&&o.d(_,"gl",function(){return pe.gl});var mt=o("xOfz");o.d(_,"SceneEventList",function(){return mt.a});var Ne=o("mKJG"),At=o.n(Ne);o.o(Ne,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Ne.CityBuildingLayer}),o.o(Ne,"Control")&&o.d(_,"Control",function(){return Ne.Control}),o.o(Ne,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Ne.HeatmapLayer}),o.o(Ne,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Ne.ImageLayer}),o.o(Ne,"LineLayer")&&o.d(_,"LineLayer",function(){return Ne.LineLayer}),o.o(Ne,"Logo")&&o.d(_,"Logo",function(){return Ne.Logo}),o.o(Ne,"Marker")&&o.d(_,"Marker",function(){return Ne.Marker}),o.o(Ne,"PointLayer")&&o.d(_,"PointLayer",function(){return Ne.PointLayer}),o.o(Ne,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Ne.PolygonLayer}),o.o(Ne,"Popup")&&o.d(_,"Popup",function(){return Ne.Popup}),o.o(Ne,"PositionType")&&o.d(_,"PositionType",function(){return Ne.PositionType}),o.o(Ne,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Ne.RasterLayer}),o.o(Ne,"Scale")&&o.d(_,"Scale",function(){return Ne.Scale}),o.o(Ne,"Scene")&&o.d(_,"Scene",function(){return Ne.Scene}),o.o(Ne,"Zoom")&&o.d(_,"Zoom",function(){return Ne.Zoom}),o.o(Ne,"gl")&&o.d(_,"gl",function(){return Ne.gl});var Ye=o("COyS"),Et=o.n(Ye);o.o(Ye,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Ye.CityBuildingLayer}),o.o(Ye,"Control")&&o.d(_,"Control",function(){return Ye.Control}),o.o(Ye,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Ye.HeatmapLayer}),o.o(Ye,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Ye.ImageLayer}),o.o(Ye,"LineLayer")&&o.d(_,"LineLayer",function(){return Ye.LineLayer}),o.o(Ye,"Logo")&&o.d(_,"Logo",function(){return Ye.Logo}),o.o(Ye,"Marker")&&o.d(_,"Marker",function(){return Ye.Marker}),o.o(Ye,"PointLayer")&&o.d(_,"PointLayer",function(){return Ye.PointLayer}),o.o(Ye,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Ye.PolygonLayer}),o.o(Ye,"Popup")&&o.d(_,"Popup",function(){return Ye.Popup}),o.o(Ye,"PositionType")&&o.d(_,"PositionType",function(){return Ye.PositionType}),o.o(Ye,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Ye.RasterLayer}),o.o(Ye,"Scale")&&o.d(_,"Scale",function(){return Ye.Scale}),o.o(Ye,"Scene")&&o.d(_,"Scene",function(){return Ye.Scene}),o.o(Ye,"Zoom")&&o.d(_,"Zoom",function(){return Ye.Zoom}),o.o(Ye,"gl")&&o.d(_,"gl",function(){return Ye.gl});var nt=o("AGSj"),Ct=o.n(nt);o.o(nt,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return nt.CityBuildingLayer}),o.o(nt,"Control")&&o.d(_,"Control",function(){return nt.Control}),o.o(nt,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return nt.HeatmapLayer}),o.o(nt,"ImageLayer")&&o.d(_,"ImageLayer",function(){return nt.ImageLayer}),o.o(nt,"LineLayer")&&o.d(_,"LineLayer",function(){return nt.LineLayer}),o.o(nt,"Logo")&&o.d(_,"Logo",function(){return nt.Logo}),o.o(nt,"Marker")&&o.d(_,"Marker",function(){return nt.Marker}),o.o(nt,"PointLayer")&&o.d(_,"PointLayer",function(){return nt.PointLayer}),o.o(nt,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return nt.PolygonLayer}),o.o(nt,"Popup")&&o.d(_,"Popup",function(){return nt.Popup}),o.o(nt,"PositionType")&&o.d(_,"PositionType",function(){return nt.PositionType}),o.o(nt,"RasterLayer")&&o.d(_,"RasterLayer",function(){return nt.RasterLayer}),o.o(nt,"Scale")&&o.d(_,"Scale",function(){return nt.Scale}),o.o(nt,"Scene")&&o.d(_,"Scene",function(){return nt.Scene}),o.o(nt,"Zoom")&&o.d(_,"Zoom",function(){return nt.Zoom}),o.o(nt,"gl")&&o.d(_,"gl",function(){return nt.gl});var Ot=o("f7l1");o.d(_,"PositionType",function(){return Ot.a});var Re=o("JCi/"),Ie=o.n(Re);o.o(Re,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Re.CityBuildingLayer}),o.o(Re,"Control")&&o.d(_,"Control",function(){return Re.Control}),o.o(Re,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Re.HeatmapLayer}),o.o(Re,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Re.ImageLayer}),o.o(Re,"LineLayer")&&o.d(_,"LineLayer",function(){return Re.LineLayer}),o.o(Re,"Logo")&&o.d(_,"Logo",function(){return Re.Logo}),o.o(Re,"Marker")&&o.d(_,"Marker",function(){return Re.Marker}),o.o(Re,"PointLayer")&&o.d(_,"PointLayer",function(){return Re.PointLayer}),o.o(Re,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Re.PolygonLayer}),o.o(Re,"Popup")&&o.d(_,"Popup",function(){return Re.Popup}),o.o(Re,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Re.RasterLayer}),o.o(Re,"Scale")&&o.d(_,"Scale",function(){return Re.Scale}),o.o(Re,"Scene")&&o.d(_,"Scene",function(){return Re.Scene}),o.o(Re,"Zoom")&&o.d(_,"Zoom",function(){return Re.Zoom}),o.o(Re,"gl")&&o.d(_,"gl",function(){return Re.gl});var Be=o("J+x/"),ft=o.n(Be);o.o(Be,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Be.CityBuildingLayer}),o.o(Be,"Control")&&o.d(_,"Control",function(){return Be.Control}),o.o(Be,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Be.HeatmapLayer}),o.o(Be,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Be.ImageLayer}),o.o(Be,"LineLayer")&&o.d(_,"LineLayer",function(){return Be.LineLayer}),o.o(Be,"Logo")&&o.d(_,"Logo",function(){return Be.Logo}),o.o(Be,"Marker")&&o.d(_,"Marker",function(){return Be.Marker}),o.o(Be,"PointLayer")&&o.d(_,"PointLayer",function(){return Be.PointLayer}),o.o(Be,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Be.PolygonLayer}),o.o(Be,"Popup")&&o.d(_,"Popup",function(){return Be.Popup}),o.o(Be,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Be.RasterLayer}),o.o(Be,"Scale")&&o.d(_,"Scale",function(){return Be.Scale}),o.o(Be,"Scene")&&o.d(_,"Scene",function(){return Be.Scene}),o.o(Be,"Zoom")&&o.d(_,"Zoom",function(){return Be.Zoom}),o.o(Be,"gl")&&o.d(_,"gl",function(){return Be.gl});var Me=o("k77m"),ht=o.n(Me);o.o(Me,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Me.CityBuildingLayer}),o.o(Me,"Control")&&o.d(_,"Control",function(){return Me.Control}),o.o(Me,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Me.HeatmapLayer}),o.o(Me,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Me.ImageLayer}),o.o(Me,"LineLayer")&&o.d(_,"LineLayer",function(){return Me.LineLayer}),o.o(Me,"Logo")&&o.d(_,"Logo",function(){return Me.Logo}),o.o(Me,"Marker")&&o.d(_,"Marker",function(){return Me.Marker}),o.o(Me,"PointLayer")&&o.d(_,"PointLayer",function(){return Me.PointLayer}),o.o(Me,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Me.PolygonLayer}),o.o(Me,"Popup")&&o.d(_,"Popup",function(){return Me.Popup}),o.o(Me,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Me.RasterLayer}),o.o(Me,"Scale")&&o.d(_,"Scale",function(){return Me.Scale}),o.o(Me,"Scene")&&o.d(_,"Scene",function(){return Me.Scene}),o.o(Me,"Zoom")&&o.d(_,"Zoom",function(){return Me.Zoom}),o.o(Me,"gl")&&o.d(_,"gl",function(){return Me.gl});var Wt=o("4bLW"),Qt=o("tWiu"),ur=o.n(Qt);o.o(Qt,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Qt.CityBuildingLayer}),o.o(Qt,"Control")&&o.d(_,"Control",function(){return Qt.Control}),o.o(Qt,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Qt.HeatmapLayer}),o.o(Qt,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Qt.ImageLayer}),o.o(Qt,"LineLayer")&&o.d(_,"LineLayer",function(){return Qt.LineLayer}),o.o(Qt,"Logo")&&o.d(_,"Logo",function(){return Qt.Logo}),o.o(Qt,"Marker")&&o.d(_,"Marker",function(){return Qt.Marker}),o.o(Qt,"PointLayer")&&o.d(_,"PointLayer",function(){return Qt.PointLayer}),o.o(Qt,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Qt.PolygonLayer}),o.o(Qt,"Popup")&&o.d(_,"Popup",function(){return Qt.Popup}),o.o(Qt,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Qt.RasterLayer}),o.o(Qt,"Scale")&&o.d(_,"Scale",function(){return Qt.Scale}),o.o(Qt,"Scene")&&o.d(_,"Scene",function(){return Qt.Scene}),o.o(Qt,"Zoom")&&o.d(_,"Zoom",function(){return Qt.Zoom}),o.o(Qt,"gl")&&o.d(_,"gl",function(){return Qt.gl});var oe=o("lGr2"),J=o.n(oe);o.o(oe,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),o.o(oe,"Control")&&o.d(_,"Control",function(){return oe.Control}),o.o(oe,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return oe.HeatmapLayer}),o.o(oe,"ImageLayer")&&o.d(_,"ImageLayer",function(){return oe.ImageLayer}),o.o(oe,"LineLayer")&&o.d(_,"LineLayer",function(){return oe.LineLayer}),o.o(oe,"Logo")&&o.d(_,"Logo",function(){return oe.Logo}),o.o(oe,"Marker")&&o.d(_,"Marker",function(){return oe.Marker}),o.o(oe,"PointLayer")&&o.d(_,"PointLayer",function(){return oe.PointLayer}),o.o(oe,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return oe.PolygonLayer}),o.o(oe,"Popup")&&o.d(_,"Popup",function(){return oe.Popup}),o.o(oe,"RasterLayer")&&o.d(_,"RasterLayer",function(){return oe.RasterLayer}),o.o(oe,"Scale")&&o.d(_,"Scale",function(){return oe.Scale}),o.o(oe,"Scene")&&o.d(_,"Scene",function(){return oe.Scene}),o.o(oe,"Zoom")&&o.d(_,"Zoom",function(){return oe.Zoom}),o.o(oe,"gl")&&o.d(_,"gl",function(){return oe.gl});var H=o("j6rd"),Se=o.n(H);o.o(H,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return H.CityBuildingLayer}),o.o(H,"Control")&&o.d(_,"Control",function(){return H.Control}),o.o(H,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return H.HeatmapLayer}),o.o(H,"ImageLayer")&&o.d(_,"ImageLayer",function(){return H.ImageLayer}),o.o(H,"LineLayer")&&o.d(_,"LineLayer",function(){return H.LineLayer}),o.o(H,"Logo")&&o.d(_,"Logo",function(){return H.Logo}),o.o(H,"Marker")&&o.d(_,"Marker",function(){return H.Marker}),o.o(H,"PointLayer")&&o.d(_,"PointLayer",function(){return H.PointLayer}),o.o(H,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return H.PolygonLayer}),o.o(H,"Popup")&&o.d(_,"Popup",function(){return H.Popup}),o.o(H,"RasterLayer")&&o.d(_,"RasterLayer",function(){return H.RasterLayer}),o.o(H,"Scale")&&o.d(_,"Scale",function(){return H.Scale}),o.o(H,"Scene")&&o.d(_,"Scene",function(){return H.Scene}),o.o(H,"Zoom")&&o.d(_,"Zoom",function(){return H.Zoom}),o.o(H,"gl")&&o.d(_,"gl",function(){return H.gl});var be=o("+3kh"),_e=o.n(be);o.o(be,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return be.CityBuildingLayer}),o.o(be,"Control")&&o.d(_,"Control",function(){return be.Control}),o.o(be,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return be.HeatmapLayer}),o.o(be,"ImageLayer")&&o.d(_,"ImageLayer",function(){return be.ImageLayer}),o.o(be,"LineLayer")&&o.d(_,"LineLayer",function(){return be.LineLayer}),o.o(be,"Logo")&&o.d(_,"Logo",function(){return be.Logo}),o.o(be,"Marker")&&o.d(_,"Marker",function(){return be.Marker}),o.o(be,"PointLayer")&&o.d(_,"PointLayer",function(){return be.PointLayer}),o.o(be,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return be.PolygonLayer}),o.o(be,"Popup")&&o.d(_,"Popup",function(){return be.Popup}),o.o(be,"RasterLayer")&&o.d(_,"RasterLayer",function(){return be.RasterLayer}),o.o(be,"Scale")&&o.d(_,"Scale",function(){return be.Scale}),o.o(be,"Scene")&&o.d(_,"Scene",function(){return be.Scene}),o.o(be,"Zoom")&&o.d(_,"Zoom",function(){return be.Zoom}),o.o(be,"gl")&&o.d(_,"gl",function(){return be.gl});var me=o("f3cN"),it=o.n(me);o.o(me,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return me.CityBuildingLayer}),o.o(me,"Control")&&o.d(_,"Control",function(){return me.Control}),o.o(me,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return me.HeatmapLayer}),o.o(me,"ImageLayer")&&o.d(_,"ImageLayer",function(){return me.ImageLayer}),o.o(me,"LineLayer")&&o.d(_,"LineLayer",function(){return me.LineLayer}),o.o(me,"Logo")&&o.d(_,"Logo",function(){return me.Logo}),o.o(me,"Marker")&&o.d(_,"Marker",function(){return me.Marker}),o.o(me,"PointLayer")&&o.d(_,"PointLayer",function(){return me.PointLayer}),o.o(me,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return me.PolygonLayer}),o.o(me,"Popup")&&o.d(_,"Popup",function(){return me.Popup}),o.o(me,"RasterLayer")&&o.d(_,"RasterLayer",function(){return me.RasterLayer}),o.o(me,"Scale")&&o.d(_,"Scale",function(){return me.Scale}),o.o(me,"Scene")&&o.d(_,"Scene",function(){return me.Scene}),o.o(me,"Zoom")&&o.d(_,"Zoom",function(){return me.Zoom}),o.o(me,"gl")&&o.d(_,"gl",function(){return me.gl});var qt=o("p14H"),Pt=o("8FOW"),ve=o.n(Pt);o.o(Pt,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return Pt.CityBuildingLayer}),o.o(Pt,"Control")&&o.d(_,"Control",function(){return Pt.Control}),o.o(Pt,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return Pt.HeatmapLayer}),o.o(Pt,"ImageLayer")&&o.d(_,"ImageLayer",function(){return Pt.ImageLayer}),o.o(Pt,"LineLayer")&&o.d(_,"LineLayer",function(){return Pt.LineLayer}),o.o(Pt,"Logo")&&o.d(_,"Logo",function(){return Pt.Logo}),o.o(Pt,"Marker")&&o.d(_,"Marker",function(){return Pt.Marker}),o.o(Pt,"PointLayer")&&o.d(_,"PointLayer",function(){return Pt.PointLayer}),o.o(Pt,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return Pt.PolygonLayer}),o.o(Pt,"Popup")&&o.d(_,"Popup",function(){return Pt.Popup}),o.o(Pt,"RasterLayer")&&o.d(_,"RasterLayer",function(){return Pt.RasterLayer}),o.o(Pt,"Scale")&&o.d(_,"Scale",function(){return Pt.Scale}),o.o(Pt,"Scene")&&o.d(_,"Scene",function(){return Pt.Scene}),o.o(Pt,"Zoom")&&o.d(_,"Zoom",function(){return Pt.Zoom}),o.o(Pt,"gl")&&o.d(_,"gl",function(){return Pt.gl});var ge=o("eOrO"),Ve=o.n(ge);o.o(ge,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),o.o(ge,"Control")&&o.d(_,"Control",function(){return ge.Control}),o.o(ge,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return ge.HeatmapLayer}),o.o(ge,"ImageLayer")&&o.d(_,"ImageLayer",function(){return ge.ImageLayer}),o.o(ge,"LineLayer")&&o.d(_,"LineLayer",function(){return ge.LineLayer}),o.o(ge,"Logo")&&o.d(_,"Logo",function(){return ge.Logo}),o.o(ge,"Marker")&&o.d(_,"Marker",function(){return ge.Marker}),o.o(ge,"PointLayer")&&o.d(_,"PointLayer",function(){return ge.PointLayer}),o.o(ge,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return ge.PolygonLayer}),o.o(ge,"Popup")&&o.d(_,"Popup",function(){return ge.Popup}),o.o(ge,"RasterLayer")&&o.d(_,"RasterLayer",function(){return ge.RasterLayer}),o.o(ge,"Scale")&&o.d(_,"Scale",function(){return ge.Scale}),o.o(ge,"Scene")&&o.d(_,"Scene",function(){return ge.Scene}),o.o(ge,"Zoom")&&o.d(_,"Zoom",function(){return ge.Zoom}),o.o(ge,"gl")&&o.d(_,"gl",function(){return ge.gl});var st=o("3qw5"),Oe=o.n(st);o.o(st,"CityBuildingLayer")&&o.d(_,"CityBuildingLayer",function(){return st.CityBuildingLayer}),o.o(st,"Control")&&o.d(_,"Control",function(){return st.Control}),o.o(st,"HeatmapLayer")&&o.d(_,"HeatmapLayer",function(){return st.HeatmapLayer}),o.o(st,"ImageLayer")&&o.d(_,"ImageLayer",function(){return st.ImageLayer}),o.o(st,"LineLayer")&&o.d(_,"LineLayer",function(){return st.LineLayer}),o.o(st,"Logo")&&o.d(_,"Logo",function(){return st.Logo}),o.o(st,"Marker")&&o.d(_,"Marker",function(){return st.Marker}),o.o(st,"PointLayer")&&o.d(_,"PointLayer",function(){return st.PointLayer}),o.o(st,"PolygonLayer")&&o.d(_,"PolygonLayer",function(){return st.PolygonLayer}),o.o(st,"Popup")&&o.d(_,"Popup",function(){return st.Popup}),o.o(st,"RasterLayer")&&o.d(_,"RasterLayer",function(){return st.RasterLayer}),o.o(st,"Scale")&&o.d(_,"Scale",function(){return st.Scale}),o.o(st,"Scene")&&o.d(_,"Scene",function(){return st.Scene}),o.o(st,"Zoom")&&o.d(_,"Zoom",function(){return st.Zoom}),o.o(st,"gl")&&o.d(_,"gl",function(){return st.gl});var vt=o("Z+lO");o.d(_,"gl",function(){return vt.a})},"d/dq":function(Fe,_,o){"use strict";o.r(_),o.d(_,"create",function(){return p}),o.d(_,"clone",function(){return Y}),o.d(_,"fromValues",function(){return z}),o.d(_,"copy",function(){return i}),o.d(_,"set",function(){return Z}),o.d(_,"add",function(){return D}),o.d(_,"subtract",function(){return K}),o.d(_,"multiply",function(){return re}),o.d(_,"divide",function(){return fe}),o.d(_,"ceil",function(){return X}),o.d(_,"floor",function(){return He}),o.d(_,"min",function(){return Xe}),o.d(_,"max",function(){return pe}),o.d(_,"round",function(){return Ce}),o.d(_,"scale",function(){return mt}),o.d(_,"scaleAndAdd",function(){return Ne}),o.d(_,"distance",function(){return At}),o.d(_,"squaredDistance",function(){return Ye}),o.d(_,"length",function(){return Et}),o.d(_,"squaredLength",function(){return nt}),o.d(_,"negate",function(){return Ct}),o.d(_,"inverse",function(){return Ot}),o.d(_,"normalize",function(){return Re}),o.d(_,"dot",function(){return Ie}),o.d(_,"cross",function(){return Be}),o.d(_,"lerp",function(){return ft}),o.d(_,"random",function(){return Me}),o.d(_,"transformMat2",function(){return ht}),o.d(_,"transformMat2d",function(){return Wt}),o.d(_,"transformMat3",function(){return Qt}),o.d(_,"transformMat4",function(){return ur}),o.d(_,"rotate",function(){return oe}),o.d(_,"angle",function(){return J}),o.d(_,"zero",function(){return H}),o.d(_,"str",function(){return Se}),o.d(_,"exactEquals",function(){return be}),o.d(_,"equals",function(){return _e}),o.d(_,"len",function(){return me}),o.d(_,"sub",function(){return it}),o.d(_,"mul",function(){return qt}),o.d(_,"div",function(){return Pt}),o.d(_,"dist",function(){return ve}),o.d(_,"sqrDist",function(){return ge}),o.d(_,"sqrLen",function(){return Ve}),o.d(_,"forEach",function(){return st});var x=o("TaHB");function p(){var Oe=new x.a(2);return x.a!=Float32Array&&(Oe[0]=0,Oe[1]=0),Oe}function Y(Oe){var vt=new x.a(2);return vt[0]=Oe[0],vt[1]=Oe[1],vt}function z(Oe,vt){var C=new x.a(2);return C[0]=Oe,C[1]=vt,C}function i(Oe,vt){return Oe[0]=vt[0],Oe[1]=vt[1],Oe}function Z(Oe,vt,C){return Oe[0]=vt,Oe[1]=C,Oe}function D(Oe,vt,C){return Oe[0]=vt[0]+C[0],Oe[1]=vt[1]+C[1],Oe}function K(Oe,vt,C){return Oe[0]=vt[0]-C[0],Oe[1]=vt[1]-C[1],Oe}function re(Oe,vt,C){return Oe[0]=vt[0]*C[0],Oe[1]=vt[1]*C[1],Oe}function fe(Oe,vt,C){return Oe[0]=vt[0]/C[0],Oe[1]=vt[1]/C[1],Oe}function X(Oe,vt){return Oe[0]=Math.ceil(vt[0]),Oe[1]=Math.ceil(vt[1]),Oe}function He(Oe,vt){return Oe[0]=Math.floor(vt[0]),Oe[1]=Math.floor(vt[1]),Oe}function Xe(Oe,vt,C){return Oe[0]=Math.min(vt[0],C[0]),Oe[1]=Math.min(vt[1],C[1]),Oe}function pe(Oe,vt,C){return Oe[0]=Math.max(vt[0],C[0]),Oe[1]=Math.max(vt[1],C[1]),Oe}function Ce(Oe,vt){return Oe[0]=Math.round(vt[0]),Oe[1]=Math.round(vt[1]),Oe}function mt(Oe,vt,C){return Oe[0]=vt[0]*C,Oe[1]=vt[1]*C,Oe}function Ne(Oe,vt,C,R){return Oe[0]=vt[0]+C[0]*R,Oe[1]=vt[1]+C[1]*R,Oe}function At(Oe,vt){var C=vt[0]-Oe[0],R=vt[1]-Oe[1];return Math.hypot(C,R)}function Ye(Oe,vt){var C=vt[0]-Oe[0],R=vt[1]-Oe[1];return C*C+R*R}function Et(Oe){var vt=Oe[0],C=Oe[1];return Math.hypot(vt,C)}function nt(Oe){var vt=Oe[0],C=Oe[1];return vt*vt+C*C}function Ct(Oe,vt){return Oe[0]=-vt[0],Oe[1]=-vt[1],Oe}function Ot(Oe,vt){return Oe[0]=1/vt[0],Oe[1]=1/vt[1],Oe}function Re(Oe,vt){var C=vt[0],R=vt[1],q=C*C+R*R;return q>0&&(q=1/Math.sqrt(q)),Oe[0]=vt[0]*q,Oe[1]=vt[1]*q,Oe}function Ie(Oe,vt){return Oe[0]*vt[0]+Oe[1]*vt[1]}function Be(Oe,vt,C){var R=vt[0]*C[1]-vt[1]*C[0];return Oe[0]=Oe[1]=0,Oe[2]=R,Oe}function ft(Oe,vt,C,R){var q=vt[0],ce=vt[1];return Oe[0]=q+R*(C[0]-q),Oe[1]=ce+R*(C[1]-ce),Oe}function Me(Oe,vt){vt=vt||1;var C=x.c()*2*Math.PI;return Oe[0]=Math.cos(C)*vt,Oe[1]=Math.sin(C)*vt,Oe}function ht(Oe,vt,C){var R=vt[0],q=vt[1];return Oe[0]=C[0]*R+C[2]*q,Oe[1]=C[1]*R+C[3]*q,Oe}function Wt(Oe,vt,C){var R=vt[0],q=vt[1];return Oe[0]=C[0]*R+C[2]*q+C[4],Oe[1]=C[1]*R+C[3]*q+C[5],Oe}function Qt(Oe,vt,C){var R=vt[0],q=vt[1];return Oe[0]=C[0]*R+C[3]*q+C[6],Oe[1]=C[1]*R+C[4]*q+C[7],Oe}function ur(Oe,vt,C){var R=vt[0],q=vt[1];return Oe[0]=C[0]*R+C[4]*q+C[12],Oe[1]=C[1]*R+C[5]*q+C[13],Oe}function oe(Oe,vt,C,R){var q=vt[0]-C[0],ce=vt[1]-C[1],Ge=Math.sin(R),qe=Math.cos(R);return Oe[0]=q*qe-ce*Ge+C[0],Oe[1]=q*Ge+ce*qe+C[1],Oe}function J(Oe,vt){var C=Oe[0],R=Oe[1],q=vt[0],ce=vt[1],Ge=Math.sqrt(C*C+R*R)*Math.sqrt(q*q+ce*ce),qe=Ge&&(C*q+R*ce)/Ge;return Math.acos(Math.min(Math.max(qe,-1),1))}function H(Oe){return Oe[0]=0,Oe[1]=0,Oe}function Se(Oe){return"vec2("+Oe[0]+", "+Oe[1]+")"}function be(Oe,vt){return Oe[0]===vt[0]&&Oe[1]===vt[1]}function _e(Oe,vt){var C=Oe[0],R=Oe[1],q=vt[0],ce=vt[1];return Math.abs(C-q)<=x.b*Math.max(1,Math.abs(C),Math.abs(q))&&Math.abs(R-ce)<=x.b*Math.max(1,Math.abs(R),Math.abs(ce))}var me=Et,it=K,qt=re,Pt=fe,ve=At,ge=Ye,Ve=nt,st=function(){var Oe=p();return function(vt,C,R,q,ce,Ge){var qe,Tt;for(C||(C=2),R||(R=0),q?Tt=Math.min(q*C+R,vt.length):Tt=vt.length,qe=R;qe<Tt;qe+=C)Oe[0]=vt[qe],Oe[1]=vt[qe+1],ce(Oe,Oe,Ge),vt[qe]=Oe[0],vt[qe+1]=Oe[1];return vt}}()},d55j:function(Fe,_,o){var x=o("uB5b"),p=o("zVLJ");function Y(z,i,Z,D){var K=!Z;Z||(Z={});for(var re=-1,fe=i.length;++re<fe;){var X=i[re],He=D?D(Z[X],z[X],X,Z,z):void 0;He===void 0&&(He=z[X]),K?p(Z,X,He):x(Z,X,He)}return Z}Fe.exports=Y},dQxg:function(Fe,_,o){var x=o("p5w1"),p=o("ITHy"),Y=o("wndA");function z(i){return x(i,Y,p)}Fe.exports=z},dUl7:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("/jsB"),Y=o("Vrkw");function z(){return function(i,Z,D){var K=new Y.Metadata(p.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(p.POST_CONSTRUCT,i.constructor))throw new Error(x.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(p.POST_CONSTRUCT,K,i.constructor)}}_.postConstruct=z},eOrO:function(Fe,_){},eaIJ:function(Fe,_){function o(x){var p=[];if(x!=null)for(var Y in Object(x))p.push(Y);return p}Fe.exports=o},eodq:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("/jsB");function Y(){return function(z){if(Reflect.hasOwnMetadata(p.PARAM_TYPES,z))throw new Error(x.DUPLICATED_INJECTABLE_DECORATOR);var i=Reflect.getMetadata(p.DESIGN_PARAM_TYPES,z)||[];return Reflect.defineMetadata(p.PARAM_TYPES,i,z),z}}_.injectable=Y},"ez++":function(Fe,_){function o(x,p,Y){for(var z=Y-1,i=x.length;++z<i;)if(x[z]===p)return z;return-1}Fe.exports=o},f3cN:function(Fe,_){},f7l1:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x;(function(p){p.TOPRIGHT="topright",p.TOPLEFT="topleft",p.BOTTOMRIGHT="bottomright",p.BOTTOMLEFT="bottomleft"})(x||(x={}))},fOlB:function(Fe,_,o){var x=o("zOZK");function p(Y,z){var i=Y==null?0:Y.length;return!!i&&x(Y,z,0)>-1}Fe.exports=p},fWxm:function(Fe,_){function o(x){return x==null}Fe.exports=o},fvT1:function(Fe,_,o){"use strict";o.d(_,"a",function(){return Y}),o.d(_,"c",function(){return z}),o.d(_,"b",function(){return i}),o.d(_,"d",function(){return Z});var x={},p={},Y=function(K){return p[K]},z=function(K,re){p[K]=re},i=function(K){return x[K]},Z=function(K,re){x[K]=re}},g0Ch:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=function(){function Y(){}return Y.prototype.getConstructorMetadata=function(z){var i=Reflect.getMetadata(x.PARAM_TYPES,z),Z=Reflect.getMetadata(x.TAGGED,z);return{compilerGeneratedMetadata:i,userGeneratedMetadata:Z||{}}},Y.prototype.getPropertiesMetadata=function(z){var i=Reflect.getMetadata(x.TAGGED_PROP,z)||[];return i},Y}();_.MetadataReader=p},g2Np:function(Fe,_,o){"use strict";o.d(_,"a",function(){return Ct});var x={},p={},Y=34,z=10,i=13;function Z(Ot){return new Function("d","return {"+Ot.map(function(Re,Ie){return JSON.stringify(Re)+": d["+Ie+'] || ""'}).join(",")+"}")}function D(Ot,Re){var Ie=Z(Ot);return function(Be,ft){return Re(Ie(Be),ft,Ot)}}function K(Ot){var Re=Object.create(null),Ie=[];return Ot.forEach(function(Be){for(var ft in Be)ft in Re||Ie.push(Re[ft]=ft)}),Ie}function re(Ot,Re){var Ie=Ot+"",Be=Ie.length;return Be<Re?new Array(Re-Be+1).join(0)+Ie:Ie}function fe(Ot){return Ot<0?"-"+re(-Ot,6):Ot>9999?"+"+re(Ot,6):re(Ot,4)}function X(Ot){var Re=Ot.getUTCHours(),Ie=Ot.getUTCMinutes(),Be=Ot.getUTCSeconds(),ft=Ot.getUTCMilliseconds();return isNaN(Ot)?"Invalid Date":fe(Ot.getUTCFullYear(),4)+"-"+re(Ot.getUTCMonth()+1,2)+"-"+re(Ot.getUTCDate(),2)+(ft?"T"+re(Re,2)+":"+re(Ie,2)+":"+re(Be,2)+"."+re(ft,3)+"Z":Be?"T"+re(Re,2)+":"+re(Ie,2)+":"+re(Be,2)+"Z":Ie||Re?"T"+re(Re,2)+":"+re(Ie,2)+"Z":"")}var He=function(Ot){var Re=new RegExp('["'+Ot+`
\r]`),Ie=Ot.charCodeAt(0);function Be(J,H){var Se,be,_e=ft(J,function(me,it){if(Se)return Se(me,it-1);be=me,Se=H?D(me,H):Z(me)});return _e.columns=be||[],_e}function ft(J,H){var Se=[],be=J.length,_e=0,me=0,it,qt=be<=0,Pt=!1;J.charCodeAt(be-1)===z&&--be,J.charCodeAt(be-1)===i&&--be;function ve(){if(qt)return p;if(Pt)return Pt=!1,x;var Ve,st=_e,Oe;if(J.charCodeAt(st)===Y){for(;_e++<be&&J.charCodeAt(_e)!==Y||J.charCodeAt(++_e)===Y;);return(Ve=_e)>=be?qt=!0:(Oe=J.charCodeAt(_e++))===z?Pt=!0:Oe===i&&(Pt=!0,J.charCodeAt(_e)===z&&++_e),J.slice(st+1,Ve-1).replace(/""/g,'"')}for(;_e<be;){if((Oe=J.charCodeAt(Ve=_e++))===z)Pt=!0;else if(Oe===i)Pt=!0,J.charCodeAt(_e)===z&&++_e;else if(Oe!==Ie)continue;return J.slice(st,Ve)}return qt=!0,J.slice(st,be)}for(;(it=ve())!==p;){for(var ge=[];it!==x&&it!==p;)ge.push(it),it=ve();if(H&&(ge=H(ge,me++))==null)continue;Se.push(ge)}return Se}function Me(J,H){return J.map(function(Se){return H.map(function(be){return oe(Se[be])}).join(Ot)})}function ht(J,H){return H==null&&(H=K(J)),[H.map(oe).join(Ot)].concat(Me(J,H)).join(`
`)}function Wt(J,H){return H==null&&(H=K(J)),Me(J,H).join(`
`)}function Qt(J){return J.map(ur).join(`
`)}function ur(J){return J.map(oe).join(Ot)}function oe(J){return J==null?"":J instanceof Date?X(J):Re.test(J+="")?'"'+J.replace(/"/g,'""')+'"':J}return{parse:Be,parseRows:ft,format:ht,formatBody:Wt,formatRows:Qt,formatRow:ur,formatValue:oe}},Xe=He(","),pe=Xe.parse,Ce=Xe.parseRows,mt=Xe.format,Ne=Xe.formatBody,At=Xe.formatRows,Ye=Xe.formatRow,Et=Xe.formatValue,nt=o("ueXz");function Ct(Ot,Re){var Ie=pe(Ot);return Object(nt.a)(Ie,Re)}},gCNn:function(Fe,_,o){"use strict";o.r(_),o.d(_,"create",function(){return p}),o.d(_,"clone",function(){return Y}),o.d(_,"length",function(){return z}),o.d(_,"fromValues",function(){return i}),o.d(_,"copy",function(){return Z}),o.d(_,"set",function(){return D}),o.d(_,"add",function(){return K}),o.d(_,"subtract",function(){return re}),o.d(_,"multiply",function(){return fe}),o.d(_,"divide",function(){return X}),o.d(_,"ceil",function(){return He}),o.d(_,"floor",function(){return Xe}),o.d(_,"min",function(){return pe}),o.d(_,"max",function(){return Ce}),o.d(_,"round",function(){return mt}),o.d(_,"scale",function(){return Ne}),o.d(_,"scaleAndAdd",function(){return At}),o.d(_,"distance",function(){return Ye}),o.d(_,"squaredDistance",function(){return Et}),o.d(_,"squaredLength",function(){return nt}),o.d(_,"negate",function(){return Ct}),o.d(_,"inverse",function(){return Ot}),o.d(_,"normalize",function(){return Re}),o.d(_,"dot",function(){return Ie}),o.d(_,"cross",function(){return Be}),o.d(_,"lerp",function(){return ft}),o.d(_,"hermite",function(){return Me}),o.d(_,"bezier",function(){return ht}),o.d(_,"random",function(){return Wt}),o.d(_,"transformMat4",function(){return Qt}),o.d(_,"transformMat3",function(){return ur}),o.d(_,"transformQuat",function(){return oe}),o.d(_,"rotateX",function(){return J}),o.d(_,"rotateY",function(){return H}),o.d(_,"rotateZ",function(){return Se}),o.d(_,"angle",function(){return be}),o.d(_,"zero",function(){return _e}),o.d(_,"str",function(){return me}),o.d(_,"exactEquals",function(){return it}),o.d(_,"equals",function(){return qt}),o.d(_,"sub",function(){return Pt}),o.d(_,"mul",function(){return ve}),o.d(_,"div",function(){return ge}),o.d(_,"dist",function(){return Ve}),o.d(_,"sqrDist",function(){return st}),o.d(_,"len",function(){return Oe}),o.d(_,"sqrLen",function(){return vt}),o.d(_,"forEach",function(){return C});var x=o("TaHB");function p(){var R=new x.a(3);return x.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function Y(R){var q=new x.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function z(R){var q=R[0],ce=R[1],Ge=R[2];return Math.hypot(q,ce,Ge)}function i(R,q,ce){var Ge=new x.a(3);return Ge[0]=R,Ge[1]=q,Ge[2]=ce,Ge}function Z(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function D(R,q,ce,Ge){return R[0]=q,R[1]=ce,R[2]=Ge,R}function K(R,q,ce){return R[0]=q[0]+ce[0],R[1]=q[1]+ce[1],R[2]=q[2]+ce[2],R}function re(R,q,ce){return R[0]=q[0]-ce[0],R[1]=q[1]-ce[1],R[2]=q[2]-ce[2],R}function fe(R,q,ce){return R[0]=q[0]*ce[0],R[1]=q[1]*ce[1],R[2]=q[2]*ce[2],R}function X(R,q,ce){return R[0]=q[0]/ce[0],R[1]=q[1]/ce[1],R[2]=q[2]/ce[2],R}function He(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function Xe(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function pe(R,q,ce){return R[0]=Math.min(q[0],ce[0]),R[1]=Math.min(q[1],ce[1]),R[2]=Math.min(q[2],ce[2]),R}function Ce(R,q,ce){return R[0]=Math.max(q[0],ce[0]),R[1]=Math.max(q[1],ce[1]),R[2]=Math.max(q[2],ce[2]),R}function mt(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function Ne(R,q,ce){return R[0]=q[0]*ce,R[1]=q[1]*ce,R[2]=q[2]*ce,R}function At(R,q,ce,Ge){return R[0]=q[0]+ce[0]*Ge,R[1]=q[1]+ce[1]*Ge,R[2]=q[2]+ce[2]*Ge,R}function Ye(R,q){var ce=q[0]-R[0],Ge=q[1]-R[1],qe=q[2]-R[2];return Math.hypot(ce,Ge,qe)}function Et(R,q){var ce=q[0]-R[0],Ge=q[1]-R[1],qe=q[2]-R[2];return ce*ce+Ge*Ge+qe*qe}function nt(R){var q=R[0],ce=R[1],Ge=R[2];return q*q+ce*ce+Ge*Ge}function Ct(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function Ot(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function Re(R,q){var ce=q[0],Ge=q[1],qe=q[2],Tt=ce*ce+Ge*Ge+qe*qe;return Tt>0&&(Tt=1/Math.sqrt(Tt)),R[0]=q[0]*Tt,R[1]=q[1]*Tt,R[2]=q[2]*Tt,R}function Ie(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Be(R,q,ce){var Ge=q[0],qe=q[1],Tt=q[2],ot=ce[0],Ut=ce[1],$=ce[2];return R[0]=qe*$-Tt*Ut,R[1]=Tt*ot-Ge*$,R[2]=Ge*Ut-qe*ot,R}function ft(R,q,ce,Ge){var qe=q[0],Tt=q[1],ot=q[2];return R[0]=qe+Ge*(ce[0]-qe),R[1]=Tt+Ge*(ce[1]-Tt),R[2]=ot+Ge*(ce[2]-ot),R}function Me(R,q,ce,Ge,qe,Tt){var ot=Tt*Tt,Ut=ot*(2*Tt-3)+1,$=ot*(Tt-2)+Tt,Qe=ot*(Tt-1),ae=ot*(3-2*Tt);return R[0]=q[0]*Ut+ce[0]*$+Ge[0]*Qe+qe[0]*ae,R[1]=q[1]*Ut+ce[1]*$+Ge[1]*Qe+qe[1]*ae,R[2]=q[2]*Ut+ce[2]*$+Ge[2]*Qe+qe[2]*ae,R}function ht(R,q,ce,Ge,qe,Tt){var ot=1-Tt,Ut=ot*ot,$=Tt*Tt,Qe=Ut*ot,ae=3*Tt*Ut,et=3*$*ot,kt=$*Tt;return R[0]=q[0]*Qe+ce[0]*ae+Ge[0]*et+qe[0]*kt,R[1]=q[1]*Qe+ce[1]*ae+Ge[1]*et+qe[1]*kt,R[2]=q[2]*Qe+ce[2]*ae+Ge[2]*et+qe[2]*kt,R}function Wt(R,q){q=q||1;var ce=x.c()*2*Math.PI,Ge=x.c()*2-1,qe=Math.sqrt(1-Ge*Ge)*q;return R[0]=Math.cos(ce)*qe,R[1]=Math.sin(ce)*qe,R[2]=Ge*q,R}function Qt(R,q,ce){var Ge=q[0],qe=q[1],Tt=q[2],ot=ce[3]*Ge+ce[7]*qe+ce[11]*Tt+ce[15];return ot=ot||1,R[0]=(ce[0]*Ge+ce[4]*qe+ce[8]*Tt+ce[12])/ot,R[1]=(ce[1]*Ge+ce[5]*qe+ce[9]*Tt+ce[13])/ot,R[2]=(ce[2]*Ge+ce[6]*qe+ce[10]*Tt+ce[14])/ot,R}function ur(R,q,ce){var Ge=q[0],qe=q[1],Tt=q[2];return R[0]=Ge*ce[0]+qe*ce[3]+Tt*ce[6],R[1]=Ge*ce[1]+qe*ce[4]+Tt*ce[7],R[2]=Ge*ce[2]+qe*ce[5]+Tt*ce[8],R}function oe(R,q,ce){var Ge=ce[0],qe=ce[1],Tt=ce[2],ot=ce[3],Ut=q[0],$=q[1],Qe=q[2],ae=qe*Qe-Tt*$,et=Tt*Ut-Ge*Qe,kt=Ge*$-qe*Ut,pr=qe*kt-Tt*et,Ke=Tt*ae-Ge*kt,bt=Ge*et-qe*ae,yt=ot*2;return ae*=yt,et*=yt,kt*=yt,pr*=2,Ke*=2,bt*=2,R[0]=Ut+ae+pr,R[1]=$+et+Ke,R[2]=Qe+kt+bt,R}function J(R,q,ce,Ge){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[0],Tt[1]=qe[1]*Math.cos(Ge)-qe[2]*Math.sin(Ge),Tt[2]=qe[1]*Math.sin(Ge)+qe[2]*Math.cos(Ge),R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function H(R,q,ce,Ge){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[2]*Math.sin(Ge)+qe[0]*Math.cos(Ge),Tt[1]=qe[1],Tt[2]=qe[2]*Math.cos(Ge)-qe[0]*Math.sin(Ge),R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function Se(R,q,ce,Ge){var qe=[],Tt=[];return qe[0]=q[0]-ce[0],qe[1]=q[1]-ce[1],qe[2]=q[2]-ce[2],Tt[0]=qe[0]*Math.cos(Ge)-qe[1]*Math.sin(Ge),Tt[1]=qe[0]*Math.sin(Ge)+qe[1]*Math.cos(Ge),Tt[2]=qe[2],R[0]=Tt[0]+ce[0],R[1]=Tt[1]+ce[1],R[2]=Tt[2]+ce[2],R}function be(R,q){var ce=R[0],Ge=R[1],qe=R[2],Tt=q[0],ot=q[1],Ut=q[2],$=Math.sqrt(ce*ce+Ge*Ge+qe*qe),Qe=Math.sqrt(Tt*Tt+ot*ot+Ut*Ut),ae=$*Qe,et=ae&&Ie(R,q)/ae;return Math.acos(Math.min(Math.max(et,-1),1))}function _e(R){return R[0]=0,R[1]=0,R[2]=0,R}function me(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function it(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function qt(R,q){var ce=R[0],Ge=R[1],qe=R[2],Tt=q[0],ot=q[1],Ut=q[2];return Math.abs(ce-Tt)<=x.b*Math.max(1,Math.abs(ce),Math.abs(Tt))&&Math.abs(Ge-ot)<=x.b*Math.max(1,Math.abs(Ge),Math.abs(ot))&&Math.abs(qe-Ut)<=x.b*Math.max(1,Math.abs(qe),Math.abs(Ut))}var Pt=re,ve=fe,ge=X,Ve=Ye,st=Et,Oe=z,vt=nt,C=function(){var R=p();return function(q,ce,Ge,qe,Tt,ot){var Ut,$;for(ce||(ce=3),Ge||(Ge=0),qe?$=Math.min(qe*ce+Ge,q.length):$=q.length,Ut=Ge;Ut<$;Ut+=ce)R[0]=q[Ut],R[1]=q[Ut+1],R[2]=q[Ut+2],Tt(R,R,ot),q[Ut]=R[0],q[Ut+1]=R[1],q[Ut+2]=R[2];return q}}()},gkfd:function(Fe,_){},hSzU:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("9R00"),p=o("D6nA"),Y=function(){function z(i){this._binding=i,this._bindingWhenSyntax=new p.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new x.BindingOnSyntax(this._binding)}return z.prototype.when=function(i){return this._bindingWhenSyntax.when(i)},z.prototype.whenTargetNamed=function(i){return this._bindingWhenSyntax.whenTargetNamed(i)},z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},z.prototype.whenTargetTagged=function(i,Z){return this._bindingWhenSyntax.whenTargetTagged(i,Z)},z.prototype.whenInjectedInto=function(i){return this._bindingWhenSyntax.whenInjectedInto(i)},z.prototype.whenParentNamed=function(i){return this._bindingWhenSyntax.whenParentNamed(i)},z.prototype.whenParentTagged=function(i,Z){return this._bindingWhenSyntax.whenParentTagged(i,Z)},z.prototype.whenAnyAncestorIs=function(i){return this._bindingWhenSyntax.whenAnyAncestorIs(i)},z.prototype.whenNoAncestorIs=function(i){return this._bindingWhenSyntax.whenNoAncestorIs(i)},z.prototype.whenAnyAncestorNamed=function(i){return this._bindingWhenSyntax.whenAnyAncestorNamed(i)},z.prototype.whenAnyAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(i,Z)},z.prototype.whenNoAncestorNamed=function(i){return this._bindingWhenSyntax.whenNoAncestorNamed(i)},z.prototype.whenNoAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(i,Z)},z.prototype.whenAnyAncestorMatches=function(i){return this._bindingWhenSyntax.whenAnyAncestorMatches(i)},z.prototype.whenNoAncestorMatches=function(i){return this._bindingWhenSyntax.whenNoAncestorMatches(i)},z.prototype.onActivation=function(i){return this._bindingOnSyntax.onActivation(i)},z}();_.BindingWhenOnSyntax=Y},hTab:function(Fe,_,o){var x;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(p,Y,z,i){"use strict";var Z=["","webkit","Moz","MS","ms","o"],D=Y.createElement("div"),K="function",re=Math.round,fe=Math.abs,X=Date.now;function He(Vt,Le,Dt){return setTimeout(Et(Vt,Dt),Le)}function Xe(Vt,Le,Dt){return Array.isArray(Vt)?(pe(Vt,Dt[Le],Dt),!0):!1}function pe(Vt,Le,Dt){var vr;if(!Vt)return;if(Vt.forEach)Vt.forEach(Le,Dt);else if(Vt.length!==i)for(vr=0;vr<Vt.length;)Le.call(Dt,Vt[vr],vr,Vt),vr++;else for(vr in Vt)Vt.hasOwnProperty(vr)&&Le.call(Dt,Vt[vr],vr,Vt)}function Ce(Vt,Le,Dt){var vr="DEPRECATED METHOD: "+Le+`
`+Dt+` AT 
`;return function(){var en=new Error("get-stack-trace"),_n=en&&en.stack?en.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Gn=p.console&&(p.console.warn||p.console.log);return Gn&&Gn.call(p.console,vr,_n),Vt.apply(this,arguments)}}var mt;typeof Object.assign!="function"?mt=function(Le){if(Le===i||Le===null)throw new TypeError("Cannot convert undefined or null to object");for(var Dt=Object(Le),vr=1;vr<arguments.length;vr++){var en=arguments[vr];if(en!==i&&en!==null)for(var _n in en)en.hasOwnProperty(_n)&&(Dt[_n]=en[_n])}return Dt}:mt=Object.assign;var Ne=Ce(function(Le,Dt,vr){for(var en=Object.keys(Dt),_n=0;_n<en.length;)(!vr||vr&&Le[en[_n]]===i)&&(Le[en[_n]]=Dt[en[_n]]),_n++;return Le},"extend","Use `assign`."),At=Ce(function(Le,Dt){return Ne(Le,Dt,!0)},"merge","Use `assign`.");function Ye(Vt,Le,Dt){var vr=Le.prototype,en;en=Vt.prototype=Object.create(vr),en.constructor=Vt,en._super=vr,Dt&&mt(en,Dt)}function Et(Vt,Le){return function(){return Vt.apply(Le,arguments)}}function nt(Vt,Le){return typeof Vt==K?Vt.apply(Le&&Le[0]||i,Le):Vt}function Ct(Vt,Le){return Vt===i?Le:Vt}function Ot(Vt,Le,Dt){pe(ft(Le),function(vr){Vt.addEventListener(vr,Dt,!1)})}function Re(Vt,Le,Dt){pe(ft(Le),function(vr){Vt.removeEventListener(vr,Dt,!1)})}function Ie(Vt,Le){for(;Vt;){if(Vt==Le)return!0;Vt=Vt.parentNode}return!1}function Be(Vt,Le){return Vt.indexOf(Le)>-1}function ft(Vt){return Vt.trim().split(/\s+/g)}function Me(Vt,Le,Dt){if(Vt.indexOf&&!Dt)return Vt.indexOf(Le);for(var vr=0;vr<Vt.length;){if(Dt&&Vt[vr][Dt]==Le||!Dt&&Vt[vr]===Le)return vr;vr++}return-1}function ht(Vt){return Array.prototype.slice.call(Vt,0)}function Wt(Vt,Le,Dt){for(var vr=[],en=[],_n=0;_n<Vt.length;){var Gn=Le?Vt[_n][Le]:Vt[_n];Me(en,Gn)<0&&vr.push(Vt[_n]),en[_n]=Gn,_n++}return Dt&&(Le?vr=vr.sort(function(po,mo){return po[Le]>mo[Le]}):vr=vr.sort()),vr}function Qt(Vt,Le){for(var Dt,vr,en=Le[0].toUpperCase()+Le.slice(1),_n=0;_n<Z.length;){if(Dt=Z[_n],vr=Dt?Dt+en:Le,vr in Vt)return vr;_n++}return i}var ur=1;function oe(){return ur++}function J(Vt){var Le=Vt.ownerDocument||Vt;return Le.defaultView||Le.parentWindow||p}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Se="ontouchstart"in p,be=Qt(p,"PointerEvent")!==i,_e=Se&&H.test(navigator.userAgent),me="touch",it="pen",qt="mouse",Pt="kinect",ve=25,ge=1,Ve=2,st=4,Oe=8,vt=1,C=2,R=4,q=8,ce=16,Ge=C|R,qe=q|ce,Tt=Ge|qe,ot=["x","y"],Ut=["clientX","clientY"];function $(Vt,Le){var Dt=this;this.manager=Vt,this.callback=Le,this.element=Vt.element,this.target=Vt.options.inputTarget,this.domHandler=function(vr){nt(Vt.options.enable,[Vt])&&Dt.handler(vr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&Ot(this.element,this.evEl,this.domHandler),this.evTarget&&Ot(this.target,this.evTarget,this.domHandler),this.evWin&&Ot(J(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Re(this.element,this.evEl,this.domHandler),this.evTarget&&Re(this.target,this.evTarget,this.domHandler),this.evWin&&Re(J(this.element),this.evWin,this.domHandler)}};function Qe(Vt){var Le,Dt=Vt.options.inputClass;return Dt?Le=Dt:be?Le=Cn:_e?Le=Ze:Se?Le=Gr:Le=Vn,new Le(Vt,ae)}function ae(Vt,Le,Dt){var vr=Dt.pointers.length,en=Dt.changedPointers.length,_n=Le&ge&&vr-en===0,Gn=Le&(st|Oe)&&vr-en===0;Dt.isFirst=!!_n,Dt.isFinal=!!Gn,_n&&(Vt.session={}),Dt.eventType=Le,et(Vt,Dt),Vt.emit("hammer.input",Dt),Vt.recognize(Dt),Vt.session.prevInput=Dt}function et(Vt,Le){var Dt=Vt.session,vr=Le.pointers,en=vr.length;Dt.firstInput||(Dt.firstInput=Ke(Le)),en>1&&!Dt.firstMultiple?Dt.firstMultiple=Ke(Le):en===1&&(Dt.firstMultiple=!1);var _n=Dt.firstInput,Gn=Dt.firstMultiple,Mi=Gn?Gn.center:_n.center,po=Le.center=bt(vr);Le.timeStamp=X(),Le.deltaTime=Le.timeStamp-_n.timeStamp,Le.angle=dt(Mi,po),Le.distance=ze(Mi,po),kt(Dt,Le),Le.offsetDirection=xt(Le.deltaX,Le.deltaY);var mo=yt(Le.deltaTime,Le.deltaX,Le.deltaY);Le.overallVelocityX=mo.x,Le.overallVelocityY=mo.y,Le.overallVelocity=fe(mo.x)>fe(mo.y)?mo.x:mo.y,Le.scale=Gn?Ht(Gn.pointers,vr):1,Le.rotation=Gn?gt(Gn.pointers,vr):0,Le.maxPointers=Dt.prevInput?Le.pointers.length>Dt.prevInput.maxPointers?Le.pointers.length:Dt.prevInput.maxPointers:Le.pointers.length,pr(Dt,Le);var Mo=Vt.element;Ie(Le.srcEvent.target,Mo)&&(Mo=Le.srcEvent.target),Le.target=Mo}function kt(Vt,Le){var Dt=Le.center,vr=Vt.offsetDelta||{},en=Vt.prevDelta||{},_n=Vt.prevInput||{};(Le.eventType===ge||_n.eventType===st)&&(en=Vt.prevDelta={x:_n.deltaX||0,y:_n.deltaY||0},vr=Vt.offsetDelta={x:Dt.x,y:Dt.y}),Le.deltaX=en.x+(Dt.x-vr.x),Le.deltaY=en.y+(Dt.y-vr.y)}function pr(Vt,Le){var Dt=Vt.lastInterval||Le,vr=Le.timeStamp-Dt.timeStamp,en,_n,Gn,Mi;if(Le.eventType!=Oe&&(vr>ve||Dt.velocity===i)){var po=Le.deltaX-Dt.deltaX,mo=Le.deltaY-Dt.deltaY,Mo=yt(vr,po,mo);_n=Mo.x,Gn=Mo.y,en=fe(Mo.x)>fe(Mo.y)?Mo.x:Mo.y,Mi=xt(po,mo),Vt.lastInterval=Le}else en=Dt.velocity,_n=Dt.velocityX,Gn=Dt.velocityY,Mi=Dt.direction;Le.velocity=en,Le.velocityX=_n,Le.velocityY=Gn,Le.direction=Mi}function Ke(Vt){for(var Le=[],Dt=0;Dt<Vt.pointers.length;)Le[Dt]={clientX:re(Vt.pointers[Dt].clientX),clientY:re(Vt.pointers[Dt].clientY)},Dt++;return{timeStamp:X(),pointers:Le,center:bt(Le),deltaX:Vt.deltaX,deltaY:Vt.deltaY}}function bt(Vt){var Le=Vt.length;if(Le===1)return{x:re(Vt[0].clientX),y:re(Vt[0].clientY)};for(var Dt=0,vr=0,en=0;en<Le;)Dt+=Vt[en].clientX,vr+=Vt[en].clientY,en++;return{x:re(Dt/Le),y:re(vr/Le)}}function yt(Vt,Le,Dt){return{x:Le/Vt||0,y:Dt/Vt||0}}function xt(Vt,Le){return Vt===Le?vt:fe(Vt)>=fe(Le)?Vt<0?C:R:Le<0?q:ce}function ze(Vt,Le,Dt){Dt||(Dt=ot);var vr=Le[Dt[0]]-Vt[Dt[0]],en=Le[Dt[1]]-Vt[Dt[1]];return Math.sqrt(vr*vr+en*en)}function dt(Vt,Le,Dt){Dt||(Dt=ot);var vr=Le[Dt[0]]-Vt[Dt[0]],en=Le[Dt[1]]-Vt[Dt[1]];return Math.atan2(en,vr)*180/Math.PI}function gt(Vt,Le){return dt(Le[1],Le[0],Ut)+dt(Vt[1],Vt[0],Ut)}function Ht(Vt,Le){return ze(Le[0],Le[1],Ut)/ze(Vt[0],Vt[1],Ut)}var hr={mousedown:ge,mousemove:Ve,mouseup:st},Zr="mousedown",yr="mousemove mouseup";function Vn(){this.evEl=Zr,this.evWin=yr,this.pressed=!1,$.apply(this,arguments)}Ye(Vn,$,{handler:function(Le){var Dt=hr[Le.type];if(Dt&ge&&Le.button===0&&(this.pressed=!0),Dt&Ve&&Le.which!==1&&(Dt=st),!this.pressed)return;Dt&st&&(this.pressed=!1),this.callback(this.manager,Dt,{pointers:[Le],changedPointers:[Le],pointerType:qt,srcEvent:Le})}});var Fn={pointerdown:ge,pointermove:Ve,pointerup:st,pointercancel:Oe,pointerout:Oe},oa={2:me,3:it,4:qt,5:Pt},$n="pointerdown",Kn="pointermove pointerup pointercancel";p.MSPointerEvent&&!p.PointerEvent&&($n="MSPointerDown",Kn="MSPointerMove MSPointerUp MSPointerCancel");function Cn(){this.evEl=$n,this.evWin=Kn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Ye(Cn,$,{handler:function(Le){var Dt=this.store,vr=!1,en=Le.type.toLowerCase().replace("ms",""),_n=Fn[en],Gn=oa[Le.pointerType]||Le.pointerType,Mi=Gn==me,po=Me(Dt,Le.pointerId,"pointerId");if(_n&ge&&(Le.button===0||Mi)?po<0&&(Dt.push(Le),po=Dt.length-1):_n&(st|Oe)&&(vr=!0),po<0)return;Dt[po]=Le,this.callback(this.manager,_n,{pointers:Dt,changedPointers:[Le],pointerType:Gn,srcEvent:Le}),vr&&Dt.splice(po,1)}});var F={touchstart:ge,touchmove:Ve,touchend:st,touchcancel:Oe},W="touchstart",le="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=W,this.evWin=le,this.started=!1,$.apply(this,arguments)}Ye(xe,$,{handler:function(Le){var Dt=F[Le.type];if(Dt===ge&&(this.started=!0),!this.started)return;var vr=ut.call(this,Le,Dt);Dt&(st|Oe)&&vr[0].length-vr[1].length===0&&(this.started=!1),this.callback(this.manager,Dt,{pointers:vr[0],changedPointers:vr[1],pointerType:me,srcEvent:Le})}});function ut(Vt,Le){var Dt=ht(Vt.touches),vr=ht(Vt.changedTouches);return Le&(st|Oe)&&(Dt=Wt(Dt.concat(vr),"identifier",!0)),[Dt,vr]}var wt={touchstart:ge,touchmove:Ve,touchend:st,touchcancel:Oe},Bt="touchstart touchmove touchend touchcancel";function Ze(){this.evTarget=Bt,this.targetIds={},$.apply(this,arguments)}Ye(Ze,$,{handler:function(Le){var Dt=wt[Le.type],vr=Rt.call(this,Le,Dt);if(!vr)return;this.callback(this.manager,Dt,{pointers:vr[0],changedPointers:vr[1],pointerType:me,srcEvent:Le})}});function Rt(Vt,Le){var Dt=ht(Vt.touches),vr=this.targetIds;if(Le&(ge|Ve)&&Dt.length===1)return vr[Dt[0].identifier]=!0,[Dt,Dt];var en,_n,Gn=ht(Vt.changedTouches),Mi=[],po=this.target;if(_n=Dt.filter(function(mo){return Ie(mo.target,po)}),Le===ge)for(en=0;en<_n.length;)vr[_n[en].identifier]=!0,en++;for(en=0;en<Gn.length;)vr[Gn[en].identifier]&&Mi.push(Gn[en]),Le&(st|Oe)&&delete vr[Gn[en].identifier],en++;return Mi.length?[Wt(_n.concat(Mi),"identifier",!0),Mi]:void 0}var lr=2500,Ur=25;function Gr(){$.apply(this,arguments);var Vt=Et(this.handler,this);this.touch=new Ze(this.manager,Vt),this.mouse=new Vn(this.manager,Vt),this.primaryTouch=null,this.lastTouches=[]}Ye(Gr,$,{handler:function(Le,Dt,vr){var en=vr.pointerType==me,_n=vr.pointerType==qt;if(_n&&vr.sourceCapabilities&&vr.sourceCapabilities.firesTouchEvents)return;if(en)cr.call(this,Dt,vr);else if(_n&&wn.call(this,vr))return;this.callback(Le,Dt,vr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function cr(Vt,Le){Vt&ge?(this.primaryTouch=Le.changedPointers[0].identifier,Br.call(this,Le)):Vt&(st|Oe)&&Br.call(this,Le)}function Br(Vt){var Le=Vt.changedPointers[0];if(Le.identifier===this.primaryTouch){var Dt={x:Le.clientX,y:Le.clientY};this.lastTouches.push(Dt);var vr=this.lastTouches,en=function(){var Gn=vr.indexOf(Dt);Gn>-1&&vr.splice(Gn,1)};setTimeout(en,lr)}}function wn(Vt){for(var Le=Vt.srcEvent.clientX,Dt=Vt.srcEvent.clientY,vr=0;vr<this.lastTouches.length;vr++){var en=this.lastTouches[vr],_n=Math.abs(Le-en.x),Gn=Math.abs(Dt-en.y);if(_n<=Ur&&Gn<=Ur)return!0}return!1}var fn=Qt(D.style,"touchAction"),tr=fn!==i,rn="compute",dn="auto",En="manipulation",bn="none",gn="pan-x",Mn="pan-y",Ga=Ia();function ga(Vt,Le){this.manager=Vt,this.set(Le)}ga.prototype={set:function(Le){Le==rn&&(Le=this.compute()),tr&&this.manager.element.style&&Ga[Le]&&(this.manager.element.style[fn]=Le),this.actions=Le.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Le=[];return pe(this.manager.recognizers,function(Dt){nt(Dt.options.enable,[Dt])&&(Le=Le.concat(Dt.getTouchAction()))}),Ma(Le.join(" "))},preventDefaults:function(Le){var Dt=Le.srcEvent,vr=Le.offsetDirection;if(this.manager.session.prevented){Dt.preventDefault();return}var en=this.actions,_n=Be(en,bn)&&!Ga[bn],Gn=Be(en,Mn)&&!Ga[Mn],Mi=Be(en,gn)&&!Ga[gn];if(_n){var po=Le.pointers.length===1,mo=Le.distance<2,Mo=Le.deltaTime<250;if(po&&mo&&Mo)return}if(Mi&&Gn)return;if(_n||Gn&&vr&Ge||Mi&&vr&qe)return this.preventSrc(Dt)},preventSrc:function(Le){this.manager.session.prevented=!0,Le.preventDefault()}};function Ma(Vt){if(Be(Vt,bn))return bn;var Le=Be(Vt,gn),Dt=Be(Vt,Mn);return Le&&Dt?bn:Le||Dt?Le?gn:Mn:Be(Vt,En)?En:dn}function Ia(){if(!tr)return!1;var Vt={},Le=p.CSS&&p.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Dt){Vt[Dt]=Le?p.CSS.supports("touch-action",Dt):!0}),Vt}var Wi=1,da=2,vi=4,ya=8,ba=ya,ha=16,wi=32;function is(Vt){this.options=mt({},this.defaults,Vt||{}),this.id=oe(),this.manager=null,this.options.enable=Ct(this.options.enable,!0),this.state=Wi,this.simultaneous={},this.requireFail=[]}is.prototype={defaults:{},set:function(Le){return mt(this.options,Le),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Le){if(Xe(Le,"recognizeWith",this))return this;var Dt=this.simultaneous;return Le=Du(Le,this),Dt[Le.id]||(Dt[Le.id]=Le,Le.recognizeWith(this)),this},dropRecognizeWith:function(Le){return Xe(Le,"dropRecognizeWith",this)?this:(Le=Du(Le,this),delete this.simultaneous[Le.id],this)},requireFailure:function(Le){if(Xe(Le,"requireFailure",this))return this;var Dt=this.requireFail;return Le=Du(Le,this),Me(Dt,Le)===-1&&(Dt.push(Le),Le.requireFailure(this)),this},dropRequireFailure:function(Le){if(Xe(Le,"dropRequireFailure",this))return this;Le=Du(Le,this);var Dt=Me(this.requireFail,Le);return Dt>-1&&this.requireFail.splice(Dt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Le){return!!this.simultaneous[Le.id]},emit:function(Le){var Dt=this,vr=this.state;function en(_n){Dt.manager.emit(_n,Le)}vr<ya&&en(Dt.options.event+Xi(vr)),en(Dt.options.event),Le.additionalEvent&&en(Le.additionalEvent),vr>=ya&&en(Dt.options.event+Xi(vr))},tryEmit:function(Le){if(this.canEmit())return this.emit(Le);this.state=wi},canEmit:function(){for(var Le=0;Le<this.requireFail.length;){if(!(this.requireFail[Le].state&(wi|Wi)))return!1;Le++}return!0},recognize:function(Le){var Dt=mt({},Le);if(!nt(this.options.enable,[this,Dt])){this.reset(),this.state=wi;return}this.state&(ba|ha|wi)&&(this.state=Wi),this.state=this.process(Dt),this.state&(da|vi|ya|ha)&&this.tryEmit(Dt)},process:function(Le){},getTouchAction:function(){},reset:function(){}};function Xi(Vt){return Vt&ha?"cancel":Vt&ya?"end":Vt&vi?"move":Vt&da?"start":""}function Xo(Vt){return Vt==ce?"down":Vt==q?"up":Vt==C?"left":Vt==R?"right":""}function Du(Vt,Le){var Dt=Le.manager;return Dt?Dt.get(Vt):Vt}function Ha(){is.apply(this,arguments)}Ye(Ha,is,{defaults:{pointers:1},attrTest:function(Le){var Dt=this.options.pointers;return Dt===0||Le.pointers.length===Dt},process:function(Le){var Dt=this.state,vr=Le.eventType,en=Dt&(da|vi),_n=this.attrTest(Le);return en&&(vr&Oe||!_n)?Dt|ha:en||_n?vr&st?Dt|ya:Dt&da?Dt|vi:da:wi}});function Oi(){Ha.apply(this,arguments),this.pX=null,this.pY=null}Ye(Oi,Ha,{defaults:{event:"pan",threshold:10,pointers:1,direction:Tt},getTouchAction:function(){var Le=this.options.direction,Dt=[];return Le&Ge&&Dt.push(Mn),Le&qe&&Dt.push(gn),Dt},directionTest:function(Le){var Dt=this.options,vr=!0,en=Le.distance,_n=Le.direction,Gn=Le.deltaX,Mi=Le.deltaY;return _n&Dt.direction||(Dt.direction&Ge?(_n=Gn===0?vt:Gn<0?C:R,vr=Gn!=this.pX,en=Math.abs(Le.deltaX)):(_n=Mi===0?vt:Mi<0?q:ce,vr=Mi!=this.pY,en=Math.abs(Le.deltaY))),Le.direction=_n,vr&&en>Dt.threshold&&_n&Dt.direction},attrTest:function(Le){return Ha.prototype.attrTest.call(this,Le)&&(this.state&da||!(this.state&da)&&this.directionTest(Le))},emit:function(Le){this.pX=Le.deltaX,this.pY=Le.deltaY;var Dt=Xo(Le.direction);Dt&&(Le.additionalEvent=this.options.event+Dt),this._super.emit.call(this,Le)}});function Jo(){Ha.apply(this,arguments)}Ye(Jo,Ha,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.scale-1)>this.options.threshold||this.state&da)},emit:function(Le){if(Le.scale!==1){var Dt=Le.scale<1?"in":"out";Le.additionalEvent=this.options.event+Dt}this._super.emit.call(this,Le)}});function ui(){is.apply(this,arguments),this._timer=null,this._input=null}Ye(ui,is,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dn]},process:function(Le){var Dt=this.options,vr=Le.pointers.length===Dt.pointers,en=Le.distance<Dt.threshold,_n=Le.deltaTime>Dt.time;if(this._input=Le,!en||!vr||Le.eventType&(st|Oe)&&!_n)this.reset();else if(Le.eventType&ge)this.reset(),this._timer=He(function(){this.state=ba,this.tryEmit()},Dt.time,this);else if(Le.eventType&st)return ba;return wi},reset:function(){clearTimeout(this._timer)},emit:function(Le){if(this.state!==ba)return;Le&&Le.eventType&st?this.manager.emit(this.options.event+"up",Le):(this._input.timeStamp=X(),this.manager.emit(this.options.event,this._input))}});function Yi(){Ha.apply(this,arguments)}Ye(Yi,Ha,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.rotation)>this.options.threshold||this.state&da)}});function Oo(){Ha.apply(this,arguments)}Ye(Oo,Ha,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ge|qe,pointers:1},getTouchAction:function(){return Oi.prototype.getTouchAction.call(this)},attrTest:function(Le){var Dt=this.options.direction,vr;return Dt&(Ge|qe)?vr=Le.overallVelocity:Dt&Ge?vr=Le.overallVelocityX:Dt&qe&&(vr=Le.overallVelocityY),this._super.attrTest.call(this,Le)&&Dt&Le.offsetDirection&&Le.distance>this.options.threshold&&Le.maxPointers==this.options.pointers&&fe(vr)>this.options.velocity&&Le.eventType&st},emit:function(Le){var Dt=Xo(Le.offsetDirection);Dt&&this.manager.emit(this.options.event+Dt,Le),this.manager.emit(this.options.event,Le)}});function Za(){is.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Ye(Za,is,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[En]},process:function(Le){var Dt=this.options,vr=Le.pointers.length===Dt.pointers,en=Le.distance<Dt.threshold,_n=Le.deltaTime<Dt.time;if(this.reset(),Le.eventType&ge&&this.count===0)return this.failTimeout();if(en&&_n&&vr){if(Le.eventType!=st)return this.failTimeout();var Gn=this.pTime?Le.timeStamp-this.pTime<Dt.interval:!0,Mi=!this.pCenter||ze(this.pCenter,Le.center)<Dt.posThreshold;this.pTime=Le.timeStamp,this.pCenter=Le.center,!Mi||!Gn?this.count=1:this.count+=1,this._input=Le;var po=this.count%Dt.taps;if(po===0)return this.hasRequireFailures()?(this._timer=He(function(){this.state=ba,this.tryEmit()},Dt.interval,this),da):ba}return wi},failTimeout:function(){return this._timer=He(function(){this.state=wi},this.options.interval,this),wi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ba&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(Vt,Le){return Le=Le||{},Le.recognizers=Ct(Le.recognizers,oo.defaults.preset),new Qo(Vt,Le)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:rn,enable:!0,inputTarget:null,inputClass:null,preset:[[Yi,{enable:!1}],[Jo,{enable:!1},["rotate"]],[Oo,{direction:Ge}],[Oi,{direction:Ge},["swipe"]],[Za],[Za,{event:"doubletap",taps:2},["tap"]],[ui]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,bu=2;function Qo(Vt,Le){this.options=mt({},oo.defaults,Le||{}),this.options.inputTarget=this.options.inputTarget||Vt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Vt,this.input=Qe(this),this.touchAction=new ga(this,this.options.touchAction),Xl(this,!0),pe(this.options.recognizers,function(Dt){var vr=this.add(new Dt[0](Dt[1]));Dt[2]&&vr.recognizeWith(Dt[2]),Dt[3]&&vr.requireFailure(Dt[3])},this)}Qo.prototype={set:function(Le){return mt(this.options,Le),Le.touchAction&&this.touchAction.update(),Le.inputTarget&&(this.input.destroy(),this.input.target=Le.inputTarget,this.input.init()),this},stop:function(Le){this.session.stopped=Le?bu:so},recognize:function(Le){var Dt=this.session;if(Dt.stopped)return;this.touchAction.preventDefaults(Le);var vr,en=this.recognizers,_n=Dt.curRecognizer;(!_n||_n&&_n.state&ba)&&(_n=Dt.curRecognizer=null);for(var Gn=0;Gn<en.length;)vr=en[Gn],Dt.stopped!==bu&&(!_n||vr==_n||vr.canRecognizeWith(_n))?vr.recognize(Le):vr.reset(),!_n&&vr.state&(da|vi|ya)&&(_n=Dt.curRecognizer=vr),Gn++},get:function(Le){if(Le instanceof is)return Le;for(var Dt=this.recognizers,vr=0;vr<Dt.length;vr++)if(Dt[vr].options.event==Le)return Dt[vr];return null},add:function(Le){if(Xe(Le,"add",this))return this;var Dt=this.get(Le.options.event);return Dt&&this.remove(Dt),this.recognizers.push(Le),Le.manager=this,this.touchAction.update(),Le},remove:function(Le){if(Xe(Le,"remove",this))return this;if(Le=this.get(Le),Le){var Dt=this.recognizers,vr=Me(Dt,Le);vr!==-1&&(Dt.splice(vr,1),this.touchAction.update())}return this},on:function(Le,Dt){if(Le===i)return;if(Dt===i)return;var vr=this.handlers;return pe(ft(Le),function(en){vr[en]=vr[en]||[],vr[en].push(Dt)}),this},off:function(Le,Dt){if(Le===i)return;var vr=this.handlers;return pe(ft(Le),function(en){Dt?vr[en]&&vr[en].splice(Me(vr[en],Dt),1):delete vr[en]}),this},emit:function(Le,Dt){this.options.domEvents&&js(Le,Dt);var vr=this.handlers[Le]&&this.handlers[Le].slice();if(!vr||!vr.length)return;Dt.type=Le,Dt.preventDefault=function(){Dt.srcEvent.preventDefault()};for(var en=0;en<vr.length;)vr[en](Dt),en++},destroy:function(){this.element&&Xl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Xl(Vt,Le){var Dt=Vt.element;if(!Dt.style)return;var vr;pe(Vt.options.cssProps,function(en,_n){vr=Qt(Dt.style,_n),Le?(Vt.oldCssProps[vr]=Dt.style[vr],Dt.style[vr]=en):Dt.style[vr]=Vt.oldCssProps[vr]||""}),Le||(Vt.oldCssProps={})}function js(Vt,Le){var Dt=Y.createEvent("Event");Dt.initEvent(Vt,!0,!0),Dt.gesture=Le,Le.target.dispatchEvent(Dt)}mt(oo,{INPUT_START:ge,INPUT_MOVE:Ve,INPUT_END:st,INPUT_CANCEL:Oe,STATE_POSSIBLE:Wi,STATE_BEGAN:da,STATE_CHANGED:vi,STATE_ENDED:ya,STATE_RECOGNIZED:ba,STATE_CANCELLED:ha,STATE_FAILED:wi,DIRECTION_NONE:vt,DIRECTION_LEFT:C,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:ce,DIRECTION_HORIZONTAL:Ge,DIRECTION_VERTICAL:qe,DIRECTION_ALL:Tt,Manager:Qo,Input:$,TouchAction:ga,TouchInput:Ze,MouseInput:Vn,PointerEventInput:Cn,TouchMouseInput:Gr,SingleTouchInput:xe,Recognizer:is,AttrRecognizer:Ha,Tap:Za,Pan:Oi,Swipe:Oo,Pinch:Jo,Rotate:Yi,Press:ui,on:Ot,off:Re,each:pe,merge:At,extend:Ne,assign:mt,inherit:Ye,bindFn:Et,prefixed:Qt});var ho=typeof p!="undefined"?p:typeof self!="undefined"?self:{};ho.Hammer=oo,!(x=function(){return oo}.call(_,o,_,Fe),x!==i&&(Fe.exports=x))})(window,document,"Hammer")},hhz5:function(Fe,_,o){"use strict";var x=o("qSre"),p=o("9ntj")},hyHi:function(Fe,_,o){"use strict";var x=o("qSre"),p=o("rZUy")},ihlD:function(Fe,_,o){"use strict";o.d(_,"a",function(){return D});var x=o("L84c"),p=o.n(x),Y=o("9DPn"),z=o.n(Y);function i(re,fe){var X=Object.keys(re);if(Object.getOwnPropertySymbols){var He=Object.getOwnPropertySymbols(re);fe&&(He=He.filter(function(Xe){return Object.getOwnPropertyDescriptor(re,Xe).enumerable})),X.push.apply(X,He)}return X}function Z(re){for(var fe=1;fe<arguments.length;fe++){var X=arguments[fe]!=null?arguments[fe]:{};fe%2?i(Object(X),!0).forEach(function(He){p()(re,He,X[He])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(X)):i(Object(X)).forEach(function(He){Object.defineProperty(re,He,Object.getOwnPropertyDescriptor(X,He))})}return re}function D(re,fe){var X=fe.radius,He=X===void 0?40:X,Xe=fe.maxZoom,pe=Xe===void 0?18:Xe,Ce=fe.minZoom,mt=Ce===void 0?0:Ce,Ne=fe.zoom,At=Ne===void 0?2:Ne;if(re.pointIndex){var Ye=re.pointIndex.getClusters(re.extent,Math.floor(At));return re.dataArray=K(Ye),re}var Et=new z.a({radius:He,minZoom:mt,maxZoom:pe}),nt={type:"FeatureCollection",features:[]};return nt.features=re.dataArray.map(function(Ct){return{type:"Feature",geometry:{type:"Point",coordinates:Ct.coordinates},properties:Z({},Ct)}}),Et.load(nt.features),Et}function K(re){return re.map(function(fe,X){return Z({coordinates:fe.geometry.coordinates,_id:X+1},fe.properties)})}},j6rd:function(Fe,_){},jJQI:function(Fe,_,o){"use strict";o.r(_),o.d(_,"create",function(){return p}),o.d(_,"clone",function(){return Y}),o.d(_,"copy",function(){return z}),o.d(_,"fromValues",function(){return i}),o.d(_,"set",function(){return Z}),o.d(_,"identity",function(){return D}),o.d(_,"transpose",function(){return K}),o.d(_,"invert",function(){return re}),o.d(_,"adjoint",function(){return fe}),o.d(_,"determinant",function(){return X}),o.d(_,"multiply",function(){return He}),o.d(_,"translate",function(){return Xe}),o.d(_,"scale",function(){return pe}),o.d(_,"rotate",function(){return Ce}),o.d(_,"rotateX",function(){return mt}),o.d(_,"rotateY",function(){return Ne}),o.d(_,"rotateZ",function(){return At}),o.d(_,"fromTranslation",function(){return Ye}),o.d(_,"fromScaling",function(){return Et}),o.d(_,"fromRotation",function(){return nt}),o.d(_,"fromXRotation",function(){return Ct}),o.d(_,"fromYRotation",function(){return Ot}),o.d(_,"fromZRotation",function(){return Re}),o.d(_,"fromRotationTranslation",function(){return Ie}),o.d(_,"fromQuat2",function(){return Be}),o.d(_,"getTranslation",function(){return ft}),o.d(_,"getScaling",function(){return Me}),o.d(_,"getRotation",function(){return ht}),o.d(_,"fromRotationTranslationScale",function(){return Wt}),o.d(_,"fromRotationTranslationScaleOrigin",function(){return Qt}),o.d(_,"fromQuat",function(){return ur}),o.d(_,"frustum",function(){return oe}),o.d(_,"perspective",function(){return J}),o.d(_,"perspectiveFromFieldOfView",function(){return H}),o.d(_,"ortho",function(){return Se}),o.d(_,"lookAt",function(){return be}),o.d(_,"targetTo",function(){return _e}),o.d(_,"str",function(){return me}),o.d(_,"frob",function(){return it}),o.d(_,"add",function(){return qt}),o.d(_,"subtract",function(){return Pt}),o.d(_,"multiplyScalar",function(){return ve}),o.d(_,"multiplyScalarAndAdd",function(){return ge}),o.d(_,"exactEquals",function(){return Ve}),o.d(_,"equals",function(){return st}),o.d(_,"mul",function(){return Oe}),o.d(_,"sub",function(){return vt});var x=o("TaHB");function p(){var C=new x.a(16);return x.a!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function Y(C){var R=new x.a(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R}function z(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function i(C,R,q,ce,Ge,qe,Tt,ot,Ut,$,Qe,ae,et,kt,pr,Ke){var bt=new x.a(16);return bt[0]=C,bt[1]=R,bt[2]=q,bt[3]=ce,bt[4]=Ge,bt[5]=qe,bt[6]=Tt,bt[7]=ot,bt[8]=Ut,bt[9]=$,bt[10]=Qe,bt[11]=ae,bt[12]=et,bt[13]=kt,bt[14]=pr,bt[15]=Ke,bt}function Z(C,R,q,ce,Ge,qe,Tt,ot,Ut,$,Qe,ae,et,kt,pr,Ke,bt){return C[0]=R,C[1]=q,C[2]=ce,C[3]=Ge,C[4]=qe,C[5]=Tt,C[6]=ot,C[7]=Ut,C[8]=$,C[9]=Qe,C[10]=ae,C[11]=et,C[12]=kt,C[13]=pr,C[14]=Ke,C[15]=bt,C}function D(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function K(C,R){if(C===R){var q=R[1],ce=R[2],Ge=R[3],qe=R[6],Tt=R[7],ot=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=q,C[6]=R[9],C[7]=R[13],C[8]=ce,C[9]=qe,C[11]=R[14],C[12]=Ge,C[13]=Tt,C[14]=ot}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C}function re(C,R){var q=R[0],ce=R[1],Ge=R[2],qe=R[3],Tt=R[4],ot=R[5],Ut=R[6],$=R[7],Qe=R[8],ae=R[9],et=R[10],kt=R[11],pr=R[12],Ke=R[13],bt=R[14],yt=R[15],xt=q*ot-ce*Tt,ze=q*Ut-Ge*Tt,dt=q*$-qe*Tt,gt=ce*Ut-Ge*ot,Ht=ce*$-qe*ot,hr=Ge*$-qe*Ut,Zr=Qe*Ke-ae*pr,yr=Qe*bt-et*pr,Vn=Qe*yt-kt*pr,Fn=ae*bt-et*Ke,oa=ae*yt-kt*Ke,$n=et*yt-kt*bt,Kn=xt*$n-ze*oa+dt*Fn+gt*Vn-Ht*yr+hr*Zr;return Kn?(Kn=1/Kn,C[0]=(ot*$n-Ut*oa+$*Fn)*Kn,C[1]=(Ge*oa-ce*$n-qe*Fn)*Kn,C[2]=(Ke*hr-bt*Ht+yt*gt)*Kn,C[3]=(et*Ht-ae*hr-kt*gt)*Kn,C[4]=(Ut*Vn-Tt*$n-$*yr)*Kn,C[5]=(q*$n-Ge*Vn+qe*yr)*Kn,C[6]=(bt*dt-pr*hr-yt*ze)*Kn,C[7]=(Qe*hr-et*dt+kt*ze)*Kn,C[8]=(Tt*oa-ot*Vn+$*Zr)*Kn,C[9]=(ce*Vn-q*oa-qe*Zr)*Kn,C[10]=(pr*Ht-Ke*dt+yt*xt)*Kn,C[11]=(ae*dt-Qe*Ht-kt*xt)*Kn,C[12]=(ot*yr-Tt*Fn-Ut*Zr)*Kn,C[13]=(q*Fn-ce*yr+Ge*Zr)*Kn,C[14]=(Ke*ze-pr*gt-bt*xt)*Kn,C[15]=(Qe*gt-ae*ze+et*xt)*Kn,C):null}function fe(C,R){var q=R[0],ce=R[1],Ge=R[2],qe=R[3],Tt=R[4],ot=R[5],Ut=R[6],$=R[7],Qe=R[8],ae=R[9],et=R[10],kt=R[11],pr=R[12],Ke=R[13],bt=R[14],yt=R[15];return C[0]=ot*(et*yt-kt*bt)-ae*(Ut*yt-$*bt)+Ke*(Ut*kt-$*et),C[1]=-(ce*(et*yt-kt*bt)-ae*(Ge*yt-qe*bt)+Ke*(Ge*kt-qe*et)),C[2]=ce*(Ut*yt-$*bt)-ot*(Ge*yt-qe*bt)+Ke*(Ge*$-qe*Ut),C[3]=-(ce*(Ut*kt-$*et)-ot*(Ge*kt-qe*et)+ae*(Ge*$-qe*Ut)),C[4]=-(Tt*(et*yt-kt*bt)-Qe*(Ut*yt-$*bt)+pr*(Ut*kt-$*et)),C[5]=q*(et*yt-kt*bt)-Qe*(Ge*yt-qe*bt)+pr*(Ge*kt-qe*et),C[6]=-(q*(Ut*yt-$*bt)-Tt*(Ge*yt-qe*bt)+pr*(Ge*$-qe*Ut)),C[7]=q*(Ut*kt-$*et)-Tt*(Ge*kt-qe*et)+Qe*(Ge*$-qe*Ut),C[8]=Tt*(ae*yt-kt*Ke)-Qe*(ot*yt-$*Ke)+pr*(ot*kt-$*ae),C[9]=-(q*(ae*yt-kt*Ke)-Qe*(ce*yt-qe*Ke)+pr*(ce*kt-qe*ae)),C[10]=q*(ot*yt-$*Ke)-Tt*(ce*yt-qe*Ke)+pr*(ce*$-qe*ot),C[11]=-(q*(ot*kt-$*ae)-Tt*(ce*kt-qe*ae)+Qe*(ce*$-qe*ot)),C[12]=-(Tt*(ae*bt-et*Ke)-Qe*(ot*bt-Ut*Ke)+pr*(ot*et-Ut*ae)),C[13]=q*(ae*bt-et*Ke)-Qe*(ce*bt-Ge*Ke)+pr*(ce*et-Ge*ae),C[14]=-(q*(ot*bt-Ut*Ke)-Tt*(ce*bt-Ge*Ke)+pr*(ce*Ut-Ge*ot)),C[15]=q*(ot*et-Ut*ae)-Tt*(ce*et-Ge*ae)+Qe*(ce*Ut-Ge*ot),C}function X(C){var R=C[0],q=C[1],ce=C[2],Ge=C[3],qe=C[4],Tt=C[5],ot=C[6],Ut=C[7],$=C[8],Qe=C[9],ae=C[10],et=C[11],kt=C[12],pr=C[13],Ke=C[14],bt=C[15],yt=R*Tt-q*qe,xt=R*ot-ce*qe,ze=R*Ut-Ge*qe,dt=q*ot-ce*Tt,gt=q*Ut-Ge*Tt,Ht=ce*Ut-Ge*ot,hr=$*pr-Qe*kt,Zr=$*Ke-ae*kt,yr=$*bt-et*kt,Vn=Qe*Ke-ae*pr,Fn=Qe*bt-et*pr,oa=ae*bt-et*Ke;return yt*oa-xt*Fn+ze*Vn+dt*yr-gt*Zr+Ht*hr}function He(C,R,q){var ce=R[0],Ge=R[1],qe=R[2],Tt=R[3],ot=R[4],Ut=R[5],$=R[6],Qe=R[7],ae=R[8],et=R[9],kt=R[10],pr=R[11],Ke=R[12],bt=R[13],yt=R[14],xt=R[15],ze=q[0],dt=q[1],gt=q[2],Ht=q[3];return C[0]=ze*ce+dt*ot+gt*ae+Ht*Ke,C[1]=ze*Ge+dt*Ut+gt*et+Ht*bt,C[2]=ze*qe+dt*$+gt*kt+Ht*yt,C[3]=ze*Tt+dt*Qe+gt*pr+Ht*xt,ze=q[4],dt=q[5],gt=q[6],Ht=q[7],C[4]=ze*ce+dt*ot+gt*ae+Ht*Ke,C[5]=ze*Ge+dt*Ut+gt*et+Ht*bt,C[6]=ze*qe+dt*$+gt*kt+Ht*yt,C[7]=ze*Tt+dt*Qe+gt*pr+Ht*xt,ze=q[8],dt=q[9],gt=q[10],Ht=q[11],C[8]=ze*ce+dt*ot+gt*ae+Ht*Ke,C[9]=ze*Ge+dt*Ut+gt*et+Ht*bt,C[10]=ze*qe+dt*$+gt*kt+Ht*yt,C[11]=ze*Tt+dt*Qe+gt*pr+Ht*xt,ze=q[12],dt=q[13],gt=q[14],Ht=q[15],C[12]=ze*ce+dt*ot+gt*ae+Ht*Ke,C[13]=ze*Ge+dt*Ut+gt*et+Ht*bt,C[14]=ze*qe+dt*$+gt*kt+Ht*yt,C[15]=ze*Tt+dt*Qe+gt*pr+Ht*xt,C}function Xe(C,R,q){var ce=q[0],Ge=q[1],qe=q[2],Tt,ot,Ut,$,Qe,ae,et,kt,pr,Ke,bt,yt;return R===C?(C[12]=R[0]*ce+R[4]*Ge+R[8]*qe+R[12],C[13]=R[1]*ce+R[5]*Ge+R[9]*qe+R[13],C[14]=R[2]*ce+R[6]*Ge+R[10]*qe+R[14],C[15]=R[3]*ce+R[7]*Ge+R[11]*qe+R[15]):(Tt=R[0],ot=R[1],Ut=R[2],$=R[3],Qe=R[4],ae=R[5],et=R[6],kt=R[7],pr=R[8],Ke=R[9],bt=R[10],yt=R[11],C[0]=Tt,C[1]=ot,C[2]=Ut,C[3]=$,C[4]=Qe,C[5]=ae,C[6]=et,C[7]=kt,C[8]=pr,C[9]=Ke,C[10]=bt,C[11]=yt,C[12]=Tt*ce+Qe*Ge+pr*qe+R[12],C[13]=ot*ce+ae*Ge+Ke*qe+R[13],C[14]=Ut*ce+et*Ge+bt*qe+R[14],C[15]=$*ce+kt*Ge+yt*qe+R[15]),C}function pe(C,R,q){var ce=q[0],Ge=q[1],qe=q[2];return C[0]=R[0]*ce,C[1]=R[1]*ce,C[2]=R[2]*ce,C[3]=R[3]*ce,C[4]=R[4]*Ge,C[5]=R[5]*Ge,C[6]=R[6]*Ge,C[7]=R[7]*Ge,C[8]=R[8]*qe,C[9]=R[9]*qe,C[10]=R[10]*qe,C[11]=R[11]*qe,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function Ce(C,R,q,ce){var Ge=ce[0],qe=ce[1],Tt=ce[2],ot=Math.hypot(Ge,qe,Tt),Ut,$,Qe,ae,et,kt,pr,Ke,bt,yt,xt,ze,dt,gt,Ht,hr,Zr,yr,Vn,Fn,oa,$n,Kn,Cn;return ot<x.b?null:(ot=1/ot,Ge*=ot,qe*=ot,Tt*=ot,Ut=Math.sin(q),$=Math.cos(q),Qe=1-$,ae=R[0],et=R[1],kt=R[2],pr=R[3],Ke=R[4],bt=R[5],yt=R[6],xt=R[7],ze=R[8],dt=R[9],gt=R[10],Ht=R[11],hr=Ge*Ge*Qe+$,Zr=qe*Ge*Qe+Tt*Ut,yr=Tt*Ge*Qe-qe*Ut,Vn=Ge*qe*Qe-Tt*Ut,Fn=qe*qe*Qe+$,oa=Tt*qe*Qe+Ge*Ut,$n=Ge*Tt*Qe+qe*Ut,Kn=qe*Tt*Qe-Ge*Ut,Cn=Tt*Tt*Qe+$,C[0]=ae*hr+Ke*Zr+ze*yr,C[1]=et*hr+bt*Zr+dt*yr,C[2]=kt*hr+yt*Zr+gt*yr,C[3]=pr*hr+xt*Zr+Ht*yr,C[4]=ae*Vn+Ke*Fn+ze*oa,C[5]=et*Vn+bt*Fn+dt*oa,C[6]=kt*Vn+yt*Fn+gt*oa,C[7]=pr*Vn+xt*Fn+Ht*oa,C[8]=ae*$n+Ke*Kn+ze*Cn,C[9]=et*$n+bt*Kn+dt*Cn,C[10]=kt*$n+yt*Kn+gt*Cn,C[11]=pr*$n+xt*Kn+Ht*Cn,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)}function mt(C,R,q){var ce=Math.sin(q),Ge=Math.cos(q),qe=R[4],Tt=R[5],ot=R[6],Ut=R[7],$=R[8],Qe=R[9],ae=R[10],et=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=qe*Ge+$*ce,C[5]=Tt*Ge+Qe*ce,C[6]=ot*Ge+ae*ce,C[7]=Ut*Ge+et*ce,C[8]=$*Ge-qe*ce,C[9]=Qe*Ge-Tt*ce,C[10]=ae*Ge-ot*ce,C[11]=et*Ge-Ut*ce,C}function Ne(C,R,q){var ce=Math.sin(q),Ge=Math.cos(q),qe=R[0],Tt=R[1],ot=R[2],Ut=R[3],$=R[8],Qe=R[9],ae=R[10],et=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*Ge-$*ce,C[1]=Tt*Ge-Qe*ce,C[2]=ot*Ge-ae*ce,C[3]=Ut*Ge-et*ce,C[8]=qe*ce+$*Ge,C[9]=Tt*ce+Qe*Ge,C[10]=ot*ce+ae*Ge,C[11]=Ut*ce+et*Ge,C}function At(C,R,q){var ce=Math.sin(q),Ge=Math.cos(q),qe=R[0],Tt=R[1],ot=R[2],Ut=R[3],$=R[4],Qe=R[5],ae=R[6],et=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=qe*Ge+$*ce,C[1]=Tt*Ge+Qe*ce,C[2]=ot*Ge+ae*ce,C[3]=Ut*Ge+et*ce,C[4]=$*Ge-qe*ce,C[5]=Qe*Ge-Tt*ce,C[6]=ae*Ge-ot*ce,C[7]=et*Ge-Ut*ce,C}function Ye(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C}function Et(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function nt(C,R,q){var ce=q[0],Ge=q[1],qe=q[2],Tt=Math.hypot(ce,Ge,qe),ot,Ut,$;return Tt<x.b?null:(Tt=1/Tt,ce*=Tt,Ge*=Tt,qe*=Tt,ot=Math.sin(R),Ut=Math.cos(R),$=1-Ut,C[0]=ce*ce*$+Ut,C[1]=Ge*ce*$+qe*ot,C[2]=qe*ce*$-Ge*ot,C[3]=0,C[4]=ce*Ge*$-qe*ot,C[5]=Ge*Ge*$+Ut,C[6]=qe*Ge*$+ce*ot,C[7]=0,C[8]=ce*qe*$+Ge*ot,C[9]=Ge*qe*$-ce*ot,C[10]=qe*qe*$+Ut,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function Ct(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=ce,C[6]=q,C[7]=0,C[8]=0,C[9]=-q,C[10]=ce,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ot(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=ce,C[1]=0,C[2]=-q,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=q,C[9]=0,C[10]=ce,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Re(C,R){var q=Math.sin(R),ce=Math.cos(R);return C[0]=ce,C[1]=q,C[2]=0,C[3]=0,C[4]=-q,C[5]=ce,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ie(C,R,q){var ce=R[0],Ge=R[1],qe=R[2],Tt=R[3],ot=ce+ce,Ut=Ge+Ge,$=qe+qe,Qe=ce*ot,ae=ce*Ut,et=ce*$,kt=Ge*Ut,pr=Ge*$,Ke=qe*$,bt=Tt*ot,yt=Tt*Ut,xt=Tt*$;return C[0]=1-(kt+Ke),C[1]=ae+xt,C[2]=et-yt,C[3]=0,C[4]=ae-xt,C[5]=1-(Qe+Ke),C[6]=pr+bt,C[7]=0,C[8]=et+yt,C[9]=pr-bt,C[10]=1-(Qe+kt),C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Be(C,R){var q=new x.a(3),ce=-R[0],Ge=-R[1],qe=-R[2],Tt=R[3],ot=R[4],Ut=R[5],$=R[6],Qe=R[7],ae=ce*ce+Ge*Ge+qe*qe+Tt*Tt;return ae>0?(q[0]=(ot*Tt+Qe*ce+Ut*qe-$*Ge)*2/ae,q[1]=(Ut*Tt+Qe*Ge+$*ce-ot*qe)*2/ae,q[2]=($*Tt+Qe*qe+ot*Ge-Ut*ce)*2/ae):(q[0]=(ot*Tt+Qe*ce+Ut*qe-$*Ge)*2,q[1]=(Ut*Tt+Qe*Ge+$*ce-ot*qe)*2,q[2]=($*Tt+Qe*qe+ot*Ge-Ut*ce)*2),Ie(C,R,q),C}function ft(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C}function Me(C,R){var q=R[0],ce=R[1],Ge=R[2],qe=R[4],Tt=R[5],ot=R[6],Ut=R[8],$=R[9],Qe=R[10];return C[0]=Math.hypot(q,ce,Ge),C[1]=Math.hypot(qe,Tt,ot),C[2]=Math.hypot(Ut,$,Qe),C}function ht(C,R){var q=new x.a(3);Me(q,R);var ce=1/q[0],Ge=1/q[1],qe=1/q[2],Tt=R[0]*ce,ot=R[1]*Ge,Ut=R[2]*qe,$=R[4]*ce,Qe=R[5]*Ge,ae=R[6]*qe,et=R[8]*ce,kt=R[9]*Ge,pr=R[10]*qe,Ke=Tt+Qe+pr,bt=0;return Ke>0?(bt=Math.sqrt(Ke+1)*2,C[3]=.25*bt,C[0]=(ae-kt)/bt,C[1]=(et-Ut)/bt,C[2]=(ot-$)/bt):Tt>Qe&&Tt>pr?(bt=Math.sqrt(1+Tt-Qe-pr)*2,C[3]=(ae-kt)/bt,C[0]=.25*bt,C[1]=(ot+$)/bt,C[2]=(et+Ut)/bt):Qe>pr?(bt=Math.sqrt(1+Qe-Tt-pr)*2,C[3]=(et-Ut)/bt,C[0]=(ot+$)/bt,C[1]=.25*bt,C[2]=(ae+kt)/bt):(bt=Math.sqrt(1+pr-Tt-Qe)*2,C[3]=(ot-$)/bt,C[0]=(et+Ut)/bt,C[1]=(ae+kt)/bt,C[2]=.25*bt),C}function Wt(C,R,q,ce){var Ge=R[0],qe=R[1],Tt=R[2],ot=R[3],Ut=Ge+Ge,$=qe+qe,Qe=Tt+Tt,ae=Ge*Ut,et=Ge*$,kt=Ge*Qe,pr=qe*$,Ke=qe*Qe,bt=Tt*Qe,yt=ot*Ut,xt=ot*$,ze=ot*Qe,dt=ce[0],gt=ce[1],Ht=ce[2];return C[0]=(1-(pr+bt))*dt,C[1]=(et+ze)*dt,C[2]=(kt-xt)*dt,C[3]=0,C[4]=(et-ze)*gt,C[5]=(1-(ae+bt))*gt,C[6]=(Ke+yt)*gt,C[7]=0,C[8]=(kt+xt)*Ht,C[9]=(Ke-yt)*Ht,C[10]=(1-(ae+pr))*Ht,C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Qt(C,R,q,ce,Ge){var qe=R[0],Tt=R[1],ot=R[2],Ut=R[3],$=qe+qe,Qe=Tt+Tt,ae=ot+ot,et=qe*$,kt=qe*Qe,pr=qe*ae,Ke=Tt*Qe,bt=Tt*ae,yt=ot*ae,xt=Ut*$,ze=Ut*Qe,dt=Ut*ae,gt=ce[0],Ht=ce[1],hr=ce[2],Zr=Ge[0],yr=Ge[1],Vn=Ge[2],Fn=(1-(Ke+yt))*gt,oa=(kt+dt)*gt,$n=(pr-ze)*gt,Kn=(kt-dt)*Ht,Cn=(1-(et+yt))*Ht,F=(bt+xt)*Ht,W=(pr+ze)*hr,le=(bt-xt)*hr,xe=(1-(et+Ke))*hr;return C[0]=Fn,C[1]=oa,C[2]=$n,C[3]=0,C[4]=Kn,C[5]=Cn,C[6]=F,C[7]=0,C[8]=W,C[9]=le,C[10]=xe,C[11]=0,C[12]=q[0]+Zr-(Fn*Zr+Kn*yr+W*Vn),C[13]=q[1]+yr-(oa*Zr+Cn*yr+le*Vn),C[14]=q[2]+Vn-($n*Zr+F*yr+xe*Vn),C[15]=1,C}function ur(C,R){var q=R[0],ce=R[1],Ge=R[2],qe=R[3],Tt=q+q,ot=ce+ce,Ut=Ge+Ge,$=q*Tt,Qe=ce*Tt,ae=ce*ot,et=Ge*Tt,kt=Ge*ot,pr=Ge*Ut,Ke=qe*Tt,bt=qe*ot,yt=qe*Ut;return C[0]=1-ae-pr,C[1]=Qe+yt,C[2]=et-bt,C[3]=0,C[4]=Qe-yt,C[5]=1-$-pr,C[6]=kt+Ke,C[7]=0,C[8]=et+bt,C[9]=kt-Ke,C[10]=1-$-ae,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,R,q,ce,Ge,qe,Tt){var ot=1/(q-R),Ut=1/(Ge-ce),$=1/(qe-Tt);return C[0]=qe*2*ot,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe*2*Ut,C[6]=0,C[7]=0,C[8]=(q+R)*ot,C[9]=(Ge+ce)*Ut,C[10]=(Tt+qe)*$,C[11]=-1,C[12]=0,C[13]=0,C[14]=Tt*qe*2*$,C[15]=0,C}function J(C,R,q,ce,Ge){var qe=1/Math.tan(R/2),Tt;return C[0]=qe/q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=qe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,Ge!=null&&Ge!==Infinity?(Tt=1/(ce-Ge),C[10]=(Ge+ce)*Tt,C[14]=2*Ge*ce*Tt):(C[10]=-1,C[14]=-2*ce),C}function H(C,R,q,ce){var Ge=Math.tan(R.upDegrees*Math.PI/180),qe=Math.tan(R.downDegrees*Math.PI/180),Tt=Math.tan(R.leftDegrees*Math.PI/180),ot=Math.tan(R.rightDegrees*Math.PI/180),Ut=2/(Tt+ot),$=2/(Ge+qe);return C[0]=Ut,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=$,C[6]=0,C[7]=0,C[8]=-((Tt-ot)*Ut*.5),C[9]=(Ge-qe)*$*.5,C[10]=ce/(q-ce),C[11]=-1,C[12]=0,C[13]=0,C[14]=ce*q/(q-ce),C[15]=0,C}function Se(C,R,q,ce,Ge,qe,Tt){var ot=1/(R-q),Ut=1/(ce-Ge),$=1/(qe-Tt);return C[0]=-2*ot,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ut,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*$,C[11]=0,C[12]=(R+q)*ot,C[13]=(Ge+ce)*Ut,C[14]=(Tt+qe)*$,C[15]=1,C}function be(C,R,q,ce){var Ge,qe,Tt,ot,Ut,$,Qe,ae,et,kt,pr=R[0],Ke=R[1],bt=R[2],yt=ce[0],xt=ce[1],ze=ce[2],dt=q[0],gt=q[1],Ht=q[2];return Math.abs(pr-dt)<x.b&&Math.abs(Ke-gt)<x.b&&Math.abs(bt-Ht)<x.b?D(C):(Qe=pr-dt,ae=Ke-gt,et=bt-Ht,kt=1/Math.hypot(Qe,ae,et),Qe*=kt,ae*=kt,et*=kt,Ge=xt*et-ze*ae,qe=ze*Qe-yt*et,Tt=yt*ae-xt*Qe,kt=Math.hypot(Ge,qe,Tt),kt?(kt=1/kt,Ge*=kt,qe*=kt,Tt*=kt):(Ge=0,qe=0,Tt=0),ot=ae*Tt-et*qe,Ut=et*Ge-Qe*Tt,$=Qe*qe-ae*Ge,kt=Math.hypot(ot,Ut,$),kt?(kt=1/kt,ot*=kt,Ut*=kt,$*=kt):(ot=0,Ut=0,$=0),C[0]=Ge,C[1]=ot,C[2]=Qe,C[3]=0,C[4]=qe,C[5]=Ut,C[6]=ae,C[7]=0,C[8]=Tt,C[9]=$,C[10]=et,C[11]=0,C[12]=-(Ge*pr+qe*Ke+Tt*bt),C[13]=-(ot*pr+Ut*Ke+$*bt),C[14]=-(Qe*pr+ae*Ke+et*bt),C[15]=1,C)}function _e(C,R,q,ce){var Ge=R[0],qe=R[1],Tt=R[2],ot=ce[0],Ut=ce[1],$=ce[2],Qe=Ge-q[0],ae=qe-q[1],et=Tt-q[2],kt=Qe*Qe+ae*ae+et*et;kt>0&&(kt=1/Math.sqrt(kt),Qe*=kt,ae*=kt,et*=kt);var pr=Ut*et-$*ae,Ke=$*Qe-ot*et,bt=ot*ae-Ut*Qe;return kt=pr*pr+Ke*Ke+bt*bt,kt>0&&(kt=1/Math.sqrt(kt),pr*=kt,Ke*=kt,bt*=kt),C[0]=pr,C[1]=Ke,C[2]=bt,C[3]=0,C[4]=ae*bt-et*Ke,C[5]=et*pr-Qe*bt,C[6]=Qe*Ke-ae*pr,C[7]=0,C[8]=Qe,C[9]=ae,C[10]=et,C[11]=0,C[12]=Ge,C[13]=qe,C[14]=Tt,C[15]=1,C}function me(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function it(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function qt(C,R,q){return C[0]=R[0]+q[0],C[1]=R[1]+q[1],C[2]=R[2]+q[2],C[3]=R[3]+q[3],C[4]=R[4]+q[4],C[5]=R[5]+q[5],C[6]=R[6]+q[6],C[7]=R[7]+q[7],C[8]=R[8]+q[8],C[9]=R[9]+q[9],C[10]=R[10]+q[10],C[11]=R[11]+q[11],C[12]=R[12]+q[12],C[13]=R[13]+q[13],C[14]=R[14]+q[14],C[15]=R[15]+q[15],C}function Pt(C,R,q){return C[0]=R[0]-q[0],C[1]=R[1]-q[1],C[2]=R[2]-q[2],C[3]=R[3]-q[3],C[4]=R[4]-q[4],C[5]=R[5]-q[5],C[6]=R[6]-q[6],C[7]=R[7]-q[7],C[8]=R[8]-q[8],C[9]=R[9]-q[9],C[10]=R[10]-q[10],C[11]=R[11]-q[11],C[12]=R[12]-q[12],C[13]=R[13]-q[13],C[14]=R[14]-q[14],C[15]=R[15]-q[15],C}function ve(C,R,q){return C[0]=R[0]*q,C[1]=R[1]*q,C[2]=R[2]*q,C[3]=R[3]*q,C[4]=R[4]*q,C[5]=R[5]*q,C[6]=R[6]*q,C[7]=R[7]*q,C[8]=R[8]*q,C[9]=R[9]*q,C[10]=R[10]*q,C[11]=R[11]*q,C[12]=R[12]*q,C[13]=R[13]*q,C[14]=R[14]*q,C[15]=R[15]*q,C}function ge(C,R,q,ce){return C[0]=R[0]+q[0]*ce,C[1]=R[1]+q[1]*ce,C[2]=R[2]+q[2]*ce,C[3]=R[3]+q[3]*ce,C[4]=R[4]+q[4]*ce,C[5]=R[5]+q[5]*ce,C[6]=R[6]+q[6]*ce,C[7]=R[7]+q[7]*ce,C[8]=R[8]+q[8]*ce,C[9]=R[9]+q[9]*ce,C[10]=R[10]+q[10]*ce,C[11]=R[11]+q[11]*ce,C[12]=R[12]+q[12]*ce,C[13]=R[13]+q[13]*ce,C[14]=R[14]+q[14]*ce,C[15]=R[15]+q[15]*ce,C}function Ve(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]}function st(C,R){var q=C[0],ce=C[1],Ge=C[2],qe=C[3],Tt=C[4],ot=C[5],Ut=C[6],$=C[7],Qe=C[8],ae=C[9],et=C[10],kt=C[11],pr=C[12],Ke=C[13],bt=C[14],yt=C[15],xt=R[0],ze=R[1],dt=R[2],gt=R[3],Ht=R[4],hr=R[5],Zr=R[6],yr=R[7],Vn=R[8],Fn=R[9],oa=R[10],$n=R[11],Kn=R[12],Cn=R[13],F=R[14],W=R[15];return Math.abs(q-xt)<=x.b*Math.max(1,Math.abs(q),Math.abs(xt))&&Math.abs(ce-ze)<=x.b*Math.max(1,Math.abs(ce),Math.abs(ze))&&Math.abs(Ge-dt)<=x.b*Math.max(1,Math.abs(Ge),Math.abs(dt))&&Math.abs(qe-gt)<=x.b*Math.max(1,Math.abs(qe),Math.abs(gt))&&Math.abs(Tt-Ht)<=x.b*Math.max(1,Math.abs(Tt),Math.abs(Ht))&&Math.abs(ot-hr)<=x.b*Math.max(1,Math.abs(ot),Math.abs(hr))&&Math.abs(Ut-Zr)<=x.b*Math.max(1,Math.abs(Ut),Math.abs(Zr))&&Math.abs($-yr)<=x.b*Math.max(1,Math.abs($),Math.abs(yr))&&Math.abs(Qe-Vn)<=x.b*Math.max(1,Math.abs(Qe),Math.abs(Vn))&&Math.abs(ae-Fn)<=x.b*Math.max(1,Math.abs(ae),Math.abs(Fn))&&Math.abs(et-oa)<=x.b*Math.max(1,Math.abs(et),Math.abs(oa))&&Math.abs(kt-$n)<=x.b*Math.max(1,Math.abs(kt),Math.abs($n))&&Math.abs(pr-Kn)<=x.b*Math.max(1,Math.abs(pr),Math.abs(Kn))&&Math.abs(Ke-Cn)<=x.b*Math.max(1,Math.abs(Ke),Math.abs(Cn))&&Math.abs(bt-F)<=x.b*Math.max(1,Math.abs(bt),Math.abs(F))&&Math.abs(yt-W)<=x.b*Math.max(1,Math.abs(yt),Math.abs(W))}var Oe=He,vt=Pt},jNud:function(Fe,_){function o(){}Fe.exports=o},jZ0V:function(Fe,_){function o(x,p,Y,z,i){var Z={};return Object.keys(z).forEach(function(D){Z[D]=z[D]}),Z.enumerable=!!Z.enumerable,Z.configurable=!!Z.configurable,("value"in Z||Z.initializer)&&(Z.writable=!0),Z=Y.slice().reverse().reduce(function(D,K){return K(x,p,D)||D},Z),i&&Z.initializer!==void 0&&(Z.value=Z.initializer?Z.initializer.call(i):void 0,Z.initializer=void 0),Z.initializer===void 0&&(Object.defineProperty(x,p,Z),Z=null),Z}Fe.exports=o},jkwx:function(Fe,_,o){"use strict";o.d(_,"a",function(){return i});var x=o("L84c"),p=o.n(x);function Y(Z,D){var K=Object.keys(Z);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Z);D&&(re=re.filter(function(fe){return Object.getOwnPropertyDescriptor(Z,fe).enumerable})),K.push.apply(K,re)}return K}function z(Z){for(var D=1;D<arguments.length;D++){var K=arguments[D]!=null?arguments[D]:{};D%2?Y(Object(K),!0).forEach(function(re){p()(Z,re,K[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(K)):Y(Object(K)).forEach(function(re){Object.defineProperty(Z,re,Object.getOwnPropertyDescriptor(K,re))})}return Z}function i(Z,D){var K=D.sourceField,re=D.targetField,fe=D.data,X={};return fe.forEach(function(He){X[He[K]]=He}),Z.dataArray=Z.dataArray.map(function(He){var Xe=He[re];return z(z({},He),X[Xe])}),Z}},"jr/B":function(Fe,_,o){var x=o("Jo4Q");function p(Y,z,i){return typeof Reflect!="undefined"&&Reflect.get?Fe.exports=p=Reflect.get:Fe.exports=p=function(D,K,re){var fe=x(D,K);if(!fe)return;var X=Object.getOwnPropertyDescriptor(fe,K);return X.get?X.get.call(re):X.value},p(Y,z,i||Y)}Fe.exports=p},k77m:function(Fe,_){},l76O:function(Fe,_,o){"use strict";var x=o("vuw8");_.a=x.a},lGr2:function(Fe,_){},lvid:function(Fe,_){var o="\\ud800-\\udfff",x="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",z=x+p+Y,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",fe="[^"+o+"]",X="(?:\\ud83c[\\udde6-\\uddff]){2}",He="[\\ud800-\\udbff][\\udc00-\\udfff]",Xe="\\u200d",pe=re+"?",Ce="["+i+"]?",mt="(?:"+Xe+"(?:"+[fe,X,He].join("|")+")"+Ce+pe+")*",Ne=Ce+pe+mt,At="(?:"+[fe+D+"?",D,X,He,Z].join("|")+")",Ye=RegExp(K+"(?="+K+")|"+At+Ne,"g");function Et(nt){for(var Ct=Ye.lastIndex=0;Ye.test(nt);)++Ct;return Ct}Fe.exports=Et},mE2a:function(Fe,_){function o(x){return function(p){return x==null?void 0:x[p]}}Fe.exports=o},mF5f:function(Fe,_){var o="[object Object]";function x(He){var Xe=!1;if(He!=null&&typeof He.toString!="function")try{Xe=!!(He+"")}catch(pe){}return Xe}function p(He,Xe){return function(pe){return He(Xe(pe))}}var Y=Function.prototype,z=Object.prototype,i=Y.toString,Z=z.hasOwnProperty,D=i.call(Object),K=z.toString,re=p(Object.getPrototypeOf,Object);function fe(He){return!!He&&typeof He=="object"}function X(He){if(!fe(He)||K.call(He)!=o||x(He))return!1;var Xe=re(He);if(Xe===null)return!0;var pe=Z.call(Xe,"constructor")&&Xe.constructor;return typeof pe=="function"&&pe instanceof pe&&i.call(pe)==D}Fe.exports=X},mKJG:function(Fe,_){},mt6U:function(Fe,_,o){var x=o("M/r+"),p=o("pAaq"),Y=o("YEB8");function z(i,Z){return Y(p(i,Z,x),i+"")}Fe.exports=z},myZC:function(Fe,_){function o(x,p){for(var Y=-1,z=x==null?0:x.length;++Y<z&&!(p(x[Y],Y,x)===!1););return x}Fe.exports=o},n1AK:function(Fe,_,o){var x=o("YfZD"),p=o("USOk"),Y=o("M/r+"),z=p?function(i,Z){return p(i,"toString",{configurable:!0,enumerable:!1,value:x(Z),writable:!0})}:Y;Fe.exports=z},nSSz:function(Fe,_,o){"use strict";o.d(_,"a",function(){return Ct}),o.d(_,"b",function(){return Wt}),o.d(_,"e",function(){return oe}),o.d(_,"f",function(){return Se}),o.d(_,"c",function(){return qt}),o.d(_,"d",function(){return Tt});var x=o("L84c"),p=o.n(x),Y=o("b83N"),z=o.n(Y),i=o("xjNF"),Z=o.n(i),D=o("vMUQ"),K=o.n(D),re=o("ArX4"),fe=o.n(re),X=o("by6o"),He=o.n(X),Xe=o("cxjn"),pe=o("LhPA"),Ce=o("2pGt");function mt(ot,Ut){var $=Object.keys(ot);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(ot);Ut&&(Qe=Qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),$.push.apply($,Qe)}return $}function Ne(ot){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?mt(Object($),!0).forEach(function(Qe){p()(ot,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors($)):mt(Object($)).forEach(function(Qe){Object.defineProperty(ot,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return ot}function At(ot){var Ut=Ye();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function Ye(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Et;(function(ot){ot.TOPRIGHT="topright",ot.TOPLEFT="topleft",ot.BOTTOMRIGHT="bottomright",ot.BOTTOMLEFT="bottomleft"})(Et||(Et={}));var nt=0,Ct=function(ot){K()($,ot);var Ut=At($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this),ae.controlOption=void 0,ae.container=void 0,ae.sceneContainer=void 0,ae.mapsService=void 0,ae.renderService=void 0,ae.layerService=void 0,ae.controlService=void 0,ae.isShow=void 0,ae.controlOption=Ne(Ne({},ae.getDefault()),Qe||{}),ae}return Z()($,[{key:"getDefault",value:function(){return{position:Et.TOPRIGHT,name:"".concat(nt++)}}},{key:"setPosition",value:function(ae){var et=this.controlService;return et&&et.removeControl(this),this.controlOption.position=ae,et&&et.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ae){this.mapsService=ae.get(Xe.TYPES.IMapService),this.renderService=ae.get(Xe.TYPES.IRendererService),this.layerService=ae.get(Xe.TYPES.ILayerService),this.controlService=ae.get(Xe.TYPES.IControlService),this.sceneContainer=ae,this.isShow=!0,this.container=this.onAdd();var et=this.container,kt=this.controlOption.position,pr=this.controlService.controlCorners[kt];return pe.a.addClass(et,"l7-control"),kt.indexOf("bottom")!==-1?pr.insertBefore(et,pr.firstChild):pr.appendChild(et),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ae=this.container;pe.a.addClass(ae,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ae=this.container;pe.a.removeClass(ae,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;pe.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ae){if(this.mapsService&&ae&&ae.screenX>0&&ae.screenY>0){var et=this.mapsService.getContainer();et!==null&&et.focus()}}}]),$}(Ce.EventEmitter),Ot=o("VGra"),Re=o.n(Ot);function Ie(ot){var Ut=Be();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function Be(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var ft=function(ot){K()($,ot);var Ut=Ie($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this,Qe),ae.layerControlInputs=void 0,ae.layers=void 0,ae.lastZIndex=void 0,ae.handlingClick=void 0,ae.layersLink=void 0,ae.baseLayersList=void 0,ae.separator=void 0,ae.overlaysList=void 0,ae.form=void 0,ae.layerControlInputs=[],ae.layers=[],ae.lastZIndex=0,ae.handlingClick=!1,ae.initLayers(),Object(pe.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Re()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:Xe.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ae=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(et){et.layer.on("remove",ae.onLayerChange),et.layer.on("add",ae.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ae,et){return this.addLayer(ae,et,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ae=this.renderService.getViewportSize(),et=ae.height;pe.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var kt=et-(this.container.offsetTop+50);return kt<this.form.clientHeight?(pe.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=kt+"px"):pe.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return pe.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ae=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(et){et.layer.off("remove",ae.onLayerChange),et.layer.off("add",ae.onLayerChange)})}},{key:"initLayout",value:function(){var ae="l7-control-layers",et=this.container=pe.a.create("div",ae),kt=this.controlOption.collapsed;et.setAttribute("aria-haspopup","true");var pr=this.form=pe.a.create("form",ae+"-list");kt&&(this.mapsService.on("click",this.collapse),et.addEventListener("mouseenter",this.expand),et.addEventListener("mouseleave",this.collapse)),this.layersLink=pe.a.create("a",ae+"-toggle",et);var Ke=this.layersLink;Ke.title="Layers",kt||this.expand(),this.baseLayersList=pe.a.create("div",ae+"-base",pr),this.separator=pe.a.create("div",ae+"-separator",pr),this.overlaysList=pe.a.create("div",ae+"-overlays",pr),et.appendChild(pr)}},{key:"initLayers",value:function(){var ae=this,et=this.controlOption,kt=et.baseLayers,pr=kt===void 0?{}:kt,Ke=et.overlayers,bt=Ke===void 0?{}:Ke;Object.keys(pr).forEach(function(yt,xt){ae.addLayer(pr[yt],yt,!1)}),Object.keys(bt).forEach(function(yt,xt){ae.addLayer(bt[yt],yt,!0)})}},{key:"update",value:function(){if(!this.container)return this;pe.a.empty(this.baseLayersList),pe.a.empty(this.overlaysList),this.layerControlInputs=[];var ae,et,kt,pr,Ke=0;for(kt=0;kt<this.layers.length;kt++)pr=this.layers[kt],this.addItem(pr),et=et||pr.overlay,ae=ae||!pr.overlay,Ke+=pr.overlay?0:1;return this.controlOption.hideSingleBase&&(ae=ae&&Ke>1,this.baseLayersList.style.display=ae?"":"none"),this.separator.style.display=et&&ae?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ae=this.layerControlInputs,et,kt,pr=this.mapsService.getZoom(),Ke=ae.length-1;Ke>=0;Ke--)if(et=ae[Ke],kt=this.layerService.getLayer(et.layerId),kt&&kt.inited){var bt=kt.getMinZoom(),yt=kt.getMaxZoom();et.disabled=pr<bt||pr>yt}}},{key:"addLayer",value:function(ae,et,kt){this.mapsService&&(ae.on("add",this.onLayerChange),ae.on("remove",this.onLayerChange)),this.layers.push({layer:ae,name:et,overlay:kt});var pr=this.controlOption,Ke=pr.sortLayers,bt=pr.sortFunction,yt=pr.autoZIndex;Ke&&this.layers.sort(function(xt,ze){return bt(xt.layer,ze.layer,xt.name,ze.name)}),yt&&ae.setZIndex&&(this.lastZIndex++,ae.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ae){this.handlingClick||this.update();var et=this.layerService.getLayer(ae.target.layerId),kt=(et==null?void 0:et.overlay)?ae.type==="add"?"overlayadd":"overlayremove":ae.type==="add"?"baselayerchange":null;kt&&this.emit(kt,et)}},{key:"createRadioElement",value:function(ae,et){var kt='<input type="radio" class="l7-control-layers-selector" name="'+ae+'"'+(et?' checked="checked"':"")+"/>",pr=document.createElement("div");return pr.innerHTML=kt,pr.firstChild}},{key:"addItem",value:function(ae){var et=document.createElement("label"),kt=this.layerService.getLayer(ae.layer.id),pr=kt&&kt.inited&&ae.layer.isVisible(),Ke;ae.overlay?(Ke=document.createElement("input"),Ke.type="checkbox",Ke.className="l7-control-layers-selector",Ke.defaultChecked=pr):Ke=this.createRadioElement("l7-base-layers",pr),this.layerControlInputs.push(Ke),Ke.layerId=ae.layer.id,Ke.addEventListener("click",this.onInputClick);var bt=document.createElement("span");bt.innerHTML=" "+ae.name;var yt=document.createElement("div");et.appendChild(yt),yt.appendChild(Ke),yt.appendChild(bt);var xt=ae.overlay?this.overlaysList:this.baseLayersList;return xt.appendChild(et),this.checkDisabledLayers(),et}},{key:"onInputClick",value:function(){var ae=this.layerControlInputs,et,kt,pr=[],Ke=[];this.handlingClick=!0;for(var bt=ae.length-1;bt>=0;bt--)et=ae[bt],kt=this.layerService.getLayer(et.layerId),et.checked?pr.push(kt):et.checked||Ke.push(kt);Ke.forEach(function(yt){yt.hide()}),pr.forEach(function(yt){yt.show()}),this.handlingClick=!1}}]),$}(Ct);function Me(ot){var Ut=ht();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function ht(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Wt=function(ot){K()($,ot);var Ut=Me($);function $(){return z()(this,$),Ut.apply(this,arguments)}return Z()($,[{key:"getDefault",value:function(){return{position:Et.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ae="l7-control-logo",et=pe.a.create("div",ae),kt=pe.a.create("a","l7-ctrl-logo");return kt.target="_blank",kt.rel="noopener nofollow",kt.href="https://antv.alipay.com/l7",kt.setAttribute("aria-label","AntV logo"),kt.setAttribute("rel","noopener nofollow"),et.appendChild(kt),et}},{key:"onRemove",value:function(){return null}}]),$}(Ct);function Qt(ot){var Ut=ur();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function ur(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var oe=function(ot){K()($,ot);var Ut=Qt($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this,Qe),ae.mScale=void 0,ae.iScale=void 0,Object(pe.i)(["update"],Re()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:Et.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ae="l7-control-scale",et=pe.a.create("div",ae);this.addScales(ae+"-line",et);var kt=this.controlOption.updateWhenIdle;return this.mapsService.on(kt?"moveend":"mapmove",this.update),this.mapsService.on(kt?"zoomend":"zoomchange",this.update),this.update(),et}},{key:"onRemove",value:function(){var ae=this.controlOption.updateWhenIdle;this.mapsService.off(ae?"zoomend":"zoomchange",this.update),this.mapsService.off(ae?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ae=this.mapsService,et=this.controlOption.maxWidth,kt=ae.getSize()[1]/2,pr=ae.containerToLngLat([0,kt]),Ke=ae.containerToLngLat([et,kt]),bt=Object(pe.q)([pr.lng,pr.lat],[Ke.lng,Ke.lat]);this.updateScales(bt)}},{key:"updateScales",value:function(ae){var et=this.controlOption,kt=et.metric,pr=et.imperial;kt&&ae&&this.updateMetric(ae),pr&&ae&&this.updateImperial(ae)}},{key:"updateMetric",value:function(ae){var et=this.getRoundNum(ae),kt=et<1e3?et+" m":et/1e3+" km";this.updateScale(this.mScale,kt,et/ae)}},{key:"updateImperial",value:function(ae){var et=ae*3.2808399,kt,pr,Ke;et>5280?(kt=et/5280,pr=this.getRoundNum(kt),this.updateScale(this.iScale,pr+" mi",pr/kt)):(Ke=this.getRoundNum(et),this.updateScale(this.iScale,Ke+" ft",Ke/et))}},{key:"updateScale",value:function(ae,et,kt){var pr=this.controlOption.maxWidth;ae.style.width=Math.round(pr*kt)+"px",ae.innerHTML=et}},{key:"getRoundNum",value:function(ae){var et=Math.pow(10,(Math.floor(ae)+"").length-1),kt=ae/et;return kt=kt>=10?10:kt>=5?5:kt>=3?3:kt>=2?2:1,et*kt}},{key:"addScales",value:function(ae,et){var kt=this.controlOption,pr=kt.metric,Ke=kt.imperial;pr&&(this.mScale=pe.a.create("div",ae,et)),Ke&&(this.iScale=pe.a.create("div",ae,et))}}]),$}(Ct);function J(ot){var Ut=H();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Se=function(ot){K()($,ot);var Ut=J($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this,Qe),ae.disabled=void 0,ae.zoomInButton=void 0,ae.zoomOutButton=void 0,Object(pe.i)(["updateDisabled","zoomIn","zoomOut"],Re()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:Et.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ae="l7-control-zoom",et=pe.a.create("div",ae+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ae+"-in",et,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ae+"-out",et,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),et}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ae,et,kt,pr,Ke){var bt=pe.a.create("a",kt,pr);return bt.innerHTML=ae,bt.title=et,bt.href="javascript:void(0)",bt.addEventListener("click",Ke),bt}},{key:"updateDisabled",value:function(){var ae=this.mapsService,et="l7-disabled";pe.a.removeClass(this.zoomInButton,et),pe.a.removeClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()<=ae.getMinZoom())&&pe.a.addClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()>=ae.getMaxZoom())&&pe.a.addClass(this.zoomInButton,et)}}]),$}(Ct);function be(ot,Ut){var $=Object.keys(ot);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(ot);Ut&&(Qe=Qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),$.push.apply($,Qe)}return $}function _e(ot){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?be(Object($),!0).forEach(function(Qe){p()(ot,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors($)):be(Object($)).forEach(function(Qe){Object.defineProperty(ot,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return ot}function me(ot){var Ut=it();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var qt=function(ot){K()($,ot);var Ut=me($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this),ae.markerOption=void 0,ae.defaultMarker=void 0,ae.popup=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.scene=void 0,ae.added=!1,ae.eventHandle=function(et){ae.emit(et.type,{target:et,data:ae.markerOption.extData,lngLat:ae.lngLat})},ae.markerOption=_e(_e({},ae.getDefault()),Qe),Object(pe.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Re()(ae)),ae.init(),ae}return Z()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:pe.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ae){this.scene=ae,this.mapsService=ae.get(Xe.TYPES.IMapService),this.sceneSerive=ae.get(Xe.TYPES.ISceneService);var et=this.markerOption,kt=et.element,pr=et.draggable;return this.mapsService.getMarkerContainer().appendChild(kt),this.registerMarkerEvent(kt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ae=this.markerOption.element;return ae&&pe.a.remove(ae),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ae){var et=this;if(!this.added)return this.once("added",function(){et.setElement(ae)}),this;var kt=this.markerOption.element;return kt&&pe.a.remove(kt),this.markerOption.element=ae,this.init(),this.mapsService.getMarkerContainer().appendChild(ae),this.registerMarkerEvent(ae),this.update(),this}},{key:"openPopup",value:function(){var ae=this;if(!this.added)return this.once("added",function(){ae.openPopup()}),this;var et=this.popup;return et?(et.isOpen()||et.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ae=this;this.added||this.once("added",function(){ae.closePopup()});var et=this.popup;return et&&et.remove(),this}},{key:"setPopup",value:function(ae){return this.popup=ae,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ae=this.popup;if(ae)ae.isOpen()?ae.remove():ae.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ae){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ae){this.markerOption.extData=ae}},{key:"update",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,kt=ae.anchor;this.updatePosition(),pe.a.setTransform(et,"".concat(pe.e[kt]))}},{key:"onMapClick",value:function(ae){var et=this.markerOption.element;this.popup&&et&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,kt=ae.offsets,pr=this.lngLat,Ke=pr.lng,bt=pr.lat,yt=this.mapsService.getBounds(),xt=this.mapsService.getZoom();if((Ke<yt[0][0]||Ke>yt[1][0]||bt<yt[0][1]||bt>yt[1][1])&&xt>3){et&&(et.style.display="none");return}var ze=this.mapsService.lngLatToContainer([Ke,bt]);et&&(et.style.display="block",et.style.left=ze.x+kt[0]+"px",et.style.top=ze.y-kt[1]+"px")}},{key:"init",value:function(){var ae=this,et=this.markerOption.element,kt=this.markerOption,pr=kt.color,Ke=kt.anchor;if(!et){this.defaultMarker=!0,et=pe.a.create("div"),this.markerOption.element=et;var bt=document.createElementNS("http://www.w3.org/2000/svg","svg");bt.setAttributeNS(null,"display","block"),bt.setAttributeNS(null,"height","48px"),bt.setAttributeNS(null,"width","48px"),bt.setAttributeNS(null,"viewBox","0 0 1024 1024");var yt=document.createElementNS("http://www.w3.org/2000/svg","path");yt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),yt.setAttributeNS(null,"fill",pr),bt.appendChild(yt),et.appendChild(bt)}pe.a.addClass(et,"l7-marker"),et.addEventListener("click",function(xt){ae.onMapClick(xt)}),et.addEventListener("click",this.eventHandle),Object(pe.g)(et,Ke,"marker")}},{key:"registerMarkerEvent",value:function(ae){ae.addEventListener("mousemove",this.eventHandle),ae.addEventListener("click",this.eventHandle),ae.addEventListener("mousedown",this.eventHandle),ae.addEventListener("mouseup",this.eventHandle),ae.addEventListener("dblclick",this.eventHandle),ae.addEventListener("contextmenu",this.eventHandle),ae.addEventListener("mouseover",this.eventHandle),ae.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ae=this.getElement();ae.removeEventListener("mousemove",this.eventHandle),ae.removeEventListener("click",this.eventHandle),ae.removeEventListener("mousedown",this.eventHandle),ae.removeEventListener("mouseup",this.eventHandle),ae.removeEventListener("dblclick",this.eventHandle),ae.removeEventListener("contextmenu",this.eventHandle),ae.removeEventListener("mouseover",this.eventHandle),ae.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ae){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ae){throw new Error("Method not implemented.")}}]),$}(Ce.EventEmitter),Pt=o("RM4u"),ve=o.n(Pt),ge=o("9DPn"),Ve=o.n(ge);function st(ot,Ut){var $=Object.keys(ot);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(ot);Ut&&(Qe=Qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),$.push.apply($,Qe)}return $}function Oe(ot){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?st(Object($),!0).forEach(function(Qe){p()(ot,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors($)):st(Object($)).forEach(function(Qe){Object.defineProperty(ot,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return ot}function vt(ot){var Ut=C();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var R=function(ot){K()($,ot);var Ut=vt($);function $(Qe){var ae,et;return z()(this,$),et=Ut.call(this),et.markers=[],et.markerLayerOption=void 0,et.clusterIndex=void 0,et.points=[],et.clusterMarkers=[],et.mapsService=void 0,et.scene=void 0,et.zoom=void 0,et.bbox=void 0,et.markerLayerOption=ve()(et.getDefault(),Qe),Object(pe.i)(["update"],Re()(et)),et.zoom=((ae=et.markerLayerOption.clusterOption)===null||ae===void 0?void 0:ae.zoom)||-99,et}return Z()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ae){return this.scene=ae,this.mapsService=ae.get(Xe.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ae){var et=this.markerLayerOption.cluster;et&&this.addPoint(ae,this.markers.length),this.markers.push(ae)}},{key:"removeMarker",value:function(ae){this.markers.indexOf(ae);var et=this.markers.indexOf(ae);et>-1&&this.markers.splice(et,1)}},{key:"getMarkers",value:function(){var ae=this.markerLayerOption.cluster;return ae?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ae=this;this.getMarkers().forEach(function(et){et.addTo(ae.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ae){ae.remove()}),this.clusterMarkers.forEach(function(ae){ae.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ae,et){var kt=ae.getLnglat(),pr=kt.lng,Ke=kt.lat,bt={geometry:{type:"Point",coordinates:[pr,Ke]},properties:Oe(Oe({},ae.getExtData()),{},{marker_id:et})};this.points.push(bt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ae=this.markerLayerOption.clusterOption,et=ae.radius,kt=ae.minZoom,pr=kt===void 0?0:kt,Ke=ae.maxZoom;this.clusterIndex=new Ve.a({radius:et,minZoom:pr,maxZoom:Ke}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ae,et){var kt=this,pr=ae[0].concat(ae[1]),Ke=this.clusterIndex.getClusters(pr,et);this.clusterMarkers.forEach(function(bt){bt.remove()}),this.clusterMarkers=[],Ke.forEach(function(bt){var yt,xt=kt.markerLayerOption.clusterOption,ze=xt.field,dt=xt.method;if(bt.properties&&((yt=bt.properties)===null||yt===void 0?void 0:yt.cluster_id)){var gt,Ht=kt.getLeaves((gt=bt.properties)===null||gt===void 0?void 0:gt.cluster_id);if(bt.properties.clusterData=Ht,ze&&dt){var hr=Ht==null?void 0:Ht.map(function(oa){var $n=p()({},ze,oa.properties[ze]);return $n}),Zr=pe.c.getColumn(hr,ze),yr=pe.c.getSatByColumn(dt,Zr),Vn="point_"+dt;bt.properties[Vn]=yr.toFixed(2)}}var Fn=kt.clusterMarker(bt);kt.clusterMarkers.push(Fn),Fn.addTo(kt.scene)})}},{key:"getLeaves",value:function(ae){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ae?this.clusterIndex.getLeaves(ae,et,kt):null}},{key:"clusterMarker",value:function(ae){var et=this.markerLayerOption.clusterOption,kt=et,pr=kt.element,Ke=pr===void 0?this.generateElement.bind(this):pr,bt=new qt({element:Ke(ae)}).setLnglat({lng:ae.geometry.coordinates[0],lat:ae.geometry.coordinates[1]});return bt}},{key:"normalMarker",value:function(ae){var et=ae.properties.marker_id;return this.markers[et]}},{key:"update",value:function(){var ae=this.mapsService.getZoom(),et=this.mapsService.getBounds();(!this.bbox||Math.abs(ae-this.zoom)>=1||!Object(pe.j)(this.bbox,et))&&(this.bbox=Object(pe.r)(et,.5),this.zoom=Math.floor(ae),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ae){var et=pe.a.create("div","l7-marker-cluster"),kt=pe.a.create("div","",et),pr=pe.a.create("span","",kt),Ke=this.markerLayerOption.clusterOption,bt=Ke.field,yt=Ke.method;ae.properties.point_count=ae.properties.point_count||1;var xt=bt&&yt?ae.properties["point_"+yt]||ae.properties[bt]:ae.properties.point_count;return pr.textContent=xt,et}}]),$}(Ce.EventEmitter);function q(ot,Ut){var $=Object.keys(ot);if(Object.getOwnPropertySymbols){var Qe=Object.getOwnPropertySymbols(ot);Ut&&(Qe=Qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),$.push.apply($,Qe)}return $}function ce(ot){for(var Ut=1;Ut<arguments.length;Ut++){var $=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?q(Object($),!0).forEach(function(Qe){p()(ot,Qe,$[Qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function(Qe){Object.defineProperty(ot,Qe,Object.getOwnPropertyDescriptor($,Qe))})}return ot}function Ge(ot){var Ut=qe();return function(){var Qe=He()(ot),ae;if(Ut){var et=He()(this).constructor;ae=Reflect.construct(Qe,arguments,et)}else ae=Qe.apply(this,arguments);return fe()(this,ae)}}function qe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Tt=function(ot){K()($,ot);var Ut=Ge($);function $(Qe){var ae;return z()(this,$),ae=Ut.call(this),ae.popupOption=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.content=void 0,ae.closeButton=void 0,ae.timeoutInstance=void 0,ae.container=void 0,ae.tip=void 0,ae.scene=void 0,ae.popupOption=ce(ce({},ae.getdefault()),Qe),Object(pe.i)(["update","onClickClose","remove"],Re()(ae)),ae}return Z()($,[{key:"addTo",value:function(ae){var et=this;return this.mapsService=ae.get(Xe.TYPES.IMapService),this.sceneSerive=ae.get(Xe.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ae,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){et.mapsService.on("click",et.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ae){var et=window.document.createDocumentFragment(),kt=window.document.createElement("body"),pr;for(kt.innerHTML=ae;!(pr=kt.firstChild,!pr);)et.appendChild(pr);return this.setDOMContent(et)}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ae){return this.setDOMContent(window.document.createTextNode(ae))}},{key:"setMaxWidth",value:function(ae){return this.popupOption.maxWidth=ae,this.update(),this}},{key:"setDOMContent",value:function(ae){return this.createContent(),this.content.appendChild(ae),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&pe.a.remove(this.content),this.content=pe.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=pe.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ae,et,kt){var pr=window.document.createElement(ae);return et!==void 0&&(pr.className=et),kt&&kt.appendChild(pr),pr}},{key:"removeDom",value:function(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:pe.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ae){ae.stopPropagation&&ae.stopPropagation(),this.remove()}},{key:"update",value:function(){var ae=this,et=this.lngLat,kt=this.popupOption,pr=kt.className,Ke=kt.maxWidth,bt=kt.anchor;if(!this.mapsService||!et||!this.content)return;var yt=this.mapsService.getMarkerContainer();if(!this.container&&yt){this.container=this.creatDom("div","l7-popup",yt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),pr&&pr.split(" ").forEach(function(ze){return ae.container.classList.add(ze)});var xt=this.popupOption.stopPropagation;xt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(ze){ae.container.addEventListener(ze,function(dt){dt.stopPropagation()})})}Ke&&this.container.style.maxWidth!==Ke&&(this.container.style.maxWidth=Ke),this.updatePosition(),pe.a.setTransform(this.container,"".concat(pe.e[bt])),Object(pe.g)(this.container,bt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.lngLat,et=ae.lng,kt=ae.lat,pr=this.popupOption.offsets,Ke=this.mapsService.lngLatToContainer([et,kt]);this.container.style.left=Ke.x+pr[0]+"px",this.container.style.top=Ke.y-pr[1]+"px"}}]),$}(Ce.EventEmitter);o("qwXO")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},nVKE:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("NNd+"),p=o("0d2E"),Y=o("7s3S"),z=o("/jsB"),i=o("Cv2u"),Z=o("QTk+"),D=o("vZkN"),K=o("Vrkw"),re=o("qR+W"),fe=o("S0vU"),X=o("NI1Q"),He=o("Wz0W");function Xe(nt){return nt._bindingDictionary}_.getBindingDictionary=Xe;function pe(nt,Ct,Ot,Re,Ie,Be){var ft=nt?z.MULTI_INJECT_TAG:z.INJECT_TAG,Me=new K.Metadata(ft,Ot),ht=new He.Target(Ct,Re,Ot,Me);if(Ie!==void 0){var Wt=new K.Metadata(Ie,Be);ht.metadata.push(Wt)}return ht}function Ce(nt,Ct,Ot,Re,Ie){var Be=At(Ot.container,Ie.serviceIdentifier),ft=[];return Be.length===x.BindingCount.NoBindingsAvailable&&Ot.container.options.autoBindInjectable&&typeof Ie.serviceIdentifier=="function"&&nt.getConstructorMetadata(Ie.serviceIdentifier).compilerGeneratedMetadata&&(Ot.container.bind(Ie.serviceIdentifier).toSelf(),Be=At(Ot.container,Ie.serviceIdentifier)),Ct?ft=Be:ft=Be.filter(function(Me){var ht=new X.Request(Me.serviceIdentifier,Ot,Re,Me,Ie);return Me.constraint(ht)}),mt(Ie.serviceIdentifier,ft,Ie,Ot.container),ft}function mt(nt,Ct,Ot,Re){switch(Ct.length){case x.BindingCount.NoBindingsAvailable:if(Ot.isOptional())return Ct;var Ie=Z.getServiceIdentifierAsString(nt),Be=p.NOT_REGISTERED;throw Be+=Z.listMetadataForTarget(Ie,Ot),Be+=Z.listRegisteredBindingsForServiceIdentifier(Re,Ie,At),new Error(Be);case x.BindingCount.OnlyOneBindingAvailable:if(!Ot.isArray())return Ct;case x.BindingCount.MultipleBindingsAvailable:default:if(Ot.isArray())return Ct;var Ie=Z.getServiceIdentifierAsString(nt),Be=p.AMBIGUOUS_MATCH+" "+Ie;throw Be+=Z.listRegisteredBindingsForServiceIdentifier(Re,Ie,At),new Error(Be)}}function Ne(nt,Ct,Ot,Re,Ie,Be){var ft,Me;if(Ie===null){ft=Ce(nt,Ct,Re,null,Be),Me=new X.Request(Ot,Re,null,ft,Be);var ht=new re.Plan(Re,Me);Re.addPlan(ht)}else ft=Ce(nt,Ct,Re,Ie,Be),Me=Ie.addChildRequest(Be.serviceIdentifier,ft,Be);ft.forEach(function(Wt){var Qt=null;if(Be.isArray())Qt=Me.addChildRequest(Wt.serviceIdentifier,Wt,Be);else{if(Wt.cache)return;Qt=Me}if(Wt.type===Y.BindingTypeEnum.Instance&&Wt.implementationType!==null){var ur=fe.getDependencies(nt,Wt.implementationType);if(!Re.container.options.skipBaseClassChecks){var oe=fe.getBaseClassDependencyCount(nt,Wt.implementationType);if(ur.length<oe){var J=p.ARGUMENTS_LENGTH_MISMATCH(fe.getFunctionName(Wt.implementationType));throw new Error(J)}}ur.forEach(function(H){Ne(nt,!1,H.serviceIdentifier,Re,Qt,H)})}})}function At(nt,Ct){var Ot=[],Re=Xe(nt);return Re.hasKey(Ct)?Ot=Re.get(Ct):nt.parent!==null&&(Ot=At(nt.parent,Ct)),Ot}function Ye(nt,Ct,Ot,Re,Ie,Be,ft,Me){Me===void 0&&(Me=!1);var ht=new D.Context(Ct),Wt=pe(Ot,Re,Ie,"",Be,ft);try{return Ne(nt,Me,Ie,ht,null,Wt),ht}catch(Qt){throw i.isStackOverflowExeption(Qt)&&(ht.plan&&Z.circularDependencyToException(ht.plan.rootRequest)),Qt}}_.plan=Ye;function Et(nt,Ct,Ot,Re){var Ie=new He.Target(Y.TargetTypeEnum.Variable,"",Ct,new K.Metadata(Ot,Re)),Be=new D.Context(nt),ft=new X.Request(Ct,Be,null,[],Ie);return ft}_.createMockRequest=Et},nz7D:function(Fe,_,o){var x=o("Ycz+"),p=o("OUY8"),Y=o("uWVo"),z=o("xrLW");function i(Z){return function(D){D=z(D);var K=p(D)?Y(D):void 0,re=K?K[0]:D.charAt(0),fe=K?x(K,1).join(""):D.slice(1);return re[Z]()+fe}}Fe.exports=i},"o+P9":function(Fe,_,o){"use strict";(function(x,p){o.d(_,"b",function(){return Z}),o.d(_,"a",function(){return re});var Y=o("PoO7"),z={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof x!="undefined"&&x,document:typeof document!="undefined"&&document,process:(typeof p=="undefined"?"undefined":Object(Y.a)(p))==="object"&&p},i=z.self||z.window||z.global,Z=z.window||z.self||z.global,D=z.global||z.self||z.window,K=z.document||{},re=z.process||{},fe=console}).call(this,o("UywP"),o("7vYp"))},"oH/p":function(Fe,_){function o(x,p,Y,z){if(!Y)return;Object.defineProperty(x,p,{enumerable:Y.enumerable,configurable:Y.configurable,writable:Y.writable,value:Y.initializer?Y.initializer.call(z):void 0})}Fe.exports=o},obOy:function(Fe,_){function o(x,p){return p==="constructor"&&typeof x[p]=="function"||p=="__proto__"?void 0:x[p]}Fe.exports=o},"ofY/":function(Fe,_,o){var x=o("d55j"),p=o("wndA");function Y(z){return x(z,p(z))}Fe.exports=Y},ojxZ:function(Fe,_){function o(x,p,Y,z){var i=-1,Z=x==null?0:x.length;for(z&&Z&&(Y=x[++i]);++i<Z;)Y=p(Y,x[i],i,x);return Y}Fe.exports=o},"p+bC":function(Fe,_,o){var x=o("RhpP"),p=o("xrLW"),Y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,z="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",D=z+i+Z,K="["+D+"]",re=RegExp(K,"g");function fe(X){return X=p(X),X&&X.replace(Y,x).replace(re,"")}Fe.exports=fe},p14H:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x;(function(p){p.Normal="normal",p.PostProcessing="post-processing"})(x||(x={}))},pAaq:function(Fe,_,o){var x=o("NgVo"),p=Math.max;function Y(z,i,Z){return i=p(i===void 0?z.length-1:i,0),function(){for(var D=arguments,K=-1,re=p(D.length-i,0),fe=Array(re);++K<re;)fe[K]=D[i+K];K=-1;for(var X=Array(i+1);++K<i;)X[K]=D[K];return X[i]=Z(fe),x(z,this,X)}}Fe.exports=Y},pXiX:function(Fe,_,o){"use strict";o.d(_,"e",function(){return ol}),o.d(_,"f",function(){return ro}),o.d(_,"d",function(){return Rc}),o.d(_,"a",function(){return so}),o.d(_,"c",function(){return Di}),o.d(_,"g",function(){return jc}),o.d(_,"b",function(){return ml});var x=o("cxjn"),p=o("b83N"),Y=o.n(p),z=o("xjNF"),i=o.n(z),Z=o("vMUQ"),D=o.n(Z),K=o("ArX4"),re=o.n(K),fe=o("by6o"),X=o.n(fe),He=o("37+z"),Xe=o.n(He),pe=o("L84c"),Ce=o.n(pe),mt=o("oH/p"),Ne=o.n(mt),At=o("VGra"),Ye=o.n(At),Et=o("jZ0V"),nt=o.n(Et),Ct=o("DXzO"),Ot=o("gteZ"),Re=o.n(Ot),Ie=o("33CM"),Be=o.n(Ie),ft=o("Tj1F"),Me=o("LhPA"),ht=o("2pGt"),Wt=o("aj+B"),Qt=o.n(Wt),ur=o("S+oY"),oe,J,H,Se,be,_e;function me(h){return h.map(function(T){return typeof T=="string"&&(T=[T,{}]),T})}var it=(oe=Object(ur.injectable)(),J=Object(ur.inject)(x.TYPES.IGlobalConfigService),oe(H=(Se=(_e=function(){function h(){Y()(this,h),Ne()(this,"configService",be,this),this.enabled=void 0}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.rendererService,U=b.postProcessingPassFactory,ie=b.normalPassFactory;E.hooks.init.tap("MultiPassRendererPlugin",function(){var de=E.getLayerConfig(),Ue=de.enableMultiPassRenderer,Ft=de.passes,er=Ft===void 0?[]:Ft;A.enabled=!!Ue&&E.getLayerConfig().enableMultiPassRenderer!==!1,A.enabled&&(E.multiPassRenderer=A.createMultiPassRenderer(E,er,U,ie),E.multiPassRenderer.setRenderFlag(!0))}),E.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(E,b,A,M){var U=E.multiPassRenderer,ie=E.getLayerConfig(),de=ie.enablePicking,Ue=ie.enableTAA;return de&&U.add(M("pixelPicking")),U}}]),h}(),_e),be=nt()(Se.prototype,"configService",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se))||H),qt,Pt=(qt={},Ce()(qt,x.BlendType.additive,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE,srcAlpha:1,dstAlpha:1}}),Ce()(qt,x.BlendType.none,{enable:!1}),Ce()(qt,x.BlendType.normal,{enable:!0,func:{srcRGB:x.gl.SRC_ALPHA,dstRGB:x.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Ce()(qt,x.BlendType.subtractive,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE,srcAlpha:x.gl.ZERO,dstAlpha:x.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:x.gl.FUNC_SUBTRACT,alpha:x.gl.FUNC_SUBTRACT}}),Ce()(qt,x.BlendType.max,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE},equation:{rgb:x.gl.MAX_EXT}}),Ce()(qt,x.BlendType.min,{enable:!0,func:{srcRGB:x.gl.ONE,dstRGB:x.gl.ONE},equation:{rgb:x.gl.MIN_EXT}}),qt),ve={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ge,Ve,st,Oe,vt,C,R,q;function ce(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Ge(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ue){throw Ue},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){U=!0,ie=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(U)throw ie}}}}function Ge(h,T){if(!h)return;if(typeof h=="string")return qe(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return qe(h,T)}function qe(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function Tt(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function ot(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Tt(Object(E),!0).forEach(function(b){Ce()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Tt(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function Ut(h){var T=$();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qe=0,ae=(ge=Object(x.lazyInject)(x.TYPES.ILogService),Ve=Object(x.lazyInject)(x.TYPES.IGlobalConfigService),st=Object(x.lazyInject)(x.TYPES.IShaderModuleService),Oe=(q=function(h){D()(E,h);var T=Ut(E);function E(){var b,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Y()(this,E),b=T.call(this),b.id="".concat(Qe++),b.name="".concat(Qe),b.type=void 0,b.visible=!0,b.zIndex=0,b.minZoom=void 0,b.maxZoom=void 0,b.inited=!1,b.layerModelNeedUpdate=!1,b.pickedFeatureID=null,b.selectedFeatureID=null,b.styleNeedUpdate=!1,b.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},b.hooks={init:new ft.b,afterInit:new ft.b,beforeRender:new ft.b,beforeRenderData:new ft.d,afterRender:new ft.c,beforePickingEncode:new ft.c,afterPickingEncode:new ft.c,beforeHighlight:new ft.c(["pickedColor"]),afterHighlight:new ft.c,beforeSelect:new ft.c(["pickedColor"]),afterSelect:new ft.c,beforeDestroy:new ft.c,afterDestroy:new ft.c},b.models=[],b.multiPassRenderer=void 0,b.plugins=void 0,b.sourceOption=void 0,b.layerModel=void 0,Ne()(b,"logger",vt,Ye()(b)),Ne()(b,"configService",C,Ye()(b)),Ne()(b,"shaderModuleService",R,Ye()(b)),b.cameraService=void 0,b.coordinateService=void 0,b.iconService=void 0,b.fontService=void 0,b.rendererService=void 0,b.layerService=void 0,b.interactionService=void 0,b.mapService=void 0,b.styleAttributeService=void 0,b.layerSource=void 0,b.postProcessingPassFactory=void 0,b.normalPassFactory=void 0,b.animateOptions={enable:!1},b.container=void 0,b.encodedData=void 0,b.configSchema=void 0,b.currentPickId=null,b.rawConfig=void 0,b.needUpdateConfig=void 0,b.pendingStyleAttributes=[],b.scaleOptions={},b.animateStartTime=void 0,b.aniamateStatus=!1,b.sourceEvent=function(){b.dataState.dataSourceNeedUpdate=!0;var M=b.getLayerConfig(),U=M.autoFit,ie=M.fitBoundsOptions;U&&b.fitBounds(ie),b.emit("dataUpdate"),b.reRender()},b.name=A.name||b.id,b.zIndex=A.zIndex||0,b.rawConfig=A,b}return i()(E,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(A){if(!this.inited)this.needUpdateConfig=ot(ot({},this.needUpdateConfig),A);else{var M=this.container.get(x.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,ot(ot(ot({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),A)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(A){this.container=A}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(A){return this.plugins.push(A),this}},{key:"init",value:function(){var A=this,M=this.container.get(x.TYPES.SceneID),U=this.rawConfig.enableMultiPassRenderer,ie=U===void 0?!1:U;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(x.TYPES.IIconService),this.fontService=this.container.get(x.TYPES.IFontService),this.rendererService=this.container.get(x.TYPES.IRendererService),this.layerService=this.container.get(x.TYPES.ILayerService),this.interactionService=this.container.get(x.TYPES.IInteractionService),this.mapService=this.container.get(x.TYPES.IMapService),this.cameraService=this.container.get(x.TYPES.ICameraService),this.coordinateService=this.container.get(x.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(x.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(x.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(x.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(x.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(er){var Mr=er.attributeName,kr=er.attributeField,xn=er.attributeValues,yn=er.updateOptions;A.styleAttributeService.updateStyleAttribute(Mr,{scale:ot({field:kr},A.splitValuesAndCallbackInAttribute(xn,A.getLayerConfig()[Mr]))},yn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(x.TYPES.ILayerPlugin);var de=ce(this.plugins),Ue;try{for(de.s();!(Ue=de.n()).done;){var Ft=Ue.value;Ft.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(er){de.e(er)}finally{de.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(ot(ot({},this.getDefaultConfig()),this.rawConfig));var A=this.getLayerConfig(),M=A.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(A,M,U){return this.updateStyleAttribute("color",A,M,U),this}},{key:"size",value:function(A,M,U){return this.updateStyleAttribute("size",A,M,U),this}},{key:"filter",value:function(A,M,U){return this.updateStyleAttribute("filter",A,M,U),this}},{key:"shape",value:function(A,M,U){return this.updateStyleAttribute("shape",A,M,U),this}},{key:"label",value:function(A,M,U){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:A,attributeValues:M,updateOptions:U}),this}},{key:"animate",value:function(A){var M={};return Re()(A)?(M.enable=!0,M=ot(ot({},M),A)):M.enable=A,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(A,M){return this.sourceOption={data:A,options:M},this}},{key:"setData",value:function(A,M){var U=this;return this.inited?this.layerSource.setData(A,M):this.on("inited",function(){U.layerSource.setData(A,M)}),this}},{key:"style",value:function(A){var M=this,U=A.passes,ie=Xe()(A,["passes"]);return U&&me(U).forEach(function(de){var Ue=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(de[0]);Ue&&Ue.updateOptions(de[1])}),this.rawConfig=ot(ot({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(A,M){return Re()(A)?this.scaleOptions=ot(ot({},this.scaleOptions),A):this.scaleOptions[A]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(A){var M={};return M.enableHighlight=Re()(A)?!0:A,Re()(A)?(M.enableHighlight=!0,A.color&&(M.highlightColor=A.color)):M.enableHighlight=!!A,this.updateLayerConfig(M),this}},{key:"setActive",value:function(A,M){var U=this;if(Re()(A)){var ie=A.x,de=ie===void 0?0:ie,Ue=A.y,Ft=Ue===void 0?0:Ue;this.updateLayerConfig({highlightColor:Re()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:de,y:Ft})}else this.updateLayerConfig({pickedFeatureID:A,highlightColor:Re()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"select",value:function(A){var M={};return M.enableSelect=Re()(A)?!0:A,Re()(A)?(M.enableSelect=!0,A.color&&(M.selectColor=A.color)):M.enableSelect=!!A,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(A,M){var U=this;if(Re()(A)){var ie=A.x,de=ie===void 0?0:ie,Ue=A.y,Ft=Ue===void 0?0:Ue;this.updateLayerConfig({selectColor:Re()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:de,y:Ft})}else this.updateLayerConfig({pickedFeatureID:A,selectColor:Re()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"setBlend",value:function(A){this.updateLayerConfig({blend:A}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(A){return this.zIndex=A,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(A){this.currentPickId=A}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(A){this.selectedFeatureID=A}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var A=this.mapService.getZoom(),M=this.getLayerConfig(),U=M.visible,ie=M.minZoom,de=ie===void 0?-Infinity:ie,Ue=M.maxZoom,Ft=Ue===void 0?Infinity:Ue;return!!U&&A>=de&&A<=Ft}},{key:"setMinZoom",value:function(A){return this.updateLayerConfig({minZoom:A}),this}},{key:"getMinZoom",value:function(){var A=this.getLayerConfig(),M=A.minZoom;return M}},{key:"getMaxZoom",value:function(){var A=this.getLayerConfig(),M=A.maxZoom;return M}},{key:"get",value:function(A){var M=this.getLayerConfig();return M[A]}},{key:"setMaxZoom",value:function(A){return this.updateLayerConfig({maxZoom:A}),this}},{key:"fitBounds",value:function(A){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),U=M.extent,ie=U.some(function(de){return Math.abs(de)===Infinity});return ie?this:(this.mapService.fitBounds([[U[0],U[1]],[U[2],U[3]]],A),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(A){return A.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(A){return A.needRescale||A.needRemapping||A.needRegenerateVertices}).length}},{key:"setSource",value:function(A){this.layerSource=A;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(A){this.encodedData=A}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Qt()([ve,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(A){var M=this.styleAttributeService.getLayerAttributeScale(A);if(M){if(M.ticks){var U=M.ticks().map(function(de){return Ce()({value:de},A,M(de))});return U}else if(M.invertExtent){var ie=M.range().map(function(de){return Ce()({value:M.invertExtent(de)},A,de)});return ie}}else return[]}},{key:"pick",value:function(A){var M=A.x,U=A.y;this.interactionService.triggerHover({x:M,y:U})}},{key:"buildLayerModel",value:function(A){var M=A.moduleName,U=A.vertexShader,ie=A.fragmentShader,de=A.triangulation,Ue=Xe()(A,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:U,fs:ie});var Ft=this.shaderModuleService.getModule(M),er=Ft.vs,Mr=Ft.fs,kr=Ft.uniforms,xn=this.rendererService.createModel,yn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,de),zn=yn.attributes,Sa=yn.elements;return xn(ot({attributes:zn,uniforms:kr,fs:Mr,vs:er,elements:Sa,blend:Pt[x.BlendType.normal]},Ue))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(A){var M=this.getLayerConfig(),U=M.enableHighlight,ie=U===void 0?!0:U,de=M.enableSelect,Ue=de===void 0?!0:de,Ft=this.eventNames().indexOf(A)!==-1||this.eventNames().indexOf("un"+A)!==-1;return(A==="click"||A==="dblclick")&&Ue&&(Ft=!0),A==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Ft=!0),this.isVisible()&&Ft}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var A=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:A.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(A,M){return{values:Be()(A)?void 0:A||M,callback:Be()(A)?A:void 0}}},{key:"updateStyleAttribute",value:function(A,M,U,ie){this.inited?this.styleAttributeService.updateStyleAttribute(A,{scale:ot({field:M},this.splitValuesAndCallbackInAttribute(U,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:A,attributeField:M,attributeValues:U,updateOptions:ie})}}]),E}(ht.EventEmitter),q),vt=nt()(Oe.prototype,"logger",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=nt()(Oe.prototype,"configService",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=nt()(Oe.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe),et,kt,pr,Ke,bt,yt,xt=(et=Object(x.lazyInject)(x.TYPES.IGlobalConfigService),kt=Object(x.lazyInject)(x.TYPES.IShaderModuleService),pr=(yt=function(){function h(T){Y()(this,h),this.triangulation=void 0,this.layer=void 0,Ne()(this,"configService",Ke,this),Ne()(this,"shaderModuleService",bt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=T,this.rendererService=T.getContainer().get(x.TYPES.IRendererService),this.styleAttributeService=T.getContainer().get(x.TYPES.IStyleAttributeService),this.mapService=T.getContainer().get(x.TYPES.IMapService),this.iconService=T.getContainer().get(x.TYPES.IIconService),this.fontService=T.getContainer().get(x.TYPES.IFontService),this.cameraService=T.getContainer().get(x.TYPES.ICameraService),this.layerService=T.getContainer().get(x.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return i()(h,[{key:"getBlend",value:function(){var E=this.layer.getLayerConfig(),b=E.blend,A=b===void 0?"normal":b;return Pt[x.BlendType[A]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(E){return[E.enable?0:1,E.duration||4,E.interval||.2,E.trailLength||.1]}},{key:"startModelAnimate",value:function(){var E=this.layer.getLayerConfig(),b=E.animateOption;b.enable&&this.layer.setAnimateStartTime()}}]),h}(),yt),Ke=nt()(pr.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt=nt()(pr.prototype,"shaderModuleService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pr),ze=o("++Hr"),dt=o.n(ze),gt=o("h9B+"),Ht=o.n(gt),hr=o("YvkH"),Zr=o.n(hr),yr=o("99LQ"),Vn=yr.c.create(),Fn=yr.c.create(),oa=yr.c.create(),$n=yr.c.create(),Kn=yr.c.create();function Cn(h,T,E,b,A){yr.c.add(h,E,b),yr.c.normalize(h,h),T=yr.c.fromValues(-h[1],h[0]);var M=yr.c.fromValues(-E[1],E[0]);return[A/yr.c.dot(T,M),T]}function F(h,T){return yr.c.set(h,-T[1],T[0])}function W(h,T,E){return yr.c.sub(h,T,E),yr.c.normalize(h,h),h}function le(h,T){return h[0]===T[0]&&h[1]===T[1]}function xe(h){for(var T=new Map,E=0;E<h.length;E++){var b=h[0].toString()+"-"+h[1].toString();T.get(b)?(h.splice(E,1),E++):T.set(b,b)}return h}var ut=function(){function h(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Y()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=yr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=T.join||"miter",this.cap=T.cap||"butt",this.miterLimit=T.miterLimit||10,this.thickness=T.thickness||1,this.dash=T.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return i()(h,[{key:"extrude",value:function(E){var b=this.complex;if(E.length<=1)return b;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var A=E.length,M=b.startIndex,U=1;U<A;U++){var ie=E[U-1],de=E[U],Ue=U<E.length-1?E[U+1]:null,Ft=this.segment(b,M,ie,de,Ue);M+=Ft}if(this.dash)for(var er=0;er<b.positions.length/6;er++)b.positions[er*6+5]=this.totalDistance;return b.startIndex=b.positions.length/6,b}},{key:"segment",value:function(E,b,A,M,U){var ie=0,de=E.indices,Ue=E.positions,Ft=E.normals,er=this.cap==="square",Mr=this.join==="bevel",kr=Object(Me.d)([M[0],M[1]]),xn=Object(Me.d)([A[0],A[1]]);W(oa,kr,xn);var yn=0;if(this.dash&&(yn=this.lineSegmentDistance(kr,xn),this.totalDistance+=yn),this.normal||(this.normal=yr.c.create(),F(this.normal,oa)),!this.started)if(this.started=!0,er){var zn=yr.c.create(),Sa=yr.c.create();yr.c.add(zn,this.normal,oa),yr.c.add(Sa,this.normal,oa),Ft.push(Sa[0],Sa[1],0),Ft.push(zn[0],zn[1],0),Ue.push(A[0],A[1],0,this.totalDistance-yn,-this.thickness,0),Ue.push(A[0],A[1],0,this.totalDistance-yn,this.thickness,0)}else this.extrusions(Ue,Ft,A,this.normal,this.thickness,this.totalDistance-yn);if(de.push(b+0,b+1,b+2),U){var oi=Object(Me.d)([U[0],U[1]]);le(kr,oi)&&yr.c.add(oi,kr,yr.c.normalize(oi,yr.c.subtract(oi,kr,xn))),W($n,oi,kr);var si=Cn(Kn,yr.c.create(),oa,$n,this.thickness),Qi=dt()(si,2),Oa=Qi[0],qi=Qi[1],_o=yr.c.dot(Kn,this.normal)<0?-1:1,Xs=Mr;if(!Xs&&this.join==="miter"){var Xa=Oa;Xa>this.miterLimit&&(Xs=!0)}Xs?(Ft.push(this.normal[0],this.normal[1],0),Ft.push(qi[0],qi[1],0),Ue.push(M[0],M[1],0,this.totalDistance,-this.thickness*_o,0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness*_o,0),de.push.apply(de,Ht()(this.lastFlip!==-_o?[b,b+2,b+3]:[b+2,b+1,b+3])),de.push(b+2,b+3,b+4),F(Vn,$n),yr.c.copy(this.normal,Vn),Ft.push(this.normal[0],this.normal[1],0),Ue.push(M[0],M[1],0,this.totalDistance,-this.thickness*_o,0),ie+=3):(this.extrusions(Ue,Ft,M,qi,Oa,this.totalDistance),de.push.apply(de,Ht()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),_o=-1,yr.c.copy(this.normal,qi),ie+=2),this.lastFlip=_o}else{if(F(this.normal,oa),er){var wa=yr.c.create(),Ri=yr.c.create();yr.c.sub(Ri,oa,this.normal),yr.c.add(wa,oa,this.normal),Ft.push(Ri[0],Ri[1],0),Ft.push(wa[0],wa[1],0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Ue,Ft,M,this.normal,this.thickness,this.totalDistance);de.push.apply(de,Ht()(this.lastFlip===1?[b,b+2,b+3]:[b+2,b+1,b+3])),ie+=2}return ie}},{key:"extrusions",value:function(E,b,A,M,U,ie){b.push(M[0],M[1],0),b.push(M[0],M[1],0),E.push(A[0],A[1],0,ie,-U,0),E.push(A[0],A[1],0,ie,U,0)}},{key:"lineSegmentDistance",value:function(E,b){var A=b[0]-E[0],M=b[1]-E[1];return Math.sqrt(A*A+M*M)}}]),h}(),wt=o("2F1M"),Bt=o.n(wt);function Ze(h){if(Bt()(h[0]))return h;if(Bt()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Bt()(h[0][0][0])){var T=h,E=0,b=0,A=0;return T.forEach(function(M){M.forEach(function(U){E+=U[0],b+=U[1],A++})}),[E/A,b/A,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Rt(h){var T=h[0][0],E=h[0][h[0].length-1];T[0]===E[0]&&T[1]===E[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var b=h[0].length,A=Zr.a.flatten(h),M=A.vertices,U=A.dimensions,ie=[],de=[],Ue=0;Ue<M.length/U;Ue++)U===2?ie.push(M[Ue*2],M[Ue*2+1],1):ie.push(M[Ue*3],M[Ue*3+1],1);var Ft=Zr()(A.vertices,A.holes,A.dimensions);de.push.apply(de,Ht()(Ft));for(var er=function(xn){var yn=A.vertices.slice(xn*U,(xn+1)*U),zn=A.vertices.slice((xn+1)*U,(xn+2)*U);zn.length===0&&(zn=A.vertices.slice(0,U));var Sa=ie.length/3;ie.push(yn[0],yn[1],1,zn[0],zn[1],1,yn[0],yn[1],0,zn[0],zn[1],0),de.push.apply(de,Ht()([0,2,1,2,3,1].map(function(wa){return wa+Sa})))},Mr=0;Mr<b;Mr++)er(Mr);return{positions:ie,index:de}}function lr(h){var T=Zr.a.flatten(h),E=Zr()(T.vertices,T.holes,T.dimensions);return{positions:T.vertices,index:E}}function Ur(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,E=h[0][0],b=h[0][h[0].length-1];E[0]===b[0]&&E[1]===b[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var A=h[0].length,M=Zr.a.flatten(h),U=M.vertices,ie=M.dimensions,de=[],Ue=[],Ft=[],er=0;er<U.length/ie;er++)ie===2?de.push(U[er*2],U[er*2+1],1,-1,-1):de.push(U[er*3],U[er*3+1],1,-1,-1),Ft.push(0,0,1);var Mr=Zr()(M.vertices,M.holes,M.dimensions);Ue.push.apply(Ue,Ht()(Mr));for(var kr=function(zn){var Sa=M.vertices.slice(zn*ie,(zn+1)*ie),wa=M.vertices.slice((zn+1)*ie,(zn+2)*ie);wa.length===0&&(wa=M.vertices.slice(0,ie));var Ri=de.length/5;de.push(Sa[0],Sa[1],1,0,0,wa[0],wa[1],1,.1,0,Sa[0],Sa[1],0,0,.8,wa[0],wa[1],0,.1,.8);var oi=Gr([wa[0],wa[1],1],[Sa[0],Sa[1],0],[Sa[0],Sa[1],1],T);Ft.push.apply(Ft,Ht()(oi).concat(Ht()(oi),Ht()(oi),Ht()(oi))),Ue.push.apply(Ue,Ht()([1,2,0,3,2,1].map(function(si){return si+Ri})))},xn=0;xn<A;xn++)kr(xn);return{positions:de,index:Ue,normals:Ft}}function Gr(h,T,E){var b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=yr.d.create(),M=yr.d.create(),U=yr.d.create();b&&(h=Object(Me.p)(h),T=Object(Me.p)(T),E=Object(Me.p)(E));var ie=yr.d.fromValues.apply(yr.d,Ht()(h)),de=yr.d.fromValues.apply(yr.d,Ht()(T)),Ue=yr.d.fromValues.apply(yr.d,Ht()(E));yr.d.sub(A,Ue,de),yr.d.sub(M,ie,de),yr.d.cross(U,A,M);var Ft=yr.d.create();return yr.d.normalize(Ft,U),Ft}var cr,Br;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Br||(Br={}));var wn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(wn||(wn={}));function fn(h){for(var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=Math.PI*2/h,b=[],A=0;A<h;A++)b.push(E*A+T*Math.PI/12);var M=b.map(function(U){var ie=Math.sin(U+Math.PI/4),de=Math.cos(U+Math.PI/4);return[ie,de,0]});return M}function tr(){return fn(30)}function rn(){return fn(4)}function dn(){return fn(3)}function En(){return fn(6,1)}function bn(){return fn(5)}var gn=(cr={},Ce()(cr,wn.CIRCLE,tr),Ce()(cr,wn.HEXAGON,En),Ce()(cr,wn.TRIANGLE,dn),Ce()(cr,wn.SQUARE,rn),Ce()(cr,wn.PENTAGON,bn),Ce()(cr,Br.CYLINDER,tr),Ce()(cr,Br.HEXAGONCOLUMN,En),Ce()(cr,Br.TRIANGLECOLUMN,dn),Ce()(cr,Br.SQUARECOLUMN,rn),Ce()(cr,Br.PENTAGONCOLUMN,bn),cr),Mn={};function Ga(h){var T=Ze(h.coordinates);return{vertices:[].concat(Ht()(T),Ht()(T),Ht()(T),Ht()(T)),indices:[0,1,2,2,3,0],size:T.length}}function ga(h){var T=h.shape,E=wi(T,!1),b=E.positions,A=E.index,M=E.normals;return{vertices:b,indices:A,normals:M,size:5}}function Ma(h){var T=Ze(h.coordinates);return{vertices:Ht()(T),indices:[0],size:T.length}}function Ia(h){var T=h.coordinates,E=T;Array.isArray(E[0][0])||(E=[T]);var b=new ut({dash:!0,join:"bevel"});E.forEach(function(M){b.extrude(M)});var A=b.complex;return{vertices:A.positions,indices:A.indices,normals:A.normals,size:6}}function Wi(h){var T=h.coordinates,E=Zr.a.flatten(T),b=E.vertices,A=E.dimensions,M=E.holes;return{indices:Zr()(b,M,A),vertices:b,size:A}}function da(h){var T=h.coordinates,E=Ur(T,!0),b=E.positions,A=E.index,M=E.normals;return{vertices:b,indices:A,normals:M,size:5}}function vi(h){var T=h.shape,E=Du(T),b=E.positions,A=E.index;return{vertices:b,indices:A,size:3}}function ya(h){var T=h.coordinates,E=[].concat(Ht()(T[0]),[0,0,1,T[1][0],T[0][1],0,1,1],Ht()(T[1]),[0,1,0],Ht()(T[0]),[0,0,1],Ht()(T[1]),[0,1,0,T[0][0],T[1][1],0,0,0]),b=[0,1,2,3,4,5];return{vertices:E,indices:b,size:5}}function ba(h){for(var T=30,E=h.coordinates,b=[],A=[],M=function(de){b.push(de,1,de,E[0][0],E[0][1],E[1][0],E[1][1],de,-1,de,E[0][0],E[0][1],E[1][0],E[1][1]),de!==T-1&&A.push.apply(A,Ht()([0,1,2,1,3,2].map(function(Ue){return de*2+Ue})))},U=0;U<T;U++)M(U);return{vertices:b,indices:A,size:7}}function ha(h){var T=h.coordinates;T.length===2&&T.push(0);var E=h.size,b=Ha(-1,1),A=Ha(1,1),M=Ha(-1,-1),U=Ha(1,-1),ie=[].concat(Ht()(T),Ht()(b),Ht()(T),Ht()(M),Ht()(T),Ht()(U),Ht()(T),Ht()(A)),de=[0,1,2,3,0,2];return{vertices:ie,indices:de,size:5}}function wi(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Mn&&Mn[h])return Mn[h];var E=gn[h]?gn[h]():gn.cylinder(),b=Ur([E],T);return Mn[h]=b,b}function is(h,T){for(var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=new Float32Array(h.length/E*3),M,U,ie,de=yr.d.create(),Ue=yr.d.create(),Ft=yr.d.create(),er=0,Mr=T.length;er<Mr;er+=3){M=T[er+0]*3,U=T[er+1]*3,ie=T[er+2]*3;var kr=[h[M],h[M+1]],xn=[h[U],h[U+1]],yn=[h[ie],h[ie+1]];b&&(kr=Object(Me.p)(kr),xn=Object(Me.p)(xn),yn=Object(Me.p)(yn));var zn=kr,Sa=dt()(zn,2),wa=Sa[0],Ri=Sa[1],oi=yr.d.fromValues(wa,Ri,h[M+2]),si=xn,Qi=dt()(si,2),Oa=Qi[0],qi=Qi[1],_o=yr.d.fromValues(Oa,qi,h[U+2]),Xs=yn,Xa=dt()(Xs,2),Ms=Xa[0],$o=Xa[1],ff=yr.d.fromValues(Ms,$o,h[ie+2]);yr.d.sub(de,ff,_o),yr.d.sub(Ue,oi,_o),yr.d.cross(Ft,de,Ue),A[M]+=de[0],A[M+1]+=de[1],A[M+2]+=de[2],A[U]+=de[0],A[U+1]+=de[1],A[U+2]+=de[2],A[ie]+=de[0],A[ie+1]+=de[1],A[ie+2]+=de[2]}return Xi(A),A}function Xi(h){for(var T=0,E=h.length;T<E;T+=3){var b=yr.d.fromValues(h[T],h[T+1],h[T+2]),A=yr.d.create();yr.d.normalize(A,b),h.set(A,T)}}function Xo(h){var T=h[0][0],E=h[0][h[0].length-1];return T[0]===E[0]&&T[1]===E[1]}function Du(h){var T=["cylinder","triangleColumn","hexagonColumn","squareColumn"],E=gn[h]?gn[h]():gn.circle(),b=T.indexOf(h)===-1?lr([E]):Rt([E]);return b}function Ha(h,T){var E=(h+1)/2,b=(T+1)/2;return[E,b]}function Oi(h){var T=Jo();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Jo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ui=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Oo=function(h){D()(E,h);var T=Oi(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.baseColor,de=ie===void 0?"rgb(16,16,16)":ie,Ue=A.brightColor,Ft=Ue===void 0?"rgb(255,176,38)":Ue,er=A.windowColor,Mr=er===void 0?"rgb(30,60,89)":er,kr=A.time,xn=kr===void 0?0:kr;return{u_opacity:U,u_baseColor:Object(Me.s)(de),u_brightColor:Object(Me.s)(Ft),u_windowColor:Object(Me.s)(Mr),u_time:this.layer.getLayerAnimateTime()||xn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Yi,fragmentShader:ui,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U,ie,de,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?10:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){var Ue=M.size;return[ie[3],ie[4]]}}})}}]),E}(xt);function Za(h){var T=oo();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var so=function(h){D()(E,h);var T=Za(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="PolygonLayer",b}return i()(E,[{key:"buildModels",value:function(){this.layerModel=new Oo(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(A){this.updateLayerConfig({time:A})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),E}(ae);function bu(h){var T=Qo();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Xl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,js=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ho=function(h){D()(E,h);var T=bu(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Xl,fragmentShader:js,triangulation:vi,depth:{enable:!1},primitive:x.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(xt);function Vt(h){var T=Le();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Le(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,vr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,en=function(h){D()(E,h);var T=Vt(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Dt,fragmentShader:vr,triangulation:ga,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size;return Array.isArray(Ue)?[Ue[0]]:[Ue]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U,ie,de,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(xt);function _n(h,T){for(var E=[],b=[],A=[],M=h+1,U=T+1,ie=h/2,de=T/2,Ue=0;Ue<U;Ue++)for(var Ft=Ue-de,er=0;er<M;er++){var Mr=er-ie;b.push(Mr/ie,-Ft/de,0),A.push(er/h),A.push(1-Ue/T)}for(var kr=0;kr<T;kr++)for(var xn=0;xn<h;xn++){var yn=xn+M*kr,zn=xn+M*(kr+1),Sa=xn+1+M*(kr+1),wa=xn+1+M*kr;E.push(yn,zn,wa),E.push(zn,Sa,wa)}return{vertices:b,indices:E,uvs:A}}function Gn(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Mi(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Gn(Object(E),!0).forEach(function(b){Ce()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Gn(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}function po(h){var T=mo();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Mo=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Nu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Ol=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,_s=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,pc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,xu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Po=function(h){D()(E,h);var T=po(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b.heatmapFramerBuffer=void 0,b.intensityModel=void 0,b.colorModel=void 0,b.shapeType=void 0,b}return i()(E,[{key:"render",value:function(){var A=this,M=this.rendererService,U=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){U({color:[0,0,0,0],depth:1,stencil:0,framebuffer:A.heatmapFramerBuffer}),A.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var A,M=this.rendererService,U=M.createFramebuffer,ie=M.clear,de=M.getViewportSize,Ue=M.createTexture2D,Ft=M.useFramebuffer,er=this.styleAttributeService.getLayerStyleAttribute("shape"),Mr=(er==null||((A=er.scale)===null||A===void 0)?void 0:A.field)||"heatmap";this.shapeType=Mr,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Mr==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var kr=this.layer.getLayerConfig(),xn=kr.rampColors,yn=Object(Me.n)(xn),zn=de(),Sa=zn.width,wa=zn.height;return this.heatmapFramerBuffer=U({color:Ue({width:Math.floor(Sa/4),height:Math.floor(wa/4),wrapS:x.gl.CLAMP_TO_EDGE,wrapT:x.gl.CLAMP_TO_EDGE,min:x.gl.LINEAR,mag:x.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:x.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?1:Ue;return[Ft]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:pc,fragmentShader:_s,triangulation:ha,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:x.gl.ONE,srcAlpha:1,dstRGB:x.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:xu,fs:Ol});var A=this.shaderModuleService.getModule("heatmapColor"),M=A.vs,U=A.fs,ie=A.uniforms,de=this.rendererService,Ue=de.createAttribute,Ft=de.createElements,er=de.createBuffer,Mr=de.createModel;return Mr({vs:M,fs:U,attributes:{a_Position:Ue({buffer:er({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:x.gl.FLOAT}),size:3}),a_Uv:Ue({buffer:er({data:[0,1,1,1,0,0,1,0],type:x.gl.FLOAT}),size:2})},uniforms:Mi({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Ft({data:[0,2,1,2,3,1],type:x.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.intensity,ie=U===void 0?10:U,de=A.radius,Ue=de===void 0?5:de;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Ue,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=yr.b.invert(yr.b.create(),yr.b.fromValues.apply(yr.b,Ht()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ht()(U)}})}},{key:"build3dHeatMap",value:function(){var A=this.rendererService.getViewportSize,M=A(),U=M.width,ie=M.height,de=_n(U/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Nu,fs:Mo});var Ue=this.shaderModuleService.getModule("heatmap3dColor"),Ft=Ue.vs,er=Ue.fs,Mr=Ue.uniforms,kr=this.rendererService,xn=kr.createAttribute,yn=kr.createElements,zn=kr.createBuffer,Sa=kr.createModel;return Sa({vs:Ft,fs:er,attributes:{a_Position:xn({buffer:zn({data:de.vertices,type:x.gl.FLOAT}),size:3}),a_Uv:xn({buffer:zn({data:de.uvs,type:x.gl.FLOAT}),size:2})},primitive:x.gl.TRIANGLES,uniforms:Mi({},Mr),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:x.gl.SRC_ALPHA,srcAlpha:1,dstRGB:x.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:yn({data:de.indices,type:x.gl.UNSIGNED_INT,count:de.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var A=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Me.n)(U);this.colorTexture=A({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:x.gl.CLAMP_TO_EDGE,wrapT:x.gl.CLAMP_TO_EDGE,min:x.gl.NEAREST,mag:x.gl.NEAREST,flipY:!1})}}]),E}(xt);function ku(h){var T=To();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function To(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fi=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ys=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,Ks=function(h){D()(E,h);var T=ku(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Ys,fragmentShader:Fi,triangulation:vi,depth:{enable:!1},primitive:x.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),E}(xt),zs={heatmap:Po,heatmap3d:Po,grid:ho,grid3d:en,hexagon:Ks},Ii=zs;function Gi(h){var T=Ts();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Ts(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ml=function(h){D()(E,h);var T=Gi(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="HeatMapLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new Ii[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var A=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(U){return U.draw({uniforms:A.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=this.getLayerConfig(),ie=U.shape3d,de=this.getSource(),Ue=de.data.type,Ft=(M==null||((A=M.scale)===null||A===void 0)?void 0:A.field)||"heatmap";return Ft==="heatmap"||Ft==="heatmap3d"?"heatmap":Ue==="hexagon"?(ie==null?void 0:ie.indexOf(Ft))===-1?"hexagon":"grid3d":Ue==="grid"?(ie==null?void 0:ie.indexOf(Ft))===-1?"grid":"grid3d":"heatmap"}}]),E}(ae);function $u(h){var T=It();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function It(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var fr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Pr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Wn=function(h){D()(E,h);var T=$u(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var A=this,M=this.layer.getSource(),U=this.rendererService.createTexture2D;return this.texture=U({height:0,width:0}),M.data.images.then(function(ie){A.texture=U({data:ie[0],width:ie[0].width,height:ie[0].height}),A.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Pr,fragmentShader:fr,triangulation:ya,primitive:x.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}}]),E}(xt),Ya={image:Wn},xi=Ya;function Ki(h){var T=Ka();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Ka(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Di=function(h){D()(E,h);var T=Ki(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="ImageLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new xi[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={image:{}};return M[A]}},{key:"getModelType",value:function(){return"image"}}]),E}(ae);function Yo(h){var T=Ps();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ml=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,$s={solid:0,dash:1},Ss=function(h){D()(E,h);var T=Yo(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Ue=de===void 0?[10,5]:de;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:$s[ie||"solid"],u_dash_array:Ue,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Ml,fragmentShader:gi,triangulation:ba,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?1:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(xt);function vl(h){var T=cu();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Eu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,fu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,ju={solid:0,dash:1},Js=function(h){D()(E,h);var T=vl(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Ue=de===void 0?[10,5]:de;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:ju[ie]||0,u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Eu,fragmentShader:fu,triangulation:ba,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?1:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(xt);function Mc(h){var T=hf();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function hf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,mc={solid:0,dash:1},$c=function(h){D()(E,h);var T=Mc(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Ue=de===void 0?[10,5]:de;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:mc[ie]||0,u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Pc,fragmentShader:pi,triangulation:ba,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?1:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:x.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),E}(xt);function gl(h){var T=Jc();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Jc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var $i=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,_u=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,yl={solid:0,dash:1},os=function(h){D()(E,h);var T=gl(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Ue=de===void 0?[10,5,0,0]:de;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,u_line_type:yl[ie],u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:_u,fragmentShader:$i,triangulation:Ia,primitive:x.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var A=this.layer.getLayerConfig(),M=A.lineType,U=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:x.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ue,Ft,er){return[Ft[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:x.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ue,Ft,er){return[Ft[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(de,Ue,Ft,er){var Mr=de.size,kr=Mr===void 0?1:Mr;return Array.isArray(kr)?[kr[0],kr[1]]:[kr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(de,Ue,Ft,er,Mr){return Mr}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:x.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(de,Ue,Ft,er){return[Ft[4]]}}})}}]),E}(xt),Lc={arc:Ss,arc3d:Js,greatcircle:$c,line:os},vc=Lc;function Pl(h){var T=Ju();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Ju(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Rc=function(h){D()(E,h);var T=Pl(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="LineLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new vc[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[A]}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return U||"line"}}]),E}(ae);function hu(h){var T=Tu();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Tu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Yl=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Si=function(h){D()(E,h);var T=hu(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.offsets;return{u_opacity:M||1,u_offsets:U||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Yl,fragmentShader:Qc,triangulation:ga,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U,ie,de){var Ue=M.size;if(Ue){var Ft=[];return Array.isArray(Ue)&&(Ft=Ue.length===2?[Ue[0],Ue[0],Ue[1]]:Ue),Array.isArray(Ue)||(Ft=[Ue]),Ft}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U,ie,de,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:x.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U){var ie=Ze(M.coordinates);return[ie[0],ie[1],0]}}})}}]),E}(xt);function qc(h){var T=df();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function df(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Kl=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ic=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,$l=function(h){D()(E,h);var T=qc(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Ue=A.strokeWidth,Ft=Ue===void 0?1:Ue,er=A.strokeOpacity,Mr=er===void 0?1:er,kr=A.offsets,xn=kr===void 0?[0,0]:kr;return{u_opacity:U,u_stroke_width:Ft,u_stroke_color:Object(Me.s)(de),u_stroke_opacity:Mr,u_offsets:[-xn[0],xn[1]]}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ga)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Ic,fragmentShader:Kl,triangulation:Ga,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(A){return[A.enable?0:1,A.speed||1,A.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:x.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(U,ie,de,Ue){var Ft=[1,1,-1,1,-1,-1,1,-1],er=Ue%4*2;return[Ft[er],Ft[er+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(U,ie,de,Ue){var Ft=U.size,er=Ft===void 0?5:Ft;return Array.isArray(er)?[er[0]]:[er]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:x.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(U,ie,de,Ue){var Ft=U.shape,er=Ft===void 0?2:Ft,Mr=A.layer.getLayerConfig().shape2d,kr=Mr.indexOf(er);return[kr]}}})}}]),E}(xt);function Qu(h){var T=zu();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function zu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var bl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Lo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Jl=function(h){D()(E,h);var T=Qu(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var A=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){A.updateTexture(),A.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Lo,fragmentShader:bl,triangulation:Ma,primitive:x.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(U,ie,de,Ue){var Ft=U.size;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(U,ie,de,Ue){var Ft=A.fontService.mapping,er=U.shape,Mr=A.fontService.getGlyph(er),kr=Ft[Mr],xn=kr.x,yn=kr.y;return[xn,yn]}}})}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=A({data:M,mag:x.gl.LINEAR,min:x.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),U=M.fontWeight,ie=U===void 0?"normal":U,de=M.fontFamily,Ue=de===void 0?"sans-serif":de,Ft=this.layer.getEncodedData(),er=[];Ft.forEach(function(Mr){var kr=Mr.shape,xn=kr===void 0?"":kr;xn=xn.toString();var yn=A.fontService.getGlyph(xn);er.indexOf(yn)===-1&&er.push(yn)}),this.fontService.setFontOptions({characterSet:er,fontWeight:ie,fontFamily:Ue,fontSize:48})}}]),E}(xt);function Ll(h){var T=Rl();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Rl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,xl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Qs=function(h){D()(E,h);var T=Ll(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.updateTexture=function(){var ie=b.rendererService.createTexture2D;if(b.texture){b.texture.update({data:b.iconService.getCanvas()}),b.layer.render();return}b.texture=ie({data:b.iconService.getCanvas(),mag:x.gl.LINEAR,min:x.gl.LINEAR,width:1024,height:b.iconService.canvasHeight||128})},b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.offsets,ie=U===void 0?[0,0]:U;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ie[0],ie[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:xl,fragmentShader:Dc,triangulation:Ma,primitive:x.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(U,ie,de,Ue){var Ft=U.size,er=Ft===void 0?5:Ft;return Array.isArray(er)?[er[0]]:[er]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(U,ie,de,Ue){var Ft=A.iconService.getIconMap(),er=U.shape,Mr=Ft[er]||{x:0,y:0},kr=Mr.x,xn=Mr.y;return[kr,xn]}}})}}]),E}(xt);function eo(h){var T=pf();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function pf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var mf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,El=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function Ql(h){var T=h.coordinates;return{vertices:Ht()(T),indices:[0],size:T.length}}var qu=function(h){D()(E,h);var T=eo(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Ue=A.strokeWidth,Ft=Ue===void 0?1:Ue,er=A.offsets,Mr=er===void 0?[0,0]:er;return{u_opacity:U,u_stroke_width:Ft,u_stroke_color:Object(Me.s)(de),u_offsets:[-Mr[0],Mr[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:El,fragmentShader:mf,triangulation:Ql,depth:{enable:!1},primitive:x.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?1:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:x.BlendType.additive}}}]),E}(xt);function Il(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=gc(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ue){throw Ue},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){U=!0,ie=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(U)throw ie}}}}function gc(h,T){if(!h)return;if(typeof h=="string")return yc(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return yc(h,T)}function yc(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}var el=function(){function h(T,E,b){Y()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var A=this.boxCells;this.xCellCount=Math.ceil(T/b),this.yCellCount=Math.ceil(E/b);for(var M=0;M<this.xCellCount*this.yCellCount;M++)A.push([]);this.boxKeys=[],this.bboxes=[],this.width=T,this.height=E,this.xScale=this.xCellCount/T,this.yScale=this.yCellCount/E,this.boxUid=0}return i()(h,[{key:"insert",value:function(E,b,A,M,U){this.forEachCell(b,A,M,U,this.insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(b),this.bboxes.push(A),this.bboxes.push(M),this.bboxes.push(U)}},{key:"query",value:function(E,b,A,M,U){return this.queryHitTest(E,b,A,M,!1,U)}},{key:"hitTest",value:function(E,b,A,M,U){return this.queryHitTest(E,b,A,M,!0,U)}},{key:"insertBoxCell",value:function(E,b,A,M,U,ie){this.boxCells[U].push(ie)}},{key:"queryHitTest",value:function(E,b,A,M,U,ie){if(A<0||E>this.width||M<0||b>this.height)return U?!1:[];var de=[];if(E<=0&&b<=0&&this.width<=A&&this.height<=M){if(U)return!0;for(var Ue=0;Ue<this.boxKeys.length;Ue++)de.push({key:this.boxKeys[Ue],x1:this.bboxes[Ue*4],y1:this.bboxes[Ue*4+1],x2:this.bboxes[Ue*4+2],y2:this.bboxes[Ue*4+3]});return ie?de.filter(ie):de}var Ft={hitTest:U,seenUids:{box:{},circle:{}}};return this.forEachCell(E,b,A,M,this.queryCell,de,Ft,ie),U?de.length>0:de}},{key:"queryCell",value:function(E,b,A,M,U,ie,de,Ue){var Ft=de.seenUids,er=this.boxCells[U];if(er!==null){var Mr=this.bboxes,kr=Il(er),xn;try{for(kr.s();!(xn=kr.n()).done;){var yn=xn.value;if(!Ft.box[yn]){Ft.box[yn]=!0;var zn=yn*4;if(E<=Mr[zn+2]&&b<=Mr[zn+3]&&A>=Mr[zn+0]&&M>=Mr[zn+1]&&(!Ue||Ue(this.boxKeys[yn]))){if(de.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[yn],x1:Mr[zn],y1:Mr[zn+1],x2:Mr[zn+2],y2:Mr[zn+3]})}}}}catch(Sa){kr.e(Sa)}finally{kr.f()}}return!1}},{key:"forEachCell",value:function(E,b,A,M,U,ie,de,Ue){for(var Ft=this.convertToXCellCoord(E),er=this.convertToYCellCoord(b),Mr=this.convertToXCellCoord(A),kr=this.convertToYCellCoord(M),xn=Ft;xn<=Mr;xn++)for(var yn=er;yn<=kr;yn++){var zn=this.xCellCount*yn+xn;if(U.call(this,E,b,A,M,zn,ie,de,Ue))return}}},{key:"convertToXCellCoord",value:function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))}},{key:"convertToYCellCoord",value:function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))}}]),h}(),ef=el,tl=function(){function h(T,E){Y()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=T,this.height=E,this.viewportPadding=Math.max(T,E),this.grid=new ef(T+this.viewportPadding,E+this.viewportPadding,25),this.screenRightBoundary=T+this.viewportPadding,this.screenBottomBoundary=E+this.viewportPadding,this.gridRightBoundary=T+2*this.viewportPadding,this.gridBottomBoundary=E+2*this.viewportPadding}return i()(h,[{key:"placeCollisionBox",value:function(E){var b=E.x1+E.anchorPointX+this.viewportPadding,A=E.y1+E.anchorPointY+this.viewportPadding,M=E.x2+E.anchorPointX+this.viewportPadding,U=E.y2+E.anchorPointY+this.viewportPadding;return!this.isInsideGrid(b,A,M,U)||this.grid.hitTest(b,A,M,U)?{box:[]}:{box:[b,A,M,U]}}},{key:"insertCollisionBox",value:function(E,b){var A={featureIndex:b};this.grid.insert(A,E[0],E[1],E[2],E[3])}},{key:"project",value:function(E,b,A){var M=yr.e.fromValues(b,A,0,1),U=yr.e.create(),ie=yr.b.fromValues.apply(yr.b,Ht()(E));return yr.e.transformMat4(U,M,ie),{x:(U[0]/U[3]+1)/2*this.width+this.viewportPadding,y:(-U[1]/U[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(E,b,A,M){return A>=0&&E<this.gridRightBoundary&&M>=0&&b<this.gridBottomBoundary}}]),h}();function qs(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=_l(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ue){throw Ue},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){U=!0,ie=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(U)throw ie}}}}function _l(h,T){if(!h)return;if(typeof h=="string")return ql(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return ql(h,T)}function ql(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function Nc(h){var T=.5,E=.5;switch(h){case"right":case"top-right":case"bottom-right":T=1;break;case"left":case"top-left":case"bottom-left":T=0;break;default:T=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":E=1;break;case"top":case"top-right":case"top-left":E=0;break;default:E=.5}return{horizontalAlign:T,verticalAlign:E}}function tf(h,T,E,b,A){if(!A)return;var M=h[b],U=M.glyph;if(U)for(var ie=T[U].advance*M.scale,de=(h[b].x+ie)*A,Ue=E;Ue<=b;Ue++)h[Ue].x-=de}function Fs(h,T,E,b,A,M,U){var ie=(T-E)*A,de=(-b*U+.5)*M,Ue=qs(h),Ft;try{for(Ue.s();!(Ft=Ue.n()).done;){var er=Ft.value;er.x+=ie,er.y+=de}}catch(Mr){Ue.e(Mr)}finally{Ue.f()}}function vf(h,T,E,b,A,M,U){var ie=-8,de=0,Ue=ie,Ft=0,er=h.positionedGlyphs,Mr=M==="right"?1:M==="left"?0:.5,kr=er.length;E.forEach(function(wa){if(wa.split("").forEach(function(oi){var si=T[oi],Qi=0;si&&(er.push({glyph:oi,x:de,y:Ue+Qi,vertical:!1,scale:1,metrics:si}),de+=si.advance+U)}),er.length!==kr){var Ri=de-U;Ft=Math.max(Ri,Ft),tf(er,T,kr,er.length-1,Mr)}de=0,Ue+=b});var xn=Nc(A),yn=xn.horizontalAlign,zn=xn.verticalAlign;Fs(er,Mr,yn,zn,Ft,b,E.length);var Sa=Ue-ie;h.top+=-zn*Sa,h.bottom=h.top+Sa,h.left+=-yn*Ft,h.right=h.left+Ft}function rl(h,T,E,b,A,M){var U=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=h.split(`
`),de=[],Ue={positionedGlyphs:de,top:U[1],bottom:U[1],left:U[0],right:U[0],lineCount:ie.length,text:h};return vf(Ue,T,ie,E,b,A,M),de.length?Ue:!1}function Pi(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],E=arguments.length>2?arguments[2]:void 0,b=h.positionedGlyphs,A=b===void 0?[]:b,M=[],U=qs(A),ie;try{for(U.s();!(ie=U.n()).done;){var de=ie.value,Ue=de.metrics,Ft=4,er=Ue.advance*de.scale/2,Mr=E?[de.x+er,de.y]:[0,0],kr=E?[0,0]:[de.x+er+T[0],de.y+T[1]],xn=(0-Ft)*de.scale-er+kr[0],yn=(0-Ft)*de.scale+kr[1],zn=xn+Ue.width*de.scale,Sa=yn+Ue.height*de.scale,wa={x:xn,y:yn},Ri={x:zn,y:yn},oi={x:xn,y:Sa},si={x:zn,y:Sa};M.push({tl:wa,tr:Ri,bl:oi,br:si,tex:Ue,glyphOffset:Mr})}}catch(Qi){U.e(Qi)}finally{U.f()}return M}function nl(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Fu(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var b=0,A=function(){};return{s:A,n:function(){return b>=h.length?{done:!0}:{done:!1,value:h[b++]}},e:function(Ue){throw Ue},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){U=!0,ie=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(U)throw ie}}}}function Fu(h,T){if(!h)return;if(typeof h=="string")return fi(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return fi(h,T)}function fi(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,b=new Array(T);E<T;E++)b[E]=h[E];return b}function kn(h){var T=Li();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Li(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ls=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Dl=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Uu(h){var T=this,E=h.id,b=[],A=[];if(!T.glyphInfoMap||!T.glyphInfoMap[E])return{vertices:[],indices:[],size:7};var M=T.glyphInfoMap[E].centroid,U=M.length===2?[M[0],M[1],0]:M;return T.glyphInfoMap[E].glyphQuads.forEach(function(ie,de){b.push.apply(b,Ht()(U).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Ht()(U),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Ht()(U),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Ht()(U),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),A.push(0+de*4,1+de*4,2+de*4,2+de*4,3+de*4,0+de*4)}),{vertices:b,indices:A,size:7}}var al=function(h){D()(E,h);var T=kn(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.glyphInfo=void 0,b.glyphInfoMap={},b.texture=void 0,b.currentZoom=-1,b.extent=void 0,b.textureHeight=0,b.textCount=0,b.preTextStyle={},b.buildModels=function(){return b.initGlyph(),b.updateTexture(),b.filterGlyphs(),[b.layer.buildLayerModel({moduleName:"pointText",vertexShader:Dl,fragmentShader:Ls,triangulation:Uu.bind(Ye()(b)),depth:{enable:!1},blend:b.getBlend()})]},b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"#fff":ie,Ue=A.strokeWidth,Ft=Ue===void 0?0:Ue,er=A.strokeOpacity,Mr=er===void 0?1:er,kr=A.textAnchor,xn=kr===void 0?"center":kr,yn=A.textAllowOverlap,zn=yn===void 0?!1:yn,Sa=A.halo,wa=Sa===void 0?.5:Sa,Ri=A.gamma,oi=Ri===void 0?2:Ri,si=this.fontService,Qi=si.canvas,Oa=si.mapping;return Object.keys(Oa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Oa).length),this.preTextStyle={textAnchor:xn,textAllowOverlap:zn},{u_opacity:U,u_stroke_opacity:Mr,u_sdf_map:this.texture,u_stroke:Object(Me.s)(de),u_halo_blur:wa,u_gamma_scale:oi,u_sdf_map_size:[Qi.width,Qi.height],u_strokeWidth:Ft}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var A=this.layer.getLayerConfig(),M=A.textAnchor,U=M===void 0?"center":M,ie=A.textAllowOverlap,de=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:U,textAllowOverlap:de},this.buildModels()}},{key:"needUpdate",value:function(){var A=this.layer.getLayerConfig(),M=A.textAllowOverlap,U=M===void 0?!1:M,ie=this.mapService.getZoom(),de=this.mapService.getBounds(),Ue=Object(Me.j)(this.extent,de);return!U&&(Math.abs(this.currentZoom-ie)>1||!Ue)||U!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:x.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?12:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:x.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var A=this.mapService.getBounds();return Object(Me.r)(A,.5)}},{key:"initTextFont",value:function(){var A=this.layer.getLayerConfig(),M=A.fontWeight,U=M===void 0?"400":M,ie=A.fontFamily,de=ie===void 0?"sans-serif":ie,Ue=this.layer.getEncodedData(),Ft=[];Ue.forEach(function(er){var Mr=er.shape,kr=Mr===void 0?"":Mr;kr=kr.toString();var xn=nl(kr),yn;try{for(xn.s();!(yn=xn.n()).done;){var zn=yn.value;Ft.indexOf(zn)===-1&&Ft.push(zn)}}catch(Sa){xn.e(Sa)}finally{xn.f()}}),this.fontService.setFontOptions({characterSet:Ft,fontWeight:U,fontFamily:de})}},{key:"generateGlyphLayout",value:function(){var A=this,M=this.fontService.mapping,U=this.layer.getLayerConfig(),ie=U.spacing,de=ie===void 0?2:ie,Ue=U.textAnchor,Ft=Ue===void 0?"center":Ue,er=U.textOffset,Mr=this.layer.getEncodedData();this.glyphInfo=Mr.map(function(kr){var xn=kr.shape,yn=xn===void 0?"":xn,zn=kr.coordinates,Sa=kr.id,wa=kr.size,Ri=wa===void 0?1:wa,oi=rl(yn.toString(),M,Ri,Ft,"center",de,er),si=Pi(oi,er,!1);return kr.shaping=oi,kr.glyphQuads=si,kr.centroid=Ze(zn),A.glyphInfoMap[Sa]={shaping:oi,glyphQuads:si,centroid:Ze(zn)},kr})}},{key:"filterGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),U=M.padding,ie=U===void 0?[4,4]:U,de=M.textAllowOverlap,Ue=de===void 0?!1:de;if(Ue)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Ft=this.rendererService.getViewportSize(),er=Ft.width,Mr=Ft.height,kr=new tl(er,Mr),xn=this.glyphInfo.filter(function(yn){var zn=yn.shaping,Sa=yn.id,wa=Sa===void 0?0:Sa,Ri=yn.centroid,oi=yn.size,si=oi/24,Qi=A.mapService.lngLatToContainer(Ri),Oa=kr.placeCollisionBox({x1:zn.left*si-ie[0],x2:zn.right*si+ie[0],y1:zn.top*si-ie[1],y2:zn.bottom*si+ie[1],anchorPointX:Qi.x,anchorPointY:Qi.y}),qi=Oa.box;return qi&&qi.length?(kr.insertCollisionBox(qi,wa),!0):!1});xn.forEach(function(yn){A.glyphInfoMap[yn.id]=yn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=A({data:M,mag:x.gl.LINEAR,min:x.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Dl,fragmentShader:Ls,triangulation:Uu.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),E}(xt),gf={fill:$l,image:Qs,normal:qu,extrude:Si,text:al,icon:Jl},ss=gf;function Tl(h){var T=il();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function il(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ol=function(h){D()(E,h);var T=Tl(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="PointLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new ss[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[A]}},{key:"getModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Ue=A.find(function(er){return er.hasOwnProperty("shape")});if(Ue){var Ft=Ue.shape;return Ft==="dot"?"normal":(U==null?void 0:U.indexOf(Ft))!==-1?"fill":(ie==null?void 0:ie.indexOf(Ft))!==-1?"extrude":de.hasOwnProperty(Ft)?"image":this.fontService.getGlyph(Ft)!==""?"icon":"text"}else return"normal"}}]),E}(ae);function Ui(h){var T=As();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function As(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,to=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Rn=function(h){D()(E,h);var T=Ui(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:to,fragmentShader:Nl,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:x.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:x.gl.STATIC_DRAW,data:[],type:x.gl.FLOAT},size:3,update:function(M,U,ie,de,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:x.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(M,U,ie,de){var Ue=M.size,Ft=Ue===void 0?10:Ue;return Array.isArray(Ft)?[Ft[0]]:[Ft]}}})}}]),E}(xt);function Us(h){var T=ni();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function ni(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var kl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,du=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Bs=function(h){D()(E,h);var T=Us(E);function E(){return Y()(this,E),T.apply(this,arguments)}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:du,fragmentShader:kl,triangulation:Wi,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),E}(xt),sl={fill:Bs,line:os,extrude:Rn,text:al,point_fill:$l,point_image:Qs,point_normal:qu,point_extrude:Si},tn=sl;function bc(h){var T=us();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function us(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ro=function(h){D()(E,h);var T=bc(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="PolygonLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new tn[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return U==="fill"?"fill":U==="extrude"?"extrude":U==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Ue=A.find(function(er){return er.hasOwnProperty("shape")});if(Ue){var Ft=Ue.shape;return Ft==="dot"?"point_normal":(U==null?void 0:U.indexOf(Ft))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(Ft))!==-1?"point_extrude":de.hasOwnProperty(Ft)?"point_image":"text"}else return"fill"}}]),E}(ae);function qo(h){var T=Rs();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function Rs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jl=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,kc=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Vs=function(h){D()(E,h);var T=qo(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.texture=void 0,b.colorTexture=void 0,b}return i()(E,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.clampLow,de=ie===void 0?!0:ie,Ue=A.clampHigh,Ft=Ue===void 0?!0:Ue,er=A.noDataValue,Mr=er===void 0?-9999999:er,kr=A.domain,xn=kr===void 0?[0,1]:kr;return this.updateColorTexure(),{u_opacity:U||1,u_texture:this.texture,u_domain:xn,u_clampLow:de,u_clampHigh:typeof Ft!="undefined"?Ft:de,u_noDataValue:Mr,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var A=this.layer.getSource(),M=this.rendererService.createTexture2D,U=A.data.dataArray[0];this.texture=M({data:U.data,width:U.width,height:U.height,format:x.gl.LUMINANCE,type:x.gl.FLOAT});var ie=this.layer.getLayerConfig(),de=ie.rampColors,Ue=Object(Me.n)(de);return this.colorTexture=M({data:Ue.data,width:Ue.width,height:Ue.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:kc,fragmentShader:jl,triangulation:ya,primitive:x.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:x.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var A=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Me.n)(U);this.colorTexture=A({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),E}(xt),Su={raster:Vs,raster3d:Vs},zl=Su;function Fl(h){var T=rf();return function(){var b=X()(h),A;if(T){var M=X()(this).constructor;A=Reflect.construct(b,arguments,M)}else A=b.apply(this,arguments);return re()(this,A)}}function rf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jc=function(h){D()(E,h);var T=Fl(E);function E(){var b;Y()(this,E);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return b=T.call.apply(T,[this].concat(M)),b.type="RasterLayer",b}return i()(E,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new zl[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={raster:{},raster3d:{}};return M[A]}},{key:"getModelType",value:function(){return"raster"}}]),E}(ae),Ro,ls,Pa,eu,Io,So,Sl,ul;function pu(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Cs(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?pu(Object(E),!0).forEach(function(b){Ce()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):pu(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var xc=(Ro=Object(ur.injectable)(),ls=Object(ur.inject)(x.TYPES.IGlobalConfigService),Pa=Object(ur.inject)(x.TYPES.ILogService),Ro(eu=(Io=(ul=function(){function h(){Y()(this,h),Ne()(this,"configService",So,this),Ne()(this,"logger",Sl,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("DataMappingPlugin",function(){A.generateMaping(E,{styleAttributeService:M})}),E.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return E.dataState.dataMappingNeedUpdate=!1,A.generateMaping(E,{styleAttributeService:M}),!0}),E.hooks.beforeRender.tap("DataMappingPlugin",function(){if(E.layerModelNeedUpdate)return;var U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=E.getSource().data.dataArray,Ue=U.filter(function(er){return er.needRemapping}),Ft=de;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(Ft=de.filter(function(er){return A.applyAttributeMapping(ie,er)[0]})),Ue.length&&((ie==null?void 0:ie.needRemapping)?(E.setEncodedData(A.mapping(U,Ft)),ie.needRemapping=!1):E.setEncodedData(A.mapping(Ue,Ft,E.getEncodedData())),A.logger.debug("remapping finished"),E.emit("remapping",null))})}},{key:"generateMaping",value:function(E,b){var A=this,M=b.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=E.getSource().data.dataArray,Ue=de;(ie==null?void 0:ie.scale)&&(Ue=de.filter(function(Ft){return A.applyAttributeMapping(ie,Ft)[0]})),E.setEncodedData(this.mapping(U,Ue))}},{key:"mapping",value:function(E,b,A){var M=this;return b.map(function(U,ie){var de=A?A[ie]:{},Ue=Cs({id:U._id,coordinates:U.coordinates},de);return E.filter(function(Ft){return Ft.scale!==void 0}).forEach(function(Ft){var er=M.applyAttributeMapping(Ft,U);Ft.needRemapping=!1,Ft.name==="color"&&(er=er.map(function(Mr){return Object(Me.s)(Mr)})),Ue[Ft.name]=Array.isArray(er)&&er.length===1?er[0]:er}),Ue})}},{key:"applyAttributeMapping",value:function(E,b){var A;if(!E.scale)return[];var M=(E==null||((A=E.scale)===null||A===void 0)?void 0:A.scalers)||[],U=[];return M.forEach(function(ie){var de,Ue=ie.field;(b.hasOwnProperty(Ue)||((de=E.scale)===null||de===void 0?void 0:de.type)==="variable")&&U.push(b[Ue])}),E.mapping?E.mapping(U):[]}}]),h}(),ul),So=nt()(Io.prototype,"configService",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sl=nt()(Io.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Io))||eu),Jn=o("UqwA"),jn,Ec,cs,Do=(jn=Object(ur.injectable)(),jn(Ec=(cs=function(){function h(){Y()(this,h),this.mapService=void 0}return i()(h,[{key:"apply",value:function(E){var b=this;this.mapService=E.getContainer().get(x.TYPES.IMapService),E.hooks.init.tap("DataSourcePlugin",function(){var A=E.sourceOption,M=A.data,U=A.options;E.setSource(new Jn.default(M,U)),b.updateClusterData(E)}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var A=b.updateClusterData(E),M=E.dataState.dataSourceNeedUpdate;return E.dataState.dataSourceNeedUpdate=!1,A||M})}},{key:"updateClusterData",value:function(E){var b=E.getSource(),A=b.cluster,M=b.clusterOptions,U=M.zoom,ie=U===void 0?0:U,de=M.maxZoom,Ue=de===void 0?16:de,Ft=this.mapService.getZoom()-1;return A&&Math.abs(ie-Ft)>1&&Ue>ie?(b.updateClusterData(Math.floor(Ft)),!0):!1}}]),h}(),cs))||Ec),vo=o("1B40"),ws=o.n(vo),Au=o("QNeN"),ec=o.n(Au),$a=o("5MNg"),no=o.n($a),ll=function(h,T){return h<T?-1:h>T?1:h>=T?0:NaN},mu=function(h){return h.length===1&&(h=cl(h)),{left:function(E,b,A,M){for(A==null&&(A=0),M==null&&(M=E.length);A<M;){var U=A+M>>>1;h(E[U],b)<0?A=U+1:M=U}return A},right:function(E,b,A,M){for(A==null&&(A=0),M==null&&(M=E.length);A<M;){var U=A+M>>>1;h(E[U],b)>0?M=U:A=U+1}return A}}};function cl(h){return function(T,E){return ll(h(T),E)}}var Cu=mu(ll),Is=Cu.right,zc=Cu.left,Gs=Is,yf=function(h,T){T==null&&(T=Ul);for(var E=0,b=h.length-1,A=h[0],M=new Array(b<0?0:b);E<b;)M[E]=T(A,A=h[++E]);return M};function Ul(h,T){return[h,T]}var Bl=function(h,T,E){var b=h.length,A=T.length,M=new Array(b*A),U,ie,de,Ue;for(E==null&&(E=Ul),U=de=0;U<b;++U)for(Ue=h[U],ie=0;ie<A;++ie,++de)M[de]=E(Ue,T[ie]);return M},_c=function(h,T){return T<h?-1:T>h?1:T>=h?0:NaN},fs=function(h){return h===null?NaN:+h},Bu=function(h,T){var E=h.length,b=0,A=-1,M=0,U,ie,de=0;if(T==null)for(;++A<E;)isNaN(U=fs(h[A]))||(ie=U-M,M+=ie/++b,de+=ie*(U-M));else for(;++A<E;)isNaN(U=fs(T(h[A],A,h)))||(ie=U-M,M+=ie/++b,de+=ie*(U-M));if(b>1)return de/(b-1)},Fc=function(h,T){var E=Bu(h,T);return E&&Math.sqrt(E)},Al=function(h,T){var E=h.length,b=-1,A,M,U;if(T==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=U=A;++b<E;)(A=h[b])!=null&&(M>A&&(M=A),U<A&&(U=A))}else for(;++b<E;)if((A=T(h[b],b,h))!=null&&A>=A)for(M=U=A;++b<E;)(A=T(h[b],b,h))!=null&&(M>A&&(M=A),U<A&&(U=A));return[M,U]},Vu=Array.prototype,tc=Vu.slice,Gu=Vu.map,Ds=function(h){return function(){return h}},nf=function(h){return h},rc=function(h,T,E){h=+h,T=+T,E=(A=arguments.length)<2?(T=h,h=0,1):A<3?1:+E;for(var b=-1,A=Math.max(0,Math.ceil((T-h)/E))|0,M=new Array(A);++b<A;)M[b]=h+b*E;return M},nc=Math.sqrt(50),ac=Math.sqrt(10),s=Math.sqrt(2),a=function(h,T,E){var b,A=-1,M,U,ie;if(T=+T,h=+h,E=+E,h===T&&E>0)return[h];if((b=T<h)&&(M=h,h=T,T=M),(ie=n(h,T,E))===0||!isFinite(ie))return[];if(ie>0)for(h=Math.ceil(h/ie),T=Math.floor(T/ie),U=new Array(M=Math.ceil(T-h+1));++A<M;)U[A]=(h+A)*ie;else for(h=Math.floor(h*ie),T=Math.ceil(T*ie),U=new Array(M=Math.ceil(h-T+1));++A<M;)U[A]=(h-A)/ie;return b&&U.reverse(),U};function n(h,T,E){var b=(T-h)/Math.max(0,E),A=Math.floor(Math.log(b)/Math.LN10),M=b/Math.pow(10,A);return A>=0?(M>=nc?10:M>=ac?5:M>=s?2:1)*Math.pow(10,A):-Math.pow(10,-A)/(M>=nc?10:M>=ac?5:M>=s?2:1)}function l(h,T,E){var b=Math.abs(T-h)/Math.max(0,E),A=Math.pow(10,Math.floor(Math.log(b)/Math.LN10)),M=b/A;return M>=nc?A*=10:M>=ac?A*=5:M>=s&&(A*=2),T<h?-A:A}var v=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},O=function(){var h=nf,T=Al,E=v;function b(A){var M,U=A.length,ie,de=new Array(U);for(M=0;M<U;++M)de[M]=h(A[M],M,A);var Ue=T(de),Ft=Ue[0],er=Ue[1],Mr=E(de,Ft,er);Array.isArray(Mr)||(Mr=l(Ft,er,Mr),Mr=rc(Math.ceil(Ft/Mr)*Mr,er,Mr));for(var kr=Mr.length;Mr[0]<=Ft;)Mr.shift(),--kr;for(;Mr[kr-1]>er;)Mr.pop(),--kr;var xn=new Array(kr+1),yn;for(M=0;M<=kr;++M)yn=xn[M]=[],yn.x0=M>0?Mr[M-1]:Ft,yn.x1=M<kr?Mr[M]:er;for(M=0;M<U;++M)ie=de[M],Ft<=ie&&ie<=er&&xn[Gs(Mr,ie,0,kr)].push(A[M]);return xn}return b.value=function(A){return arguments.length?(h=typeof A=="function"?A:Ds(A),b):h},b.domain=function(A){return arguments.length?(T=typeof A=="function"?A:Ds([A[0],A[1]]),b):T},b.thresholds=function(A){return arguments.length?(E=typeof A=="function"?A:Array.isArray(A)?Ds(tc.call(A)):Ds(A),b):E},b},L=function(h,T,E){if(E==null&&(E=fs),!(b=h.length))return;if((T=+T)<=0||b<2)return+E(h[0],0,h);if(T>=1)return+E(h[b-1],b-1,h);var b,A=(b-1)*T,M=Math.floor(A),U=+E(h[M],M,h),ie=+E(h[M+1],M+1,h);return U+(ie-U)*(A-M)},j=function(h,T,E){return h=Gu.call(h,fs).sort(ll),Math.ceil((E-T)/(2*(L(h,.75)-L(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,T,E){return Math.ceil((E-T)/(3.5*Fc(h)*Math.pow(h.length,-1/3)))},Ee=function(h,T){var E=h.length,b=-1,A,M;if(T==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=A;++b<E;)(A=h[b])!=null&&A>M&&(M=A)}else for(;++b<E;)if((A=T(h[b],b,h))!=null&&A>=A)for(M=A;++b<E;)(A=T(h[b],b,h))!=null&&A>M&&(M=A);return M},$e=function(h,T){var E=h.length,b=E,A=-1,M,U=0;if(T==null)for(;++A<E;)isNaN(M=fs(h[A]))?--b:U+=M;else for(;++A<E;)isNaN(M=fs(T(h[A],A,h)))?--b:U+=M;if(b)return U/b},rt=function(h,T){var E=h.length,b=-1,A,M=[];if(T==null)for(;++b<E;)isNaN(A=fs(h[b]))||M.push(A);else for(;++b<E;)isNaN(A=fs(T(h[b],b,h)))||M.push(A);return L(M.sort(ll),.5)},at=function(h){for(var T=h.length,E,b=-1,A=0,M,U;++b<T;)A+=h[b].length;for(M=new Array(A);--T>=0;)for(U=h[T],E=U.length;--E>=0;)M[--A]=U[E];return M},zt=function(h,T){var E=h.length,b=-1,A,M;if(T==null){for(;++b<E;)if((A=h[b])!=null&&A>=A)for(M=A;++b<E;)(A=h[b])!=null&&M>A&&(M=A)}else for(;++b<E;)if((A=T(h[b],b,h))!=null&&A>=A)for(M=A;++b<E;)(A=T(h[b],b,h))!=null&&M>A&&(M=A);return M},Nt=function(h,T){for(var E=T.length,b=new Array(E);E--;)b[E]=h[T[E]];return b},Jt=function(h,T){if(!(E=h.length))return;var E,b=0,A=0,M,U=h[A];for(T==null&&(T=ll);++b<E;)(T(M=h[b],U)<0||T(U,U)!==0)&&(U=M,A=b);if(T(U,U)===0)return A},jt=function(h,T,E){for(var b=(E==null?h.length:E)-(T=T==null?0:+T),A,M;b;)M=Math.random()*b--|0,A=h[b+T],h[b+T]=h[M+T],h[M+T]=A;return h},Gt=function(h,T){var E=h.length,b=-1,A,M=0;if(T==null)for(;++b<E;)(A=+h[b])&&(M+=A);else for(;++b<E;)(A=+T(h[b],b,h))&&(M+=A);return M},ar=function(h){if(!(M=h.length))return[];for(var T=-1,E=zt(h,nr),b=new Array(E);++T<E;)for(var A=-1,M,U=b[T]=new Array(M);++A<M;)U[A]=h[A][T];return b};function nr(h){return h.length}var Rr=function(){return ar(arguments)};function gr(h,T){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(T).domain(h);break}return this}function Ar(h,T){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(T).domain(h);break}return this}var Cr="$";function an(){}an.prototype=Yr.prototype={constructor:an,has:function(T){return Cr+T in this},get:function(T){return this[Cr+T]},set:function(T,E){return this[Cr+T]=E,this},remove:function(T){var E=Cr+T;return E in this&&delete this[E]},clear:function(){for(var T in this)T[0]===Cr&&delete this[T]},keys:function(){var T=[];for(var E in this)E[0]===Cr&&T.push(E.slice(1));return T},values:function(){var T=[];for(var E in this)E[0]===Cr&&T.push(this[E]);return T},entries:function(){var T=[];for(var E in this)E[0]===Cr&&T.push({key:E.slice(1),value:this[E]});return T},size:function(){var T=0;for(var E in this)E[0]===Cr&&++T;return T},empty:function(){for(var T in this)if(T[0]===Cr)return!1;return!0},each:function(T){for(var E in this)E[0]===Cr&&T(this[E],E.slice(1),this)}};function Yr(h,T){var E=new an;if(h instanceof an)h.each(function(ie,de){E.set(de,ie)});else if(Array.isArray(h)){var b=-1,A=h.length,M;if(T==null)for(;++b<A;)E.set(b,h[b]);else for(;++b<A;)E.set(T(M=h[b],b,h),M)}else if(h)for(var U in h)E.set(U,h[U]);return E}var vn=Yr,Pn=function(){var h=[],T=[],E,b,A;function M(ie,de,Ue,Ft){if(de>=h.length)return E!=null&&ie.sort(E),b!=null?b(ie):ie;for(var er=-1,Mr=ie.length,kr=h[de++],xn,yn,zn=vn(),Sa,wa=Ue();++er<Mr;)(Sa=zn.get(xn=kr(yn=ie[er])+""))?Sa.push(yn):zn.set(xn,[yn]);return zn.each(function(Ri,oi){Ft(wa,oi,M(Ri,de,Ue,Ft))}),wa}function U(ie,de){if(++de>h.length)return ie;var Ue,Ft=T[de-1];return b!=null&&de>=h.length?Ue=ie.entries():(Ue=[],ie.each(function(er,Mr){Ue.push({key:Mr,values:U(er,de)})})),Ft!=null?Ue.sort(function(er,Mr){return Ft(er.key,Mr.key)}):Ue}return A={object:function(de){return M(de,0,qn,sa)},map:function(de){return M(de,0,Aa,Wa)},entries:function(de){return U(M(de,0,Aa,Wa),0)},key:function(de){return h.push(de),A},sortKeys:function(de){return T[h.length-1]=de,A},sortValues:function(de){return E=de,A},rollup:function(de){return b=de,A}}};function qn(){return{}}function sa(h,T,E){h[T]=E}function Aa(){return vn()}function Wa(h,T,E){h.set(T,E)}function Tn(){}var ua=vn.prototype;Tn.prototype=xa.prototype={constructor:Tn,has:ua.has,add:function(T){return T+="",this[Cr+T]=T,this},remove:ua.remove,clear:ua.clear,values:ua.keys,size:ua.size,empty:ua.empty,each:ua.each};function xa(h,T){var E=new Tn;if(h instanceof Tn)h.each(function(M){E.add(M)});else if(h){var b=-1,A=h.length;if(T==null)for(;++b<A;)E.add(h[b]);else for(;++b<A;)E.add(T(h[b],b,h))}return E}var Zn=xa,Ca=function(h){var T=[];for(var E in h)T.push(E);return T},ia=function(h){var T=[];for(var E in h)T.push(h[E]);return T},La=function(h){var T=[];for(var E in h)T.push({key:E,value:h[E]});return T},Fa=Array.prototype,Hi=Fa.map,Ai=Fa.slice,Ni={name:"implicit"};function Ei(){var h=vn(),T=[],E=[],b=Ni;function A(M){var U=M+"",ie=h.get(U);if(!ie){if(b!==Ni)return b;h.set(U,ie=T.push(M))}return E[(ie-1)%E.length]}return A.domain=function(M){if(!arguments.length)return T.slice();T=[],h=vn();for(var U=-1,ie=M.length,de,Ue;++U<ie;)h.has(Ue=(de=M[U])+"")||h.set(Ue,T.push(de));return A},A.range=function(M){return arguments.length?(E=Ai.call(M),A):E.slice()},A.unknown=function(M){return arguments.length?(b=M,A):b},A.copy=function(){return Ei(T,E).unknown(b)},gr.apply(A,arguments),A}function Bi(){var h=Ei().unknown(void 0),T=h.domain,E=h.range,b=[0,1],A,M,U=!1,ie=0,de=0,Ue=.5;delete h.unknown;function Ft(){var er=T().length,Mr=b[1]<b[0],kr=b[Mr-0],xn=b[1-Mr];A=(xn-kr)/Math.max(1,er-ie+de*2),U&&(A=Math.floor(A)),kr+=(xn-kr-A*(er-ie))*Ue,M=A*(1-ie),U&&(kr=Math.round(kr),M=Math.round(M));var yn=rc(er).map(function(zn){return kr+A*zn});return E(Mr?yn.reverse():yn)}return h.domain=function(er){return arguments.length?(T(er),Ft()):T()},h.range=function(er){return arguments.length?(b=[+er[0],+er[1]],Ft()):b.slice()},h.rangeRound=function(er){return b=[+er[0],+er[1]],U=!0,Ft()},h.bandwidth=function(){return M},h.step=function(){return A},h.round=function(er){return arguments.length?(U=!!er,Ft()):U},h.padding=function(er){return arguments.length?(ie=Math.min(1,de=+er),Ft()):ie},h.paddingInner=function(er){return arguments.length?(ie=Math.min(1,er),Ft()):ie},h.paddingOuter=function(er){return arguments.length?(de=+er,Ft()):de},h.align=function(er){return arguments.length?(Ue=Math.max(0,Math.min(1,er)),Ft()):Ue},h.copy=function(){return Bi(T(),b).round(U).paddingInner(ie).paddingOuter(de).align(Ue)},gr.apply(Ft(),arguments)}function es(h){var T=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return es(T())},h}function ts(){return es(Bi.apply(null,arguments).paddingInner(1))}var vu=o("GfBb");function wu(h,T,E,b,A){var M=h*h,U=M*h;return((1-3*h+3*M-U)*T+(4-6*M+3*U)*E+(1+3*h+3*M-3*U)*b+U*A)/6}var hs=function(h){var T=h.length-1;return function(E){var b=E<=0?E=0:E>=1?(E=1,T-1):Math.floor(E*T),A=h[b],M=h[b+1],U=b>0?h[b-1]:2*A-M,ie=b<T-1?h[b+2]:2*M-A;return wu((E-b/T)*T,U,A,M,ie)}},Hs=function(h){var T=h.length;return function(E){var b=Math.floor(((E%=1)<0?++E:E)*T),A=h[(b+T-1)%T],M=h[b%T],U=h[(b+1)%T],ie=h[(b+2)%T];return wu((E-b/T)*T,A,M,U,ie)}},Ou=function(h){return function(){return h}};function ic(h,T){return function(E){return h+E*T}}function tu(h,T,E){return h=Math.pow(h,E),T=Math.pow(T,E)-h,E=1/E,function(b){return Math.pow(h+b*T,E)}}function Hu(h,T){var E=T-h;return E?ic(h,E>180||E<-180?E-360*Math.round(E/360):E):Ou(isNaN(h)?T:h)}function oc(h){return(h=+h)===1?ru:function(T,E){return E-T?tu(T,E,h):Ou(isNaN(T)?E:T)}}function ru(h,T){var E=T-h;return E?ic(h,E):Ou(isNaN(h)?T:h)}var Mu=function h(T){var E=oc(T);function b(A,M){var U=E((A=Object(vu.b)(A)).r,(M=Object(vu.b)(M)).r),ie=E(A.g,M.g),de=E(A.b,M.b),Ue=ru(A.opacity,M.opacity);return function(Ft){return A.r=U(Ft),A.g=ie(Ft),A.b=de(Ft),A.opacity=Ue(Ft),A+""}}return b.gamma=h,b}(1);function ds(h){return function(T){var E=T.length,b=new Array(E),A=new Array(E),M=new Array(E),U,ie;for(U=0;U<E;++U)ie=Object(vu.b)(T[U]),b[U]=ie.r||0,A[U]=ie.g||0,M[U]=ie.b||0;return b=h(b),A=h(A),M=h(M),ie.opacity=1,function(de){return ie.r=b(de),ie.g=A(de),ie.b=M(de),ie+""}}}var ao=ds(hs),Zu=ds(Hs),Vl=function(h,T){T||(T=[]);var E=h?Math.min(T.length,h.length):0,b=T.slice(),A;return function(M){for(A=0;A<E;++A)b[A]=h[A]*(1-M)+T[A]*M;return b}};function ps(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var No=function(h,T){return(ps(T)?Vl:ko)(h,T)};function ko(h,T){var E=T?T.length:0,b=h?Math.min(E,h.length):0,A=new Array(b),M=new Array(E),U;for(U=0;U<b;++U)A[U]=sc(h[U],T[U]);for(;U<E;++U)M[U]=T[U];return function(ie){for(U=0;U<b;++U)M[U]=A[U](ie);return M}}var Ko=function(h,T){var E=new Date;return h=+h,T=+T,function(b){return E.setTime(h*(1-b)+T*b),E}},Ao=function(h,T){return h=+h,T=+T,function(E){return h*(1-E)+T*E}},uo=function(h,T){var E={},b={},A;(h===null||typeof h!="object")&&(h={}),(T===null||typeof T!="object")&&(T={});for(A in T)A in h?E[A]=sc(h[A],T[A]):b[A]=T[A];return function(M){for(A in E)b[A]=E[A](M);return b}},Ns=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(Ns.source,"g");function Gl(h){return function(){return h}}function Uc(h){return function(T){return h(T)+""}}var fl=function(h,T){var E=Ns.lastIndex=nu.lastIndex=0,b,A,M,U=-1,ie=[],de=[];for(h=h+"",T=T+"";(b=Ns.exec(h))&&(A=nu.exec(T));)(M=A.index)>E&&(M=T.slice(E,M),ie[U]?ie[U]+=M:ie[++U]=M),(b=b[0])===(A=A[0])?ie[U]?ie[U]+=A:ie[++U]=A:(ie[++U]=null,de.push({i:U,x:Ao(b,A)})),E=nu.lastIndex;return E<T.length&&(M=T.slice(E),ie[U]?ie[U]+=M:ie[++U]=M),ie.length<2?de[0]?Uc(de[0].x):Gl(T):(T=de.length,function(Ue){for(var Ft=0,er;Ft<T;++Ft)ie[(er=de[Ft]).i]=er.x(Ue);return ie.join("")})},sc=function(h,T){var E=typeof T,b;return T==null||E==="boolean"?Ou(T):(E==="number"?Ao:E==="string"?(b=Object(vu.a)(T))?(T=b,Mu):fl:T instanceof vu.a?Mu:T instanceof Date?Ko:ps(T)?Vl:Array.isArray(T)?ko:typeof T.valueOf!="function"&&typeof T.toString!="function"||isNaN(T)?uo:Ao)(h,T)},hl=function(h,T){return h=+h,T=+T,function(E){return Math.round(h*(1-E)+T*E)}},ks=function(h){return function(){return h}},go=function(h){return+h},Tc=[0,1];function ms(h){return h}function af(h,T){return(T-=h=+h)?function(E){return(E-h)/T}:ks(isNaN(T)?NaN:.5)}function Sf(h){var T=h[0],E=h[h.length-1],b;return T>E&&(b=T,T=E,E=b),function(A){return Math.max(T,Math.min(E,A))}}function Af(h,T,E){var b=h[0],A=h[1],M=T[0],U=T[1];return A<b?(b=af(A,b),M=E(U,M)):(b=af(b,A),M=E(M,U)),function(ie){return M(b(ie))}}function Sc(h,T,E){var b=Math.min(h.length,T.length)-1,A=new Array(b),M=new Array(b),U=-1;for(h[b]<h[0]&&(h=h.slice().reverse(),T=T.slice().reverse());++U<b;)A[U]=af(h[U],h[U+1]),M[U]=E(T[U],T[U+1]);return function(ie){var de=Gs(h,ie,1,b)-1;return M[de](A[de](ie))}}function Wu(h,T){return T.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function bf(){var h=Tc,T=Tc,E=sc,b,A,M,U=ms,ie,de,Ue;function Ft(){return ie=Math.min(h.length,T.length)>2?Sc:Af,de=Ue=null,er}function er(Mr){return isNaN(Mr=+Mr)?M:(de||(de=ie(h.map(b),T,E)))(b(U(Mr)))}return er.invert=function(Mr){return U(A((Ue||(Ue=ie(T,h.map(b),Ao)))(Mr)))},er.domain=function(Mr){return arguments.length?(h=Hi.call(Mr,go),U===ms||(U=Sf(h)),Ft()):h.slice()},er.range=function(Mr){return arguments.length?(T=Ai.call(Mr),Ft()):T.slice()},er.rangeRound=function(Mr){return T=Ai.call(Mr),E=hl,Ft()},er.clamp=function(Mr){return arguments.length?(U=Mr?Sf(h):ms,er):U!==ms},er.interpolate=function(Mr){return arguments.length?(E=Mr,Ft()):E},er.unknown=function(Mr){return arguments.length?(M=Mr,er):M},function(Mr,kr){return b=Mr,A=kr,Ft()}}function of(h,T){return bf()(h,T)}var Cf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pu(h){if(!(T=Cf.exec(h)))throw new Error("invalid format: "+h);var T;return new uc({fill:T[1],align:T[2],sign:T[3],symbol:T[4],zero:T[5],width:T[6],comma:T[7],precision:T[8]&&T[8].slice(1),trim:T[9],type:T[10]})}Pu.prototype=uc.prototype;function uc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}uc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var If=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Bc(h,T){if((E=(h=T?h.toExponential(T-1):h.toExponential()).indexOf("e"))<0)return null;var E,b=h.slice(0,E);return[b.length>1?b[0]+b.slice(2):b,+h.slice(E+1)]}var Ac=function(h){return h=Bc(Math.abs(h)),h?h[1]:NaN},$f=function(h,T){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ac(T)/3)))*3-Ac(Math.abs(h)))},Jf=function(h,T){return function(E,b){for(var A=E.length,M=[],U=0,ie=h[0],de=0;A>0&&ie>0&&!(de+ie+1>b&&(ie=Math.max(1,b-de)),M.push(E.substring(A-=ie,A+ie)),(de+=ie+1)>b);)ie=h[U=(U+1)%h.length];return M.reverse().join(T)}},Qf=function(h){return function(T){return T.replace(/[0-9]/g,function(E){return h[+E]})}},qf=function(h){e:for(var T=h.length,E=1,b=-1,A;E<T;++E)switch(h[E]){case".":b=A=E;break;case"0":b===0&&(b=E),A=E;break;default:if(!+h[E])break e;b>0&&(b=0);break}return b>0?h.slice(0,b)+h.slice(A+1):h},wf,eh=function(h,T){var E=Bc(h,T);if(!E)return h+"";var b=E[0],A=E[1],M=A-(wf=Math.max(-8,Math.min(8,Math.floor(A/3)))*3)+1,U=b.length;return M===U?b:M>U?b+new Array(M-U+1).join("0"):M>0?b.slice(0,M)+"."+b.slice(M):"0."+new Array(1-M).join("0")+Bc(h,Math.max(0,T+M-1))[0]},Hl=function(h,T){var E=Bc(h,T);if(!E)return h+"";var b=E[0],A=E[1];return A<0?"0."+new Array(-A).join("0")+b:b.length>A+1?b.slice(0,A+1)+"."+b.slice(A+1):b+new Array(A-b.length+2).join("0")},sf={"%":function(T,E){return(T*100).toFixed(E)},b:function(T){return Math.round(T).toString(2)},c:function(T){return T+""},d:If,e:function(T,E){return T.toExponential(E)},f:function(T,E){return T.toFixed(E)},g:function(T,E){return T.toPrecision(E)},o:function(T){return Math.round(T).toString(8)},p:function(T,E){return Hl(T*100,E)},r:Hl,s:eh,X:function(T){return Math.round(T).toString(16).toUpperCase()},x:function(T){return Math.round(T).toString(16)}},io=function(h){return h},lc=Array.prototype.map,xf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Cc=function(h){var T=h.grouping===void 0||h.thousands===void 0?io:Jf(lc.call(h.grouping,Number),h.thousands+""),E=h.currency===void 0?"":h.currency[0]+"",b=h.currency===void 0?"":h.currency[1]+"",A=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?io:Qf(lc.call(h.numerals,String)),U=h.percent===void 0?"%":h.percent+"",ie=h.minus===void 0?"-":h.minus+"",de=h.nan===void 0?"NaN":h.nan+"";function Ue(er){er=Pu(er);var Mr=er.fill,kr=er.align,xn=er.sign,yn=er.symbol,zn=er.zero,Sa=er.width,wa=er.comma,Ri=er.precision,oi=er.trim,si=er.type;si==="n"?(wa=!0,si="g"):sf[si]||(Ri===void 0&&(Ri=12),oi=!0,si="g"),(zn||Mr==="0"&&kr==="=")&&(zn=!0,Mr="0",kr="=");var Qi=yn==="$"?E:yn==="#"&&/[boxX]/.test(si)?"0"+si.toLowerCase():"",Oa=yn==="$"?b:/[%p]/.test(si)?U:"",qi=sf[si],_o=/[defgprs%]/.test(si);Ri=Ri===void 0?6:/[gprs]/.test(si)?Math.max(1,Math.min(21,Ri)):Math.max(0,Math.min(20,Ri));function Xs(Xa){var Ms=Qi,$o=Oa,ff,Rh,wc;if(si==="c")$o=qi(Xa)+$o,Xa="";else{Xa=+Xa;var bh=Xa<0||1/Xa<0;if(Xa=isNaN(Xa)?de:qi(Math.abs(Xa),Ri),oi&&(Xa=qf(Xa)),bh&&+Xa===0&&xn!=="+"&&(bh=!1),Ms=(bh?xn==="("?xn:ie:xn==="-"||xn==="("?"":xn)+Ms,$o=(si==="s"?xf[8+wf/3]:"")+$o+(bh&&xn==="("?")":""),_o){for(ff=-1,Rh=Xa.length;++ff<Rh;)if(wc=Xa.charCodeAt(ff),48>wc||wc>57){$o=(wc===46?A+Xa.slice(ff+1):Xa.slice(ff))+$o,Xa=Xa.slice(0,ff);break}}}wa&&!zn&&(Xa=T(Xa,Infinity));var ah=Ms.length+Xa.length+$o.length,Xc=ah<Sa?new Array(Sa-ah+1).join(Mr):"";wa&&zn&&(Xa=T(Xc+Xa,Xc.length?Sa-$o.length:Infinity),Xc="");switch(kr){case"<":Xa=Ms+Xa+$o+Xc;break;case"=":Xa=Ms+Xc+Xa+$o;break;case"^":Xa=Xc.slice(0,ah=Xc.length>>1)+Ms+Xa+$o+Xc.slice(ah);break;default:Xa=Xc+Ms+Xa+$o;break}return M(Xa)}return Xs.toString=function(){return er+""},Xs}function Ft(er,Mr){var kr=Ue((er=Pu(er),er.type="f",er)),xn=Math.max(-8,Math.min(8,Math.floor(Ac(Mr)/3)))*3,yn=Math.pow(10,-xn),zn=xf[8+xn/3];return function(Sa){return kr(yn*Sa)+zn}}return{format:Ue,formatPrefix:Ft}},au,Cl,Ef;Df({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Df(h){return au=Cc(h),Cl=au.format,Ef=au.formatPrefix,au}var Vc=function(h,T){return h=Math.abs(h),T=Math.abs(T)-h,Math.max(0,Ac(T)-Ac(h))+1},uf=function(h){return Math.max(0,-Ac(Math.abs(h)))},Gc=function(h,T,E,b){var A=l(h,T,E),M;b=Pu(b==null?",f":b);switch(b.type){case"s":{var U=Math.max(Math.abs(h),Math.abs(T));return b.precision==null&&!isNaN(M=$f(A,U))&&(b.precision=M),Ef(b,U)}case"":case"e":case"g":case"p":case"r":{b.precision==null&&!isNaN(M=Vc(A,Math.max(Math.abs(h),Math.abs(T))))&&(b.precision=M-(b.type==="e"));break}case"f":case"%":{b.precision==null&&!isNaN(M=uf(A))&&(b.precision=M-(b.type==="%")*2);break}}return Cl(b)};function dl(h){var T=h.domain;return h.ticks=function(E){var b=T();return a(b[0],b[b.length-1],E==null?10:E)},h.tickFormat=function(E,b){var A=T();return Gc(A[0],A[A.length-1],E==null?10:E,b)},h.nice=function(E){E==null&&(E=10);var b=T(),A=0,M=b.length-1,U=b[A],ie=b[M],de;return ie<U&&(de=U,U=ie,ie=de,de=A,A=M,M=de),de=n(U,ie,E),de>0?(U=Math.floor(U/de)*de,ie=Math.ceil(ie/de)*de,de=n(U,ie,E)):de<0&&(U=Math.ceil(U*de)/de,ie=Math.floor(ie*de)/de,de=n(U,ie,E)),de>0?(b[A]=Math.floor(U/de)*de,b[M]=Math.ceil(ie/de)*de,T(b)):de<0&&(b[A]=Math.ceil(U*de)/de,b[M]=Math.floor(ie*de)/de,T(b)),h},h}function ne(){var h=of(ms,ms);return h.copy=function(){return Wu(h,ne())},gr.apply(h,arguments),dl(h)}function se(h){var T;function E(b){return isNaN(b=+b)?T:b}return E.invert=E,E.domain=E.range=function(b){return arguments.length?(h=Hi.call(b,go),E):h.slice()},E.unknown=function(b){return arguments.length?(T=b,E):T},E.copy=function(){return se(h).unknown(T)},h=arguments.length?Hi.call(h,go):[0,1],dl(E)}var N=function(h,T){h=h.slice();var E=0,b=h.length-1,A=h[E],M=h[b],U;return M<A&&(U=E,E=b,b=U,U=A,A=M,M=U),h[E]=T.floor(A),h[b]=T.ceil(M),h};function G(h){return Math.log(h)}function Ae(h){return Math.exp(h)}function ct(h){return-Math.log(-h)}function Yt(h){return-Math.exp(-h)}function sr(h){return isFinite(h)?+("1e"+h):h<0?0:h}function or(h){return h===10?sr:h===Math.E?Math.exp:function(T){return Math.pow(h,T)}}function Dr(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(T){return Math.log(T)/h})}function sn(h){return function(T){return-h(-T)}}function Hn(h){var T=h(G,Ae),E=T.domain,b=10,A,M;function U(){return A=Dr(b),M=or(b),E()[0]<0?(A=sn(A),M=sn(M),h(ct,Yt)):h(G,Ae),T}return T.base=function(ie){return arguments.length?(b=+ie,U()):b},T.domain=function(ie){return arguments.length?(E(ie),U()):E()},T.ticks=function(ie){var de=E(),Ue=de[0],Ft=de[de.length-1],er;(er=Ft<Ue)&&(Mr=Ue,Ue=Ft,Ft=Mr);var Mr=A(Ue),kr=A(Ft),xn,yn,zn,Sa=ie==null?10:+ie,wa=[];if(!(b%1)&&kr-Mr<Sa)if(Mr=Math.round(Mr)-1,kr=Math.round(kr)+1,Ue>0)for(;Mr<kr;++Mr)for(yn=1,xn=M(Mr);yn<b;++yn){if(zn=xn*yn,zn<Ue)continue;if(zn>Ft)break;wa.push(zn)}else for(;Mr<kr;++Mr)for(yn=b-1,xn=M(Mr);yn>=1;--yn){if(zn=xn*yn,zn<Ue)continue;if(zn>Ft)break;wa.push(zn)}else wa=a(Mr,kr,Math.min(kr-Mr,Sa)).map(M);return er?wa.reverse():wa},T.tickFormat=function(ie,de){if(de==null&&(de=b===10?".0e":","),typeof de!="function"&&(de=Cl(de)),ie===Infinity)return de;ie==null&&(ie=10);var Ue=Math.max(1,b*ie/T.ticks().length);return function(Ft){var er=Ft/M(Math.round(A(Ft)));return er*b<b-.5&&(er*=b),er<=Ue?de(Ft):""}},T.nice=function(){return E(N(E(),{floor:function(de){return M(Math.floor(A(de)))},ceil:function(de){return M(Math.ceil(A(de)))}}))},T}function ea(){var h=Hn(bf()).domain([1,10]);return h.copy=function(){return Wu(h,ea()).base(h.base())},gr.apply(h,arguments),h}function la(h){return function(T){return Math.sign(T)*Math.log1p(Math.abs(T/h))}}function ti(h){return function(T){return Math.sign(T)*Math.expm1(Math.abs(T))*h}}function ja(h){var T=1,E=h(la(T),ti(T));return E.constant=function(b){return arguments.length?h(la(T=+b),ti(T)):T},dl(E)}function _i(){var h=ja(bf());return h.copy=function(){return Wu(h,_i()).constant(h.constant())},gr.apply(h,arguments)}function Qa(h){return function(T){return T<0?-Math.pow(-T,h):Math.pow(T,h)}}function Vi(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function Co(h){return h<0?-h*h:h*h}function yo(h){var T=h(ms,ms),E=1;function b(){return E===1?h(ms,ms):E===.5?h(Vi,Co):h(Qa(E),Qa(1/E))}return T.exponent=function(A){return arguments.length?(E=+A,b()):E},dl(T)}function Zi(){var h=yo(bf());return h.copy=function(){return Wu(h,Zi()).exponent(h.exponent())},gr.apply(h,arguments),h}function jo(){return Zi.apply(null,arguments).exponent(.5)}function qa(){var h=[],T=[],E=[],b;function A(){var U=0,ie=Math.max(1,T.length);for(E=new Array(ie-1);++U<ie;)E[U-1]=L(h,U/ie);return M}function M(U){return isNaN(U=+U)?b:T[Gs(E,U)]}return M.invertExtent=function(U){var ie=T.indexOf(U);return ie<0?[NaN,NaN]:[ie>0?E[ie-1]:h[0],ie<E.length?E[ie]:h[h.length-1]]},M.domain=function(U){if(!arguments.length)return h.slice();h=[];for(var ie=0,de=U.length,Ue;ie<de;++ie)(Ue=U[ie],Ue!=null&&!isNaN(Ue=+Ue))&&h.push(Ue);return h.sort(ll),A()},M.range=function(U){return arguments.length?(T=Ai.call(U),A()):T.slice()},M.unknown=function(U){return arguments.length?(b=U,M):b},M.quantiles=function(){return E.slice()},M.copy=function(){return qa().domain(h).range(T).unknown(b)},gr.apply(M,arguments)}function lo(){var h=0,T=1,E=1,b=[.5],A=[0,1],M;function U(de){return de<=de?A[Gs(b,de,0,E)]:M}function ie(){var de=-1;for(b=new Array(E);++de<E;)b[de]=((de+1)*T-(de-E)*h)/(E+1);return U}return U.domain=function(de){return arguments.length?(h=+de[0],T=+de[1],ie()):[h,T]},U.range=function(de){return arguments.length?(E=(A=Ai.call(de)).length-1,ie()):A.slice()},U.invertExtent=function(de){var Ue=A.indexOf(de);return Ue<0?[NaN,NaN]:Ue<1?[h,b[0]]:Ue>=E?[b[E-1],T]:[b[Ue-1],b[Ue]]},U.unknown=function(de){return arguments.length&&(M=de),U},U.thresholds=function(){return b.slice()},U.copy=function(){return lo().domain([h,T]).range(A).unknown(M)},gr.apply(dl(U),arguments)}function iu(){var h=[.5],T=[0,1],E,b=1;function A(M){return M<=M?T[Gs(h,M,0,b)]:E}return A.domain=function(M){return arguments.length?(h=Ai.call(M),b=Math.min(h.length,T.length-1),A):h.slice()},A.range=function(M){return arguments.length?(T=Ai.call(M),b=Math.min(h.length,T.length-1),A):T.slice()},A.invertExtent=function(M){var U=T.indexOf(M);return[h[U-1],h[U]]},A.unknown=function(M){return arguments.length?(E=M,A):E},A.copy=function(){return iu().domain(h).range(T).unknown(E)},gr.apply(A,arguments)}var Ti=new Date,ki=new Date;function Ea(h,T,E,b){function A(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return A.floor=function(M){return h(M=new Date(+M)),M},A.ceil=function(M){return h(M=new Date(M-1)),T(M,1),h(M),M},A.round=function(M){var U=A(M),ie=A.ceil(M);return M-U<ie-M?U:ie},A.offset=function(M,U){return T(M=new Date(+M),U==null?1:Math.floor(U)),M},A.range=function(M,U,ie){var de=[],Ue;if(M=A.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<U)||!(ie>0))return de;do de.push(Ue=new Date(+M)),T(M,ie),h(M);while(Ue<M&&M<U);return de},A.filter=function(M){return Ea(function(U){if(U>=U)for(;h(U),!M(U);)U.setTime(U-1)},function(U,ie){if(U>=U)if(ie<0)for(;++ie<=0;)for(;T(U,-1),!M(U););else for(;--ie>=0;)for(;T(U,1),!M(U););})},E&&(A.count=function(M,U){return Ti.setTime(+M),ki.setTime(+U),h(Ti),h(ki),Math.floor(E(Ti,ki))},A.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?A.filter(b?function(U){return b(U)%M===0}:function(U){return A.count(0,U)%M===0}):A}),A}var wo=Ea(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,T){h.setFullYear(h.getFullYear()+T)},function(h,T){return T.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});wo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Ea(function(T){T.setFullYear(Math.floor(T.getFullYear()/h)*h),T.setMonth(0,1),T.setHours(0,0,0,0)},function(T,E){T.setFullYear(T.getFullYear()+E*h)})};var cc=wo,Nf=wo.range,oh=Ea(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,T){h.setMonth(h.getMonth()+T)},function(h,T){return T.getMonth()-h.getMonth()+(T.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),kf=oh,Lu=oh.range,jf=1e3,lf=6e4,zf=36e5,Eh=864e5,sh=6048e5;function _f(h){return Ea(function(T){T.setDate(T.getDate()-(T.getDay()+7-h)%7),T.setHours(0,0,0,0)},function(T,E){T.setDate(T.getDate()+E*7)},function(T,E){return(E-T-(E.getTimezoneOffset()-T.getTimezoneOffset())*lf)/sh})}var Ff=_f(0),Uf=_f(1),uh=_f(2),Bf=_f(3),Of=_f(4),Zl=_f(5),Ih=_f(6),ye=Ff.range,je=Uf.range,Mt=uh.range,Er=Bf.range,Lr=Of.range,wr=Zl.range,_r=Ih.range,Wr=Ea(function(h){h.setHours(0,0,0,0)},function(h,T){h.setDate(h.getDate()+T)},function(h,T){return(T-h-(T.getTimezoneOffset()-h.getTimezoneOffset())*lf)/Eh},function(h){return h.getDate()-1}),un=Wr,Jr=Wr.range,Qr=Ea(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*jf-h.getMinutes()*lf)},function(h,T){h.setTime(+h+T*zf)},function(h,T){return(T-h)/zf},function(h){return h.getHours()}),ln=Qr,Sn=Qr.range,pn=Ea(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*jf)},function(h,T){h.setTime(+h+T*lf)},function(h,T){return(T-h)/lf},function(h){return h.getMinutes()}),nn=pn,Tr=pn.range,xr=Ea(function(h){h.setTime(h-h.getMilliseconds())},function(h,T){h.setTime(+h+T*jf)},function(h,T){return(T-h)/jf},function(h){return h.getUTCSeconds()}),Xr=xr,On=xr.range,Ir=Ea(function(){},function(h,T){h.setTime(+h+T)},function(h,T){return T-h});Ir.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?Ea(function(T){T.setTime(Math.floor(T/h)*h)},function(T,E){T.setTime(+T+E*h)},function(T,E){return(E-T)/h}):Ir};var ta=Ir,qr=Ir.range;function Fr(h){return Ea(function(T){T.setUTCDate(T.getUTCDate()-(T.getUTCDay()+7-h)%7),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCDate(T.getUTCDate()+E*7)},function(T,E){return(E-T)/sh})}var Vr=Fr(0),Kr=Fr(1),Xn=Fr(2),na=Fr(3),cn=Fr(4),Hr=Fr(5),jr=Fr(6),ma=Vr.range,pa=Kr.range,Un=Xn.range,Ua=na.range,_a=cn.range,Ba=Hr.range,hi=jr.range,zo=Ea(function(h){h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCDate(h.getUTCDate()+T)},function(h,T){return(T-h)/Eh},function(h){return h.getUTCDate()-1}),Os=zo,ei=zo.range,bo=Ea(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCFullYear(h.getUTCFullYear()+T)},function(h,T){return T.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});bo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Ea(function(T){T.setUTCFullYear(Math.floor(T.getUTCFullYear()/h)*h),T.setUTCMonth(0,1),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCFullYear(T.getUTCFullYear()+E*h)})};var Ci=bo,vs=bo.range;function Fo(h){if(0<=h.y&&h.y<100){var T=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return T.setFullYear(h.y),T}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function gs(h){if(0<=h.y&&h.y<100){var T=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return T.setUTCFullYear(h.y),T}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function Uo(h,T,E){return{y:h,m:T,d:E,H:0,M:0,S:0,L:0}}function Bo(h){var T=h.dateTime,E=h.date,b=h.time,A=h.periods,M=h.days,U=h.shortDays,ie=h.months,de=h.shortMonths,Ue=Va(A),Ft=rs(A),er=Va(M),Mr=rs(M),kr=Va(U),xn=rs(U),yn=Va(ie),zn=rs(ie),Sa=Va(de),wa=rs(de),Ri={a:bh,A:ah,b:Xc,B:dd,c:null,d:dr,e:dr,f:Bn,g:Wl,G:pl,H:rr,I:mr,j:Or,L:$r,m:on,M:Dn,p:sd,q:pd,Q:rd,s:ld,S:ca,u:Na,U:ri,V:Hc,w:ys,W:fc,x:null,X:null,y:xo,Y:Xu,Z:wl,"%":td},oi={a:md,A:ud,b:vd,B:Bh,c:null,d:Mf,e:Mf,f:Dh,g:Hh,G:_h,H:za,I:li,j:lh,L:th,m:hc,M:rh,p:gd,q:Qh,Q:rd,s:ld,S:Vh,u:ch,U:fh,V:Zs,w:Nh,W:Vf,x:null,X:null,y:Gh,Y:ed,Z:Gf,"%":td},si={a:Xs,A:Xa,b:Ms,B:$o,c:ff,d:We,e:We,f:pt,g:ee,G:I,H:Pe,I:Pe,j:tt,L:ke,m:Q,M:Je,p:_o,q:k,Q:Zt,s:Kt,S:_t,u:y,U:c,V:d,w,W:g,x:Rh,X:wc,y:ee,Y:I,Z:B,"%":De};Ri.x=Qi(E,Ri),Ri.X=Qi(b,Ri),Ri.c=Qi(T,Ri),oi.x=Qi(E,oi),oi.X=Qi(b,oi),oi.c=Qi(T,oi);function Qi(ka,zi){return function(ci){var In=[],Oc=-1,Es=0,Yc=ka.length,Kc,xh,yd;for(ci instanceof Date||(ci=new Date(+ci));++Oc<Yc;)ka.charCodeAt(Oc)===37&&(In.push(ka.slice(Es,Oc)),(xh=Vo[Kc=ka.charAt(++Oc)])!=null?Kc=ka.charAt(++Oc):xh=Kc==="e"?" ":"0",(yd=zi[Kc])&&(Kc=yd(ci,xh)),In.push(Kc),Es=Oc+1);return In.push(ka.slice(Es,Oc)),In.join("")}}function Oa(ka,zi){return function(ci){var In=Uo(1900,void 0,1),Oc=qi(In,ka,ci+="",0),Es,Yc;if(Oc!=ci.length)return null;if("Q"in In)return new Date(In.Q);if("s"in In)return new Date(In.s*1e3+("L"in In?In.L:0));if(zi&&!("Z"in In)&&(In.Z=0),"p"in In&&(In.H=In.H%12+In.p*12),In.m===void 0&&(In.m="q"in In?In.q:0),"V"in In){if(In.V<1||In.V>53)return null;"w"in In||(In.w=1),"Z"in In?(Es=gs(Uo(In.y,0,1)),Yc=Es.getUTCDay(),Es=Yc>4||Yc===0?Kr.ceil(Es):Kr(Es),Es=Os.offset(Es,(In.V-1)*7),In.y=Es.getUTCFullYear(),In.m=Es.getUTCMonth(),In.d=Es.getUTCDate()+(In.w+6)%7):(Es=Fo(Uo(In.y,0,1)),Yc=Es.getDay(),Es=Yc>4||Yc===0?Uf.ceil(Es):Uf(Es),Es=un.offset(Es,(In.V-1)*7),In.y=Es.getFullYear(),In.m=Es.getMonth(),In.d=Es.getDate()+(In.w+6)%7)}else("W"in In||"U"in In)&&("w"in In||(In.w="u"in In?In.u%7:"W"in In?1:0),Yc="Z"in In?gs(Uo(In.y,0,1)).getUTCDay():Fo(Uo(In.y,0,1)).getDay(),In.m=0,In.d="W"in In?(In.w+6)%7+In.W*7-(Yc+5)%7:In.w+In.U*7-(Yc+6)%7);return"Z"in In?(In.H+=In.Z/100|0,In.M+=In.Z%100,gs(In)):Fo(In)}}function qi(ka,zi,ci,In){for(var Oc=0,Es=zi.length,Yc=ci.length,Kc,xh;Oc<Es;){if(In>=Yc)return-1;if(Kc=zi.charCodeAt(Oc++),Kc===37){if(Kc=zi.charAt(Oc++),xh=si[Kc in Vo?zi.charAt(Oc++):Kc],!xh||(In=xh(ka,ci,In))<0)return-1}else if(Kc!=ci.charCodeAt(In++))return-1}return In}function _o(ka,zi,ci){var In=Ue.exec(zi.slice(ci));return In?(ka.p=Ft[In[0].toLowerCase()],ci+In[0].length):-1}function Xs(ka,zi,ci){var In=kr.exec(zi.slice(ci));return In?(ka.w=xn[In[0].toLowerCase()],ci+In[0].length):-1}function Xa(ka,zi,ci){var In=er.exec(zi.slice(ci));return In?(ka.w=Mr[In[0].toLowerCase()],ci+In[0].length):-1}function Ms(ka,zi,ci){var In=Sa.exec(zi.slice(ci));return In?(ka.m=wa[In[0].toLowerCase()],ci+In[0].length):-1}function $o(ka,zi,ci){var In=yn.exec(zi.slice(ci));return In?(ka.m=zn[In[0].toLowerCase()],ci+In[0].length):-1}function ff(ka,zi,ci){return qi(ka,T,zi,ci)}function Rh(ka,zi,ci){return qi(ka,E,zi,ci)}function wc(ka,zi,ci){return qi(ka,b,zi,ci)}function bh(ka){return U[ka.getDay()]}function ah(ka){return M[ka.getDay()]}function Xc(ka){return de[ka.getMonth()]}function dd(ka){return ie[ka.getMonth()]}function sd(ka){return A[+(ka.getHours()>=12)]}function pd(ka){return 1+~~(ka.getMonth()/3)}function md(ka){return U[ka.getUTCDay()]}function ud(ka){return M[ka.getUTCDay()]}function vd(ka){return de[ka.getUTCMonth()]}function Bh(ka){return ie[ka.getUTCMonth()]}function gd(ka){return A[+(ka.getUTCHours()>=12)]}function Qh(ka){return 1+~~(ka.getUTCMonth()/3)}return{format:function(zi){var ci=Qi(zi+="",Ri);return ci.toString=function(){return zi},ci},parse:function(zi){var ci=Oa(zi+="",!1);return ci.toString=function(){return zi},ci},utcFormat:function(zi){var ci=Qi(zi+="",oi);return ci.toString=function(){return zi},ci},utcParse:function(zi){var ci=Oa(zi+="",!0);return ci.toString=function(){return zi},ci}}}var Vo={"-":"",_:" ","0":"0"},aa=/^\s*\d+/,ou=/^%/,yi=/[\\^$*+?|[\]().{}]/g;function An(h,T,E){var b=h<0?"-":"",A=(b?-h:h)+"",M=A.length;return b+(M<E?new Array(E-M+1).join(T)+A:A)}function Ra(h){return h.replace(yi,"\\$&")}function Va(h){return new RegExp("^(?:"+h.map(Ra).join("|")+")","i")}function rs(h){for(var T={},E=-1,b=h.length;++E<b;)T[h[E].toLowerCase()]=E;return T}function w(h,T,E){var b=aa.exec(T.slice(E,E+1));return b?(h.w=+b[0],E+b[0].length):-1}function y(h,T,E){var b=aa.exec(T.slice(E,E+1));return b?(h.u=+b[0],E+b[0].length):-1}function c(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.U=+b[0],E+b[0].length):-1}function d(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.V=+b[0],E+b[0].length):-1}function g(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.W=+b[0],E+b[0].length):-1}function I(h,T,E){var b=aa.exec(T.slice(E,E+4));return b?(h.y=+b[0],E+b[0].length):-1}function ee(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.y=+b[0]+(+b[0]>68?1900:2e3),E+b[0].length):-1}function B(h,T,E){var b=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(T.slice(E,E+6));return b?(h.Z=b[1]?0:-(b[2]+(b[3]||"00")),E+b[0].length):-1}function k(h,T,E){var b=aa.exec(T.slice(E,E+1));return b?(h.q=b[0]*3-3,E+b[0].length):-1}function Q(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.m=b[0]-1,E+b[0].length):-1}function We(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.d=+b[0],E+b[0].length):-1}function tt(h,T,E){var b=aa.exec(T.slice(E,E+3));return b?(h.m=0,h.d=+b[0],E+b[0].length):-1}function Pe(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.H=+b[0],E+b[0].length):-1}function Je(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.M=+b[0],E+b[0].length):-1}function _t(h,T,E){var b=aa.exec(T.slice(E,E+2));return b?(h.S=+b[0],E+b[0].length):-1}function ke(h,T,E){var b=aa.exec(T.slice(E,E+3));return b?(h.L=+b[0],E+b[0].length):-1}function pt(h,T,E){var b=aa.exec(T.slice(E,E+6));return b?(h.L=Math.floor(b[0]/1e3),E+b[0].length):-1}function De(h,T,E){var b=ou.exec(T.slice(E,E+1));return b?E+b[0].length:-1}function Zt(h,T,E){var b=aa.exec(T.slice(E));return b?(h.Q=+b[0],E+b[0].length):-1}function Kt(h,T,E){var b=aa.exec(T.slice(E));return b?(h.s=+b[0],E+b[0].length):-1}function dr(h,T){return An(h.getDate(),T,2)}function rr(h,T){return An(h.getHours(),T,2)}function mr(h,T){return An(h.getHours()%12||12,T,2)}function Or(h,T){return An(1+un.count(cc(h),h),T,3)}function $r(h,T){return An(h.getMilliseconds(),T,3)}function Bn(h,T){return $r(h,T)+"000"}function on(h,T){return An(h.getMonth()+1,T,2)}function Dn(h,T){return An(h.getMinutes(),T,2)}function ca(h,T){return An(h.getSeconds(),T,2)}function Na(h){var T=h.getDay();return T===0?7:T}function ri(h,T){return An(Ff.count(cc(h)-1,h),T,2)}function co(h){var T=h.getDay();return T>=4||T===0?Of(h):Of.ceil(h)}function Hc(h,T){return h=co(h),An(Of.count(cc(h),h)+(cc(h).getDay()===4),T,2)}function ys(h){return h.getDay()}function fc(h,T){return An(Uf.count(cc(h)-1,h),T,2)}function xo(h,T){return An(h.getFullYear()%100,T,2)}function Wl(h,T){return h=co(h),An(h.getFullYear()%100,T,2)}function Xu(h,T){return An(h.getFullYear()%1e4,T,4)}function pl(h,T){var E=h.getDay();return h=E>=4||E===0?Of(h):Of.ceil(h),An(h.getFullYear()%1e4,T,4)}function wl(h){var T=h.getTimezoneOffset();return(T>0?"-":(T*=-1,"+"))+An(T/60|0,"0",2)+An(T%60,"0",2)}function Mf(h,T){return An(h.getUTCDate(),T,2)}function za(h,T){return An(h.getUTCHours(),T,2)}function li(h,T){return An(h.getUTCHours()%12||12,T,2)}function lh(h,T){return An(1+Os.count(Ci(h),h),T,3)}function th(h,T){return An(h.getUTCMilliseconds(),T,3)}function Dh(h,T){return th(h,T)+"000"}function hc(h,T){return An(h.getUTCMonth()+1,T,2)}function rh(h,T){return An(h.getUTCMinutes(),T,2)}function Vh(h,T){return An(h.getUTCSeconds(),T,2)}function ch(h){var T=h.getUTCDay();return T===0?7:T}function fh(h,T){return An(Vr.count(Ci(h)-1,h),T,2)}function qh(h){var T=h.getUTCDay();return T>=4||T===0?cn(h):cn.ceil(h)}function Zs(h,T){return h=qh(h),An(cn.count(Ci(h),h)+(Ci(h).getUTCDay()===4),T,2)}function Nh(h){return h.getUTCDay()}function Vf(h,T){return An(Kr.count(Ci(h)-1,h),T,2)}function Gh(h,T){return An(h.getUTCFullYear()%100,T,2)}function Hh(h,T){return h=qh(h),An(h.getUTCFullYear()%100,T,2)}function ed(h,T){return An(h.getUTCFullYear()%1e4,T,4)}function _h(h,T){var E=h.getUTCDay();return h=E>=4||E===0?cn(h):cn.ceil(h),An(h.getUTCFullYear()%1e4,T,4)}function Gf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var bs,Hf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return bs=Bo(h),Hf=bs.format,cd=bs.parse,e=bs.utcFormat,t=bs.utcParse,bs}var u=1e3,f=u*60,m=f*60,S=m*24,P=S*7,V=S*30,te=S*365;function he(h){return new Date(h)}function Te(h){return h instanceof Date?+h:+new Date(+h)}function we(h,T,E,b,A,M,U,ie,de){var Ue=of(ms,ms),Ft=Ue.invert,er=Ue.domain,Mr=de(".%L"),kr=de(":%S"),xn=de("%I:%M"),yn=de("%I %p"),zn=de("%a %d"),Sa=de("%b %d"),wa=de("%B"),Ri=de("%Y"),oi=[[U,1,u],[U,5,5*u],[U,15,15*u],[U,30,30*u],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[A,1,m],[A,3,3*m],[A,6,6*m],[A,12,12*m],[b,1,S],[b,2,2*S],[E,1,P],[T,1,V],[T,3,3*V],[h,1,te]];function si(Oa){return(U(Oa)<Oa?Mr:M(Oa)<Oa?kr:A(Oa)<Oa?xn:b(Oa)<Oa?yn:T(Oa)<Oa?E(Oa)<Oa?zn:Sa:h(Oa)<Oa?wa:Ri)(Oa)}function Qi(Oa,qi,_o,Xs){if(Oa==null&&(Oa=10),typeof Oa=="number"){var Xa=Math.abs(_o-qi)/Oa,Ms=mu(function($o){return $o[2]}).right(oi,Xa);Ms===oi.length?(Xs=l(qi/te,_o/te,Oa),Oa=h):Ms?(Ms=oi[Xa/oi[Ms-1][2]<oi[Ms][2]/Xa?Ms-1:Ms],Xs=Ms[1],Oa=Ms[0]):(Xs=Math.max(l(qi,_o,Oa),1),Oa=ie)}return Xs==null?Oa:Oa.every(Xs)}return Ue.invert=function(Oa){return new Date(Ft(Oa))},Ue.domain=function(Oa){return arguments.length?er(Hi.call(Oa,Te)):er().map(he)},Ue.ticks=function(Oa,qi){var _o=er(),Xs=_o[0],Xa=_o[_o.length-1],Ms=Xa<Xs,$o;return Ms&&($o=Xs,Xs=Xa,Xa=$o),$o=Qi(Oa,Xs,Xa,qi),$o=$o?$o.range(Xs,Xa+1):[],Ms?$o.reverse():$o},Ue.tickFormat=function(Oa,qi){return qi==null?si:de(qi)},Ue.nice=function(Oa,qi){var _o=er();return(Oa=Qi(Oa,_o[0],_o[_o.length-1],qi))?er(N(_o,Oa)):Ue},Ue.copy=function(){return Wu(Ue,we(h,T,E,b,A,M,U,ie,de))},Ue}var lt=function(){return gr.apply(we(cc,kf,Ff,un,ln,nn,Xr,ta,Hf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Lt=Ea(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCMonth(h.getUTCMonth()+T)},function(h,T){return T.getUTCMonth()-h.getUTCMonth()+(T.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),St=Lt,$t=Lt.range,Xt=Ea(function(h){h.setUTCMinutes(0,0,0)},function(h,T){h.setTime(+h+T*zf)},function(h,T){return(T-h)/zf},function(h){return h.getUTCHours()}),ir=Xt,br=Xt.range,Sr=Ea(function(h){h.setUTCSeconds(0,0)},function(h,T){h.setTime(+h+T*lf)},function(h,T){return(T-h)/lf},function(h){return h.getUTCMinutes()}),zr=Sr,Nr=Sr.range,mn=function(){return gr.apply(we(Ci,St,Vr,Os,ir,zr,Xr,ta,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hn(){var h=0,T=1,E,b,A,M,U=ms,ie=!1,de;function Ue(Ft){return isNaN(Ft=+Ft)?de:U(A===0?.5:(Ft=(M(Ft)-E)*A,ie?Math.max(0,Math.min(1,Ft)):Ft))}return Ue.domain=function(Ft){return arguments.length?(E=M(h=+Ft[0]),b=M(T=+Ft[1]),A=E===b?0:1/(b-E),Ue):[h,T]},Ue.clamp=function(Ft){return arguments.length?(ie=!!Ft,Ue):ie},Ue.interpolator=function(Ft){return arguments.length?(U=Ft,Ue):U},Ue.unknown=function(Ft){return arguments.length?(de=Ft,Ue):de},function(Ft){return M=Ft,E=Ft(h),b=Ft(T),A=E===b?0:1/(b-E),Ue}}function Ln(h,T){return T.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Qn(){var h=dl(hn()(ms));return h.copy=function(){return Ln(h,Qn())},Ar.apply(h,arguments)}function Yn(){var h=Hn(hn()).domain([1,10]);return h.copy=function(){return Ln(h,Yn()).base(h.base())},Ar.apply(h,arguments)}function Nn(){var h=ja(hn());return h.copy=function(){return Ln(h,Nn()).constant(h.constant())},Ar.apply(h,arguments)}function Ta(){var h=yo(hn());return h.copy=function(){return Ln(h,Ta()).exponent(h.exponent())},Ar.apply(h,arguments)}function fa(){return Ta.apply(null,arguments).exponent(.5)}function ra(){var h=[],T=ms;function E(b){if(!isNaN(b=+b))return T((Gs(h,b)-1)/(h.length-1))}return E.domain=function(b){if(!arguments.length)return h.slice();h=[];for(var A=0,M=b.length,U;A<M;++A)(U=b[A],U!=null&&!isNaN(U=+U))&&h.push(U);return h.sort(ll),E},E.interpolator=function(b){return arguments.length?(T=b,E):T},E.copy=function(){return ra(T).domain(h)},Ar.apply(E,arguments)}function Ja(){var h=0,T=.5,E=1,b,A,M,U,ie,de=ms,Ue,Ft=!1,er;function Mr(kr){return isNaN(kr=+kr)?er:(kr=.5+((kr=+Ue(kr))-A)*(kr<A?U:ie),de(Ft?Math.max(0,Math.min(1,kr)):kr))}return Mr.domain=function(kr){return arguments.length?(b=Ue(h=+kr[0]),A=Ue(T=+kr[1]),M=Ue(E=+kr[2]),U=b===A?0:.5/(A-b),ie=A===M?0:.5/(M-A),Mr):[h,T,E]},Mr.clamp=function(kr){return arguments.length?(Ft=!!kr,Mr):Ft},Mr.interpolator=function(kr){return arguments.length?(de=kr,Mr):de},Mr.unknown=function(kr){return arguments.length?(er=kr,Mr):er},function(kr){return Ue=kr,b=kr(h),A=kr(T),M=kr(E),U=b===A?0:.5/(A-b),ie=A===M?0:.5/(M-A),Mr}}function Da(){var h=dl(Ja()(ms));return h.copy=function(){return Ln(h,Da())},Ar.apply(h,arguments)}function ji(){var h=Hn(Ja()).domain([.1,1,10]);return h.copy=function(){return Ln(h,ji()).base(h.base())},Ar.apply(h,arguments)}function va(){var h=ja(Ja());return h.copy=function(){return Ln(h,va()).constant(h.constant())},Ar.apply(h,arguments)}function ai(){var h=yo(Ja());return h.copy=function(){return Ln(h,ai()).exponent(h.exponent())},Ar.apply(h,arguments)}function Go(){return ai.apply(null,arguments).exponent(.5)}var bi,Ho,Zo,ns,gu,as,Yu,su,Ku,uu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ws=(bi={},Ce()(bi,x.ScaleTypes.LINEAR,ne),Ce()(bi,x.ScaleTypes.POWER,Zi),Ce()(bi,x.ScaleTypes.LOG,ea),Ce()(bi,x.ScaleTypes.IDENTITY,se),Ce()(bi,x.ScaleTypes.TIME,lt),Ce()(bi,x.ScaleTypes.QUANTILE,qa),Ce()(bi,x.ScaleTypes.QUANTIZE,lo),Ce()(bi,x.ScaleTypes.THRESHOLD,iu),Ce()(bi,x.ScaleTypes.CAT,Ei),bi),lu=(Ho=Object(ur.injectable)(),Zo=Object(ur.inject)(x.TYPES.IGlobalConfigService),ns=Object(ur.inject)(x.TYPES.ILogService),Ho(gu=(as=(Ku=function(){function h(){Y()(this,h),Ne()(this,"configService",Yu,this),Ne()(this,"logger",su,this),this.scaleCache={},this.scaleOptions={}}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("FeatureScalePlugin",function(){A.scaleOptions=E.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=E.getSource().data.dataArray;if(ie.length===0)return;A.caculateScalesForAttributes(U||[],ie)}),E.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){A.scaleOptions=E.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=E.getSource().data.dataArray;return A.caculateScalesForAttributes(U||[],ie),E.layerModelNeedUpdate=!0,!0}),E.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(E.layerModelNeedUpdate)return;A.scaleOptions=E.getScaleOptions();var U=M.getLayerStyleAttributes();if(U){var ie=E.getSource().data.dataArray;if(ie.length===0)return;var de=U.filter(function(Ue){return Ue.needRescale});de.length&&(A.caculateScalesForAttributes(de,ie),A.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(E){return!isNaN(parseFloat(E))&&isFinite(E)}},{key:"caculateScalesForAttributes",value:function(E,b){var A=this;this.scaleCache={},E.forEach(function(M){if(M.scale){var U=M.scale,ie=M.name;U.names=A.parseFields(M.scale.field||[]);var de=[];U.names.forEach(function(Ue){de.push(A.getOrCreateScale(Ue,M,b))}),de.some(function(Ue){return Ue.type===x.StyleScaleType.VARIABLE})?(U.type=x.StyleScaleType.VARIABLE,de.forEach(function(Ue){if(!U.callback){var Ft;if(U.values&&U.values!=="text"){var er;if(((er=Ue.option)===null||er===void 0?void 0:er.type)==="linear"&&U.values.length>2){var Mr=Ue.scale.ticks(U.values.length);ie==="color"&&Ue.scale.domain(Mr)}Ue.scale.range(U.values)}else((Ft=Ue.option)===null||Ft===void 0?void 0:Ft.type)==="cat"&&Ue.scale.range(Ue.option.domain)}})):(U.type=x.StyleScaleType.CONSTANT,U.defaultValues=de.map(function(Ue,Ft){return Ue.scale(U.names[Ft])})),U.scalers=de.map(function(Ue){return{field:Ue.field,func:Ue.scale,option:Ue.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(E,b,A){var M,U=[E,b.name].join("_"),ie=(M=b.scale)===null||M===void 0?void 0:M.values,de=this.createScale(E,b.name,ie,A);return de}},{key:"parseFields",value:function(E){return Array.isArray(E)?E:ec()(E)?E.split("*"):[E]}},{key:"createScale",value:function(E,b,A,M){var U,ie=this.scaleOptions[b]&&this.scaleOptions[b].field===E?this.scaleOptions[b]:this.scaleOptions[E],de={field:E,scale:void 0,type:x.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?de.scale=this.createDefaultScale(ie):(de.scale=Ei([E]),de.type=x.StyleScaleType.CONSTANT),de;var Ue=(U=M.find(function(Mr){return!no()(Mr[E])}))===null||U===void 0?void 0:U[E];if(this.isNumber(E)||no()(Ue)&&!ie)de.scale=Ei([E]),de.type=x.StyleScaleType.CONSTANT;else{var Ft=ie&&ie.type||this.getDefaultType(Ue);A==="text"&&(Ft=x.ScaleTypes.CAT);var er=this.createDefaultScaleConfig(Ft,E,M);Object.assign(er,ie),de.scale=this.createDefaultScale(er),de.option=er}return de}},{key:"getDefaultType",value:function(E){var b=x.ScaleTypes.LINEAR;return typeof E=="string"&&(b=uu.test(E)?x.ScaleTypes.TIME:x.ScaleTypes.CAT),b}},{key:"createDefaultScaleConfig",value:function(E,b,A){var M={type:E},U=(A==null?void 0:A.map(function(ie){return ie[b]}))||[];return E!==x.ScaleTypes.CAT&&E!==x.ScaleTypes.QUANTILE?M.domain=Al(U):E===x.ScaleTypes.CAT?M.domain=ws()(U):E===x.ScaleTypes.QUANTILE&&(M.domain=U),M}},{key:"createDefaultScale",value:function(E){var b=E.type,A=E.domain,M=Ws[b]();return A&&M.domain(A),M}}]),h}(),Ku),Yu=nt()(as.prototype,"configService",[Zo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=nt()(as.prototype,"logger",[ns],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as))||gu),mi,ii,Ji,fo,yu,Eo,Wo,Ru;function di(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Zf(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?di(Object(E),!0).forEach(function(b){Ce()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):di(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var Zc=(mi=Object(ur.injectable)(),ii=Object(ur.inject)(x.TYPES.ICameraService),Ji=Object(ur.inject)(x.TYPES.IRendererService),mi(fo=(yu=(Ru=function(){function h(){Y()(this,h),Ne()(this,"cameraService",Eo,this),Ne()(this,"rendererService",Wo,this)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){E.models.forEach(function(b){b.addUniforms(Zf({},E.layerModel.getAnimateUniforms()))})})}}]),h}(),Ru),Eo=nt()(yu.prototype,"cameraService",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wo=nt()(yu.prototype,"rendererService",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu))||fo),cf,dc,Iu=(cf=Object(ur.injectable)(),cf(dc=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.init.tap("LayerModelPlugin",function(){E.prepareBuildModel(),E.buildModels(),E.styleNeedUpdate=!1}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return E.prepareBuildModel(),E.clearModels(),E.buildModels(),E.layerModelNeedUpdate=!1,!1})}}]),h}())||dc),Pf,Lf,Wf=(Pf=Object(ur.injectable)(),Pf(Lf=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.afterInit.tap("LayerStylePlugin",function(){E.updateLayerConfig({});var b=E.getLayerConfig(),A=b.autoFit,M=b.fitBoundsOptions;A&&setTimeout(function(){E.fitBounds(M)},100)})}}]),h}())||Lf),Th,Tf;function Sh(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(h);T&&(b=b.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),E.push.apply(E,b)}return E}function Xf(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Sh(Object(E),!0).forEach(function(b){Ce()(h,b,E[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Sh(Object(E)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(E,b))})}return h}var hh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Zh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},kh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Wh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},dh=["ambient","diffuse","specular"];function Ah(h){var T={u_DirectionalLights:new Array(3).fill(Xf({},kh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Xf({},Wh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Zh]),h.forEach(function(E,b){var A=E.type,M=A===void 0?"directional":A,U=Xe()(E,["type"]),ie=hh[M].lights,de=hh[M].num,Ue=T[de];T[ie][Ue]=Xf(Xf({},T[ie][Ue]),U),T[de]++}),T}var Xh=(Th=Object(ur.injectable)(),Th(Tf=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LightingPlugin",function(){var b=E.getLayerConfig(),A=b.enableLighting;A&&E.models.forEach(function(M){return M.addUniforms(Xf({},Ah()))})})}}]),h}())||Tf),ph,Yf,nh={NONE:0,ENCODE:1,HIGHLIGHT:2},Yh=(ph=Object(ur.injectable)(),ph(Yf=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E,b){var A=b.rendererService,M=b.styleAttributeService;E.hooks.init.tap("PixelPickingPlugin",function(){var U=E.getLayerConfig(),ie=U.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:x.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:x.gl.FLOAT},size:3,update:function(Ue,Ft){var er=Ue.id;return ie?Object(Me.l)(er):[0,0,0]}}})}),E.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var U=E.getLayerConfig(),ie=U.enablePicking;ie&&E.isVisible()&&E.models.forEach(function(de){return de.addUniforms({u_PickingStage:nh.ENCODE})})}),E.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var U=E.getLayerConfig(),ie=U.enablePicking;ie&&E.isVisible()&&E.models.forEach(function(de){return de.addUniforms({u_PickingStage:nh.HIGHLIGHT})})}),E.hooks.beforeHighlight.tap("PixelPickingPlugin",function(U){var ie=E.getLayerConfig(),de=ie.highlightColor,Ue=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(U))}),E.models.forEach(function(Ft){return Ft.addUniforms({u_PickingStage:nh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Ue.map(function(er){return er*255})})})}),E.hooks.beforeSelect.tap("PixelPickingPlugin",function(U){var ie=E.getLayerConfig(),de=ie.selectColor,Ue=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(U))}),E.models.forEach(function(Ft){return Ft.addUniforms({u_PickingStage:nh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Ue.map(function(er){return er*255})})})})}}]),h}())||Yf),jh,mh,zh,Ch,vh,Fh,Uh=(jh=Object(ur.injectable)(),mh=Object(ur.inject)(x.TYPES.ILogService),jh(zh=(Ch=(Fh=function(){function h(){Y()(this,h),Ne()(this,"logger",vh,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("RegisterStyleAttributePlugin",function(){A.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(E){E.registerStyleAttribute({name:"position",type:x.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:x.gl.FLOAT},size:3,update:function(A,M,U){return U.length===2?[U[0],U[1],0]:[U[0],U[1],U[2]]}}}),E.registerStyleAttribute({name:"filter",type:x.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:1,update:function(A,M){var U=A.filter;return U?[1]:[0]}}}),E.registerStyleAttribute({name:"color",type:x.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:x.gl.DYNAMIC_DRAW,data:[],type:x.gl.FLOAT},size:4,update:function(A,M){var U=A.color;return!U||!U.length?[1,1,1,1]:U}}})}}]),h}(),Fh),vh=nt()(Ch.prototype,"logger",[mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ch))||zh),wh,Oh,gh,Mh,yh,Rf,Ph,Kh,$h,nd,ad=(wh=Object(ur.injectable)(),Oh=Object(ur.inject)(x.TYPES.ICameraService),gh=Object(ur.inject)(x.TYPES.ICoordinateSystemService),Mh=Object(ur.inject)(x.TYPES.IRendererService),wh(yh=(Rf=(nd=function(){function h(){Y()(this,h),Ne()(this,"cameraService",Ph,this),Ne()(this,"coordinateSystemService",Kh,this),Ne()(this,"rendererService",$h,this)}return i()(h,[{key:"apply",value:function(E){var b=this;E.hooks.beforeRender.tap("ShaderUniformPlugin",function(){b.coordinateSystemService.refresh();var A=b.rendererService.getViewportSize(),M=A.width,U=A.height;E.models.forEach(function(ie){var de;return ie.addUniforms((de={},Ce()(de,x.CameraUniform.ProjectionMatrix,b.cameraService.getProjectionMatrix()),Ce()(de,x.CameraUniform.ViewMatrix,b.cameraService.getViewMatrix()),Ce()(de,x.CameraUniform.ViewProjectionMatrix,b.cameraService.getViewProjectionMatrix()),Ce()(de,x.CameraUniform.Zoom,b.cameraService.getZoom()),Ce()(de,x.CameraUniform.ZoomScale,b.cameraService.getZoomScale()),Ce()(de,x.CameraUniform.FocalDistance,b.cameraService.getFocalDistance()),Ce()(de,x.CameraUniform.CameraPosition,b.cameraService.getCameraPosition()),Ce()(de,x.CoordinateUniform.CoordinateSystem,b.coordinateSystemService.getCoordinateSystem()),Ce()(de,x.CoordinateUniform.ViewportCenter,b.coordinateSystemService.getViewportCenter()),Ce()(de,x.CoordinateUniform.ViewportCenterProjection,b.coordinateSystemService.getViewportCenterProjection()),Ce()(de,x.CoordinateUniform.PixelsPerDegree,b.coordinateSystemService.getPixelsPerDegree()),Ce()(de,x.CoordinateUniform.PixelsPerDegree2,b.coordinateSystemService.getPixelsPerDegree2()),Ce()(de,x.CoordinateUniform.PixelsPerMeter,b.coordinateSystemService.getPixelsPerMeter()),Ce()(de,"u_ViewportSize",[M,U]),Ce()(de,"u_DevicePixelRatio",window.devicePixelRatio),Ce()(de,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ce()(de,"u_PickingBuffer",E.getLayerConfig().pickingBuffer||0),de))})})}}]),h}(),nd),Ph=nt()(Rf.prototype,"cameraService",[Oh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=nt()(Rf.prototype,"coordinateSystemService",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=nt()(Rf.prototype,"rendererService",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf))||yh),id,Jh,Ed=(id=Object(ur.injectable)(),id(Jh=function(){function h(){Y()(this,h)}return i()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("UpdateModelPlugin",function(){E.layerModel&&E.layerModel.needUpdate()})}}]),h}())||Jh),fd,Lh,xs,Wc,hd,Kf,od=(fd=Object(ur.injectable)(),Lh=Object(ur.inject)(x.TYPES.ILogService),fd(xs=(Wc=(Kf=function(){function h(){Y()(this,h),Ne()(this,"logger",hd,this)}return i()(h,[{key:"apply",value:function(E,b){var A=this,M=b.styleAttributeService;E.hooks.init.tap("UpdateStyleAttributePlugin",function(){A.initStyleAttribute(E,{styleAttributeService:M})}),E.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(E.layerModelNeedUpdate)return;A.updateStyleAtrribute(E,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(E,b){var A=this,M=b.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||de&&de.needRegenerateVertices){E.layerModelNeedUpdate=!0,U.forEach(function(Ue){return Ue.needRegenerateVertices=!1});return}U.filter(function(Ue){return Ue.needRegenerateVertices}).forEach(function(Ue){M.updateAttributeByFeatureRange(Ue.name,E.getEncodedData(),Ue.featureRange.startIndex,Ue.featureRange.endIndex),Ue.needRegenerateVertices=!1,A.logger.debug("regenerate vertex attributes: ".concat(Ue.name," finished"))})}},{key:"initStyleAttribute",value:function(E,b){var A=this,M=b.styleAttributeService,U=M.getLayerStyleAttributes()||[];U.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,E.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,A.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),h}(),Kf),hd=nt()(Wc.prototype,"logger",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wc))||xs);x.container.bind(x.TYPES.ILayerPlugin).to(Do).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Uh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(lu).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(xc).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Wf).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(od).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Ed).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(it).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(ad).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Zc).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Xh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Yh).inRequestScope(),x.container.bind(x.TYPES.ILayerPlugin).to(Iu).inRequestScope()},pg6l:function(Fe,_,o){"use strict";(function(x){o.d(_,"a",function(){return Y});var p=o("PoO7");function Y(z){if(typeof window!="undefined"&&Object(p.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof x!="undefined"&&Object(p.a)(x.versions)==="object"&&Boolean(x.versions.electron))return!0;var i=(typeof navigator=="undefined"?"undefined":Object(p.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Z=z||i;return!!(Z&&Z.indexOf("Electron")>=0)}}).call(this,o("7vYp"))},pygv:function(Fe,_){function o(x,p){for(var Y=-1,z=x==null?0:x.length,i=Array(z);++Y<z;)i[Y]=p(x[Y],Y,x);return i}Fe.exports=o},q2Nz:function(Fe,_,o){var x=o("zVLJ"),p=o("U3SQ");function Y(z,i,Z){(Z!==void 0&&!p(z[i],Z)||Z===void 0&&!(i in z))&&x(z,i,Z)}Fe.exports=Y},q8dt:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("/jsB"),p=o("Vrkw"),Y=o("Vkc/");function z(){return function(i,Z,D){var K=new p.Metadata(x.UNMANAGED_TAG,!0);Y.tagParameter(i,Z,D,K)}}_.unmanaged=z},"qDY+":function(Fe,_){var o=800,x=16,p=Date.now;function Y(z){var i=0,Z=0;return function(){var D=p(),K=x-(D-Z);if(Z=D,K>0){if(++i>=o)return arguments[0]}else i=0;return z.apply(void 0,arguments)}}Fe.exports=Y},qG1B:function(Fe,_){function o(x){return x.split("")}Fe.exports=o},"qR+W":function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=function(){function p(Y,z){this.parentContext=Y,this.rootRequest=z}return p}();_.Plan=x},qun4:function(Fe,_){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function x(p){return o.test(p)}Fe.exports=x},qwXO:function(Fe,_){Fe.exports=o;function o(x,p){p||(p=document);var Y=p.head||p.getElementsByTagName("head")[0];if(!Y){Y=p.createElement("head");var z=p.body||p.getElementsByTagName("body")[0];z?z.parentNode.insertBefore(Y,z):p.documentElement.appendChild(Y)}var i=p.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=x:i.appendChild(p.createTextNode(x)),Y.appendChild(i),i}},r4C2:function(Fe,_,o){var x=o("SQcl"),p=o("Aq8R"),Y=p(function(z,i,Z){return i=i.toLowerCase(),z+(Z?x(i):i)});Fe.exports=Y},rZUy:function(Fe,_,o){"use strict";var x=o("qSre")},roZi:function(Fe,_,o){var x=o("gteZ"),p=Object.create,Y=function(){function z(){}return function(i){if(!x(i))return{};if(p)return p(i);z.prototype=i;var Z=new z;return z.prototype=void 0,Z}}();Fe.exports=Y},sQYV:function(Fe,_,o){"use strict";o.d(_,"d",function(){return Ef}),o.d(_,"b",function(){return Gc}),o.d(_,"a",function(){return dl});var x=o("BLox"),p=o("2pGt"),Y=o.n(p),z=o("S+oY"),i=o("UHDP"),Z=o.n(i),D=o("Y2WT"),K=o("L84c"),re=o.n(K),fe=o("b83N"),X=o.n(fe),He=o("xjNF"),Xe=o.n(He),pe=o("LhPA"),Ce=o("QnA+"),mt=o.n(Ce);function Ne(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function At(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ne(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ne(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Ye(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=Et(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ct=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function Et(ne,se){if(!ne)return;if(typeof ne=="string")return nt(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return nt(ne,se)}function nt(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var Ct=30;function Ot(ne){var se=ne.characterSet,N=ne.getFontWidth,G=ne.fontHeight,Ae=ne.buffer,ct=ne.maxCanvasWidth,Yt=ne.mapping,sr=Yt===void 0?{}:Yt,or=ne.xOffset,Dr=or===void 0?0:or,sn=ne.yOffset,Hn=sn===void 0?0:sn,ea=0,la=Dr;Array.from(se).forEach(function(ja,_i){if(!sr[ja]){var Qa=N(ja,_i);la+Ct>ct&&(la=0,ea++),sr[ja]={x:la,y:Hn+ea*Ct,width:Ct,height:Ct,advance:Qa},la+=Ct}});var ti=G+Ae*2;return{mapping:sr,xOffset:la,yOffset:Hn+ea*ti,canvasHeight:Be(Hn+(ea+1)*ti)}}function Re(ne,se,N){var G=0,Ae=0,ct=0,Yt=[],sr={},or=Ye(ne),Dr;try{for(or.s();!(Dr=or.n()).done;){var sn=Dr.value;if(!sr[sn.id]){var Hn=sn.height,ea=sn.width;G+ea+se>N&&(Ie(sr,Yt,Ae),G=0,Ae=ct+Ae+se,ct=0,Yt=[]),Yt.push({icon:sn,xOffset:G}),G=G+ea+se,ct=Math.max(ct,Hn)}}}catch(ti){or.e(ti)}finally{or.f()}Yt.length>0&&Ie(sr,Yt,Ae);var la=Be(ct+Ae+se);return{mapping:sr,canvasHeight:la}}function Ie(ne,se,N){var G=Ye(se),Ae;try{for(G.s();!(Ae=G.n()).done;){var ct=Ae.value,Yt=ct.icon,sr=ct.xOffset;ne[Yt.id]=At(At({},Yt),{},{x:sr,y:N,image:Yt.image})}}catch(or){G.e(or)}finally{G.f()}}function Be(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var ft,Me,ht;function Wt(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=Qt(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ct=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function Qt(ne,se){if(!ne)return;if(typeof ne=="string")return ur(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return ur(ne,se)}function ur(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}function oe(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function J(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):oe(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var H=Oe(),Se="sans-serif",be="normal",_e=24,me=3,it=.25,qt=8,Pt=1024,ve=1,ge=1,Ve=3,st=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Oe(){for(var ne=[],se=32;se<128;se++)ne.push(String.fromCharCode(se));return ne}function vt(ne,se,N,G){ne.font="".concat(G," ").concat(N,"px ").concat(se),ne.fillStyle="black",ne.textBaseline="middle"}function C(ne,se){for(var N=0;N<ne.length;N++)se.data[4*N+3]=ne[N]}var R=(ft=Object(z.injectable)(),ft(Me=(ht=function(){function ne(){X()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new pe.b(Ve)}return Xe()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Se,fontWeight:be,characterSet:H,fontSize:_e,buffer:me,sdf:!0,cutoff:it,radius:qt},this.key=""}},{key:"addIconGlyphs",value:function(N){var G=this;N.forEach(function(Ae){G.iconFontGlyphs[Ae.name]=Ae.unicode})}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=J(J({},this.fontOptions),N),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),Ae=this.cache.get(this.key);if(Ae&&G.length===0)return;var ct=this.generateFontAtlas(this.key,G,Ae);this.fontAtlas=ct,this.cache.set(this.key,ct)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(N,G,Ae){var ct=this.fontOptions,Yt=ct.fontFamily,sr=ct.fontWeight,or=ct.fontSize,Dr=ct.buffer,sn=ct.sdf,Hn=ct.radius,ea=ct.cutoff,la=Ae&&Ae.data;la||(la=document.createElement("canvas"),la.width=Pt);var ti=la.getContext("2d");vt(ti,Yt,or,sr);var ja=Ot(J({getFontWidth:function(cc){return ti.measureText(cc).width},fontHeight:or*ge,buffer:Dr,characterSet:G,maxCanvasWidth:Pt},Ae&&{mapping:Ae.mapping,xOffset:Ae.xOffset,yOffset:Ae.yOffset})),_i=ja.mapping,Qa=ja.canvasHeight,Vi=ja.xOffset,Co=ja.yOffset;if(la.height!==Qa){var yo=ti.getImageData(0,0,la.width,la.height);la.height=Qa,ti.putImageData(yo,0,0)}if(vt(ti,Yt,or,sr),sn){var Zi=new mt.a(or,Dr,Hn,ea,Yt,sr),jo=ti.getImageData(0,0,Zi.size,Zi.size),qa=Wt(G),lo;try{for(qa.s();!(lo=qa.n()).done;){var iu=lo.value;C(Zi.draw(iu),jo),ti.putImageData(jo,_i[iu].x,_i[iu].y)}}catch(wo){qa.e(wo)}finally{qa.f()}}else{var Ti=Wt(G),ki;try{for(Ti.s();!(ki=Ti.n()).done;){var Ea=ki.value;ti.fillText(Ea,_i[Ea].x,_i[Ea].y+or*ve)}}catch(wo){Ti.e(wo)}finally{Ti.f()}}return{xOffset:Vi,yOffset:Co,mapping:_i,data:la,width:la.width,height:la.height}}},{key:"getKey",value:function(){var N=this.fontOptions,G=N.fontFamily,Ae=N.fontWeight,ct=N.fontSize,Yt=N.buffer,sr=N.sdf,or=N.radius,Dr=N.cutoff;return sr?"".concat(G," ").concat(Ae," ").concat(ct," ").concat(Yt," ").concat(or," ").concat(Dr):"".concat(G," ").concat(Ae," ").concat(ct," ").concat(Yt)}},{key:"getNewChars",value:function(N,G){var Ae=this.cache.get(N);if(!Ae)return G;var ct=[],Yt=Ae.mapping,sr=new Set(Object.keys(Yt)),or=new Set(G);return or.forEach(function(Dr){sr.has(Dr)||ct.push(Dr)}),ct}},{key:"scale",get:function(){return ge}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}}]),ne}(),ht))||Me),q=o("vMUQ"),ce=o.n(q),Ge=o("ArX4"),qe=o.n(Ge),Tt=o("by6o"),ot=o.n(Tt),Ut,$,Qe;function ae(ne){var se=et();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var kt=3,pr=1024,Ke=64,bt=(Ut=Object(z.injectable)(),Ut($=(Qe=function(ne){ce()(N,ne);var se=ae(N);function N(){var G;X()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Yt=0;Yt<Ae;Yt++)ct[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ct)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return Xe()(N,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ae,ct){var Yt=this,sr=new Image;if(this.hasImage(Ae))throw new Error("Image Id already exists");this.iconData.push({id:Ae,width:Ke,height:Ke}),this.updateIconMap(),this.loadImage(ct).then(function(or){sr=or;var Dr=Yt.iconData.find(function(sn){return sn.id===Ae});Dr&&(Dr.image=sr),Yt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ae){return this.iconMap.hasOwnProperty(Ae)}},{key:"removeImage",value:function(Ae){this.hasImage(Ae)&&(this.iconData=this.iconData.filter(function(ct){return ct.id!==Ae}),delete this.iconMap[Ae],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ae=this;this.canvas.width=pr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ct){var Yt=Ae.iconMap[ct],sr=Yt.x,or=Yt.y,Dr=Yt.image;Dr&&Ae.ctx.drawImage(Dr,sr,or,Ke,Ke)})}},{key:"updateIconMap",value:function(){var Ae=Re(this.iconData,kt,pr),ct=Ae.mapping,Yt=Ae.canvasHeight;this.iconMap=ct,this.canvasHeight=Yt}},{key:"loadImage",value:function(Ae){return new Promise(function(ct,Yt){if(Ae instanceof HTMLImageElement){ct(Ae);return}var sr=new Image;sr.crossOrigin="anonymous",sr.onload=function(){ct(sr)},sr.onerror=function(){Yt(new Error("Could not load image at "+Ae))},sr.src=Ae instanceof File?URL.createObjectURL(Ae):Ae})}}]),N}(p.EventEmitter),Qe))||$),yt=o("++Hr"),xt=o.n(yt),ze=o("99LQ"),dt,gt,Ht,hr=(dt=Object(z.injectable)(),dt(gt=(Ht=function(){function ne(){X()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Xe()(ne,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=ze.b.invert(ze.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),G=xt()(N,2),Ae=G[0],ct=G[1];return[Ae,ct]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,G){return this.viewport.projectFlat(N,G)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,G){var Ae=ze.b.fromTranslation(ze.b.create(),[N,G,0]);this.jitteredProjectionMatrix=ze.b.multiply(ze.b.create(),Ae,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ze.b.multiply(ze.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Ht))||gt),Zr,yr,Vn;function Fn(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=oa(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ct=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function oa(ne,se){if(!ne)return;if(typeof ne=="string")return $n(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return $n(ne,se)}function $n(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var Kn=(Zr=Object(z.injectable)(),Zr(yr=(Vn=function(){function ne(){X()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Xe()(ne,[{key:"init",value:function(N,G){this.container=N.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,G){var Ae=G.get(D.a.IMapService);Ae.map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(G){return G.controlOption.name===N})}},{key:"removeControl",value:function(N){var G=this.controls.indexOf(N);return G>-1&&this.controls.splice(G,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(G){G.addTo(N.scene),N.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var N=Fn(this.controls),G;try{for(N.s();!(G=N.n()).done;){var Ae=G.value;Ae.remove()}}catch(ct){N.e(ct)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},G="l7-",Ae=this.controlContainer=pe.a.create("div",G+"control-container",this.container);function ct(Yt,sr){var or=G+Yt+" "+G+sr;N[Yt+sr]=pe.a.create("div",or,Ae)}ct("top","left"),ct("top","right"),ct("bottom","left"),ct("bottom","right")}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&pe.a.remove(this.controlCorners[N]);this.controlContainer&&pe.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),Vn))||yr),Cn,F,W,le=(Cn=Object(z.injectable)(),Cn(F=(W=function(){function ne(){X()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Xe()(ne,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var G=this.markerLayers.indexOf(N);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(G){G.addTo(N.scene),N.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(G){N.markerLayers.push(G),G.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var G=this.markers.indexOf(N);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),ne}(),W))||F),xe,ut,wt,Bt=(xe=Object(z.injectable)(),xe(ut=(wt=function(){function ne(){X()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Xe()(ne,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}}]),ne}(),wt))||ut),Ze=o("RM4u"),Rt=o.n(Ze),lr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Ur=lr,Gr,cr,Br;function wn(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function fn(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?wn(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):wn(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var tr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},rn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},dn=(Gr=Object(z.injectable)(),Gr(cr=(Br=function(){function ne(){X()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return Xe()(ne,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return Ur[N]}},{key:"setSceneConfig",value:function(N,G){this.sceneConfigCache[N]=fn(fn({},tr),G)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,G,Ae){this.layerConfigCache[G]=fn({},Rt()({},this.sceneConfigCache[N],rn,Ae))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),Br))||cr),En=o("oH/p"),bn=o.n(En),gn=o("jZ0V"),Mn=o.n(gn),Ga=o("DXzO"),ga=Math.PI/180,Ma=512,Ia=4003e4;function Wi(ne){var se=ne.latitude,N=se===void 0?0:se,G=ne.zoom,Ae=G===void 0?0:G,ct=ne.scale,Yt=ne.highPrecision,sr=Yt===void 0?!1:Yt,or=ne.flipY,Dr=or===void 0?!1:or;ct=ct!==void 0?ct:Math.pow(2,Ae);var sn={},Hn=Ma*ct,ea=Math.cos(N*ga),la=Hn/360,ti=la/ea,ja=Hn/Ia/ea;if(sn.pixelsPerMeter=[ja,-ja,ja],sn.metersPerPixel=[1/ja,-1/ja,1/ja],sn.pixelsPerDegree=[la,-ti,ja],sn.degreesPerPixel=[1/la,-1/ti,1/ja],sr){var _i=ga*Math.tan(N*ga)/ea,Qa=la*_i/2,Vi=Hn/Ia*_i,Co=Vi/ti*ja;sn.pixelsPerDegree2=[0,-Qa,Vi],sn.pixelsPerMeter2=[Co,0,Co],Dr&&(sn.pixelsPerDegree2[1]=-sn.pixelsPerDegree2[1],sn.pixelsPerMeter2[1]=-sn.pixelsPerMeter2[1])}return Dr&&(sn.pixelsPerMeter[1]=-sn.pixelsPerMeter[1],sn.metersPerPixel[1]=-sn.metersPerPixel[1],sn.pixelsPerDegree[1]=-sn.pixelsPerDegree[1],sn.degreesPerPixel[1]=-sn.degreesPerPixel[1]),sn}var da=o("8Mwt"),vi,ya,ba,ha,wi,is,Xi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Xo=(vi=Object(z.injectable)(),ya=Object(z.inject)(D.a.ICameraService),vi(ba=(ha=(is=function(){function ne(){X()(this,ne),this.needRefresh=!0,bn()(this,"cameraService",wi,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Xe()(ne,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),Ae=this.cameraService.getCenter(),ct=Wi({latitude:Ae[1],zoom:N}),Yt=ct.pixelsPerMeter,sr=ct.pixelsPerDegree;this.viewportCenter=Ae,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Yt,this.pixelsPerDegree=sr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===da.a.LNGLAT||this.coordinateSystem===da.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===da.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ae,N):this.coordinateSystem===da.a.P20_OFFSET&&this.calculateLnglatOffset(Ae,N,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,G,Ae,ct){var Yt=Wi({latitude:N[1],zoom:G,scale:Ae,flipY:ct,highPrecision:!0}),sr=Yt.pixelsPerMeter,or=Yt.pixelsPerDegree,Dr=Yt.pixelsPerDegree2,sn=this.cameraService.getViewMatrix(),Hn=this.cameraService.getProjectionMatrix(),ea=ze.b.multiply([],Hn,sn),la=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,G));this.viewportCenterProjection=ze.e.transformMat4([],[la[0],la[1],0,1],ea),sn=this.cameraService.getViewMatrixUncentered()||sn,ea=ze.b.multiply([],Hn,sn),ea=ze.b.multiply([],ea,Xi),this.cameraService.setViewProjectionMatrix(ea),this.pixelsPerMeter=sr,this.pixelsPerDegree=or,this.pixelsPerDegree2=Dr}}]),ne}(),is),wi=Mn()(ha.prototype,"cameraService",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha))||ba),Du=o("VGra"),Ha=o.n(Du),Oi=o("hTab"),Jo=o.n(Oi),ui=o("4bLW"),Yi,Oo,Za,oo,so,bu,Qo,Xl;function js(ne){var se=ho();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ho(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Vt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Le=(Yi=Object(z.injectable)(),Oo=Object(z.inject)(D.a.IMapService),Za=Object(z.inject)(D.a.ILogService),Yi(oo=(so=(Xl=function(ne){ce()(N,ne);var se=js(N);function N(){var G;X()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Yt=0;Yt<Ae;Yt++)ct[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ct)),bn()(G,"mapService",bu,Ha()(G)),bn()(G,"logger",Qo,Ha()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(sr){var or=G.interactionEvent(sr);or.type=Vt[or.type],G.emit(ui.a.Drag,or)},G.onHammer=function(sr){sr.srcEvent.stopPropagation();var or=G.interactionEvent(sr);G.emit(ui.a.Hover,or)},G.onTouch=function(sr){var or=sr.touches[0];G.onHover({x:or.pageX,y:or.pageY,type:"touch"})},G.onHover=function(sr){var or=sr.clientX,Dr=sr.clientY,sn=or,Hn=Dr,ea=sr.type,la=G.mapService.getMapContainer();if(la){var ti=la.getBoundingClientRect(),ja=ti.top,_i=ti.left;sn=sn-_i-la.clientLeft,Hn=Hn-ja-la.clientTop}var Qa=G.mapService.containerToLngLat([sn,Hn]);if(ea==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(sn,Hn,Qa);return}if(ea==="touch"){G.isDoubleTap(sn,Hn,Qa);return}ea!=="click"&&ea!=="dblclick"&&G.emit(ui.a.Hover,{x:sn,y:Hn,lngLat:Qa,type:ea,target:sr})},G}return Xe()(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ui.a.Hover)}},{key:"triggerHover",value:function(Ae){var ct=Ae.x,Yt=Ae.y;this.emit(ui.a.Hover,{x:ct,y:Yt})}},{key:"triggerSelect",value:function(Ae){this.emit(ui.a.Select,{featureId:Ae})}},{key:"triggerActive",value:function(Ae){this.emit(ui.a.Active,{featureId:Ae})}},{key:"addEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();if(Ae){var ct=new Jo.a.Manager(Ae);ct.add(new Jo.a.Tap({event:"dblclick",taps:2})),ct.add(new Jo.a.Tap({event:"click"})),ct.add(new Jo.a.Pan({threshold:0,pointers:0})),ct.add(new Jo.a.Press({})),ct.on("dblclick click",this.onHammer),ct.on("panstart panmove panend pancancel",this.onDrag),Ae.addEventListener("mousemove",this.onHover),Ae.addEventListener("mousedown",this.onHover),Ae.addEventListener("mouseup",this.onHover),Ae.addEventListener("contextmenu",this.onHover),this.hammertime=ct,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ae=this.mapService.getMapContainer();Ae&&(Ae.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ae.removeEventListener("mousedown",this.onHover),Ae.removeEventListener("mouseup",this.onHover),Ae.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ae){var ct=Ae.type,Yt=Ae.pointerType,sr,or;Yt==="touch"?(or=Math.floor(Ae.pointers[0].clientY),sr=Math.floor(Ae.pointers[0].clientX)):(or=Math.floor(Ae.srcEvent.y),sr=Math.floor(Ae.srcEvent.x));var Dr=this.mapService.getMapContainer();if(Dr){var sn=Dr.getBoundingClientRect(),Hn=sn.top,ea=sn.left;sr-=ea,or-=Hn}var la=this.mapService.containerToLngLat([sr,or]);return{x:sr,y:or,lngLat:la,type:ct,target:Ae.srcEvent}}},{key:"isDoubleTap",value:function(Ae,ct,Yt){var sr=this,or=new Date().getTime(),Dr="click";or-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ae)<10&&Math.abs(this.lastClickXY[1]-ct)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Dr="dblclick",this.emit(ui.a.Hover,{x:Ae,y:ct,lngLat:Yt,type:Dr})):(this.lastClickTime=or,this.lastClickXY=[Ae,ct],this.clickTimer=setTimeout(function(){Dr="click",sr.emit(ui.a.Hover,{x:Ae,y:ct,lngLat:Yt,type:Dr})},400))}}]),N}(Y.a),Xl),bu=Mn()(so.prototype,"mapService",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Mn()(so.prototype,"logger",[Za],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),Dt=o("ylX1"),vr=o.n(Dt),en=o("PByh"),_n=o.n(en),Gn=o("Z+lO"),Mi,po,mo,Mo,Nu,Ol,_s,pc,xu,Po,ku,To;function Fi(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function Ys(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Fi(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Fi(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var Ks=(Mi=Object(z.injectable)(),po=Object(z.inject)(D.a.IRendererService),mo=Object(z.inject)(D.a.IGlobalConfigService),Mo=Object(z.inject)(D.a.IInteractionService),Nu=Object(z.inject)(D.a.ILayerService),Mi(Ol=(_s=(To=function(){function ne(){var se=this;X()(this,ne),bn()(this,"rendererService",pc,this),bn()(this,"configService",xu,this),bn()(this,"interactionService",Po,this),bn()(this,"layerService",ku,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(N,G){var Ae,ct=G.x,Yt=G.y,sr=G.lngLat,or=G.type,Dr=G.target,sn=!1,Hn=se.rendererService,ea=Hn.getViewportSize,la=Hn.readPixels,ti=Hn.getContainer,ja=ti().getBoundingClientRect(),_i=ja.width,Qa=ja.height;_i*=window.devicePixelRatio,Qa*=window.devicePixelRatio;var Vi=N.getLayerConfig(),Co=Vi.enableHighlight,yo=Vi.enableSelect,Zi=ct*window.devicePixelRatio,jo=Yt*window.devicePixelRatio;if(Zi>_i-1*window.devicePixelRatio||Zi<0||jo>Qa-1*window.devicePixelRatio||jo<0)return!1;var qa;if(qa=la({x:Math.floor(Zi/se.pickBufferScale),y:Math.floor((Qa-(Yt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),qa[0]!==0||qa[1]!==0||qa[2]!==0){var lo=Object(pe.k)(qa),iu=N.getSource().getFeatureById(lo);lo!==N.getCurrentPickId()&&or==="mousemove"&&(or="mouseenter");var Ti={x:ct,y:Yt,type:or,lngLat:sr,featureId:lo,feature:iu,target:Dr};iu&&(sn=!0,N.setCurrentPickId(lo),se.triggerHoverOnLayer(N,Ti))}else{var ki={x:ct,y:Yt,lngLat:sr,type:N.getCurrentPickId()!==null&&or==="mousemove"?"mouseout":"un"+or,featureId:null,target:Dr,feature:null};se.triggerHoverOnLayer(N,Ys(Ys({},ki),{},{type:"unpick"})),se.triggerHoverOnLayer(N,ki),N.setCurrentPickId(null)}if(Co&&se.highlightPickedFeature(N,qa),yo&&or==="click"&&((Ae=qa)===null||Ae===void 0?void 0:Ae.toString())!==[0,0,0,0].toString()){var Ea=Object(pe.k)(qa);N.getCurrentSelectedId()===null||Ea!==N.getCurrentSelectedId()?(se.selectFeature(N,qa),N.setCurrentSelectedId(Ea)):(se.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return sn}}return Xe()(ne,[{key:"init",value:function(N){var G=this.rendererService,Ae=G.createTexture2D,ct=G.createFramebuffer,Yt=G.getViewportSize,sr=G.getContainer,or=sr().getBoundingClientRect(),Dr=or.width,sn=or.height;Dr*=window.devicePixelRatio,sn*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=ct({color:Ae({width:Math.round(Dr/this.pickBufferScale),height:Math.round(sn/this.pickBufferScale),wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ui.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=_n()(vr.a.mark(function G(Ae){return vr.a.wrap(function(Yt){for(;;)switch(Yt.prev=Yt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Yt.next=2;break}return Yt.abrupt("return");case 2:return this.alreadyInPicking=!0,Yt.next=5,this.pickingLayers(Ae);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Yt.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"pickingLayers",value:function(){var se=_n()(vr.a.mark(function G(Ae){var ct=this,Yt,sr,or,Dr,sn,Hn,ea,la;return vr.a.wrap(function(ja){for(;;)switch(ja.prev=ja.next){case 0:Yt=this.rendererService,sr=Yt.getViewportSize,or=Yt.useFramebuffer,Dr=Yt.clear,sn=Yt.getContainer,Hn=sn().getBoundingClientRect(),ea=Hn.width,la=Hn.height,ea*=window.devicePixelRatio,la*=window.devicePixelRatio,(this.width!==ea||this.height!==la)&&(this.pickingFBO.resize({width:Math.round(ea/this.pickBufferScale),height:Math.round(la/this.pickBufferScale)}),this.width=ea,this.height=la),or(this.pickingFBO,function(){var _i=ct.layerService.getLayers();_i.filter(function(Qa){return Qa.needPick(Ae.type)}).reverse().some(function(Qa){Dr({framebuffer:ct.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Qa.hooks.beforePickingEncode.call(),Qa.renderModels(),Qa.hooks.afterPickingEncode.call();var Vi=ct.pickFromPickingFBO(Qa,Ae);return Vi&&!Qa.getLayerConfig().enablePropagation})});case 6:case"end":return ja.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"triggerHoverOnLayer",value:function(N,G){N.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(N,G){var Ae=xt()(G,3),ct=Ae[0],Yt=Ae[1],sr=Ae[2];N.hooks.beforeHighlight.call([ct,Yt,sr])}},{key:"selectFeature",value:function(N,G){var Ae=xt()(G,3),ct=Ae[0],Yt=Ae[1],sr=Ae[2];N.hooks.beforeSelect.call([ct,Yt,sr])}}]),ne}(),To),pc=Mn()(_s.prototype,"rendererService",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu=Mn()(_s.prototype,"configService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Po=Mn()(_s.prototype,"interactionService",[Mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ku=Mn()(_s.prototype,"layerService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_s))||Ol),zs=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;X()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return Xe()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();N=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=N}return N}}]),ne}(),Ii,Gi,Ts,ml,$u,It,fr,Pr,Wn=(Ii=Object(z.injectable)(),Gi=Object(z.inject)(D.a.IRendererService),Ts=Object(z.inject)(D.a.IGlobalConfigService),Ii(ml=($u=(Pr=function(){function ne(){X()(this,ne),this.clock=new zs,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,bn()(this,"renderService",It,this),bn()(this,"configService",fr,this)}return Xe()(ne,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(G){return G.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(G){return G.name===N})}},{key:"remove",value:function(N){var G=this.layers.indexOf(N);G>-1&&this.layers.splice(G,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(N){return N.inited}).filter(function(N){return N.isVisible()}).forEach(function(N){N.hooks.beforeRenderData.call(),N.hooks.beforeRender.call(),N.render(),N.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,G){return N.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Pr),It=Mn()($u.prototype,"renderService",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Mn()($u.prototype,"configService",[Ts],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$u))||ml),Ya=o("37+z"),xi=o.n(Ya),Ki=o("h9B+"),Ka=o.n(Ki),Di=o("5MNg"),Yo=o.n(Di),Ps=function(){function ne(se){var N=this;X()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var Ae;return((Ae=N.scale)===null||Ae===void 0?void 0:Ae.defaultValues)||[]}return G.map(function(ct,Yt){var sr,or=(sr=N.scale)===null||sr===void 0?void 0:sr.scalers[Yt].func,Dr=or(ct);return Dr})},this.setProps(se)}return Xe()(ne,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var Ae,ct=(Ae=this.scale)===null||Ae===void 0?void 0:Ae.callback.apply(Ae,Ka()(N));if(!Yo()(ct))return[ct]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),gi,Ml,$s,Ss,vl,cu,Eu;function fu(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function ju(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?fu(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):fu(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Js(ne){return new Promise(function(se){return setTimeout(se,ne)})}var Mc=(gi={},re()(gi,Gn.a.FLOAT,4),re()(gi,Gn.a.UNSIGNED_BYTE,1),re()(gi,Gn.a.UNSIGNED_SHORT,2),gi),hf=(Ml=Object(z.injectable)(),$s=Object(z.inject)(D.a.IRendererService),Ml(Ss=(vl=(Eu=function(){function ne(){X()(this,ne),this.attributesAndIndices=void 0,bn()(this,"rendererService",cu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Xe()(ne,[{key:"registerStyleAttribute",value:function(N){var G=this.getLayerStyleAttribute(N.name||"");return G?G.setProps(N):(G=new Ps(N),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(N,G,Ae){var ct=this.getLayerStyleAttribute(N);ct||(ct=this.registerStyleAttribute(ju(ju({},G),{},{name:N})));var Yt=G.scale;Yt&&ct&&(ct.scale=Yt,ct.needRescale=!0,ct.needRemapping=!0,ct.needRegenerateVertices=!0,Ae&&Ae.featureRange&&(ct.featureRange=Ae.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(G){return G.name===N})}},{key:"getLayerAttributeScale",value:function(N){var G,Ae=this.getLayerStyleAttribute(N),ct=Ae==null||((G=Ae.scale)===null||G===void 0)?void 0:G.scalers;return ct&&ct[0]?ct[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ct=arguments.length>3?arguments[3]:void 0,Yt=this.attributes.find(function(yo){return yo.name===N});if(Yt&&Yt.descriptor){var sr=Yt.descriptor,or=sr.update,Dr=sr.buffer,sn=sr.size,Hn=sn===void 0?0:sn,ea=Mc[Dr.type||Gn.a.FLOAT];if(or){var la=this.featureLayout,ti=la.elements,ja=la.sizePerElement,_i=ti.slice(Ae,ct);if(!_i.length)return;var Qa=_i[0].offset,Vi=Qa*Hn*ea,Co=_i.map(function(yo,Zi){for(var jo=yo.featureIdx,qa=yo.vertices,lo=yo.normals,iu=qa.length/ja,Ti=[],ki=0;ki<iu;ki++){var Ea=lo?lo.slice(ki*3,ki*3+3):[];Ti.push.apply(Ti,Ka()(or(G[jo],jo,qa.slice(ki*ja,ki*ja+ja),Zi,Ea)))}return Ti}).reduce(function(yo,Zi){return yo.push.apply(yo,Ka()(Zi)),yo},[]);Yt.vertexAttribute.updateBuffer({data:Co,offset:Vi})}}}},{key:"createAttributesAndIndices",value:function(N,G){var Ae=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ct=this.attributes.map(function(Qa){return Qa.resetDescriptor(),Qa.descriptor}),Yt=0,sr=[],or=[],Dr=[],sn=3;N.forEach(function(Qa,Vi){var Co=Ae.triangulation(Qa),yo=Co.indices,Zi=Co.vertices,jo=Co.normals,qa=Co.size;yo.forEach(function(ki){or.push(ki+Yt)}),sn=qa;var lo=Zi.length/qa;Ae.featureLayout.sizePerElement=sn,Ae.featureLayout.elements.push({featureIdx:Vi,vertices:Zi,normals:jo,offset:Yt}),Yt+=lo;for(var iu=function(Ea){var wo=(jo==null?void 0:jo.slice(Ea*3,Ea*3+3))||[],cc=Zi.slice(Ea*qa,Ea*qa+qa);ct.forEach(function(Nf,oh){if(Nf&&Nf.update){var kf;(kf=Nf.buffer.data).push.apply(kf,Ka()(Nf.update(Qa,Vi,cc,Ea,wo)))}})},Ti=0;Ti<lo;Ti++)iu(Ti)});var Hn=this.rendererService,ea=Hn.createAttribute,la=Hn.createBuffer,ti=Hn.createElements,ja={};ct.forEach(function(Qa,Vi){if(Qa){var Co=Qa.buffer,yo=Qa.update,Zi=Qa.name,jo=xi()(Qa,["buffer","update","name"]),qa=ea(ju({buffer:la(Co)},jo));ja[Qa.name||""]=qa,Ae.attributes[Vi].vertexAttribute=qa}});var _i=ti({data:or,type:Gn.a.UNSIGNED_INT,count:or.length});return this.attributesAndIndices={attributes:ja,elements:_i},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(N=this.attributesAndIndices)===null||N===void 0||N.elements.destroy(),this.attributes=[]}}]),ne}(),Eu),cu=Mn()(vl.prototype,"rendererService",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl))||Ss),pi=o("PoO7"),Pc=o("TAnc"),mc=o("KPh1"),$c=o("Dk3c"),gl=o("lO9p"),Jc=o("4wWY"),$i=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",_u=Object(Jc.a)();function yl(ne){try{var se=window[ne],N="__storage_test__";return se.setItem(N,N),se.removeItem(N),se}catch(G){return null}}var os=function(){function ne(se,N){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object($c.a)(this,ne),this.storage=yl(G),this.id=se,this.config={},Object.assign(this.config,N),this._loadConfiguration()}return Object(gl.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(N){return this.config={},this.updateConfiguration(N)}},{key:"updateConfiguration",value:function(N){if(Object.assign(this.config,N),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var N={};if(this.storage){var G=this.storage.getItem(this.id);N=G?JSON.parse(G):{}}return Object.assign(this.config,N),this}}]),ne}();function Lc(ne){var se;return ne<10?se="".concat(ne.toFixed(2),"ms"):ne<100?se="".concat(ne.toFixed(1),"ms"):ne<1e3?se="".concat(ne.toFixed(0),"ms"):se="".concat((ne/1e3).toFixed(2),"s"),se}function vc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-ne.length,0);return"".concat(" ".repeat(N)).concat(ne)}function Pl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-ne.length,0);return"".concat(ne).concat(" ".repeat(N))}function Ju(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=1e-16,G=se.isInteger,Ae=G===void 0?!1:G;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return Rc(ne,se);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<N)return Ae?"0":"0.";if(Ae)return ne.toFixed(0);if(Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var ct=ne.toPrecision(2),Yt=ct.indexOf(".0");return Yt===ct.length-2?ct.slice(0,-1):ct}function Rc(ne,se){for(var N=se.maxElts,G=N===void 0?16:N,Ae=se.size,ct=Ae===void 0?1:Ae,Yt="[",sr=0;sr<ne.length&&sr<G;++sr)sr>0&&(Yt+=",".concat(sr%ct===0?" ":"")),Yt+=Ju(ne[sr],se);var or=ne.length>G?"...":"]";return"".concat(Yt).concat(or)}function hu(ne,se,N){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ae=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>G&&(N=Math.min(N,G/ne.width));var ct=ne.width*N,Yt=ne.height*N,sr=["font-size:1px;","padding:".concat(Math.floor(Yt/2),"px ").concat(Math.floor(ct/2),"px;"),"line-height:".concat(Yt,"px;"),"background:url(".concat(Ae,");"),"background-size:".concat(ct,"px ").concat(Yt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),sr]}var Tu={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Qc(ne){return typeof ne=="string"?Tu[ne.toUpperCase()]||Tu.WHITE:ne}function Yl(ne,se,N){return!_u&&typeof ne=="string"&&(se&&(se=Qc(se),ne="[".concat(se,"m").concat(ne,"[39m")),N&&(se=Qc(N),ne="[".concat(N+10,"m").concat(ne,"[49m"))),ne}function Si(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=qc(ne))){var se=0,N=function(){};return{s:N,n:function(){return se>=ne.length?{done:!0}:{done:!1,value:ne[se++]}},e:function(or){throw or},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,Ae=!0,ct=!1,Yt;return{s:function(){G=ne[Symbol.iterator]()},n:function(){var or=G.next();return Ae=or.done,or},e:function(or){ct=!0,Yt=or},f:function(){try{!Ae&&G.return!=null&&G.return()}finally{if(ct)throw Yt}}}}function qc(ne,se){if(!ne)return;if(typeof ne=="string")return df(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(N);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return df(ne,se)}function df(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}function Kl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],N=Object.getPrototypeOf(ne),G=Object.getOwnPropertyNames(N),Ae=Si(G),ct;try{var Yt=function(){var or=ct.value;typeof ne[or]=="function"&&(se.find(function(Dr){return or===Dr})||(ne[or]=ne[or].bind(ne)))};for(Ae.s();!(ct=Ae.n()).done;)Yt()}catch(sr){Ae.e(sr)}finally{Ae.f()}}function Ic(ne,se){if(!ne)throw new Error(se||"Assertion failed")}var $l=o("o+P9");function Qu(){var ne;if(_u&&$l.b.performance)ne=$l.b.performance.now();else if($l.a.hrtime){var se=$l.a.hrtime();ne=se[0]*1e3+se[1]/1e6}else ne=Date.now();return ne}var zu={debug:_u&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},bl={enabled:!0,level:0};function Lo(){}var Jl={},Ll={once:!0};function Rl(ne){for(var se in ne)for(var N in ne[se])return N||"untitled";return"empty"}var Dc=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=se.id;Object($c.a)(this,ne),this.id=N,this.VERSION=$i,this._startTs=Qu(),this._deltaTs=Qu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new os("__probe-".concat(this.id,"__"),bl),this.userData={},this.timeStamp("".concat(this.id," started")),Kl(this),Object.seal(this)}return Object(gl.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Qu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Qu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:N}),this}},{key:"setLevel",value:function(N){return this._storage.updateConfiguration({level:N}),this}},{key:"assert",value:function(N,G){Ic(N,G)}},{key:"warn",value:function(N){return this._getLogFunction(0,N,zu.warn,arguments,Ll)}},{key:"error",value:function(N){return this._getLogFunction(0,N,zu.error,arguments)}},{key:"deprecated",value:function(N,G){return this.warn("`".concat(N,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(N,G){return this.error("`".concat(N,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(N,G){return this._getLogFunction(N,G,zu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(N,G){return this._getLogFunction(N,G,zu.debug,arguments)}},{key:"info",value:function(N,G){return this._getLogFunction(N,G,console.info,arguments)}},{key:"once",value:function(N,G){return this._getLogFunction(N,G,zu.debug||zu.info,arguments,Ll)}},{key:"table",value:function(N,G,Ae){return G?this._getLogFunction(N,G,console.table||Lo,Ae&&[Ae],{tag:Rl(G)}):Lo}},{key:"image",value:function(N){var G=N.logLevel,Ae=N.priority,ct=N.image,Yt=N.message,sr=Yt===void 0?"":Yt,or=N.scale,Dr=or===void 0?1:or;return this._shouldLog(G||Ae)?_u?mf({image:ct,message:sr,scale:Dr}):pf({image:ct,message:sr,scale:Dr}):Lo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(N){return this._storage.config[N]}},{key:"set",value:function(N,G){this._storage.updateConfiguration(Object(mc.a)({},N,G))}},{key:"time",value:function(N,G){return this._getLogFunction(N,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(N,G){return this._getLogFunction(N,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(N,G){return this._getLogFunction(N,G,console.timeStamp||Lo)}},{key:"group",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ae=Qs({logLevel:N,message:G,opts:Ae});var ct=Ae,Yt=ct.collapsed;return Ae.method=(Yt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ae)}},{key:"groupCollapsed",value:function(N,G){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(N,G,Object.assign({},Ae,{collapsed:!0}))}},{key:"groupEnd",value:function(N){return this._getLogFunction(N,"",console.groupEnd||Lo)}},{key:"withGroup",value:function(N,G,Ae){this.group(N,G)();try{Ae()}finally{this.groupEnd(N)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(N){return this.isEnabled()&&this.getLevel()>=xl(N)}},{key:"_getLogFunction",value:function(N,G,Ae){var ct=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Yt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(N)){var sr;Yt=Qs({logLevel:N,message:G,args:ct,opts:Yt}),Ae=Ae||Yt.method,Ic(Ae),Yt.total=this.getTotal(),Yt.delta=this.getDelta(),this._deltaTs=Qu();var or=Yt.tag||Yt.message;if(Yt.once)if(!Jl[or])Jl[or]=Qu();else return Lo;return G=eo(this.id,Yt.message,Yt),(sr=Ae).bind.apply(sr,[console,G].concat(Object(Pc.a)(Yt.args)))}return Lo}},{key:"level",set:function(N){this.setLevel(N)},get:function(){return this.getLevel()}},{key:"priority",set:function(N){this.level=N},get:function(){return this.level}}]),ne}();Dc.VERSION=$i;function xl(ne){if(!ne)return 0;var se;switch(Object(pi.a)(ne)){case"number":se=ne;break;case"object":se=ne.logLevel||ne.priority||0;break;default:return 0}return Ic(Number.isFinite(se)&&se>=0),se}function Qs(ne){var se=ne.logLevel,N=ne.message;ne.logLevel=xl(se);for(var G=ne.args?Array.from(ne.args):[];G.length&&G.shift()!==N;);ne.args=G;switch(Object(pi.a)(se)){case"string":case"function":N!==void 0&&G.unshift(N),ne.message=se;break;case"object":Object.assign(ne,se);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var Ae=Object(pi.a)(ne.message);return Ic(Ae==="string"||Ae==="object"),Object.assign(ne,ne.opts)}function eo(ne,se,N){if(typeof se=="string"){var G=N.time?vc(Lc(N.total)):"";se=N.time?"".concat(ne,": ").concat(G,"  ").concat(se):"".concat(ne,": ").concat(se),se=Yl(se,N.color,N.background)}return se}function pf(ne){var se=ne.image,N=ne.message,G=N===void 0?"":N,Ae=ne.scale,ct=Ae===void 0?1:Ae,Yt=null;try{Yt=o(2)}catch(sr){}return Yt?function(){return Yt(se,{fit:"box",width:"".concat(Math.round(80*ct),"%")}).then(function(sr){return console.log(sr)})}:Lo}function mf(ne){var se=ne.image,N=ne.message,G=N===void 0?"":N,Ae=ne.scale,ct=Ae===void 0?1:Ae;if(typeof se=="string"){var Yt=new Image;return Yt.onload=function(){var sn,Hn=hu(Yt,G,ct);(sn=console).log.apply(sn,Object(Pc.a)(Hn))},Yt.src=se,Lo}var sr=se.nodeName||"";if(sr.toLowerCase()==="img"){var or;return(or=console).log.apply(or,Object(Pc.a)(hu(se,G,ct))),Lo}if(sr.toLowerCase()==="canvas"){var Dr=new Image;return Dr.onload=function(){var sn;return(sn=console).log.apply(sn,Object(Pc.a)(hu(Dr,G,ct)))},Dr.src=se.toDataURL(),Lo}return Lo}var El,Ql,qu=new Dc({id:"L7"}).enable(!1);qu.priority=5;var Il=(El=Object(z.injectable)(),El(Ql=function(){function ne(){X()(this,ne)}return Xe()(ne,[{key:"error",value:function(N){qu.error(N)()}},{key:"warn",value:function(N){qu.probe(1,N)()}},{key:"info",value:function(N){qu.info(3,N)()}},{key:"debug",value:function(N){qu.probe(4,N)()}}]),ne}())||Ql),gc=o("Tj1F"),yc=o("PFor"),el=o.n(yc),ef=window.document.documentElement.style,tl=0;function qs(ne){var se=ne;if(typeof ne=="string"&&(se=document.getElementById(ne)),se){var N=document.createElement("div");return N.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,N.id="l7-scene-".concat(tl++),N.classList.add("l7-scene"),se.appendChild(N),N}return null}var _l,ql,Nc,tf,Fs,vf,rl,Pi,nl,Fu,fi,kn,Li,Ls,Dl,Uu,al,gf,ss,Tl,il,ol,Ui,As,Nl,to,Rn,Us,ni,kl,du,Bs,sl,tn,bc,us;function ro(ne){var se=qo();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Rs=(_l=Object(z.injectable)(),ql=Object(z.inject)(D.a.SceneID),Nc=Object(z.inject)(D.a.IIconService),tf=Object(z.inject)(D.a.IFontService),Fs=Object(z.inject)(D.a.IControlService),vf=Object(z.inject)(D.a.ILogService),rl=Object(z.inject)(D.a.IGlobalConfigService),Pi=Object(z.inject)(D.a.IMapService),nl=Object(z.inject)(D.a.ICoordinateSystemService),Fu=Object(z.inject)(D.a.IRendererService),fi=Object(z.inject)(D.a.ILayerService),kn=Object(z.inject)(D.a.ICameraService),Li=Object(z.inject)(D.a.IInteractionService),Ls=Object(z.inject)(D.a.IPickingService),Dl=Object(z.inject)(D.a.IShaderModuleService),Uu=Object(z.inject)(D.a.IMarkerService),al=Object(z.inject)(D.a.IPopupService),_l(gf=(ss=(us=function(ne){ce()(N,ne);var se=ro(N);function N(){var G;return X()(this,N),G=se.call(this),G.destroyed=!1,G.loaded=!1,bn()(G,"id",Tl,Ha()(G)),bn()(G,"iconService",il,Ha()(G)),bn()(G,"fontService",ol,Ha()(G)),bn()(G,"controlService",Ui,Ha()(G)),bn()(G,"logger",As,Ha()(G)),bn()(G,"configService",Nl,Ha()(G)),bn()(G,"map",to,Ha()(G)),bn()(G,"coordinateSystemService",Rn,Ha()(G)),bn()(G,"rendererService",Us,Ha()(G)),bn()(G,"layerService",ni,Ha()(G)),bn()(G,"cameraService",kl,Ha()(G)),bn()(G,"interactionService",du,Ha()(G)),bn()(G,"pickingService",Bs,Ha()(G)),bn()(G,"shaderModuleService",sl,Ha()(G)),bn()(G,"markerService",tn,Ha()(G)),bn()(G,"popupService",bc,Ha()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),pe.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(Ae){G.cameraService.update(Ae),G.render()},G.hooks={init:new gc.a},G}return Xe()(N,[{key:"init",value:function(Ae){var ct=this;this.configService.setSceneConfig(this.id,Ae),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",_n()(vr.a.mark(function Yt(){return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:return or.next=2,new Promise(function(Dr){ct.map.onCameraChanged(function(sn){ct.cameraService.init(),ct.cameraService.update(sn),Dr()}),ct.map.init()});case 2:ct.map.onCameraChanged(ct.handleMapCameraChanged),ct.map.addMarkerContainer(),ct.markerService.addMarkers(),ct.markerService.addMarkerLayers(),ct.popupService.initPopup(),ct.interactionService.init(),ct.interactionService.on(ui.a.Drag,ct.addSceneEvent.bind(ct)),ct.logger.debug("map ".concat(ct.id," loaded"));case 10:case"end":return or.stop()}},Yt)}))),this.hooks.init.tapPromise("initRenderer",_n()(vr.a.mark(function Yt(){var sr;return vr.a.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(sr=qs(ct.configService.getSceneConfig(ct.id).id||""),ct.$container=sr,!sr){Dr.next=11;break}return ct.canvas=pe.a.create("canvas","",sr),ct.setCanvas(),Dr.next=7,ct.rendererService.init(ct.canvas,ct.configService.getSceneConfig(ct.id));case 7:el()(ct.$container,ct.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ct.handleWindowResized),Dr.next=12;break;case 11:ct.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ct.pickingService.init(ct.id),ct.logger.debug("scene ".concat(ct.id," renderer loaded"));case 14:case"end":return Dr.stop()}},Yt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ae){this.logger.debug("add layer ".concat(Ae.name," to scene ").concat(this.id)),this.layerService.add(Ae),this.render()}},{key:"render",value:function(){var G=_n()(vr.a.mark(function ct(){return vr.a.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(!(this.rendering||this.destroyed)){sr.next=2;break}return sr.abrupt("return");case 2:if(this.rendering=!0,this.inited){sr.next=13;break}return sr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return sr.stop()}},ct,this)}));function Ae(){return G.apply(this,arguments)}return Ae}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ae){var ct,Yt=(ct=this.$container)===null||ct===void 0?void 0:ct.getElementsByTagName("canvas")[0];this.render();var sr=Ae==="jpg"?Yt==null?void 0:Yt.toDataURL("image/jpeg"):Yt==null?void 0:Yt.toDataURL("image/png");return sr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ae=this.$container.parentElement;Ae!==null&&(this.markerContainer=pe.a.create("div","l7-marker-container",Ae))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(yc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ae,ct,Yt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ct=this.$container)===null||ct===void 0?void 0:ct.clientHeight)||300,Dr=this.canvas;Dr&&(Dr.width=sr*Yt,Dr.height=or*Yt,Dr.style.width="".concat(sr,"px"),Dr.style.height="".concat(or,"px")),this.rendererService.viewport({x:0,y:0,width:Yt*sr,height:Yt*or})}},{key:"setCanvas",value:function(){var Ae,ct,Yt=window.devicePixelRatio,sr=((Ae=this.$container)===null||Ae===void 0?void 0:Ae.clientWidth)||400,or=((ct=this.$container)===null||ct===void 0?void 0:ct.clientHeight)||300,Dr=this.canvas;Dr.width=sr*Yt,Dr.height=or*Yt,Dr.style.width="".concat(sr,"px"),Dr.style.height="".concat(or,"px")}},{key:"addSceneEvent",value:function(Ae){this.emit(Ae.type,Ae)}}]),N}(p.EventEmitter),us),Tl=Mn()(ss.prototype,"id",[ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=Mn()(ss.prototype,"iconService",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=Mn()(ss.prototype,"fontService",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui=Mn()(ss.prototype,"controlService",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),As=Mn()(ss.prototype,"logger",[vf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=Mn()(ss.prototype,"configService",[rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Mn()(ss.prototype,"map",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=Mn()(ss.prototype,"coordinateSystemService",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Mn()(ss.prototype,"rendererService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Mn()(ss.prototype,"layerService",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=Mn()(ss.prototype,"cameraService",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=Mn()(ss.prototype,"interactionService",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=Mn()(ss.prototype,"pickingService",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sl=Mn()(ss.prototype,"shaderModuleService",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tn=Mn()(ss.prototype,"markerService",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bc=Mn()(ss.prototype,"popupService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ss))||gf),jl=o("1B40"),kc=o.n(jl);function Vs(ne){var se=0;switch(ne){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var Su=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function zl(ne){var se={};return ne=ne.replace(Su,function(N,G,Ae){var ct=Ae.split(":"),Yt=ct[0].trim(),sr="";ct.length>1&&(sr=ct[1].trim());switch(G){case"bool":sr=sr==="true";break;case"float":case"int":sr=Number(sr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":sr?sr=sr.replace("[","").replace("]","").split(",").reduce(function(or,Dr){return or.push(Number(Dr.trim())),or},[]):sr=new Array(Vs(G)).fill(0);break;default:}return se[Yt]=sr,"uniform ".concat(G," ").concat(Yt,`;
`)}),{content:ne,uniforms:se}}var Fl,rf,jc;function Ro(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function ls(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ro(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ro(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var Pa="#define PI 3.14159265359",eu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Io=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,So=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Sl=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,ul=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,pu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Cs=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,xc=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Jn=/precision\s+(high|low|medium)p\s+float/,jn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Ec=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,cs=(Fl=Object(z.injectable)(),Fl(rf=(jc=function(){function ne(){X()(this,ne),this.moduleCache={},this.rawContentCache={}}return Xe()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Pa,fs:Pa}),this.registerModule("decode",{vs:eu,fs:""}),this.registerModule("projection",{vs:Cs,fs:""}),this.registerModule("project",{vs:pu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:xc}),this.registerModule("lighting",{vs:So,fs:""}),this.registerModule("light",{vs:Io,fs:""}),this.registerModule("picking",{vs:ul,fs:Sl})}},{key:"registerModule",value:function(N,G){if(this.rawContentCache[N])return;var Ae=G.vs,ct=G.fs,Yt=G.uniforms,sr=zl(Ae),or=sr.content,Dr=sr.uniforms,sn=zl(ct),Hn=sn.content,ea=sn.uniforms;this.rawContentCache[N]={fs:Hn,uniforms:ls(ls(ls({},Dr),ea),Yt),vs:or}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var G=this;if(this.moduleCache[N])return this.moduleCache[N];var Ae=this.rawContentCache[N].vs,ct=this.rawContentCache[N].fs,Yt=this.processModule(Ae,[],"vs"),sr=Yt.content,or=Yt.includeList,Dr=this.processModule(ct,[],"fs"),sn=Dr.content,Hn=Dr.includeList,ea=sn,la=kc()(or.concat(Hn).concat(N)).reduce(function(ti,ja){return ls(ls({},ti),G.rawContentCache[ja].uniforms)},{});return Jn.test(sn)||(ea=jn+sn),this.moduleCache[N]={fs:ea.trim(),uniforms:la,vs:sr.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,G,Ae){var ct=this,Yt=N.replace(Ec,function(sr,or){var Dr=or.split(" "),sn=Dr[0].replace(/"/g,"");if(G.indexOf(sn)>-1)return"";var Hn=ct.rawContentCache[sn][Ae];G.push(sn);var ea=ct.processModule(Hn,G,Ae),la=ea.content;return la});return{content:Yt,includeList:G}}}]),ne}(),jc))||rf),Do=o("jr/B"),vo=o.n(Do),ws=o("p14H"),Au,ec,$a,no,ll,mu,cl=(Au=Object(z.injectable)(),ec=Object(z.inject)(D.a.IShaderModuleService),Au($a=(no=(mu=function(){function ne(){X()(this,ne),bn()(this,"shaderModuleService",ll,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Xe()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ws.a.Normal}},{key:"init",value:function(N,G){this.config=G,this.rendererService=N.getContainer().get(D.a.IRendererService),this.cameraService=N.getContainer().get(D.a.ICameraService),this.mapService=N.getContainer().get(D.a.IMapService),this.interactionService=N.getContainer().get(D.a.IInteractionService),this.layerService=N.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(N){}}]),ne}(),mu),ll=Mn()(no.prototype,"shaderModuleService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no))||$a),Cu,Is;function zc(ne){var se=Gs();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Gs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var yf=(Cu=Object(z.injectable)(),Cu(Is=function(ne){ce()(N,ne);var se=zc(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ae,ct){vo()(ot()(N.prototype),"init",this).call(this,Ae,ct)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(cl))||Is),Ul,Bl,_c,fs,Bu,Fc;function Al(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=Vu(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ae=function(){};return{s:Ae,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ct=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ct&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function Vu(ne,se){if(!ne)return;if(typeof ne=="string")return tc(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return tc(ne,se)}function tc(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var Gu=(Ul=Object(z.injectable)(),Bl=Object(z.inject)(D.a.IPostProcessor),Ul(_c=(fs=(Fc=function(){function ne(){X()(this,ne),this.passes=[],bn()(this,"postProcessor",Bu,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Xe()(ne,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=_n()(vr.a.mark(function G(){var Ae,ct,Yt;return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:Ae=Al(this.passes),or.prev=1,Ae.s();case 3:if((ct=Ae.n()).done){or.next=9;break}return Yt=ct.value,or.next=7,Yt.render(this.layer);case 7:or.next=3;break;case 9:or.next=14;break;case 11:or.prev=11,or.t0=or.catch(1),Ae.e(or.t0);case 14:return or.prev=14,Ae.f(),or.finish(14);case 17:this.layer.renderModels();case 18:case"end":return or.stop()}},G,this,[[1,11,14,17]])}));function N(){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){(this.width!==N||this.height!==G)&&(this.width=N,this.height=G)}},{key:"add",value:function(N,G){N.getType()===ws.a.PostProcessing?this.postProcessor.add(N,this.layer,G):(N.init(this.layer,G),this.passes.push(N))}},{key:"insert",value:function(N,G,Ae){N.init(this.layer,G),this.passes.splice(Ae,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),Fc),Bu=Mn()(fs.prototype,"postProcessor",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs))||_c),Ds,nf,rc,nc,ac,s;function a(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function n(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?a(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):a(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function l(ne){var se=v();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function v(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var O=(Ds=Object(z.injectable)(),nf=Object(z.inject)(D.a.ILogService),Ds(rc=(nc=(s=function(ne){ce()(N,ne);var se=l(N);function N(){var G;X()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Yt=0;Yt<Ae;Yt++)ct[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ct)),bn()(G,"logger",ac,Ha()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(sr){var or=sr.x,Dr=sr.y,sn=sr.lngLat,Hn=sr.type;if(!G.layer.isVisible()||!G.layer.needPick(Hn))return;var ea=G.rendererService,la=ea.getViewportSize,ti=ea.readPixels,ja=ea.useFramebuffer,_i=la(),Qa=_i.width,Vi=_i.height,Co=G.layer.getLayerConfig(),yo=Co.enableHighlight,Zi=Co.enableSelect,jo=or*window.devicePixelRatio,qa=Dr*window.devicePixelRatio;if(jo>Qa||jo<0||qa>Vi||qa<0)return;var lo;ja(G.pickingFBO,function(){var iu;if(lo=ti({x:Math.round(jo),y:Math.round(Vi-(Dr+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),lo[0]!==0||lo[1]!==0||lo[2]!==0){G.logger.debug("picked");var Ti=Object(pe.k)(lo),ki=G.layer.getSource().getFeatureById(Ti),Ea={x:or,y:Dr,type:Hn,lngLat:sn,featureId:Ti,feature:ki};ki&&(G.layer.setCurrentPickId(Ti),G.triggerHoverOnLayer(Ea))}else{var wo={x:or,y:Dr,lngLat:sn,type:G.layer.getCurrentPickId()===null?"un"+Hn:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(n(n({},wo),{},{type:"unpick"})),G.triggerHoverOnLayer(wo),G.layer.setCurrentPickId(null)}yo&&G.highlightPickedFeature(lo),Zi&&Hn==="click"&&((iu=lo)===null||iu===void 0?void 0:iu.toString())!==[0,0,0,0].toString()&&G.selectFeature(lo)})},G}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ae,ct){vo()(ot()(N.prototype),"init",this).call(this,Ae,ct),this.layer=Ae;var Yt=this.rendererService,sr=Yt.createTexture2D,or=Yt.createFramebuffer,Dr=Yt.getViewportSize,sn=Dr(),Hn=sn.width,ea=sn.height;this.pickingFBO=or({color:sr({width:Hn,height:ea,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ui.a.Hover,this.pickFromPickingFBO),this.interactionService.on(ui.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ui.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ae){var ct=this;if(this.alreadyInRendering)return;var Yt=this.rendererService,sr=Yt.getViewportSize,or=Yt.useFramebuffer,Dr=Yt.clear,sn=sr(),Hn=sn.width,ea=sn.height;this.alreadyInRendering=!0,(this.width!==Hn||this.height!==ea)&&(this.pickingFBO.resize({width:Hn,height:ea}),this.width=Hn,this.height=ea),or(this.pickingFBO,function(){Dr({framebuffer:ct.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var la=ct.layer.multiPassRenderer.getRenderFlag();ct.layer.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforePickingEncode.call(),Ae.render(),Ae.hooks.afterPickingEncode.call(),ct.layer.multiPassRenderer.setRenderFlag(la),ct.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Ae){this.layer.emit(Ae.type,Ae)}},{key:"highlightPickedFeature",value:function(Ae){var ct=xt()(Ae,3),Yt=ct[0],sr=ct[1],or=ct[2];this.layer.hooks.beforeHighlight.call([Yt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ae){var ct=xt()(Ae,3),Yt=ct[0],sr=ct[1],or=ct[2];this.layer.hooks.beforeSelect.call([Yt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ae){var ct=Ae.featureId,Yt=Object(pe.l)(ct);this.selectFeature(new Uint8Array(Yt))}},{key:"highlightFeatureHandle",value:function(Ae){var ct=Ae.featureId,Yt=Object(pe.l)(ct);this.highlightPickedFeature(new Uint8Array(Yt))}}]),N}(cl),s),ac=Mn()(nc.prototype,"logger",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc))||rc),L=o("ZaRd"),j,ue;function Ee(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function $e(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ee(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ee(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function rt(ne){var se=at();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function at(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var zt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Nt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jt=(j=Object(z.injectable)(),j(ue=function(ne){ce()(N,ne);var se=rt(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Nt,fs:zt});var Ae=this.shaderModuleService.getModule("blur-pass"),ct=Ae.vs,Yt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ct,fs:Yt,uniforms:$e($e({},sr),{},{u_ViewportSize:[Dr,sn]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ct={};return Yo()(Ae.blurRadius)||(ct.u_BlurDir=[Ae.blurRadius,0]),ct}}]),N}(L.a))||ue),jt,Gt;function ar(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function nr(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?ar(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):ar(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Rr(ne){var se=gr();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function gr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ar=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Cr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,an=(jt=Object(z.injectable)(),jt(Gt=function(ne){ce()(N,ne);var se=Rr(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Cr,fs:Ar});var Ae=this.shaderModuleService.getModule("blur-pass"),ct=Ae.vs,Yt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ct,fs:Yt,uniforms:nr(nr({},sr),{},{u_ViewportSize:[Dr,sn]})}}},{key:"convertOptionsToUniforms",value:function(Ae){var ct={};return Yo()(Ae.blurRadius)||(ct.u_BlurDir=[0,Ae.blurRadius]),ct}}]),N}(L.a))||Gt),Yr,vn;function Pn(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function qn(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Pn(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Pn(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function sa(ne){var se=Aa();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function Aa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Wa=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,Tn=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ua=(Yr=Object(z.injectable)(),Yr(vn=function(ne){ce()(N,ne);var se=sa(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Tn,fs:Wa});var Ae=this.shaderModuleService.getModule("colorhalftone-pass"),ct=Ae.vs,Yt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ct,fs:Yt,uniforms:qn(qn({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||vn),xa,Zn;function Ca(ne){var se=ia();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ia(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var La=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Fa=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Hi=(xa=Object(z.injectable)(),xa(Zn=function(ne){ce()(N,ne);var se=Ca(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Fa,fs:La}),this.shaderModuleService.getModule("copy-pass")}}]),N}(L.a))||Zn),Ai,Ni;function Ei(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function Bi(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ei(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ei(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function es(ne){var se=ts();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ts(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var vu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,wu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hs=(Ai=Object(z.injectable)(),Ai(Ni=function(ne){ce()(N,ne);var se=es(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:wu,fs:vu});var Ae=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ct=Ae.vs,Yt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ct,fs:Yt,uniforms:Bi(Bi({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||Ni),Hs,Ou;function ic(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function tu(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?ic(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):ic(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Hu(ne){var se=oc();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function oc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Mu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ds=(Hs=Object(z.injectable)(),Hs(Ou=function(ne){ce()(N,ne);var se=Hu(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Mu,fs:ru});var Ae=this.shaderModuleService.getModule("ink-pass"),ct=Ae.vs,Yt=Ae.fs,sr=Ae.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ct,fs:Yt,uniforms:tu(tu({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||Ou),ao,Zu;function Vl(ne){var se=ps();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var No=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,ko=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ko=(ao=Object(z.injectable)(),ao(Zu=function(ne){ce()(N,ne);var se=Vl(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:ko,fs:No}),this.shaderModuleService.getModule("noise-pass")}}]),N}(L.a))||Zu),Ao,uo;function Ns(ne){var se=nu();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function nu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Gl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Uc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,fl=(Ao=Object(z.injectable)(),Ao(uo=function(ne){ce()(N,ne);var se=Ns(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Gl,fs:Uc}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(L.a))||uo),sc,hl,ks,go,Tc,ms,af,Sf=(sc=Object(z.injectable)(),hl=Object(z.inject)(D.a.IRendererService),ks=Object(z.postConstruct)(),sc(go=(Tc=(af=function(){function ne(){X()(this,ne),bn()(this,"rendererService",ms,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Xe()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=_n()(vr.a.mark(function G(Ae){var ct,Yt;return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:ct=0;case 1:if(!(ct<this.passes.length)){or.next=10;break}return Yt=this.passes[ct],Yt.setRenderToScreen(this.isLastEnabledPass(ct)),or.next=6,Yt.render(Ae);case 6:ct!==this.passes.length-1&&this.swap();case 7:ct++,or.next=1;break;case 10:case"end":return or.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){this.readFBO.resize({width:N,height:G}),this.writeFBO.resize({width:N,height:G})}},{key:"add",value:function(N,G,Ae){N.init(G,Ae),this.passes.push(N)}},{key:"insert",value:function(N,G,Ae,ct){N.init(Ae,ct),this.passes.splice(G,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(G){return G.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var G=N+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),ne}(),af),ms=Mn()(Tc.prototype,"rendererService",[hl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn()(Tc.prototype,"init",[ks],Object.getOwnPropertyDescriptor(Tc.prototype,"init"),Tc.prototype),Tc))||go),Af,Sc;function Wu(ne){var se=bf();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function bf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var of=(Af=Object(z.injectable)(),Af(Sc=function(ne){ce()(N,ne);var se=Wu(N);function N(){return X()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ae,ct){vo()(ot()(N.prototype),"init",this).call(this,Ae,ct)}},{key:"render",value:function(Ae){var ct=this.rendererService,Yt=ct.useFramebuffer,sr=ct.clear;Yt(null,function(){sr({color:[0,0,0,0],depth:1,stencil:0}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)})}}]),N}(cl))||Sc),Cf,Pu,uc,If,Bc,Ac,$f,Jf;function Qf(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ae){return Object.getOwnPropertyDescriptor(ne,Ae).enumerable})),N.push.apply(N,G)}return N}function qf(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Qf(Object(N),!0).forEach(function(G){re()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Qf(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function wf(ne){var se=eh();return function(){var G=ot()(ne),Ae;if(se){var ct=ot()(this).constructor;Ae=Reflect.construct(G,arguments,ct)}else Ae=G.apply(this,arguments);return qe()(this,Ae)}}function eh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Hl=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,sf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,io=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function lc(ne,se){for(var N=0,G=1/se,Ae=ne;Ae>0;)N=N+G*(Ae%se),Ae=Math.floor(Ae/se),G=G/se;return N}var xf=1,Cc=(Cf=Object(z.injectable)(),Pu=Object(z.inject)(D.a.IShaderModuleService),uc=Object(z.inject)(D.a.ILogService),Cf(If=(Bc=(Jf=function(ne){ce()(N,ne);var se=wf(N);function N(){var G;X()(this,N);for(var Ae=arguments.length,ct=new Array(Ae),Yt=0;Yt<Ae;Yt++)ct[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ct)),bn()(G,"shaderModuleService",Ac,Ha()(G)),bn()(G,"logger",$f,Ha()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ae,ct){vo()(ot()(N.prototype),"init",this).call(this,Ae,ct);var Yt=this.rendererService,sr=Yt.createFramebuffer,or=Yt.createTexture2D;this.sampleRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})});for(var Dr=0;Dr<30;Dr++)this.haltonSequence.push([lc(Dr,2),lc(Dr,3)]);this.blendModel=this.createTriangleModel("blend-pass",Hl),this.outputModel=this.createTriangleModel("copy-pass",sf,{blend:{enable:!0,func:{srcRGB:Gn.a.ONE,dstRGB:Gn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Gn.a.ONE,dstAlpha:Gn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Gn.a.FUNC_ADD,alpha:Gn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",sf)}},{key:"render",value:function(Ae){var ct=this,Yt=this.rendererService,sr=Yt.clear,or=Yt.getViewportSize,Dr=Yt.useFramebuffer,sn=or(),Hn=sn.width,ea=sn.height;this.sampleRenderTarget.resize({width:Hn,height:ea}),this.prevRenderTarget.resize({width:Hn,height:ea}),this.outputRenderTarget.resize({width:Hn,height:ea}),this.copyRenderTarget.resize({width:Hn,height:ea}),this.resetFrame(),this.stopAccumulating();var la=Ae.multiPassRenderer.getPostProcessor().getReadFBO();Dr(la,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:la}),Ae.multiPassRenderer.setRenderFlag(!1),Ae.render(),Ae.multiPassRenderer.setRenderFlag(!0)});var ti=function ja(_i){if(!ct.accumulatingId||_i!==ct.accumulatingId)return;ct.isFinished()||(ct.doRender(Ae),requestAnimationFrame(function(){ja(_i)}))};this.accumulatingId=xf++,this.timer=window.setTimeout(function(){ti(ct.accumulatingId)},50)}},{key:"doRender",value:function(Ae){var ct=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Yt=this.rendererService,sr=Yt.clear,or=Yt.getViewportSize,Dr=Yt.useFramebuffer,sn=or(),Hn=sn.width,ea=sn.height,la=Ae.getLayerConfig(),ti=la.jitterScale,ja=ti===void 0?1:ti,_i=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((_i[0]*2-1)/Hn*ja,(_i[1]*2-1)/ea*ja),Ae.multiPassRenderer.setRenderFlag(!1),Ae.hooks.beforeRender.call(),Dr(this.sampleRenderTarget,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ct.sampleRenderTarget}),Ae.render()}),Ae.hooks.afterRender.call(),Ae.multiPassRenderer.setRenderFlag(!0);var Qa=Ae.getLayerConfig();Dr(this.outputRenderTarget,function(){ct.blendModel.draw({uniforms:{u_opacity:Qa.opacity||1,u_MixRatio:ct.frame===0?1:.9,u_Diffuse1:ct.sampleRenderTarget,u_Diffuse2:ct.frame===0?Ae.multiPassRenderer.getPostProcessor().getReadFBO():ct.prevRenderTarget}})}),this.frame===0&&sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Dr(this.copyRenderTarget,function(){ct.outputModel.draw({uniforms:{u_Texture:ct.outputRenderTarget}})}),Dr(Ae.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ct.copyModel.draw({uniforms:{u_Texture:ct.copyRenderTarget}})}),Ae.multiPassRenderer.getPostProcessor().render(Ae));var Vi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Vi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ae,ct,Yt){this.shaderModuleService.registerModule(Ae,{vs:io,fs:ct});var sr=this.shaderModuleService.getModule(Ae),or=sr.vs,Dr=sr.fs,sn=sr.uniforms,Hn=this.rendererService,ea=Hn.createAttribute,la=Hn.createBuffer,ti=Hn.createModel;return ti(qf({vs:or,fs:Dr,attributes:{a_Position:ea({buffer:la({data:[-4,-4,4,-4,0,4],type:Gn.a.FLOAT}),size:2})},uniforms:qf({},sn),depth:{enable:!1},count:3},Yt))}}]),N}(cl),Jf),Ac=Mn()(Bc.prototype,"shaderModuleService",[Pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$f=Mn()(Bc.prototype,"logger",[uc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bc))||If),au=new z.Container;au.bind(D.a.IGlobalConfigService).to(dn).inSingletonScope(),au.bind(D.a.IShaderModuleService).to(cs).inSingletonScope(),au.bind(D.a.ILogService).to(Il).inSingletonScope(),Object(z.decorate)(Object(z.injectable)(),p.EventEmitter),au.bind(D.a.IEventEmitter).to(p.EventEmitter);var Cl=Z()(au,!1),Ef=function(se){var N=Cl.lazyInject(se);return function(G,Ae,ct){N.call(this,G,Ae),ct&&(ct.initializer=function(){return G[Ae]})}},Df=function(se){var N=Cl.lazyMultiInject(se);return function(G,Ae,ct){N.call(this,G,Ae),ct&&(ct.initializer=function(){return G[Ae]})}},Vc=_.c=au,uf=0;function Gc(){var ne=new z.Container;return ne.parent=au,ne.bind(D.a.SceneID).toConstantValue("".concat(uf++)),ne.bind(D.a.ILayerService).to(Wn).inSingletonScope(),ne.bind(D.a.ISceneService).to(Rs).inSingletonScope(),ne.bind(D.a.ICameraService).to(hr).inSingletonScope(),ne.bind(D.a.ICoordinateSystemService).to(Xo).inSingletonScope(),ne.bind(D.a.IInteractionService).to(Le).inSingletonScope(),ne.bind(D.a.IPickingService).to(Ks).inSingletonScope(),ne.bind(D.a.IControlService).to(Kn).inSingletonScope(),ne.bind(D.a.IMarkerService).to(le).inSingletonScope(),ne.bind(D.a.IIconService).to(bt).inSingletonScope(),ne.bind(D.a.IFontService).to(R).inSingletonScope(),ne.bind(D.a.IPopupService).to(Bt).inSingletonScope(),ne.bind(D.a.INormalPass).to(yf).whenTargetNamed("clear"),ne.bind(D.a.INormalPass).to(O).whenTargetNamed("pixelPicking"),ne.bind(D.a.INormalPass).to(of).whenTargetNamed("render"),ne.bind(D.a.INormalPass).to(Cc).whenTargetNamed("taa"),ne.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(N){return se.container.getNamed(D.a.INormalPass,N)}}),ne.bind(D.a.IPostProcessingPass).to(Hi).whenTargetNamed("copy"),ne.bind(D.a.IPostProcessingPass).to(Jt).whenTargetNamed("blurH"),ne.bind(D.a.IPostProcessingPass).to(an).whenTargetNamed("blurV"),ne.bind(D.a.IPostProcessingPass).to(Ko).whenTargetNamed("noise"),ne.bind(D.a.IPostProcessingPass).to(fl).whenTargetNamed("sepia"),ne.bind(D.a.IPostProcessingPass).to(ua).whenTargetNamed("colorHalftone"),ne.bind(D.a.IPostProcessingPass).to(hs).whenTargetNamed("hexagonalPixelate"),ne.bind(D.a.IPostProcessingPass).to(ds).whenTargetNamed("ink"),ne.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(N){var G=se.container.getNamed(D.a.IPostProcessingPass,N);return G.setName(N),G}}),ne}function dl(ne){var se=new z.Container;return se.parent=ne,se.bind(D.a.IStyleAttributeService).to(hf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Gu).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Sf).inSingletonScope(),se}},"t+Cx":function(Fe,_,o){"use strict";o.d(_,"a",function(){return pe});var x=o("L84c"),p=o.n(x),Y=o("++Hr"),z=o.n(Y),i=o("LhPA"),Z=Math.PI/3,D=[0,Z,2*Z,3*Z,4*Z,5*Z];function K(Ce){return Ce[0]}function re(Ce){return Ce[1]}var fe=function(){var Ce=0,mt=0,Ne=1,At=1,Ye=K,Et=re,nt,Ct,Ot;function Re(Be){var ft={},Me=[],ht,Wt=Be.length;for(ht=0;ht<Wt;++ht){if(isNaN(ur=+Ye.call(null,Qt=Be[ht],ht,Be))||isNaN(oe=+Et.call(null,Qt,ht,Be)))continue;var Qt,ur,oe,J=Math.round(oe=oe/Ot),H=Math.round(ur=ur/Ct-(J&1)/2),Se=oe-J;if(Math.abs(Se)*3>1){var be=ur-H,_e=H+(ur<H?-1:1)/2,me=J+(oe<J?-1:1),it=ur-_e,qt=oe-me;be*be+Se*Se>it*it+qt*qt&&(H=_e+(J&1?1:-1)/2,J=me)}var Pt=H+"-"+J,ve=ft[Pt];ve?ve.push(Qt):(Me.push(ve=ft[Pt]=[Qt]),ve.x=(H+(J&1)/2)*Ct,ve.y=J*Ot)}return Me}function Ie(Be){var ft=0,Me=0;return D.map(function(ht){var Wt=Math.sin(ht)*Be,Qt=-Math.cos(ht)*Be,ur=Wt-ft,oe=Qt-Me;return ft=Wt,Me=Qt,[ur,oe]})}return Re.hexagon=function(Be){return"m"+Ie(Be==null?nt:+Be).join("l")+"z"},Re.centers=function(){for(var Be=[],ft=Math.round(mt/Ot),Me=Math.round(Ce/Ct),ht=ft*Ot;ht<At+nt;ht+=Ot,++ft)for(var Wt=Me*Ct+(ft&1)*Ct/2;Wt<Ne+Ct/2;Wt+=Ct)Be.push([Wt,ht]);return Be},Re.mesh=function(){var Be=Ie(nt).slice(0,4).join("l");return Re.centers().map(function(ft){return"M"+ft+"m"+Be}).join("")},Re.x=function(Be){return arguments.length?(Ye=Be,Re):Ye},Re.y=function(Be){return arguments.length?(Et=Be,Re):Et},Re.radius=function(Be){return arguments.length?(nt=+Be,Ct=nt*2*Math.sin(Z),Ot=nt*1.5,Re):nt},Re.size=function(Be){return arguments.length?(Ce=mt=0,Ne=+Be[0],At=+Be[1],Re):[Ne-Ce,At-mt]},Re.extent=function(Be){return arguments.length?(Ce=+Be[0][0],mt=+Be[0][1],Ne=+Be[1][0],At=+Be[1][1],Re):[[Ce,mt],[Ne,At]]},Re.radius(1)};function X(Ce,mt){var Ne=Object.keys(Ce);if(Object.getOwnPropertySymbols){var At=Object.getOwnPropertySymbols(Ce);mt&&(At=At.filter(function(Ye){return Object.getOwnPropertyDescriptor(Ce,Ye).enumerable})),Ne.push.apply(Ne,At)}return Ne}function He(Ce){for(var mt=1;mt<arguments.length;mt++){var Ne=arguments[mt]!=null?arguments[mt]:{};mt%2?X(Object(Ne),!0).forEach(function(At){p()(Ce,At,Ne[At])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ce,Object.getOwnPropertyDescriptors(Ne)):X(Object(Ne)).forEach(function(At){Object.defineProperty(Ce,At,Object.getOwnPropertyDescriptor(Ne,At))})}return Ce}var Xe=6378e3;function pe(Ce,mt){var Ne=Ce.dataArray,At=mt.size,Ye=At===void 0?10:At,Et=mt.method,nt=Et===void 0?"sum":Et,Ct=Ye/(2*Math.PI*Xe)*(256<<20)/2,Ot=Ne.map(function(ft){var Me=Object(i.d)(ft.coordinates),ht=z()(Me,2),Wt=ht[0],Qt=ht[1];return He(He({},ft),{},{coordinates:[Wt,Qt]})}),Re=fe().radius(Ct).x(function(ft){return ft.coordinates[0]}).y(function(ft){return ft.coordinates[1]}),Ie=Re(Ot),Be={dataArray:Ie.map(function(ft,Me){var ht;if(mt.field&&nt){var Wt=i.c.getColumn(ft,mt.field);ft[nt]=i.c.statMap[nt](Wt)}return ht={},p()(ht,mt.method,ft[nt]),p()(ht,"count",ft.length),p()(ht,"rawData",ft),p()(ht,"coordinates",[ft.x,ft.y]),p()(ht,"_id",Me),ht}),radius:Ct,xOffset:Ct,yOffset:Ct,type:"hexagon"};return Be}},tBy1:function(Fe,_){function o(x){return x!==x}Fe.exports=o},tWiu:function(Fe,_){},uB5b:function(Fe,_,o){var x=o("zVLJ"),p=o("U3SQ"),Y=Object.prototype,z=Y.hasOwnProperty;function i(Z,D,K){var re=Z[D];(!(z.call(Z,D)&&p(re,K))||K===void 0&&!(D in Z))&&x(Z,D,K)}Fe.exports=i},uWVo:function(Fe,_,o){var x=o("qG1B"),p=o("OUY8"),Y=o("NW8c");function z(i){return p(i)?Y(i):x(i)}Fe.exports=z},ubZI:function(Fe,_,o){"use strict";o.d(_,"a",function(){return J});var x=o("L84c"),p=o.n(x),Y=o("b83N"),z=o.n(Y),i=o("xjNF"),Z=o.n(i),D=o("vMUQ"),K=o.n(D),re=o("ArX4"),fe=o.n(re),X=o("by6o"),He=o.n(X),Xe=o("QNeN"),pe=o.n(Xe),Ce=o("33CM"),mt=o.n(Ce),Ne=o("5+VK"),At=o.n(Ne),Ye=o("Tj1F"),Et=o("LhPA"),nt=o("2pGt"),Ct=o("UqwA"),Ot=o("ihlD");function Re(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]>Se&&(Se=H[be]);return Se}function Ie(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Se=H[0],be=1;be<H.length;be++)H[be]<Se&&(Se=H[be]);return Se}function Be(H){if(H.length===0)return 0;for(var Se=H[0],be=0,_e,me=1;me<H.length;me++)_e=Se+H[me]*1,Math.abs(Se)>=Math.abs(H[me])?be+=Se-_e+H[me]:be+=H[me]-_e+Se,Se=_e;return Se+be*1}function ft(H){if(H.length===0)throw new Error("mean requires at least one data point");return Be(H)/H.length}var Me={min:Ie,max:Re,mean:ft,sum:Be};function ht(H,Se){return H.map(function(be){return be[Se]*1})}function Wt(H,Se){var be=Object.keys(H);if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(H);Se&&(_e=_e.filter(function(me){return Object.getOwnPropertyDescriptor(H,me).enumerable})),be.push.apply(be,_e)}return be}function Qt(H){for(var Se=1;Se<arguments.length;Se++){var be=arguments[Se]!=null?arguments[Se]:{};Se%2?Wt(Object(be),!0).forEach(function(_e){p()(H,_e,be[_e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(be)):Wt(Object(be)).forEach(function(_e){Object.defineProperty(H,_e,Object.getOwnPropertyDescriptor(be,_e))})}return H}function ur(H){var Se=oe();return function(){var _e=He()(H),me;if(Se){var it=He()(this).constructor;me=Reflect.construct(_e,arguments,it)}else me=_e.apply(this,arguments);return fe()(this,me)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var J=function(H){K()(be,H);var Se=ur(be);function be(_e,me){var it;return z()(this,be),it=Se.call(this),it.data=void 0,it.extent=void 0,it.hooks={init:new Ye.c},it.parser={type:"geojson"},it.transforms=[],it.cluster=!1,it.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},it.originData=void 0,it.rawData=void 0,it.clusterIndex=void 0,it.originData=_e,it.initCfg(me),it.hooks.init.tap("parser",function(){it.excuteParser()}),it.hooks.init.tap("cluster",function(){it.initCluster()}),it.hooks.init.tap("transform",function(){it.executeTrans()}),it.init(),it}return Z()(be,[{key:"setData",value:function(me,it){this.rawData=me,this.originData=me,this.initCfg(it),this.init(),this.emit("update")}},{key:"getClusters",value:function(me){return this.clusterIndex.getClusters(this.extent,me)}},{key:"getClustersLeaves",value:function(me){return this.clusterIndex.getLeaves(me,Infinity)}},{key:"updateClusterData",value:function(me){var it=this,qt=this.clusterOptions,Pt=qt.method,ve=Pt===void 0?"sum":Pt,ge=qt.field,Ve=Object(Et.r)(Object(Et.h)(this.extent),2),st=this.clusterIndex.getClusters(Ve[0].concat(Ve[1]),Math.floor(me));this.clusterOptions.zoom=me,st.forEach(function(Oe){Oe.id||(Oe.properties.point_count=1)}),(ge||mt()(ve))&&(st=st.map(function(Oe){var vt=Oe.id;if(vt){var C=it.clusterIndex.getLeaves(vt,Infinity),R=C.map(function(Ge){return Ge.properties}),q;if(pe()(ve)&&ge){var ce=ht(R,ge);q=Me[ve](ce)}mt()(ve)&&(q=ve(R)),Oe.properties.stat=q}else Oe.properties.point_count=1;return Oe})),this.data=Object(Ct.getParser)("geojson")({type:"FeatureCollection",features:st}),this.executeTrans()}},{key:"getFeatureById",value:function(me){var it=this.parser.type,qt=it===void 0?"geojson":it;if(qt==="geojson"&&!this.cluster){var Pt=me<this.originData.features.length?this.originData.features[me]:"null",ve=At()(Pt);if(this.transforms.length!==0){var ge=this.data.dataArray.find(function(Ve){return Ve._id===me});ve.properties=ge}return ve}else return me<this.data.dataArray.length?this.data.dataArray[me]:"null"}},{key:"getFeatureId",value:function(me,it){var qt=this.data.dataArray.find(function(Pt){return Pt[me]===name});return qt==null?void 0:qt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(me){me&&(me.parser&&(this.parser=me.parser),me.transforms&&(this.transforms=me.transforms),this.cluster=me.cluster||!1,me.clusterOptions&&(this.cluster=!0,this.clusterOptions=Qt(Qt({},this.clusterOptions),me.clusterOptions)))}},{key:"excuteParser",value:function(){var me=this.parser,it=me.type||"geojson",qt=Object(Ct.getParser)(it);this.data=qt(this.originData,me),this.extent=Object(Et.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var me=this,it=this.transforms;it.forEach(function(qt){var Pt=qt.type,ve=Object(Ct.getTransform)(Pt)(me.data,qt);Object.assign(me.data,ve)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var me=this.clusterOptions||{};this.clusterIndex=Object(Ot.a)(this.data,me)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),be}(nt.EventEmitter)},ueXz:function(Fe,_,o){"use strict";o.d(_,"a",function(){return re});var x=o("L84c"),p=o.n(x),Y=o("h9B+"),z=o.n(Y),i=o("KgZ/"),Z=o.n(i);function D(fe,X){var He=Object.keys(fe);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(fe);X&&(Xe=Xe.filter(function(pe){return Object.getOwnPropertyDescriptor(fe,pe).enumerable})),He.push.apply(He,Xe)}return He}function K(fe){for(var X=1;X<arguments.length;X++){var He=arguments[X]!=null?arguments[X]:{};X%2?D(Object(He),!0).forEach(function(Xe){p()(fe,Xe,He[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(fe,Object.getOwnPropertyDescriptors(He)):D(Object(He)).forEach(function(Xe){Object.defineProperty(fe,Xe,Object.getOwnPropertyDescriptor(He,Xe))})}return fe}function re(fe,X){var He=X.x,Xe=X.y,pe=X.x1,Ce=X.y1,mt=X.coordinates,Ne=[];return fe.forEach(function(At,Ye){var Et=[];if(He&&Xe&&(Et=[parseFloat(At[He]),parseFloat(At[Xe])]),He&&Xe&&pe&&Ce){var nt=[parseFloat(At[He]),parseFloat(At[Xe])],Ct=[parseFloat(At[pe]),parseFloat(At[Ce])];Et=[nt,Ct]}if(mt){var Ot="Polygon";Array.isArray(mt[0])||(Ot="Point"),Array.isArray(mt[0])&&!Array.isArray(mt[0][0])&&(Ot="LineString");var Re={type:Ot,coordinates:z()(At[mt])};Z()(Re,!0),Et=Re.coordinates}var Ie=K(K({},At),{},{_id:Ye,coordinates:Et});Ne.push(Ie)}),{dataArray:Ne}}},ujT9:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});function x(p,Y){var z=Y.callback;return z&&(p.dataArray=p.dataArray.filter(z)),p}},v6Pd:function(Fe,_){function o(x){return function(p,Y,z){for(var i=-1,Z=Object(p),D=z(p),K=D.length;K--;){var re=D[x?K:++i];if(Y(Z[re],re,Z)===!1)break}return p}}Fe.exports=o},v7Ln:function(Fe,_){var o=/\w*$/;function x(p){var Y=new p.constructor(p.source,o.exec(p));return Y.lastIndex=p.lastIndex,Y}Fe.exports=x},vG7H:function(Fe,_,o){var x=o("roZi"),p=o("PPmI"),Y=o("wCGl");function z(i){return typeof i.constructor=="function"&&!Y(i)?x(p(i)):{}}Fe.exports=z},vZkN:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("QbGg"),p=function(){function Y(z){this.id=x.id(),this.container=z}return Y.prototype.addPlan=function(z){this.plan=z},Y.prototype.setCurrentRequest=function(z){this.currentRequest=z},Y}();_.Context=p},vlZP:function(Fe,_,o){var x=o("nz7D"),p=x("toUpperCase");Fe.exports=p},wEuU:function(Fe,_,o){var x=o("aXON"),p=1/0,Y=17976931348623157e292;function z(i){if(!i)return i===0?i:0;if(i=x(i),i===p||i===-p){var Z=i<0?-1:1;return Z*Y}return i===i?i:0}Fe.exports=z},wHDA:function(Fe,_,o){var x=o("QH1C");function p(Y,z){var i=z?x(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.length)}Fe.exports=p},wndA:function(Fe,_,o){var x=o("iFIB"),p=o("LhK6"),Y=o("kHJI");function z(i){return Y(i)?x(i,!0):p(i)}Fe.exports=z},x00w:function(Fe,_,o){"use strict";var x=o("qSre"),p=o("9ntj")},xG66:function(Fe,_){},xOfz:function(Fe,_,o){"use strict";o.d(_,"a",function(){return x});var x=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},xVag:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("0d2E"),p=o("7s3S"),Y=o("Cv2u"),z=o("QTk+"),i=o("c2Jw"),Z=function(fe,X,He){try{return He()}catch(Xe){throw Y.isStackOverflowExeption(Xe)?new Error(x.CIRCULAR_DEPENDENCY_IN_FACTORY(fe,X.toString())):Xe}},D=function re(fe){return function(X){X.parentContext.setCurrentRequest(X);var He=X.bindings,Xe=X.childRequests,pe=X.target&&X.target.isArray(),Ce=!X.parentRequest||!X.parentRequest.target||!X.target||!X.parentRequest.target.matchesArray(X.target.serviceIdentifier);if(pe&&Ce)return Xe.map(function(nt){var Ct=re(fe);return Ct(nt)});var mt=null;if(X.target.isOptional()&&He.length===0)return;var Ne=He[0],At=Ne.scope===p.BindingScopeEnum.Singleton,Ye=Ne.scope===p.BindingScopeEnum.Request;if(At&&Ne.activated)return Ne.cache;if(Ye&&fe!==null&&fe.has(Ne.id))return fe.get(Ne.id);if(Ne.type===p.BindingTypeEnum.ConstantValue)mt=Ne.cache;else if(Ne.type===p.BindingTypeEnum.Function)mt=Ne.cache;else if(Ne.type===p.BindingTypeEnum.Constructor)mt=Ne.implementationType;else if(Ne.type===p.BindingTypeEnum.DynamicValue&&Ne.dynamicValue!==null)mt=Z("toDynamicValue",Ne.serviceIdentifier,function(){return Ne.dynamicValue(X.parentContext)});else if(Ne.type===p.BindingTypeEnum.Factory&&Ne.factory!==null)mt=Z("toFactory",Ne.serviceIdentifier,function(){return Ne.factory(X.parentContext)});else if(Ne.type===p.BindingTypeEnum.Provider&&Ne.provider!==null)mt=Z("toProvider",Ne.serviceIdentifier,function(){return Ne.provider(X.parentContext)});else if(Ne.type===p.BindingTypeEnum.Instance&&Ne.implementationType!==null)mt=i.resolveInstance(Ne.implementationType,Xe,re(fe));else{var Et=z.getServiceIdentifierAsString(X.serviceIdentifier);throw new Error(x.INVALID_BINDING_TYPE+" "+Et)}return typeof Ne.onActivation=="function"&&(mt=Ne.onActivation(X.parentContext,mt)),At&&(Ne.cache=mt,Ne.activated=!0),Ye&&fe!==null&&!fe.has(Ne.id)&&fe.set(Ne.id,mt),mt}};function K(re){var fe=D(re.plan.rootRequest.requestScope);return fe(re.plan.rootRequest)}_.resolve=K},xZJU:function(Fe,_,o){var x=o("d55j"),p=o("wooT");function Y(z,i){return x(z,p(z),i)}Fe.exports=Y},xl7n:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("3XrA");function p(fe){if(!fe)throw new Error("coord is required");if(!Array.isArray(fe)){if(fe.type==="Feature"&&fe.geometry!==null&&fe.geometry.type==="Point")return fe.geometry.coordinates;if(fe.type==="Point")return fe.coordinates}if(Array.isArray(fe)&&fe.length>=2&&!Array.isArray(fe[0])&&!Array.isArray(fe[1]))return fe;throw new Error("coord must be GeoJSON Point or an Array of numbers")}_.getCoord=p;function Y(fe){if(Array.isArray(fe))return fe;if(fe.type==="Feature"){if(fe.geometry!==null)return fe.geometry.coordinates}else if(fe.coordinates)return fe.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}_.getCoords=Y;function z(fe){if(fe.length>1&&x.isNumber(fe[0])&&x.isNumber(fe[1]))return!0;if(Array.isArray(fe[0])&&fe[0].length)return z(fe[0]);throw new Error("coordinates must only contain numbers")}_.containsNumber=z;function i(fe,X,He){if(!X||!He)throw new Error("type and name required");if(!fe||fe.type!==X)throw new Error("Invalid input to "+He+": must be a "+X+", given "+fe.type)}_.geojsonType=i;function Z(fe,X,He){if(!fe)throw new Error("No feature passed");if(!He)throw new Error(".featureOf() requires a name");if(!fe||fe.type!=="Feature"||!fe.geometry)throw new Error("Invalid input to "+He+", Feature with geometry required");if(!fe.geometry||fe.geometry.type!==X)throw new Error("Invalid input to "+He+": must be a "+X+", given "+fe.geometry.type)}_.featureOf=Z;function D(fe,X,He){if(!fe)throw new Error("No featureCollection passed");if(!He)throw new Error(".collectionOf() requires a name");if(!fe||fe.type!=="FeatureCollection")throw new Error("Invalid input to "+He+", FeatureCollection required");for(var Xe=0,pe=fe.features;Xe<pe.length;Xe++){var Ce=pe[Xe];if(!Ce||Ce.type!=="Feature"||!Ce.geometry)throw new Error("Invalid input to "+He+", Feature with geometry required");if(!Ce.geometry||Ce.geometry.type!==X)throw new Error("Invalid input to "+He+": must be a "+X+", given "+Ce.geometry.type)}}_.collectionOf=D;function K(fe){return fe.type==="Feature"?fe.geometry:fe}_.getGeom=K;function re(fe,X){return fe.type==="FeatureCollection"?"FeatureCollection":fe.type==="GeometryCollection"?"GeometryCollection":fe.type==="Feature"&&fe.geometry!==null?fe.geometry.type:fe.type}_.getType=re},xrLW:function(Fe,_,o){var x=o("JArH");function p(Y){return Y==null?"":x(Y)}Fe.exports=p},y1Ry:function(Fe,_){},"y5r/":function(Fe,_,o){var x=o("4NP+"),p=o("48OD");function Y(z,i,Z){return p()?Fe.exports=Y=Reflect.construct:Fe.exports=Y=function(K,re,fe){var X=[null];X.push.apply(X,re);var He=Function.bind.apply(K,X),Xe=new He;return fe&&x(Xe,fe.prototype),Xe},Y.apply(null,arguments)}Fe.exports=Y},yktm:function(Fe,_,o){"use strict";o.r(_),o.d(_,"create",function(){return p}),o.d(_,"clone",function(){return Y}),o.d(_,"fromValues",function(){return z}),o.d(_,"copy",function(){return i}),o.d(_,"set",function(){return Z}),o.d(_,"add",function(){return D}),o.d(_,"subtract",function(){return K}),o.d(_,"multiply",function(){return re}),o.d(_,"divide",function(){return fe}),o.d(_,"ceil",function(){return X}),o.d(_,"floor",function(){return He}),o.d(_,"min",function(){return Xe}),o.d(_,"max",function(){return pe}),o.d(_,"round",function(){return Ce}),o.d(_,"scale",function(){return mt}),o.d(_,"scaleAndAdd",function(){return Ne}),o.d(_,"distance",function(){return At}),o.d(_,"squaredDistance",function(){return Ye}),o.d(_,"length",function(){return Et}),o.d(_,"squaredLength",function(){return nt}),o.d(_,"negate",function(){return Ct}),o.d(_,"inverse",function(){return Ot}),o.d(_,"normalize",function(){return Re}),o.d(_,"dot",function(){return Ie}),o.d(_,"cross",function(){return Be}),o.d(_,"lerp",function(){return ft}),o.d(_,"random",function(){return Me}),o.d(_,"transformMat4",function(){return ht}),o.d(_,"transformQuat",function(){return Wt}),o.d(_,"zero",function(){return Qt}),o.d(_,"str",function(){return ur}),o.d(_,"exactEquals",function(){return oe}),o.d(_,"equals",function(){return J}),o.d(_,"sub",function(){return H}),o.d(_,"mul",function(){return Se}),o.d(_,"div",function(){return be}),o.d(_,"dist",function(){return _e}),o.d(_,"sqrDist",function(){return me}),o.d(_,"len",function(){return it}),o.d(_,"sqrLen",function(){return qt}),o.d(_,"forEach",function(){return Pt});var x=o("TaHB");function p(){var ve=new x.a(4);return x.a!=Float32Array&&(ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0),ve}function Y(ve){var ge=new x.a(4);return ge[0]=ve[0],ge[1]=ve[1],ge[2]=ve[2],ge[3]=ve[3],ge}function z(ve,ge,Ve,st){var Oe=new x.a(4);return Oe[0]=ve,Oe[1]=ge,Oe[2]=Ve,Oe[3]=st,Oe}function i(ve,ge){return ve[0]=ge[0],ve[1]=ge[1],ve[2]=ge[2],ve[3]=ge[3],ve}function Z(ve,ge,Ve,st,Oe){return ve[0]=ge,ve[1]=Ve,ve[2]=st,ve[3]=Oe,ve}function D(ve,ge,Ve){return ve[0]=ge[0]+Ve[0],ve[1]=ge[1]+Ve[1],ve[2]=ge[2]+Ve[2],ve[3]=ge[3]+Ve[3],ve}function K(ve,ge,Ve){return ve[0]=ge[0]-Ve[0],ve[1]=ge[1]-Ve[1],ve[2]=ge[2]-Ve[2],ve[3]=ge[3]-Ve[3],ve}function re(ve,ge,Ve){return ve[0]=ge[0]*Ve[0],ve[1]=ge[1]*Ve[1],ve[2]=ge[2]*Ve[2],ve[3]=ge[3]*Ve[3],ve}function fe(ve,ge,Ve){return ve[0]=ge[0]/Ve[0],ve[1]=ge[1]/Ve[1],ve[2]=ge[2]/Ve[2],ve[3]=ge[3]/Ve[3],ve}function X(ve,ge){return ve[0]=Math.ceil(ge[0]),ve[1]=Math.ceil(ge[1]),ve[2]=Math.ceil(ge[2]),ve[3]=Math.ceil(ge[3]),ve}function He(ve,ge){return ve[0]=Math.floor(ge[0]),ve[1]=Math.floor(ge[1]),ve[2]=Math.floor(ge[2]),ve[3]=Math.floor(ge[3]),ve}function Xe(ve,ge,Ve){return ve[0]=Math.min(ge[0],Ve[0]),ve[1]=Math.min(ge[1],Ve[1]),ve[2]=Math.min(ge[2],Ve[2]),ve[3]=Math.min(ge[3],Ve[3]),ve}function pe(ve,ge,Ve){return ve[0]=Math.max(ge[0],Ve[0]),ve[1]=Math.max(ge[1],Ve[1]),ve[2]=Math.max(ge[2],Ve[2]),ve[3]=Math.max(ge[3],Ve[3]),ve}function Ce(ve,ge){return ve[0]=Math.round(ge[0]),ve[1]=Math.round(ge[1]),ve[2]=Math.round(ge[2]),ve[3]=Math.round(ge[3]),ve}function mt(ve,ge,Ve){return ve[0]=ge[0]*Ve,ve[1]=ge[1]*Ve,ve[2]=ge[2]*Ve,ve[3]=ge[3]*Ve,ve}function Ne(ve,ge,Ve,st){return ve[0]=ge[0]+Ve[0]*st,ve[1]=ge[1]+Ve[1]*st,ve[2]=ge[2]+Ve[2]*st,ve[3]=ge[3]+Ve[3]*st,ve}function At(ve,ge){var Ve=ge[0]-ve[0],st=ge[1]-ve[1],Oe=ge[2]-ve[2],vt=ge[3]-ve[3];return Math.hypot(Ve,st,Oe,vt)}function Ye(ve,ge){var Ve=ge[0]-ve[0],st=ge[1]-ve[1],Oe=ge[2]-ve[2],vt=ge[3]-ve[3];return Ve*Ve+st*st+Oe*Oe+vt*vt}function Et(ve){var ge=ve[0],Ve=ve[1],st=ve[2],Oe=ve[3];return Math.hypot(ge,Ve,st,Oe)}function nt(ve){var ge=ve[0],Ve=ve[1],st=ve[2],Oe=ve[3];return ge*ge+Ve*Ve+st*st+Oe*Oe}function Ct(ve,ge){return ve[0]=-ge[0],ve[1]=-ge[1],ve[2]=-ge[2],ve[3]=-ge[3],ve}function Ot(ve,ge){return ve[0]=1/ge[0],ve[1]=1/ge[1],ve[2]=1/ge[2],ve[3]=1/ge[3],ve}function Re(ve,ge){var Ve=ge[0],st=ge[1],Oe=ge[2],vt=ge[3],C=Ve*Ve+st*st+Oe*Oe+vt*vt;return C>0&&(C=1/Math.sqrt(C)),ve[0]=Ve*C,ve[1]=st*C,ve[2]=Oe*C,ve[3]=vt*C,ve}function Ie(ve,ge){return ve[0]*ge[0]+ve[1]*ge[1]+ve[2]*ge[2]+ve[3]*ge[3]}function Be(ve,ge,Ve,st){var Oe=Ve[0]*st[1]-Ve[1]*st[0],vt=Ve[0]*st[2]-Ve[2]*st[0],C=Ve[0]*st[3]-Ve[3]*st[0],R=Ve[1]*st[2]-Ve[2]*st[1],q=Ve[1]*st[3]-Ve[3]*st[1],ce=Ve[2]*st[3]-Ve[3]*st[2],Ge=ge[0],qe=ge[1],Tt=ge[2],ot=ge[3];return ve[0]=qe*ce-Tt*q+ot*R,ve[1]=-(Ge*ce)+Tt*C-ot*vt,ve[2]=Ge*q-qe*C+ot*Oe,ve[3]=-(Ge*R)+qe*vt-Tt*Oe,ve}function ft(ve,ge,Ve,st){var Oe=ge[0],vt=ge[1],C=ge[2],R=ge[3];return ve[0]=Oe+st*(Ve[0]-Oe),ve[1]=vt+st*(Ve[1]-vt),ve[2]=C+st*(Ve[2]-C),ve[3]=R+st*(Ve[3]-R),ve}function Me(ve,ge){ge=ge||1;var Ve,st,Oe,vt,C,R;do Ve=x.c()*2-1,st=x.c()*2-1,C=Ve*Ve+st*st;while(C>=1);do Oe=x.c()*2-1,vt=x.c()*2-1,R=Oe*Oe+vt*vt;while(R>=1);var q=Math.sqrt((1-C)/R);return ve[0]=ge*Ve,ve[1]=ge*st,ve[2]=ge*Oe*q,ve[3]=ge*vt*q,ve}function ht(ve,ge,Ve){var st=ge[0],Oe=ge[1],vt=ge[2],C=ge[3];return ve[0]=Ve[0]*st+Ve[4]*Oe+Ve[8]*vt+Ve[12]*C,ve[1]=Ve[1]*st+Ve[5]*Oe+Ve[9]*vt+Ve[13]*C,ve[2]=Ve[2]*st+Ve[6]*Oe+Ve[10]*vt+Ve[14]*C,ve[3]=Ve[3]*st+Ve[7]*Oe+Ve[11]*vt+Ve[15]*C,ve}function Wt(ve,ge,Ve){var st=ge[0],Oe=ge[1],vt=ge[2],C=Ve[0],R=Ve[1],q=Ve[2],ce=Ve[3],Ge=ce*st+R*vt-q*Oe,qe=ce*Oe+q*st-C*vt,Tt=ce*vt+C*Oe-R*st,ot=-C*st-R*Oe-q*vt;return ve[0]=Ge*ce+ot*-C+qe*-q-Tt*-R,ve[1]=qe*ce+ot*-R+Tt*-C-Ge*-q,ve[2]=Tt*ce+ot*-q+Ge*-R-qe*-C,ve[3]=ge[3],ve}function Qt(ve){return ve[0]=0,ve[1]=0,ve[2]=0,ve[3]=0,ve}function ur(ve){return"vec4("+ve[0]+", "+ve[1]+", "+ve[2]+", "+ve[3]+")"}function oe(ve,ge){return ve[0]===ge[0]&&ve[1]===ge[1]&&ve[2]===ge[2]&&ve[3]===ge[3]}function J(ve,ge){var Ve=ve[0],st=ve[1],Oe=ve[2],vt=ve[3],C=ge[0],R=ge[1],q=ge[2],ce=ge[3];return Math.abs(Ve-C)<=x.b*Math.max(1,Math.abs(Ve),Math.abs(C))&&Math.abs(st-R)<=x.b*Math.max(1,Math.abs(st),Math.abs(R))&&Math.abs(Oe-q)<=x.b*Math.max(1,Math.abs(Oe),Math.abs(q))&&Math.abs(vt-ce)<=x.b*Math.max(1,Math.abs(vt),Math.abs(ce))}var H=K,Se=re,be=fe,_e=At,me=Ye,it=Et,qt=nt,Pt=function(){var ve=p();return function(ge,Ve,st,Oe,vt,C){var R,q;for(Ve||(Ve=4),st||(st=0),Oe?q=Math.min(Oe*Ve+st,ge.length):q=ge.length,R=st;R<q;R+=Ve)ve[0]=ge[R],ve[1]=ge[R+1],ve[2]=ge[R+2],ve[3]=ge[R+3],vt(ve,ve,C),ge[R]=ve[0],ge[R+1]=ve[1],ge[R+2]=ve[2],ge[R+3]=ve[3];return ge}}()},zOZK:function(Fe,_,o){var x=o("5uMz"),p=o("tBy1"),Y=o("ez++");function z(i,Z,D){return Z===Z?Y(i,Z,D):x(i,p,D)}Fe.exports=z},zVLJ:function(Fe,_,o){var x=o("USOk");function p(Y,z,i){z=="__proto__"&&x?x(Y,z,{configurable:!0,enumerable:!0,value:i,writable:!0}):Y[z]=i}Fe.exports=p},zaTR:function(Fe,_,o){var x=o("QH1C");function p(Y,z){var i=z?x(Y.buffer):Y.buffer;return new Y.constructor(i,Y.byteOffset,Y.byteLength)}Fe.exports=p},zyyB:function(Fe,_,o){"use strict";Object.defineProperty(_,"__esModule",{value:!0});var x=o("QbGg"),p=function(){function z(i){this.id=x.id(),this.registry=i}return z}();_.ContainerModule=p;var Y=function(){function z(i){this.id=x.id(),this.registry=i}return z}();_.AsyncContainerModule=Y}}]);
